<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Inferring a Binomial Probability via Exact Mathematical Analysis | Doing Bayesian Data Analysis in brms and the tidyverse</title>
  <meta name="description" content="This project is an attempt to re-express the code in Kruschke’s (2014) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Inferring a Binomial Probability via Exact Mathematical Analysis | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This project is an attempt to re-express the code in Kruschke’s (2014) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="github-repo" content="ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Inferring a Binomial Probability via Exact Mathematical Analysis | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This project is an attempt to re-express the code in Kruschke’s (2014) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2019-10-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bayes-rule.html">
<link rel="next" href="markov-chain-monte-carlo.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What and why</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#caution-work-in-progress"><i class="fa fa-check"></i>Caution: Work in progress</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html"><i class="fa fa-check"></i><b>1</b> What’s in This Book (Read This First!)</a><ul>
<li class="chapter" data-level="1.1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#real-people-can-read-this-book"><i class="fa fa-check"></i><b>1.1</b> Real people can read this book</a></li>
<li class="chapter" data-level="1.2" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-in-this-book"><i class="fa fa-check"></i><b>1.2</b> What’s in this book</a></li>
<li class="chapter" data-level="1.3" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-new-in-the-second-edition"><i class="fa fa-check"></i><b>1.3</b> What’s new in the second edition</a></li>
<li class="chapter" data-level="1.4" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#gimme-feedback-be-polite"><i class="fa fa-check"></i><b>1.4</b> Gimme feedback (be polite)</a></li>
<li class="chapter" data-level="1.5" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#thank-you"><i class="fa fa-check"></i><b>1.5</b> Thank you!</a></li>
<li class="chapter" data-level="" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#reference"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>I THE BASICS: MODELS, PROBABILITY, BAYES’ RULE, AND R</b></span></li>
<li class="chapter" data-level="2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html"><i class="fa fa-check"></i><b>2</b> Introduction: Credibility, Models, and Parameters</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#bayesian-inference-is-reallocation-of-credibility-across-possibilities"><i class="fa fa-check"></i><b>2.1</b> Bayesian inference is reallocation of credibility across possibilities</a><ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#data-are-noisy-and-inferences-are-probabilistic."><i class="fa fa-check"></i><b>2.1.1</b> Data are noisy and inferences are probabilistic.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#possibilities-are-parameter-values-in-descriptive-models"><i class="fa fa-check"></i><b>2.2</b> Possibilities are parameter values in descriptive models</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#the-steps-of-bayesian-data-analysis"><i class="fa fa-check"></i><b>2.3</b> The steps of Bayesian data analysis</a></li>
<li class="chapter" data-level="" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#reference-1"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html"><i class="fa fa-check"></i><b>3</b> The R Programming Language</a><ul>
<li class="chapter" data-level="3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-software"><i class="fa fa-check"></i><b>3.1</b> Get the software</a><ul>
<li class="chapter" data-level="3.1.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-look-at-rstudio."><i class="fa fa-check"></i><b>3.1.1</b> A look at RStudio.</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-simple-example-of-r-in-action"><i class="fa fa-check"></i><b>3.2</b> A simple example of R in action</a><ul>
<li class="chapter" data-level="3.2.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-programs-used-with-this-book."><i class="fa fa-check"></i><b>3.2.1</b> Get the programs used with this book.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#basic-commands-and-operators-in-r"><i class="fa fa-check"></i><b>3.3</b> Basic commands and operators in R</a><ul>
<li class="chapter" data-level="3.3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#getting-help-in-r."><i class="fa fa-check"></i><b>3.3.1</b> Getting help in R.</a></li>
<li class="chapter" data-level="3.3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#arithmetic-and-logical-operators."><i class="fa fa-check"></i><b>3.3.2</b> Arithmetic and logical operators.</a></li>
<li class="chapter" data-level="3.3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#assignment-relational-operators-and-tests-of-equality."><i class="fa fa-check"></i><b>3.3.3</b> Assignment, relational operators, and tests of equality.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-types"><i class="fa fa-check"></i><b>3.4</b> Variable types</a><ul>
<li class="chapter" data-level="3.4.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#vector."><i class="fa fa-check"></i><b>3.4.1</b> Vector.</a></li>
<li class="chapter" data-level="3.4.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#factor."><i class="fa fa-check"></i><b>3.4.2</b> Factor.</a></li>
<li class="chapter" data-level="3.4.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#matrix-and-array."><i class="fa fa-check"></i><b>3.4.3</b> Matrix and array.</a></li>
<li class="chapter" data-level="3.4.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#list-and-data-frame."><i class="fa fa-check"></i><b>3.4.4</b> List and data frame.</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#loading-and-saving-data"><i class="fa fa-check"></i><b>3.5</b> Loading and saving data</a><ul>
<li class="chapter" data-level="3.5.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#the-read.csv-read_csv-and-read.table-read_table-functions."><i class="fa fa-check"></i><b>3.5.1</b> The <del>read.csv</del> <code>read_csv()</code> and <del>read.table</del> <code>read_table()</code> functions.</a></li>
<li class="chapter" data-level="3.5.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#saving-data-from-r."><i class="fa fa-check"></i><b>3.5.2</b> Saving data from R.</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#some-utility-functions"><i class="fa fa-check"></i><b>3.6</b> Some utility functions</a></li>
<li class="chapter" data-level="3.7" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-in-r"><i class="fa fa-check"></i><b>3.7</b> Programming in R</a><ul>
<li class="chapter" data-level="3.7.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-names-in-r."><i class="fa fa-check"></i><b>3.7.1</b> Variable names in R.</a></li>
<li class="chapter" data-level="3.7.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#running-a-program."><i class="fa fa-check"></i><b>3.7.2</b> Running a program.</a></li>
<li class="chapter" data-level="3.7.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-a-function."><i class="fa fa-check"></i><b>3.7.3</b> Programming a function.</a></li>
<li class="chapter" data-level="3.7.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#conditions-and-loops."><i class="fa fa-check"></i><b>3.7.4</b> Conditions and loops.</a></li>
<li class="chapter" data-level="3.7.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#measuring-processing-time."><i class="fa fa-check"></i><b>3.7.5</b> Measuring processing time.</a></li>
<li class="chapter" data-level="3.7.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#debugging."><i class="fa fa-check"></i><b>3.7.6</b> Debugging.</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#graphical-plots-opening-and-saving"><i class="fa fa-check"></i><b>3.8</b> Graphical plots: Opening and saving</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#reference-2"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html"><i class="fa fa-check"></i><b>4</b> What is This Stuff Called Probability?</a><ul>
<li class="chapter" data-level="4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#the-set-of-all-possible-events"><i class="fa fa-check"></i><b>4.1</b> The set of all possible events</a></li>
<li class="chapter" data-level="4.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-outside-or-inside-the-head"><i class="fa fa-check"></i><b>4.2</b> Probability: Outside or inside the head</a><ul>
<li class="chapter" data-level="4.2.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#outside-the-head-long-run-relative-frequency."><i class="fa fa-check"></i><b>4.2.1</b> Outside the head: Long-run relative frequency.</a></li>
<li class="chapter" data-level="4.2.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#inside-the-head-subjective-belief."><i class="fa fa-check"></i><b>4.2.2</b> Inside the head: Subjective belief.</a></li>
<li class="chapter" data-level="4.2.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probabilities-assign-numbers-to-possibilities."><i class="fa fa-check"></i><b>4.2.3</b> Probabilities assign numbers to possibilities.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-distributions"><i class="fa fa-check"></i><b>4.3</b> Probability distributions</a><ul>
<li class="chapter" data-level="4.3.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#discrete-distributions-probability-mass."><i class="fa fa-check"></i><b>4.3.1</b> Discrete distributions: Probability mass.</a></li>
<li class="chapter" data-level="4.3.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#continuous-distributions-rendezvous-with-density."><i class="fa fa-check"></i><b>4.3.2</b> Continuous distributions: Rendezvous with density.</a></li>
<li class="chapter" data-level="4.3.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#mean-and-variance-of-a-distribution."><i class="fa fa-check"></i><b>4.3.3</b> Mean and variance of a distribution.</a></li>
<li class="chapter" data-level="4.3.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#highest-density-interval-hdi."><i class="fa fa-check"></i><b>4.3.4</b> Highest density interval (HDI).</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#two-way-distributions"><i class="fa fa-check"></i><b>4.4</b> Two-way distributions</a></li>
<li class="chapter" data-level="" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#reference-3"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes-rule.html"><a href="bayes-rule.html"><i class="fa fa-check"></i><b>5</b> Bayes’ Rule</a><ul>
<li class="chapter" data-level="5.1" data-path="bayes-rule.html"><a href="bayes-rule.html#bayes-rule-1"><i class="fa fa-check"></i><b>5.1</b> Bayes’ rule</a><ul>
<li class="chapter" data-level="5.1.1" data-path="bayes-rule.html"><a href="bayes-rule.html#derived-from-definitions-of-conditional-probability."><i class="fa fa-check"></i><b>5.1.1</b> Derived from definitions of conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bayes-rule.html"><a href="bayes-rule.html#applied-to-parameters-and-data"><i class="fa fa-check"></i><b>5.2</b> Applied to parameters and data</a></li>
<li class="chapter" data-level="5.3" data-path="bayes-rule.html"><a href="bayes-rule.html#complete-examples-estimating-bias-in-a-coin"><i class="fa fa-check"></i><b>5.3</b> Complete examples: Estimating bias in a coin</a><ul>
<li class="chapter" data-level="5.3.1" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-sample-size-on-the-posterior."><i class="fa fa-check"></i><b>5.3.1</b> Influence of sample size on the posterior.</a></li>
<li class="chapter" data-level="5.3.2" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-prior-on-the-posterior."><i class="fa fa-check"></i><b>5.3.2</b> Influence of prior on the posterior.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="bayes-rule.html"><a href="bayes-rule.html#why-bayesian-inference-can-be-difficult"><i class="fa fa-check"></i><b>5.4</b> Why Bayesian inference can be difficult</a></li>
<li class="chapter" data-level="" data-path="bayes-rule.html"><a href="bayes-rule.html#reference-4"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="bayes-rule.html"><a href="bayes-rule.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>II ALL THE FUNDAMENTALS APPLIED TO INFERRING A BINOMIAL PROBABILITY</b></span></li>
<li class="chapter" data-level="6" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><i class="fa fa-check"></i><b>6</b> Inferring a Binomial Probability via Exact Mathematical Analysis</a><ul>
<li class="chapter" data-level="6.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-likelihood-function-the-bernoulli-distribution"><i class="fa fa-check"></i><b>6.1</b> The likelihood function: The Bernoulli distribution</a></li>
<li class="chapter" data-level="6.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#a-description-of-credibilities-the-beta-distribution"><i class="fa fa-check"></i><b>6.2</b> A description of credibilities: The beta distribution</a><ul>
<li class="chapter" data-level="6.2.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#specifying-a-beta-prior."><i class="fa fa-check"></i><b>6.2.1</b> Specifying a beta prior.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-posterior-beta"><i class="fa fa-check"></i><b>6.3</b> The posterior beta</a><ul>
<li class="chapter" data-level="6.3.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#posterior-is-compromise-of-prior-and-likelihood."><i class="fa fa-check"></i><b>6.3.1</b> Posterior is compromise of prior and likelihood.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#examples"><i class="fa fa-check"></i><b>6.4</b> Examples</a><ul>
<li class="chapter" data-level="6.4.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.1</b> Prior knowledge expressed as a beta distribution.</a></li>
<li class="chapter" data-level="6.4.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-that-cannot-be-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.2</b> Prior knowledge that cannot be expressed as a beta distribution.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#summary"><i class="fa fa-check"></i><b>6.5</b> Summary</a></li>
<li class="chapter" data-level="" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#reference-5"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>7</b> Markov Chain Monte Carlo</a><ul>
<li class="chapter" data-level="7.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#approximating-a-distribution-with-a-large-sample"><i class="fa fa-check"></i><b>7.1</b> Approximating a distribution with a large sample</a></li>
<li class="chapter" data-level="7.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-simple-case-of-the-metropolis-algorithm"><i class="fa fa-check"></i><b>7.2</b> A simple case of the Metropolis algorithm</a><ul>
<li class="chapter" data-level="7.2.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-politician-stumbles-upon-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.2.1</b> A politician stumbles upon the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.2.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-random-walk."><i class="fa fa-check"></i><b>7.2.2</b> A random walk.</a></li>
<li class="chapter" data-level="7.2.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#general-properties-of-a-random-walk."><i class="fa fa-check"></i><b>7.2.3</b> General properties of a random walk.</a></li>
<li class="chapter" data-level="7.2.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#why-we-care."><i class="fa fa-check"></i><b>7.2.4</b> Why we care.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-metropolis-algorithm-more-generally"><i class="fa fa-check"></i><b>7.3</b> The Metropolis algorithm more generally</a><ul>
<li class="chapter" data-level="7.3.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#metropolis-algorithm-applied-to-bernoulli-likelihood-and-beta-prior."><i class="fa fa-check"></i><b>7.3.1</b> Metropolis algorithm applied to Bernoulli likelihood and beta prior.</a></li>
<li class="chapter" data-level="7.3.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#summary-of-metropolis-algorithm."><i class="fa fa-check"></i><b>7.3.2</b> Summary of Metropolis algorithm.</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#toward-gibbs-sampling-estimating-two-coin-biases"><i class="fa fa-check"></i><b>7.4</b> Toward Gibbs sampling: Estimating two coin biases</a><ul>
<li class="chapter" data-level="7.4.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#prior-likelihood-and-posterior-for-two-biases."><i class="fa fa-check"></i><b>7.4.1</b> Prior, likelihood and posterior for two biases.</a></li>
<li class="chapter" data-level="7.4.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-exact-formal-analysis."><i class="fa fa-check"></i><b>7.4.2</b> The posterior via exact formal analysis.</a></li>
<li class="chapter" data-level="7.4.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.4.3</b> The posterior via the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.4.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#gibbs-hamiltonian-monte-carlo-sampling."><i class="fa fa-check"></i><b>7.4.4</b> <del>Gibbs</del> Hamiltonian Monte Carlo sampling.</a></li>
<li class="chapter" data-level="7.4.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#is-there-a-difference-between-biases"><i class="fa fa-check"></i><b>7.4.5</b> Is there a difference between biases?</a></li>
<li class="chapter" data-level="7.4.6" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#terminology-mcmc."><i class="fa fa-check"></i><b>7.4.6</b> Terminology: MCMC.</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness-accuracy-and-efficiency"><i class="fa fa-check"></i><b>7.5</b> MCMC representativeness, accuracy, and efficiency</a><ul>
<li class="chapter" data-level="7.5.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness."><i class="fa fa-check"></i><b>7.5.1</b> MCMC representativeness.</a></li>
<li class="chapter" data-level="7.5.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-accuracy."><i class="fa fa-check"></i><b>7.5.2</b> MCMC accuracy.</a></li>
<li class="chapter" data-level="7.5.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-efficiency."><i class="fa fa-check"></i><b>7.5.3</b> MCMC efficiency.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#reference-6"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="jags-brms.html"><a href="jags-brms.html"><i class="fa fa-check"></i><b>8</b> <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="8.1" data-path="jags-brms.html"><a href="jags-brms.html#jags-brms-and-its-relation-to-r"><i class="fa fa-check"></i><b>8.1</b> <del>JAGS</del> brms and its relation to R</a></li>
<li class="chapter" data-level="8.2" data-path="jags-brms.html"><a href="jags-brms.html#a-complete-example"><i class="fa fa-check"></i><b>8.2</b> A complete example</a><ul>
<li class="chapter" data-level="8.2.1" data-path="jags-brms.html"><a href="jags-brms.html#load-data."><i class="fa fa-check"></i><b>8.2.1</b> Load data.</a></li>
<li class="chapter" data-level="8.2.2" data-path="jags-brms.html"><a href="jags-brms.html#specify-model."><i class="fa fa-check"></i><b>8.2.2</b> Specify model.</a></li>
<li class="chapter" data-level="8.2.3" data-path="jags-brms.html"><a href="jags-brms.html#initialize-chains."><i class="fa fa-check"></i><b>8.2.3</b> Initialize chains.</a></li>
<li class="chapter" data-level="8.2.4" data-path="jags-brms.html"><a href="jags-brms.html#generate-chains."><i class="fa fa-check"></i><b>8.2.4</b> Generate chains.</a></li>
<li class="chapter" data-level="8.2.5" data-path="jags-brms.html"><a href="jags-brms.html#examine-chains."><i class="fa fa-check"></i><b>8.2.5</b> Examine chains.</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="jags-brms.html"><a href="jags-brms.html#simplified-scripts-for-frequently-used-analyses"><i class="fa fa-check"></i><b>8.3</b> Simplified scripts for frequently used analyses</a></li>
<li class="chapter" data-level="8.4" data-path="jags-brms.html"><a href="jags-brms.html#example-difference-of-biases"><i class="fa fa-check"></i><b>8.4</b> Example: Difference of biases</a></li>
<li class="chapter" data-level="8.5" data-path="jags-brms.html"><a href="jags-brms.html#sampling-from-the-prior-distribution-in-jags-brms"><i class="fa fa-check"></i><b>8.5</b> Sampling from the prior distribution in <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="8.6" data-path="jags-brms.html"><a href="jags-brms.html#probability-distributions-available-in-jags-brms"><i class="fa fa-check"></i><b>8.6</b> Probability distributions available in <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="8.6.1" data-path="jags-brms.html"><a href="jags-brms.html#defining-new-likelihood-functions."><i class="fa fa-check"></i><b>8.6.1</b> Defining new likelihood functions.</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="jags-brms.html"><a href="jags-brms.html#faster-sampling-with-parallel-processing-in-runjags-brmsbrm"><i class="fa fa-check"></i><b>8.7</b> Faster sampling with parallel processing in <del>runjags</del> <code>brms::brm()</code></a></li>
<li class="chapter" data-level="8.8" data-path="jags-brms.html"><a href="jags-brms.html#tips-for-expanding-jags-brms-models"><i class="fa fa-check"></i><b>8.8</b> Tips for expanding <del>JAGS</del> brms models</a></li>
<li class="chapter" data-level="" data-path="jags-brms.html"><a href="jags-brms.html#reference-7"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="jags-brms.html"><a href="jags-brms.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>9</b> Hierarchical Models</a><ul>
<li class="chapter" data-level="9.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-single-coin-from-a-single-mint"><i class="fa fa-check"></i><b>9.1</b> A single coin from a single mint</a><ul>
<li class="chapter" data-level="9.1.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation."><i class="fa fa-check"></i><b>9.1.1</b> Posterior via grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#multiple-coins-from-a-single-mint"><i class="fa fa-check"></i><b>9.2</b> Multiple coins from a single mint</a><ul>
<li class="chapter" data-level="9.2.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation.-1"><i class="fa fa-check"></i><b>9.2.1</b> Posterior via grid approximation.</a></li>
<li class="chapter" data-level="9.2.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-realistic-model-with-mcmc."><i class="fa fa-check"></i><b>9.2.2</b> A realistic model with MCMC.</a></li>
<li class="chapter" data-level="9.2.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#doing-it-with-jags-brms."><i class="fa fa-check"></i><b>9.2.3</b> Doing it with <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="9.2.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-therapeutic-touch."><i class="fa fa-check"></i><b>9.2.4</b> Example: Therapeutic touch.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#shrinkage-in-hierarchical-models"><i class="fa fa-check"></i><b>9.3</b> Shrinkage in hierarchical models</a></li>
<li class="chapter" data-level="9.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#speeding-up-jags-brms"><i class="fa fa-check"></i><b>9.4</b> Speeding up <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="9.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#extending-the-hierarchy-subjects-within-categories"><i class="fa fa-check"></i><b>9.5</b> Extending the hierarchy: Subjects within categories</a><ul>
<li class="chapter" data-level="9.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-baseball-batting-abilities-by-position."><i class="fa fa-check"></i><b>9.5.1</b> Example: Baseball batting abilities by position.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hierarchical-models.html"><a href="hierarchical-models.html#reference-8"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="hierarchical-models.html"><a href="hierarchical-models.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html"><i class="fa fa-check"></i><b>10</b> Model Comparison and Hierarchical Modeling</a><ul>
<li class="chapter" data-level="10.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#general-formula-and-the-bayes-factor"><i class="fa fa-check"></i><b>10.1</b> General formula and the Bayes factor</a></li>
<li class="chapter" data-level="10.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#example-two-factories-of-coins"><i class="fa fa-check"></i><b>10.2</b> Example: Two factories of coins</a><ul>
<li class="chapter" data-level="10.2.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-formal-analysis."><i class="fa fa-check"></i><b>10.2.1</b> Solution by formal analysis.</a></li>
<li class="chapter" data-level="10.2.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-grid-approximation."><i class="fa fa-check"></i><b>10.2.2</b> Solution by grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-mcmc"><i class="fa fa-check"></i><b>10.3</b> Solution by MCMC</a><ul>
<li class="chapter" data-level="10.3.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#nonhierarchical-mcmc-computation-of-each-models-marginal-likelihood."><i class="fa fa-check"></i><b>10.3.1</b> Nonhierarchical MCMC computation of each model’s marginal likelihood.</a></li>
<li class="chapter" data-level="10.3.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#hierarchical-mcmc-computation-of-relative-model-probability-is-not-available-in-brms-well-cover-information-criteria-instead."><i class="fa fa-check"></i><b>10.3.2</b> Hierarchical MCMC computation <del>of relative model probability</del> is not available in brms: We’ll cover information criteria instead.</a></li>
<li class="chapter" data-level="10.3.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#models-with-different-noise-distributions-in-jags-brms."><i class="fa fa-check"></i><b>10.3.3</b> Models with different “noise” distributions in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#prediction-model-averaging"><i class="fa fa-check"></i><b>10.4</b> Prediction: Model averaging</a></li>
<li class="chapter" data-level="10.5" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#model-complexity-naturally-accounted-for"><i class="fa fa-check"></i><b>10.5</b> Model complexity naturally accounted for</a><ul>
<li class="chapter" data-level="10.5.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#caveats-regarding-nested-model-comparison."><i class="fa fa-check"></i><b>10.5.1</b> Caveats regarding nested model comparison.</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#extreme-sensitivity-to-the-prior-distribution"><i class="fa fa-check"></i><b>10.6</b> Extreme sensitivity to the prior distribution</a><ul>
<li class="chapter" data-level="10.6.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#priors-of-different-models-should-be-equally-informed."><i class="fa fa-check"></i><b>10.6.1</b> Priors of different models should be equally informed.</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#bonus-theres-danger-ahead"><i class="fa fa-check"></i><b>10.7</b> Bonus: There’s danger ahead</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#reference-9"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Doing Bayesian Data Analysis</em> in brms and the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="inferring-a-binomial-probability-via-exact-mathematical-analysis" class="section level1">
<h1><span class="header-section-number">6</span> Inferring a Binomial Probability via Exact Mathematical Analysis</h1>
<blockquote>
<p>This chapter presents an example of how to do Bayesian inference using pure analytical mathematics without any approximations. Ultimately, we will not use the pure analytical approach for complex applications, but this chapter is important for two reasons. <em>First</em>, the relatively simple mathematics in this chapter nicely reveal the underlying concepts of Bayesian inference on a continuous parameter. The simple formulas show how the continuous allocation of credibility changes systematically as data accumulate. The examples provide an important conceptual foundation for subsequent approximation methods, because the examples give you a clear sense of what is being approximated. <em>Second</em>, the distributions introduced in this chapter, especially the beta distribution, will be used repeatedly in subsequent chapters. (p. 123, <em>emphasis</em> added)</p>
</blockquote>
<div id="the-likelihood-function-the-bernoulli-distribution" class="section level2">
<h2><span class="header-section-number">6.1</span> The likelihood function: The Bernoulli distribution</h2>
<p>If we denote a set of possible outcomes as <span class="math inline">\(\{y_i\}\)</span> Kruschke’s Bernoulli likelihood function for a set of <span class="math inline">\(N\)</span> trials follows the form</p>
<p><span class="math display">\[p(\{y_i\} | \theta) = \theta^z \cdot (1 - \theta) ^ {N - z},\]</span></p>
<p>where <span class="math inline">\(z\)</span> is the number of 1s in the data (i.e., heads in a series of coin flips) and the sole parameter a given observation will be a 1 is <span class="math inline">\(\theta\)</span> (i.e., the probability; <span class="math inline">\(p(y_i = 1 | \theta)\)</span>).</p>
<p>If you follow that equation closely, here is how we might express it in <strong>R</strong>.</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb376-1" data-line-number="1">bernoulli_likelihood &lt;-<span class="st"> </span><span class="cf">function</span>(theta, data) {</a>
<a class="sourceLine" id="cb376-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb376-3" data-line-number="3">  <span class="co"># `theta` = success probability parameter ranging from 0 to 1</span></a>
<a class="sourceLine" id="cb376-4" data-line-number="4">  <span class="co"># `data`  = the vector of data (i.e., a series of 0s and 1s)</span></a>
<a class="sourceLine" id="cb376-5" data-line-number="5">  n &lt;-<span class="st"> </span><span class="kw">length</span>(data)</a>
<a class="sourceLine" id="cb376-6" data-line-number="6">  z &lt;-<span class="st"> </span><span class="kw">sum</span>(data)</a>
<a class="sourceLine" id="cb376-7" data-line-number="7">  <span class="kw">return</span>(theta<span class="op">^</span>z <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>theta)<span class="op">^</span>(n <span class="op">-</span><span class="st"> </span><span class="kw">sum</span>(data)))</a>
<a class="sourceLine" id="cb376-8" data-line-number="8">  </a>
<a class="sourceLine" id="cb376-9" data-line-number="9">  }</a></code></pre></div>
<p>This will come in handy in just a bit.</p>
</div>
<div id="a-description-of-credibilities-the-beta-distribution" class="section level2">
<h2><span class="header-section-number">6.2</span> A description of credibilities: The beta distribution</h2>
<blockquote>
<p>In this chapter, we use purely mathematical analysis, with no numerical approximation, to derive the mathematical form of the posterior credibilities of parameter values. To do this, we need a mathematical description of the prior allocation of credibilities…</p>
<p>In principle, we could use any probability density function supported on the interval [0, 1]. When we intend to apply Bayes’ rule (Equation 5.7, p. 106), however, there are two desiderata for mathematical tractability. First, it would be convenient if the product of <span class="math inline">\(p(y | \theta)\)</span> and <span class="math inline">\(p(\theta)\)</span>, which is in the numerator of Bayes’ rule, results in a function of the same form as <span class="math inline">\(p(\theta)\)</span>… Second, we desire the denominator of Bayes’ rule (Equation 5.9, p. 107), namely <span class="math inline">\(\int \text d \; \theta p(y | \theta) p(\theta)\)</span>, to be solvable analytically. This quality also depends on how the form of the function <span class="math inline">\(p(\theta)\)</span> relates to the form of the function <span class="math inline">\(p(y | \theta)\)</span>. When the forms of <span class="math inline">\(p(y | \theta)\)</span> and <span class="math inline">\(p(\theta)\)</span> combine so that the posterior distribution has the same form as the prior distribution, then <span class="math inline">\(p(\theta)\)</span> is called a <em>conjugate prior</em> for <span class="math inline">\(p(y | \theta)\)</span>. (p. 127 <em>emphasis</em> in the original)</p>
</blockquote>
<p>When we want a conjugate prior for <span class="math inline">\(\theta\)</span> of the Bernoulli likelihood, the <em>beta distribution</em> is a handy choice. Beta has two parameters, <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> (also sometimes called <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>), and the density is defined as</p>
<p><span class="math display">\[\begin{align*}
p(\theta | a, b) &amp; = \operatorname{beta} (\theta | a, b) \\
&amp; = \frac{\theta^{(a - 1)} (1 - \theta)^{(b - 1)}}{B(a, b)},
\end{align*}\]</span></p>
<p>where <span class="math inline">\(B(a, b)\)</span> is a normalizing constant, keeping the results in a probability metric. Kruschke then clarifies that the beta distribution and the Beta function are not the same. In <strong>R</strong>, we use the beta density with the <code>dbeta()</code> function, whereas we use the Beta function with <code>beta()</code>. In this project, we’ll primarily use <code>dbeta()</code>. But to give a sense, notice that when given the same input for <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, the two functions return very different values.</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb377-1" data-line-number="1">theta &lt;-<span class="st"> </span><span class="fl">.5</span></a>
<a class="sourceLine" id="cb377-2" data-line-number="2">a     &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb377-3" data-line-number="3">b     &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb377-4" data-line-number="4"></a>
<a class="sourceLine" id="cb377-5" data-line-number="5"><span class="kw">dbeta</span>(theta, a, b)</a></code></pre></div>
<pre><code>## [1] 1.875</code></pre>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb379-1" data-line-number="1"><span class="kw">beta</span>(a, b)</a></code></pre></div>
<pre><code>## [1] 0.03333333</code></pre>
<p>The <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> parameters are also called <em>shape</em> parameters. And indeed, if we look at the parameters of the <code>dbeta()</code> function in <strong>R</strong>, we’ll see that <span class="math inline">\(a\)</span> is called <code>shape1</code> and <span class="math inline">\(b\)</span> is called <code>shape2</code>.</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb381-1" data-line-number="1"><span class="kw">print</span>(dbeta)</a></code></pre></div>
<pre><code>## function (x, shape1, shape2, ncp = 0, log = FALSE) 
## {
##     if (missing(ncp)) 
##         .Call(C_dbeta, x, shape1, shape2, log)
##     else .Call(C_dnbeta, x, shape1, shape2, ncp, log)
## }
## &lt;bytecode: 0x7feee4218d48&gt;
## &lt;environment: namespace:stats&gt;</code></pre>
<p>You can learn more about the <code>dbeta()</code> function <a href="https://www.rdocumentation.org/packages/stats/versions/3.5.2/topics/Beta">here</a>.</p>
<p>Before we make Figure 6.1, we’ll need some data.</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb383-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb383-2" data-line-number="2"></a>
<a class="sourceLine" id="cb383-3" data-line-number="3">length &lt;-<span class="st"> </span><span class="fl">1e4</span></a>
<a class="sourceLine" id="cb383-4" data-line-number="4"></a>
<a class="sourceLine" id="cb383-5" data-line-number="5">d &lt;-</a>
<a class="sourceLine" id="cb383-6" data-line-number="6"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">shape1 =</span> <span class="kw">c</span>(.<span class="dv">1</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb383-7" data-line-number="7"><span class="st">  </span><span class="kw">expand</span>(shape1,</a>
<a class="sourceLine" id="cb383-8" data-line-number="8">         <span class="dt">shape2 =</span> <span class="kw">c</span>(.<span class="dv">1</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb383-9" data-line-number="9"><span class="st">  </span><span class="kw">expand</span>(<span class="kw">nesting</span>(shape1, shape2),</a>
<a class="sourceLine" id="cb383-10" data-line-number="10">         <span class="dt">x =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> length)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb383-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">a =</span> <span class="kw">str_c</span>(<span class="st">&quot;a =&quot;</span>, shape1),</a>
<a class="sourceLine" id="cb383-12" data-line-number="12">         <span class="dt">b =</span> <span class="kw">str_c</span>(<span class="st">&quot;b =&quot;</span>, shape2),</a>
<a class="sourceLine" id="cb383-13" data-line-number="13">         <span class="dt">group =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>length, <span class="dt">each =</span> <span class="dv">25</span>))</a>
<a class="sourceLine" id="cb383-14" data-line-number="14"></a>
<a class="sourceLine" id="cb383-15" data-line-number="15"><span class="kw">head</span>(d)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 6
##   shape1 shape2        x a      b      group
##    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt;
## 1    0.1    0.1 0        a =0.1 b =0.1     1
## 2    0.1    0.1 0.000100 a =0.1 b =0.1     1
## 3    0.1    0.1 0.000200 a =0.1 b =0.1     1
## 4    0.1    0.1 0.000300 a =0.1 b =0.1     1
## 5    0.1    0.1 0.000400 a =0.1 b =0.1     1
## 6    0.1    0.1 0.000500 a =0.1 b =0.1     1</code></pre>
<p>Now we’re ready for our Figure 6.1.</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb385-1" data-line-number="1">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb385-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">group =</span> group)) <span class="op">+</span></a>
<a class="sourceLine" id="cb385-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb385-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">dbeta</span>(x, <span class="dt">shape1 =</span> shape1, <span class="dt">shape2 =</span> shape2)),</a>
<a class="sourceLine" id="cb385-5" data-line-number="5">            <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>, <span class="dt">size =</span> <span class="fl">1.25</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb385-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.5</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb385-7" data-line-number="7"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb385-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb385-9" data-line-number="9">       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;p(&quot;</span>, theta, <span class="st">&quot;|a, b)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb385-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb385-11" data-line-number="11"><span class="st">  </span><span class="kw">facet_grid</span>(b<span class="op">~</span>a)</a></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-5-1.png" /><!-- --></p>
<blockquote>
<p>Notice that as <span class="math inline">\(a\)</span> gets bigger (left to right across columns of Figure 6.1), the bulk of the distribution moves rightward over higher values of <span class="math inline">\(\theta\)</span>, but as <span class="math inline">\(b\)</span> gets bigger (top to bottom across rows of Figure 6.1), the bulk of the distribution moves leftward over lower values of <span class="math inline">\(\theta\)</span>. Notice that as <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> get bigger together, the beta distribution gets narrower. (p. 127).</p>
</blockquote>
<div id="specifying-a-beta-prior." class="section level3">
<h3><span class="header-section-number">6.2.1</span> Specifying a beta prior.</h3>
<blockquote>
<p>It is useful to know the central tendency and spread of the beta distribution expressed in terms of <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>. It turns out that the mean of the <span class="math inline">\(\text{beta} (\theta | a, b)\)</span> distribution is <span class="math inline">\(\mu = a / (a + b)\)</span> and the mode is <span class="math inline">\(\omega = (a − 1) / (a + b − 2)\)</span> for <span class="math inline">\(a &gt; 1\)</span> and <span class="math inline">\(b &gt; 1\)</span> (<span class="math inline">\(\mu\)</span> is Greek letter mu and <span class="math inline">\(\omega\)</span> is Greek letter omega)… The spread of the beta distribution is related to the “concentration” <span class="math inline">\(\kappa = a + b\)</span> (<span class="math inline">\(\kappa\)</span> is Greek letter kappa). You can see from Figure 6.1 that as <span class="math inline">\(\kappa = a + b\)</span> gets larger, the beta distribution gets narrower or more concentrated. (p. 129)</p>
</blockquote>
<p>As such, if you’d like to specify a beta distribution in terms of <span class="math inline">\(\omega\)</span> and <span class="math inline">\(\kappa\)</span>, it’d follow the form</p>
<p><span class="math display">\[\operatorname{beta} (\alpha = \omega (\kappa - 2) + 1, \beta = (1 - \omega) \cdot (\kappa - 2) + 1),\]</span></p>
<p>as long as <span class="math inline">\(\kappa &gt; 2\)</span>. Kruschke further clarified:</p>
<blockquote>
<p>The value we choose for the prior <span class="math inline">\(\kappa\)</span> can be thought of this way: It is the number of new flips of the coin that we would need to make us teeter between the new data and the prior belief about <span class="math inline">\(\mu\)</span>. If we would only need a few new flips to sway our beliefs, then our prior beliefs should be represented by a small <span class="math inline">\(\kappa\)</span>. If we would need a large number of new flips to sway us away from our prior beliefs about <span class="math inline">\(\mu\)</span>, then our prior beliefs are worth a very large <span class="math inline">\(\kappa\)</span>. (p. 129)</p>
</blockquote>
<p>He went on to clarify why we might prefer the mode to the mean when discussing the central tendency of a beta distribution.</p>
<blockquote>
<p>The mode can be more intuitive than the mean, especially for skewed distributions, because the mode is where the distribution reaches its tallest height, which is easy to visualize. The mean in a skewed distribution is somewhere away from the mode, in the direction of the longer tail. (pp. 129–130)</p>
</blockquote>
<p>Figure 6.2 helped contrast the mean and mode for beta. We’ll use the same process for Figure 6.2 and create the data, first.</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb386-1" data-line-number="1">d &lt;-</a>
<a class="sourceLine" id="cb386-2" data-line-number="2"><span class="kw">tibble</span>(<span class="dt">shape1   =</span> <span class="kw">c</span>(<span class="fl">5.6</span>, <span class="fl">17.6</span>, <span class="dv">5</span>, <span class="dv">17</span>),</a>
<a class="sourceLine" id="cb386-3" data-line-number="3">       <span class="dt">shape2   =</span> <span class="kw">c</span>(<span class="fl">1.4</span>, <span class="fl">4.4</span>, <span class="dv">2</span>, <span class="dv">5</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb386-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">a        =</span> <span class="kw">str_c</span>(<span class="st">&quot;a =&quot;</span>, shape1),</a>
<a class="sourceLine" id="cb386-5" data-line-number="5">         <span class="dt">b        =</span> <span class="kw">str_c</span>(<span class="st">&quot;b =&quot;</span>, shape2),</a>
<a class="sourceLine" id="cb386-6" data-line-number="6">         <span class="dt">kappa    =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;kappa = 7&quot;</span>, <span class="st">&quot;kappa = 22&quot;</span>), <span class="dt">times =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb386-7" data-line-number="7">         <span class="dt">mu_omega =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;mu = 0.8&quot;</span>, <span class="st">&quot;omega = 0.8&quot;</span>), <span class="dt">each =</span> <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb386-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">kappa    =</span> <span class="kw">factor</span>(kappa, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;kappa = 7&quot;</span>, <span class="st">&quot;kappa = 22&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb386-9" data-line-number="9"><span class="st">  </span><span class="kw">expand</span>(<span class="kw">nesting</span>(shape1, shape2, a, b, kappa, mu_omega), </a>
<a class="sourceLine" id="cb386-10" data-line-number="10">         <span class="dt">x =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> length))</a>
<a class="sourceLine" id="cb386-11" data-line-number="11"></a>
<a class="sourceLine" id="cb386-12" data-line-number="12"><span class="kw">head</span>(d)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 7
##   shape1 shape2 a     b     kappa     mu_omega           x
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;fct&gt;     &lt;chr&gt;          &lt;dbl&gt;
## 1      5      2 a =5  b =2  kappa = 7 omega = 0.8 0       
## 2      5      2 a =5  b =2  kappa = 7 omega = 0.8 0.000100
## 3      5      2 a =5  b =2  kappa = 7 omega = 0.8 0.000200
## 4      5      2 a =5  b =2  kappa = 7 omega = 0.8 0.000300
## 5      5      2 a =5  b =2  kappa = 7 omega = 0.8 0.000400
## 6      5      2 a =5  b =2  kappa = 7 omega = 0.8 0.000500</code></pre>
<p>Here’s Figure 6.2.</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb388-1" data-line-number="1">d <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb388-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb388-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">.8</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb388-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">dbeta</span>(x, <span class="dt">shape1 =</span> shape1, <span class="dt">shape2 =</span> shape2)),</a>
<a class="sourceLine" id="cb388-5" data-line-number="5">            <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>, <span class="dt">size =</span> <span class="fl">1.25</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb388-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.8</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb388-7" data-line-number="7"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb388-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb388-9" data-line-number="9">       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;p(&quot;</span>, theta, <span class="st">&quot;|a, b)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb388-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb388-11" data-line-number="11"><span class="st">  </span><span class="kw">facet_grid</span>(mu_omega<span class="op">~</span>kappa)</a></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-7-1.png" /><!-- --></p>
<p>In lines 264 to 290 in his <code>DBDA2E-utilities.R</code> file, Kruschke provided a series of <code>betaABfrom...()</code> functions that will allow us to compute the <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> parameters from measures of central tendency (i.e., mean and mode) and of spread (i.e., <span class="math inline">\(\kappa\)</span> and <span class="math inline">\(\sigma\)</span>). Here are those bits of his code.</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb389-1" data-line-number="1"><span class="co"># Shape parameters from central tendency and scale:</span></a>
<a class="sourceLine" id="cb389-2" data-line-number="2">betaABfromMeanKappa &lt;-<span class="st"> </span><span class="cf">function</span>(mean, kappa) {</a>
<a class="sourceLine" id="cb389-3" data-line-number="3">  <span class="cf">if</span> (mean <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">|</span><span class="st"> </span>mean <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>) <span class="kw">stop</span>(<span class="st">&quot;must have 0 &lt; mean &lt; 1&quot;</span>)</a>
<a class="sourceLine" id="cb389-4" data-line-number="4">  <span class="cf">if</span> (kappa <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="kw">stop</span>(<span class="st">&quot;kappa must be &gt; 0&quot;</span>)</a>
<a class="sourceLine" id="cb389-5" data-line-number="5">  a &lt;-<span class="st"> </span>mean <span class="op">*</span><span class="st"> </span>kappa</a>
<a class="sourceLine" id="cb389-6" data-line-number="6">  b &lt;-<span class="st"> </span>(<span class="fl">1.0</span> <span class="op">-</span><span class="st"> </span>mean) <span class="op">*</span><span class="st"> </span>kappa</a>
<a class="sourceLine" id="cb389-7" data-line-number="7">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">a =</span> a, <span class="dt">b =</span> b))</a>
<a class="sourceLine" id="cb389-8" data-line-number="8">}</a>
<a class="sourceLine" id="cb389-9" data-line-number="9"></a>
<a class="sourceLine" id="cb389-10" data-line-number="10">betaABfromModeKappa &lt;-<span class="st"> </span><span class="cf">function</span>(mode, kappa) {</a>
<a class="sourceLine" id="cb389-11" data-line-number="11">  <span class="cf">if</span> (mode <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">|</span><span class="st"> </span>mode <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>) <span class="kw">stop</span>(<span class="st">&quot;must have 0 &lt; mode &lt; 1&quot;</span>)</a>
<a class="sourceLine" id="cb389-12" data-line-number="12">  <span class="cf">if</span> (kappa <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span>) <span class="kw">stop</span>(<span class="st">&quot;kappa must be &gt; 2 for mode parameterization&quot;</span>)</a>
<a class="sourceLine" id="cb389-13" data-line-number="13">  a &lt;-<span class="st"> </span>mode <span class="op">*</span><span class="st"> </span>(kappa <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb389-14" data-line-number="14">  b &lt;-<span class="st"> </span>(<span class="fl">1.0</span> <span class="op">-</span><span class="st"> </span>mode) <span class="op">*</span><span class="st"> </span>(kappa <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb389-15" data-line-number="15">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">a =</span> a, <span class="dt">b =</span> b))</a>
<a class="sourceLine" id="cb389-16" data-line-number="16">}</a>
<a class="sourceLine" id="cb389-17" data-line-number="17"></a>
<a class="sourceLine" id="cb389-18" data-line-number="18">betaABfromMeanSD &lt;-<span class="st"> </span><span class="cf">function</span>(mean, sd) {</a>
<a class="sourceLine" id="cb389-19" data-line-number="19">  <span class="cf">if</span> (mean <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">|</span><span class="st"> </span>mean <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>) <span class="kw">stop</span>(<span class="st">&quot;must have 0 &lt; mean &lt; 1&quot;</span>)</a>
<a class="sourceLine" id="cb389-20" data-line-number="20">  <span class="cf">if</span> (sd <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="kw">stop</span>(<span class="st">&quot;sd must be &gt; 0&quot;</span>)</a>
<a class="sourceLine" id="cb389-21" data-line-number="21">  kappa &lt;-<span class="st"> </span>mean <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>mean)<span class="op">/</span>sd<span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb389-22" data-line-number="22">  <span class="cf">if</span> (kappa <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="kw">stop</span>(<span class="st">&quot;invalid combination of mean and sd&quot;</span>)</a>
<a class="sourceLine" id="cb389-23" data-line-number="23">  a &lt;-<span class="st"> </span>mean <span class="op">*</span><span class="st"> </span>kappa</a>
<a class="sourceLine" id="cb389-24" data-line-number="24">  b &lt;-<span class="st"> </span>(<span class="fl">1.0</span> <span class="op">-</span><span class="st"> </span>mean) <span class="op">*</span><span class="st"> </span>kappa</a>
<a class="sourceLine" id="cb389-25" data-line-number="25">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">a =</span> a, <span class="dt">b =</span> b))</a>
<a class="sourceLine" id="cb389-26" data-line-number="26">}</a></code></pre></div>
<p>You can use them like so.</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb390-1" data-line-number="1"><span class="kw">betaABfromMeanKappa</span>(<span class="dt">mean =</span> <span class="fl">.25</span>, <span class="dt">kappa =</span> <span class="dv">4</span>)</a></code></pre></div>
<pre><code>## $a
## [1] 1
## 
## $b
## [1] 3</code></pre>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb392-1" data-line-number="1"><span class="kw">betaABfromModeKappa</span>(<span class="dt">mode =</span> <span class="fl">.25</span>, <span class="dt">kappa =</span> <span class="dv">4</span>)</a></code></pre></div>
<pre><code>## $a
## [1] 1.5
## 
## $b
## [1] 2.5</code></pre>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb394-1" data-line-number="1"><span class="kw">betaABfromMeanSD</span>(<span class="dt">mean =</span> <span class="fl">.5</span>, <span class="dt">sd =</span> <span class="fl">.1</span>)</a></code></pre></div>
<pre><code>## $a
## [1] 12
## 
## $b
## [1] 12</code></pre>
<p>You can also save the results as an object, which can then be indexed by parameter.</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb396-1" data-line-number="1">beta_param &lt;-<span class="st"> </span><span class="kw">betaABfromModeKappa</span>(<span class="dt">mode =</span> <span class="fl">.25</span>, <span class="dt">kappa =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb396-2" data-line-number="2"></a>
<a class="sourceLine" id="cb396-3" data-line-number="3">beta_param<span class="op">$</span>a</a></code></pre></div>
<pre><code>## [1] 1.5</code></pre>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb398-1" data-line-number="1">beta_param<span class="op">$</span>b</a></code></pre></div>
<pre><code>## [1] 2.5</code></pre>
</div>
</div>
<div id="the-posterior-beta" class="section level2">
<h2><span class="header-section-number">6.3</span> The posterior beta</h2>
<p>I’m not going to reproduce all of Formula 6.8. But this a fine opportunity to re-express Bayes’ rule in terms of <span class="math inline">\(z\)</span> and <span class="math inline">\(N\)</span>,</p>
<p><span class="math display">\[p(\theta | z, N) = \frac{p(z, N | \theta) p(\theta)}{p(z, N)}.\]</span></p>
<div id="posterior-is-compromise-of-prior-and-likelihood." class="section level3">
<h3><span class="header-section-number">6.3.1</span> Posterior is compromise of prior and likelihood.</h3>
<p>You might wonder how Kruschke computed the HDI values for Figure 6.3. Remember our <code>hdi_of_icdf()</code> function from back in Chapter 4? Yep, that’s how. Here’s that code, again.</p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb400-1" data-line-number="1">hdi_of_icdf &lt;-<span class="st"> </span><span class="cf">function</span>(name, <span class="dt">width =</span> <span class="fl">.95</span>, <span class="dt">tol =</span> <span class="fl">1e-8</span>, ... ) {</a>
<a class="sourceLine" id="cb400-2" data-line-number="2">  <span class="co"># Arguments:</span></a>
<a class="sourceLine" id="cb400-3" data-line-number="3">  <span class="co">#   `name` is R&#39;s name for the inverse cumulative density function</span></a>
<a class="sourceLine" id="cb400-4" data-line-number="4">  <span class="co">#   of the distribution.</span></a>
<a class="sourceLine" id="cb400-5" data-line-number="5">  <span class="co">#   `width` is the desired mass of the HDI region.</span></a>
<a class="sourceLine" id="cb400-6" data-line-number="6">  <span class="co">#   `tol` is passed to R&#39;s optimize function.</span></a>
<a class="sourceLine" id="cb400-7" data-line-number="7">  <span class="co"># Return value:</span></a>
<a class="sourceLine" id="cb400-8" data-line-number="8">  <span class="co">#   Highest density iterval (HDI) limits in a vector.</span></a>
<a class="sourceLine" id="cb400-9" data-line-number="9">  <span class="co"># Example of use: For determining HDI of a beta(30, 12) distribution, type</span></a>
<a class="sourceLine" id="cb400-10" data-line-number="10">  <span class="co">#   `hdi_of_icdf(qbeta, shape1 = 30, shape2 = 12)`</span></a>
<a class="sourceLine" id="cb400-11" data-line-number="11">  <span class="co">#   Notice that the parameters of the `name` must be explicitly stated;</span></a>
<a class="sourceLine" id="cb400-12" data-line-number="12">  <span class="co">#   e.g., `hdi_of_icdf(qbeta, 30, 12)` does not work.</span></a>
<a class="sourceLine" id="cb400-13" data-line-number="13">  <span class="co"># Adapted and corrected from Greg Snow&#39;s TeachingDemos package.</span></a>
<a class="sourceLine" id="cb400-14" data-line-number="14">  incredible_mass &lt;-<span class="st">  </span><span class="fl">1.0</span> <span class="op">-</span><span class="st"> </span>width</a>
<a class="sourceLine" id="cb400-15" data-line-number="15">  interval_width  &lt;-<span class="st"> </span><span class="cf">function</span>(low_tail_prob, name, width, ...) {</a>
<a class="sourceLine" id="cb400-16" data-line-number="16">    <span class="kw">name</span>(width <span class="op">+</span><span class="st"> </span>low_tail_prob, ...) <span class="op">-</span><span class="st"> </span><span class="kw">name</span>(low_tail_prob, ...)</a>
<a class="sourceLine" id="cb400-17" data-line-number="17">  }</a>
<a class="sourceLine" id="cb400-18" data-line-number="18">  </a>
<a class="sourceLine" id="cb400-19" data-line-number="19">  opt_info            &lt;-<span class="st"> </span><span class="kw">optimize</span>(interval_width, <span class="kw">c</span>(<span class="dv">0</span>, incredible_mass), </a>
<a class="sourceLine" id="cb400-20" data-line-number="20">                                  <span class="dt">name =</span> name, <span class="dt">width =</span> width, </a>
<a class="sourceLine" id="cb400-21" data-line-number="21">                                  <span class="dt">tol =</span> tol, ...)</a>
<a class="sourceLine" id="cb400-22" data-line-number="22">  </a>
<a class="sourceLine" id="cb400-23" data-line-number="23">  hdi_lower_tail_prob &lt;-<span class="st"> </span>opt_info<span class="op">$</span>minimum</a>
<a class="sourceLine" id="cb400-24" data-line-number="24">  </a>
<a class="sourceLine" id="cb400-25" data-line-number="25">  <span class="kw">return</span>(<span class="kw">c</span>(<span class="kw">name</span>(hdi_lower_tail_prob, ...),</a>
<a class="sourceLine" id="cb400-26" data-line-number="26">           <span class="kw">name</span>(width <span class="op">+</span><span class="st"> </span>hdi_lower_tail_prob, ...)))</a>
<a class="sourceLine" id="cb400-27" data-line-number="27">  </a>
<a class="sourceLine" id="cb400-28" data-line-number="28">}</a></code></pre></div>
<p>Recall it’s based off of the <code>HDIofICDF()</code> function from Kruschke’s <code>DBDA2E-utilities.R</code> file. I’ve altered Kruschke’s formatting a little bit, but the guts of the code are unchanged. Our <code>hdi_of_icdf()</code> function will take the <code>name</code> of an “inverse cumulative density function” and its parameters and then return an HDI range, as defined by the <code>width</code> parameter. Since the prior at the top of Figure 6.3 is <span class="math inline">\(\text{beta} (5, 5)\)</span>, we can use <code>hdi_of_icdf()</code> to calculate the HDI like so.</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb401-1" data-line-number="1"><span class="kw">hdi_of_icdf</span>(<span class="dt">name   =</span> qbeta,</a>
<a class="sourceLine" id="cb401-2" data-line-number="2">            <span class="dt">shape1 =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb401-3" data-line-number="3">            <span class="dt">shape2 =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb401-4" data-line-number="4">            <span class="dt">width  =</span> <span class="fl">.95</span>)</a></code></pre></div>
<pre><code>## [1] 0.2120085 0.7879915</code></pre>
<p>Here they are for the posterior distribution at the bottom of the figure.</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb403-1" data-line-number="1"><span class="kw">hdi_of_icdf</span>(<span class="dt">name   =</span> qbeta,</a>
<a class="sourceLine" id="cb403-2" data-line-number="2">            <span class="dt">shape1 =</span> <span class="dv">6</span>,</a>
<a class="sourceLine" id="cb403-3" data-line-number="3">            <span class="dt">shape2 =</span> <span class="dv">14</span>)</a></code></pre></div>
<pre><code>## [1] 0.1142339 0.4967144</code></pre>
<p>Note that since we set <code>width  = .95</code> as the default, we can leave it out if we want to stick with the conventional 95% intervals.</p>
<p>Here are the mean calculations from the last paragraph on page 134.</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb405-1" data-line-number="1">n &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb405-2" data-line-number="2">z &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb405-3" data-line-number="3">a &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb405-4" data-line-number="4">b &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb405-5" data-line-number="5"></a>
<a class="sourceLine" id="cb405-6" data-line-number="6">(proportion_heads &lt;-<span class="st"> </span>z <span class="op">/</span><span class="st"> </span>n)</a></code></pre></div>
<pre><code>## [1] 0.1</code></pre>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb407-1" data-line-number="1">(prior_mean &lt;-<span class="st"> </span>a <span class="op">/</span><span class="st"> </span>(a <span class="op">+</span><span class="st"> </span>b))</a></code></pre></div>
<pre><code>## [1] 0.5</code></pre>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb409-1" data-line-number="1">(posterior_mean &lt;-<span class="st"> </span>(z <span class="op">+</span><span class="st"> </span>a) <span class="op">/</span><span class="st"> </span>(n <span class="op">+</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>b))</a></code></pre></div>
<pre><code>## [1] 0.3</code></pre>
<p>In order to make the plots for Figure 6.3, we’ll want to compute the prior, likelihood, and posterior density values across a densely-packed range of <span class="math inline">\(\theta\)</span> values.</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb411-1" data-line-number="1">trial_data &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">9</span>), <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb411-2" data-line-number="2"></a>
<a class="sourceLine" id="cb411-3" data-line-number="3">d &lt;-</a>
<a class="sourceLine" id="cb411-4" data-line-number="4"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">theta =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">100</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb411-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Prior (beta)</span><span class="st">`</span>           =<span class="st"> </span><span class="kw">dbeta</span>(theta, </a>
<a class="sourceLine" id="cb411-6" data-line-number="6">                                          <span class="dt">shape1 =</span> a, </a>
<a class="sourceLine" id="cb411-7" data-line-number="7">                                          <span class="dt">shape2 =</span> b),</a>
<a class="sourceLine" id="cb411-8" data-line-number="8">         <span class="st">`</span><span class="dt">Likelihood (Bernoulli)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">bernoulli_likelihood</span>(<span class="dt">theta =</span> theta, </a>
<a class="sourceLine" id="cb411-9" data-line-number="9">                                                         <span class="dt">data  =</span> trial_data),</a>
<a class="sourceLine" id="cb411-10" data-line-number="10">         <span class="st">`</span><span class="dt">Posterior (beta)</span><span class="st">`</span>       =<span class="st"> </span><span class="kw">dbeta</span>(theta, </a>
<a class="sourceLine" id="cb411-11" data-line-number="11">                                          <span class="dt">shape1 =</span> <span class="dv">6</span>, </a>
<a class="sourceLine" id="cb411-12" data-line-number="12">                                          <span class="dt">shape2 =</span> <span class="dv">14</span>))</a>
<a class="sourceLine" id="cb411-13" data-line-number="13"></a>
<a class="sourceLine" id="cb411-14" data-line-number="14"><span class="kw">glimpse</span>(d)</a></code></pre></div>
<pre><code>## Observations: 100
## Variables: 4
## $ theta                    &lt;dbl&gt; 0.00000000, 0.01010101, 0.02020202, 0.0…
## $ `Prior (beta)`           &lt;dbl&gt; 0.000000e+00, 6.297429e-06, 9.670878e-0…
## $ `Likelihood (Bernoulli)` &lt;dbl&gt; 0.000000000, 0.009218977, 0.016812166, …
## $ `Posterior (beta)`       &lt;dbl&gt; 0.000000e+00, 1.500163e-05, 4.201284e-0…</code></pre>
<p>To make things easier on ourselves, we’ll also make two additional data objects to annotate the plots with lines and text.</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb413-1" data-line-number="1"><span class="co"># the data for the in-plot lines</span></a>
<a class="sourceLine" id="cb413-2" data-line-number="2">d_line &lt;-</a>
<a class="sourceLine" id="cb413-3" data-line-number="3"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">theta      =</span> <span class="kw">c</span>(.<span class="dv">212</span> <span class="op">+</span><span class="st"> </span><span class="fl">.008</span>, <span class="fl">.788</span> <span class="op">-</span><span class="st"> </span><span class="fl">.008</span>, <span class="fl">.114</span> <span class="op">+</span><span class="st"> </span><span class="fl">.004</span>, <span class="fl">.497</span> <span class="op">-</span><span class="st"> </span><span class="fl">.005</span>),</a>
<a class="sourceLine" id="cb413-4" data-line-number="4">         <span class="dt">value      =</span> <span class="kw">rep</span>(<span class="kw">c</span>(.<span class="dv">51</span>, <span class="fl">.66</span>), <span class="dt">each =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb413-5" data-line-number="5">         <span class="dt">xintercept =</span> <span class="kw">c</span>(.<span class="dv">212</span>, <span class="fl">.788</span>, <span class="fl">.114</span>, <span class="fl">.497</span>),</a>
<a class="sourceLine" id="cb413-6" data-line-number="6">         <span class="dt">key        =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Prior (beta)&quot;</span>, <span class="st">&quot;Posterior (beta)&quot;</span>), <span class="dt">each =</span> <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb413-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">key =</span> <span class="kw">factor</span>(key, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Prior (beta)&quot;</span>, <span class="st">&quot;Likelihood (Bernoulli)&quot;</span>, <span class="st">&quot;Posterior (beta)&quot;</span>)))</a>
<a class="sourceLine" id="cb413-8" data-line-number="8">  </a>
<a class="sourceLine" id="cb413-9" data-line-number="9"><span class="co"># the data for the annotation</span></a>
<a class="sourceLine" id="cb413-10" data-line-number="10">d_text &lt;-</a>
<a class="sourceLine" id="cb413-11" data-line-number="11"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">theta =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.3</span>),</a>
<a class="sourceLine" id="cb413-12" data-line-number="12">         <span class="dt">value =</span> <span class="kw">c</span>(.<span class="dv">8</span>, <span class="fl">1.125</span>),</a>
<a class="sourceLine" id="cb413-13" data-line-number="13">         <span class="dt">label =</span> <span class="st">&quot;95% HDI&quot;</span>,</a>
<a class="sourceLine" id="cb413-14" data-line-number="14">         <span class="dt">key   =</span> <span class="kw">c</span>(<span class="st">&quot;Prior (beta)&quot;</span>, <span class="st">&quot;Posterior (beta)&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb413-15" data-line-number="15"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">key =</span> <span class="kw">factor</span>(key, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Prior (beta)&quot;</span>, <span class="st">&quot;Likelihood (Bernoulli)&quot;</span>, <span class="st">&quot;Posterior (beta)&quot;</span>)))</a></code></pre></div>
<p>Finally, here’s our Figure 6.3.</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb414-1" data-line-number="1">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb414-2" data-line-number="2"><span class="st">  </span><span class="kw">gather</span>(key, value, <span class="op">-</span>theta) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb414-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">key =</span> <span class="kw">factor</span>(key, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Prior (beta)&quot;</span>, <span class="st">&quot;Likelihood (Bernoulli)&quot;</span>, <span class="st">&quot;Posterior (beta)&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb414-4" data-line-number="4"><span class="st">  </span></a>
<a class="sourceLine" id="cb414-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb414-6" data-line-number="6"><span class="st">  </span><span class="co"># densities</span></a>
<a class="sourceLine" id="cb414-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> value),</a>
<a class="sourceLine" id="cb414-8" data-line-number="8">              <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb414-9" data-line-number="9"><span class="st">  </span><span class="co"># dashed vertical lines</span></a>
<a class="sourceLine" id="cb414-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">data =</span> d_line,</a>
<a class="sourceLine" id="cb414-11" data-line-number="11">             <span class="kw">aes</span>(<span class="dt">xintercept =</span> xintercept), </a>
<a class="sourceLine" id="cb414-12" data-line-number="12">             <span class="dt">linetype =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb414-13" data-line-number="13"><span class="st">  </span><span class="co"># arrows</span></a>
<a class="sourceLine" id="cb414-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> d_line,</a>
<a class="sourceLine" id="cb414-15" data-line-number="15">            <span class="kw">aes</span>(<span class="dt">y =</span> value),</a>
<a class="sourceLine" id="cb414-16" data-line-number="16">            <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(.<span class="dv">15</span>,<span class="st">&quot;cm&quot;</span>), </a>
<a class="sourceLine" id="cb414-17" data-line-number="17">                          <span class="dt">ends =</span> <span class="st">&quot;both&quot;</span>, </a>
<a class="sourceLine" id="cb414-18" data-line-number="18">                          <span class="dt">type =</span> <span class="st">&quot;closed&quot;</span>),</a>
<a class="sourceLine" id="cb414-19" data-line-number="19">            <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb414-20" data-line-number="20"><span class="st">  </span><span class="co"># text</span></a>
<a class="sourceLine" id="cb414-21" data-line-number="21"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> d_text,</a>
<a class="sourceLine" id="cb414-22" data-line-number="22">            <span class="kw">aes</span>(<span class="dt">y =</span> value, <span class="dt">label =</span> label),</a>
<a class="sourceLine" id="cb414-23" data-line-number="23">            <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb414-24" data-line-number="24"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb414-25" data-line-number="25">       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb414-26" data-line-number="26"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="dt">ncol =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb414-27" data-line-number="27"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-17-1.png" /><!-- --></p>
</div>
</div>
<div id="examples" class="section level2">
<h2><span class="header-section-number">6.4</span> Examples</h2>
<div id="prior-knowledge-expressed-as-a-beta-distribution." class="section level3">
<h3><span class="header-section-number">6.4.1</span> Prior knowledge expressed as a beta distribution.</h3>
<p>Here are the results Kruschke reported in the first paragraph of this subsection.</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb415-1" data-line-number="1">beta_param &lt;-<span class="st"> </span><span class="kw">betaABfromModeKappa</span>(<span class="dt">mode =</span> <span class="fl">.5</span>, <span class="dt">kappa =</span> <span class="dv">500</span>)</a>
<a class="sourceLine" id="cb415-2" data-line-number="2"></a>
<a class="sourceLine" id="cb415-3" data-line-number="3">beta_param<span class="op">$</span>a</a></code></pre></div>
<pre><code>## [1] 250</code></pre>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb417-1" data-line-number="1">beta_param<span class="op">$</span>b</a></code></pre></div>
<pre><code>## [1] 250</code></pre>
<p>Confusingly, it appears Kruschke switched from <code>dbeta(250, 250)</code> in the prose to <code>dbeta(100, 100)</code> in Figure 6.4.a. So it goes…</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb419-1" data-line-number="1">beta_param &lt;-<span class="st"> </span><span class="kw">betaABfromModeKappa</span>(<span class="dt">mode =</span> <span class="fl">.5</span>, <span class="dt">kappa =</span> <span class="dv">200</span>)</a>
<a class="sourceLine" id="cb419-2" data-line-number="2"></a>
<a class="sourceLine" id="cb419-3" data-line-number="3">beta_param<span class="op">$</span>a</a></code></pre></div>
<pre><code>## [1] 100</code></pre>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb421-1" data-line-number="1">beta_param<span class="op">$</span>b</a></code></pre></div>
<pre><code>## [1] 100</code></pre>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb423-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">.001</span>)),</a>
<a class="sourceLine" id="cb423-2" data-line-number="2">       <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb423-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb423-4" data-line-number="4">                  <span class="dt">ymax =</span> <span class="kw">dbeta</span>(x, </a>
<a class="sourceLine" id="cb423-5" data-line-number="5">                               <span class="dt">shape1 =</span> beta_param<span class="op">$</span>a, </a>
<a class="sourceLine" id="cb423-6" data-line-number="6">                               <span class="dt">shape2 =</span> beta_param<span class="op">$</span>b)),</a>
<a class="sourceLine" id="cb423-7" data-line-number="7">              <span class="dt">fill =</span> <span class="st">&quot;grey75&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb423-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">.5</span> <span class="op">-</span><span class="st"> </span><span class="fl">.069</span>, <span class="dt">to =</span> <span class="fl">.5</span> <span class="op">+</span><span class="st"> </span><span class="fl">.069</span>, <span class="dt">by =</span> <span class="fl">.001</span>)),</a>
<a class="sourceLine" id="cb423-9" data-line-number="9">              <span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb423-10" data-line-number="10">                  <span class="dt">ymax =</span> <span class="kw">dbeta</span>(x, </a>
<a class="sourceLine" id="cb423-11" data-line-number="11">                               <span class="dt">shape1 =</span> beta_param<span class="op">$</span>a, </a>
<a class="sourceLine" id="cb423-12" data-line-number="12">                               <span class="dt">shape2 =</span> beta_param<span class="op">$</span>b)),</a>
<a class="sourceLine" id="cb423-13" data-line-number="13">              <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb423-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">c</span>(.<span class="dv">5</span> <span class="op">-</span><span class="st"> </span><span class="fl">.069</span> <span class="op">+</span><span class="st"> </span><span class="fl">.005</span>, <span class="fl">.5</span> <span class="op">+</span><span class="st"> </span><span class="fl">.069</span> <span class="op">-</span><span class="st"> </span><span class="fl">.005</span>),</a>
<a class="sourceLine" id="cb423-15" data-line-number="15">                          <span class="dt">y =</span> <span class="fl">1.7</span>),</a>
<a class="sourceLine" id="cb423-16" data-line-number="16">            <span class="kw">aes</span>(<span class="dt">y =</span> y),</a>
<a class="sourceLine" id="cb423-17" data-line-number="17">            <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(.<span class="dv">15</span>,<span class="st">&quot;cm&quot;</span>), </a>
<a class="sourceLine" id="cb423-18" data-line-number="18">                          <span class="dt">ends =</span> <span class="st">&quot;both&quot;</span>, </a>
<a class="sourceLine" id="cb423-19" data-line-number="19">                          <span class="dt">type =</span> <span class="st">&quot;closed&quot;</span>),</a>
<a class="sourceLine" id="cb423-20" data-line-number="20">            <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb423-21" data-line-number="21"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">.5</span>, <span class="dt">y =</span> <span class="fl">3.5</span>, </a>
<a class="sourceLine" id="cb423-22" data-line-number="22">           <span class="dt">label =</span> <span class="st">&quot;95% HDI&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;grey0&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb423-23" data-line-number="23"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">12</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb423-24" data-line-number="24"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Prior (beta)&quot;</span>,</a>
<a class="sourceLine" id="cb423-25" data-line-number="25">       <span class="dt">x =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb423-26" data-line-number="26">       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;dbeta(&quot;</span>, theta, <span class="st">&quot;|100, 100)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb423-27" data-line-number="27"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-19-1.png" /><!-- --></p>
<p>Here are those HDI values.</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb424-1" data-line-number="1"><span class="kw">hdi_of_icdf</span>(<span class="dt">name   =</span> qbeta,</a>
<a class="sourceLine" id="cb424-2" data-line-number="2">            <span class="dt">shape1 =</span> <span class="dv">100</span>,</a>
<a class="sourceLine" id="cb424-3" data-line-number="3">            <span class="dt">shape2 =</span> <span class="dv">100</span>,</a>
<a class="sourceLine" id="cb424-4" data-line-number="4">            <span class="dt">width  =</span> <span class="fl">.95</span>)</a></code></pre></div>
<pre><code>## [1] 0.4309509 0.5690491</code></pre>
<p>Here are our <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> parameters for Kruschke’s free throw example</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb426-1" data-line-number="1">beta_param &lt;-<span class="st"> </span><span class="kw">betaABfromModeKappa</span>(<span class="dt">mode =</span> <span class="fl">.75</span>, <span class="dt">kappa =</span> <span class="dv">25</span>)</a>
<a class="sourceLine" id="cb426-2" data-line-number="2"></a>
<a class="sourceLine" id="cb426-3" data-line-number="3">beta_param<span class="op">$</span>a</a></code></pre></div>
<pre><code>## [1] 18.25</code></pre>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb428-1" data-line-number="1">beta_param<span class="op">$</span>b</a></code></pre></div>
<pre><code>## [1] 6.75</code></pre>
<p>Behold Figure 6.4.b.</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb430-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">.001</span>)),</a>
<a class="sourceLine" id="cb430-2" data-line-number="2">       <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb430-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb430-4" data-line-number="4">                  <span class="dt">ymax =</span> <span class="kw">dbeta</span>(x, </a>
<a class="sourceLine" id="cb430-5" data-line-number="5">                               <span class="dt">shape1 =</span> beta_param<span class="op">$</span>a, </a>
<a class="sourceLine" id="cb430-6" data-line-number="6">                               <span class="dt">shape2 =</span> beta_param<span class="op">$</span>b)),</a>
<a class="sourceLine" id="cb430-7" data-line-number="7">              <span class="dt">fill =</span> <span class="st">&quot;grey75&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb430-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">.558</span>, <span class="dt">to =</span> <span class="fl">.892</span>, <span class="dt">by =</span> <span class="fl">.001</span>)),</a>
<a class="sourceLine" id="cb430-9" data-line-number="9">              <span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb430-10" data-line-number="10">                  <span class="dt">ymax =</span> <span class="kw">dbeta</span>(x, </a>
<a class="sourceLine" id="cb430-11" data-line-number="11">                               <span class="dt">shape1 =</span> beta_param<span class="op">$</span>a, </a>
<a class="sourceLine" id="cb430-12" data-line-number="12">                               <span class="dt">shape2 =</span> beta_param<span class="op">$</span>b)),</a>
<a class="sourceLine" id="cb430-13" data-line-number="13">              <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb430-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">c</span>(.<span class="dv">558</span> <span class="op">+</span><span class="st"> </span><span class="fl">.005</span>, <span class="fl">.892</span> <span class="op">-</span><span class="st"> </span><span class="fl">.005</span>),</a>
<a class="sourceLine" id="cb430-15" data-line-number="15">                          <span class="dt">y =</span> <span class="fl">.75</span>),</a>
<a class="sourceLine" id="cb430-16" data-line-number="16">            <span class="kw">aes</span>(<span class="dt">y =</span> y),</a>
<a class="sourceLine" id="cb430-17" data-line-number="17">            <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(.<span class="dv">15</span>,<span class="st">&quot;cm&quot;</span>), </a>
<a class="sourceLine" id="cb430-18" data-line-number="18">                          <span class="dt">ends =</span> <span class="st">&quot;both&quot;</span>, </a>
<a class="sourceLine" id="cb430-19" data-line-number="19">                          <span class="dt">type =</span> <span class="st">&quot;closed&quot;</span>),</a>
<a class="sourceLine" id="cb430-20" data-line-number="20">            <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb430-21" data-line-number="21"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">.73</span>, <span class="dt">y =</span> <span class="fl">1.5</span>, </a>
<a class="sourceLine" id="cb430-22" data-line-number="22">           <span class="dt">label =</span> <span class="st">&quot;95% HDI&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb430-23" data-line-number="23"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb430-24" data-line-number="24"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Prior (beta)&quot;</span>,</a>
<a class="sourceLine" id="cb430-25" data-line-number="25">       <span class="dt">x =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb430-26" data-line-number="26">       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;dbeta(&quot;</span>, theta, <span class="st">&quot;|18.25, 6.75)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb430-27" data-line-number="27"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-22-1.png" /><!-- --></p>
<p>Here are those HDI values.</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb431-1" data-line-number="1"><span class="kw">hdi_of_icdf</span>(<span class="dt">name   =</span> qbeta,</a>
<a class="sourceLine" id="cb431-2" data-line-number="2">            <span class="dt">shape1 =</span> beta_param<span class="op">$</span>a,</a>
<a class="sourceLine" id="cb431-3" data-line-number="3">            <span class="dt">shape2 =</span> beta_param<span class="op">$</span>b,</a>
<a class="sourceLine" id="cb431-4" data-line-number="4">            <span class="dt">width  =</span> <span class="fl">.95</span>)</a></code></pre></div>
<pre><code>## [1] 0.5581935 0.8915815</code></pre>
<p>But we can be a little more organized and plot the top row of Figure 6.4 all at once.</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb433-1" data-line-number="1"><span class="co"># the data for the in-plot lines</span></a>
<a class="sourceLine" id="cb433-2" data-line-number="2">d_line &lt;-</a>
<a class="sourceLine" id="cb433-3" data-line-number="3"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">theta      =</span> <span class="kw">c</span>(.<span class="dv">431</span> <span class="op">+</span><span class="st"> </span><span class="fl">.005</span>, <span class="fl">.569</span> <span class="op">-</span><span class="st"> </span><span class="fl">.005</span>, <span class="fl">.558</span> <span class="op">+</span><span class="st"> </span><span class="fl">.005</span>, <span class="fl">.892</span> <span class="op">-</span><span class="st"> </span><span class="fl">.005</span>),</a>
<a class="sourceLine" id="cb433-4" data-line-number="4">         <span class="dt">value      =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="fl">1.9</span>, <span class="fl">.8</span>), <span class="dt">each =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb433-5" data-line-number="5">         <span class="dt">xintercept =</span> <span class="kw">c</span>(.<span class="dv">431</span>, <span class="fl">.569</span>, <span class="fl">.558</span>, <span class="fl">.892</span>),</a>
<a class="sourceLine" id="cb433-6" data-line-number="6">         <span class="dt">exemplar   =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;dbeta(theta, 100, 100)&quot;</span>, <span class="st">&quot;dbeta(theta, 18.25, 6.75)&quot;</span>), <span class="dt">each =</span> <span class="dv">2</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb433-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">exemplar =</span> <span class="kw">factor</span>(exemplar, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;dbeta(theta, 100, 100)&quot;</span>, <span class="st">&quot;dbeta(theta, 18.25, 6.75)&quot;</span>, <span class="st">&quot;dbeta(theta, 1, 1)&quot;</span>)))</a>
<a class="sourceLine" id="cb433-8" data-line-number="8">  </a>
<a class="sourceLine" id="cb433-9" data-line-number="9"><span class="co"># the data for the annotation</span></a>
<a class="sourceLine" id="cb433-10" data-line-number="10">d_text &lt;-</a>
<a class="sourceLine" id="cb433-11" data-line-number="11"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">theta    =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.735</span>),</a>
<a class="sourceLine" id="cb433-12" data-line-number="12">         <span class="dt">value    =</span> <span class="kw">c</span>(<span class="fl">3.6</span>, <span class="fl">1.45</span>),</a>
<a class="sourceLine" id="cb433-13" data-line-number="13">         <span class="dt">label    =</span> <span class="st">&quot;95% HDI&quot;</span>,</a>
<a class="sourceLine" id="cb433-14" data-line-number="14">         <span class="dt">exemplar =</span> <span class="kw">c</span>(<span class="st">&quot;dbeta(theta, 100, 100)&quot;</span>, <span class="st">&quot;dbeta(theta, 18.25, 6.75)&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb433-15" data-line-number="15"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">exemplar =</span> <span class="kw">factor</span>(exemplar, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;dbeta(theta, 100, 100)&quot;</span>, <span class="st">&quot;dbeta(theta, 18.25, 6.75)&quot;</span>, <span class="st">&quot;dbeta(theta, 1, 1)&quot;</span>)))</a>
<a class="sourceLine" id="cb433-16" data-line-number="16"></a>
<a class="sourceLine" id="cb433-17" data-line-number="17"><span class="co"># our main data tibble</span></a>
<a class="sourceLine" id="cb433-18" data-line-number="18"><span class="kw">tibble</span>(<span class="dt">theta =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb433-19" data-line-number="19">       <span class="dt">a     =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">100</span>, <span class="fl">18.25</span>, <span class="dv">1</span>), <span class="dt">each =</span> <span class="dv">100</span>),</a>
<a class="sourceLine" id="cb433-20" data-line-number="20">       <span class="dt">b     =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">100</span>, <span class="fl">6.75</span>, <span class="dv">1</span>),  <span class="dt">each =</span> <span class="dv">100</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb433-21" data-line-number="21"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">exemplar =</span> <span class="kw">ifelse</span>(a <span class="op">==</span><span class="st"> </span><span class="fl">18.25</span>, <span class="kw">str_c</span>(<span class="st">&quot;dbeta(theta, &quot;</span>, a, <span class="st">&quot;, &quot;</span>, b, <span class="st">&quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb433-22" data-line-number="22">                           <span class="kw">str_c</span>(<span class="st">&quot;dbeta(theta, &quot;</span>, a <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">0</span>), <span class="st">&quot;, &quot;</span>, b <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">0</span>), <span class="st">&quot;)&quot;</span>)),</a>
<a class="sourceLine" id="cb433-23" data-line-number="23">         <span class="dt">density  =</span> <span class="kw">dbeta</span>(theta, <span class="dt">shape1 =</span> a, <span class="dt">shape2 =</span> b)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb433-24" data-line-number="24"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">exemplar =</span> <span class="kw">factor</span>(exemplar, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;dbeta(theta, 100, 100)&quot;</span>, <span class="st">&quot;dbeta(theta, 18.25, 6.75)&quot;</span>, <span class="st">&quot;dbeta(theta, 1, 1)&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb433-25" data-line-number="25"><span class="st">  </span></a>
<a class="sourceLine" id="cb433-26" data-line-number="26"><span class="st">  </span><span class="co"># finally, the plot code!</span></a>
<a class="sourceLine" id="cb433-27" data-line-number="27"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb433-28" data-line-number="28"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> density),</a>
<a class="sourceLine" id="cb433-29" data-line-number="29">              <span class="dt">size =</span> <span class="dv">0</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb433-30" data-line-number="30"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">data =</span> d_line,</a>
<a class="sourceLine" id="cb433-31" data-line-number="31">             <span class="kw">aes</span>(<span class="dt">xintercept =</span> xintercept), </a>
<a class="sourceLine" id="cb433-32" data-line-number="32">             <span class="dt">linetype =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb433-33" data-line-number="33"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> d_line,</a>
<a class="sourceLine" id="cb433-34" data-line-number="34">            <span class="kw">aes</span>(<span class="dt">y =</span> value),</a>
<a class="sourceLine" id="cb433-35" data-line-number="35">            <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(.<span class="dv">15</span>,<span class="st">&quot;cm&quot;</span>), </a>
<a class="sourceLine" id="cb433-36" data-line-number="36">                          <span class="dt">ends =</span> <span class="st">&quot;both&quot;</span>, </a>
<a class="sourceLine" id="cb433-37" data-line-number="37">                          <span class="dt">type =</span> <span class="st">&quot;closed&quot;</span>),</a>
<a class="sourceLine" id="cb433-38" data-line-number="38">            <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb433-39" data-line-number="39"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> d_text,</a>
<a class="sourceLine" id="cb433-40" data-line-number="40">            <span class="kw">aes</span>(<span class="dt">y =</span> value, <span class="dt">label =</span> label),</a>
<a class="sourceLine" id="cb433-41" data-line-number="41">            <span class="dt">color =</span> <span class="st">&quot;grey0&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb433-42" data-line-number="42"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Prior (beta)&quot;</span>, </a>
<a class="sourceLine" id="cb433-43" data-line-number="43">       <span class="dt">x =</span> <span class="kw">expression</span>(theta), </a>
<a class="sourceLine" id="cb433-44" data-line-number="44">       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;p(&quot;</span>, theta, <span class="st">&quot;)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb433-45" data-line-number="45"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb433-46" data-line-number="46"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>exemplar, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-24-1.png" /><!-- --></p>
<p>If you look closely, you’ll notice the middle row is the same for each column. So we’ll just plot it once.</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb434-1" data-line-number="1">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb434-2" data-line-number="2">z &lt;-<span class="st"> </span><span class="dv">17</span></a>
<a class="sourceLine" id="cb434-3" data-line-number="3"></a>
<a class="sourceLine" id="cb434-4" data-line-number="4">trial_data &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dt">times =</span> n <span class="op">-</span><span class="st"> </span>z), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dt">times =</span> z))</a>
<a class="sourceLine" id="cb434-5" data-line-number="5"></a>
<a class="sourceLine" id="cb434-6" data-line-number="6"><span class="kw">tibble</span>(<span class="dt">theta        =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">100</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb434-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">likelihood =</span> <span class="kw">bernoulli_likelihood</span>(<span class="dt">theta =</span> theta, <span class="dt">data =</span> trial_data)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb434-8" data-line-number="8"><span class="st">  </span></a>
<a class="sourceLine" id="cb434-9" data-line-number="9"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb434-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> likelihood),</a>
<a class="sourceLine" id="cb434-11" data-line-number="11">              <span class="dt">size =</span> <span class="dv">0</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb434-12" data-line-number="12"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Likelihood (Bernoulli)&quot;</span>,</a>
<a class="sourceLine" id="cb434-13" data-line-number="13">       <span class="dt">subtitle =</span> <span class="st">&quot;This is the same for all 3 exemplars, so</span><span class="ch">\n</span><span class="st">there&#39;s no need to plot this thrice.&quot;</span>,</a>
<a class="sourceLine" id="cb434-14" data-line-number="14">       <span class="dt">x =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb434-15" data-line-number="15">       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;p(D|&quot;</span>, theta, <span class="st">&quot;)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb434-16" data-line-number="16"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-25-1.png" /><!-- --></p>
<p>The bottom row:</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb435-1" data-line-number="1"><span class="co"># the data for the in-plot lines</span></a>
<a class="sourceLine" id="cb435-2" data-line-number="2">d_line &lt;-</a>
<a class="sourceLine" id="cb435-3" data-line-number="3"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">theta =</span> <span class="kw">c</span>(.<span class="dv">466</span> <span class="op">+</span><span class="st"> </span><span class="fl">.005</span>, <span class="fl">.597</span> <span class="op">-</span><span class="st"> </span><span class="fl">.005</span>, </a>
<a class="sourceLine" id="cb435-4" data-line-number="4">                   <span class="fl">.663</span> <span class="op">+</span><span class="st"> </span><span class="fl">.004</span>, <span class="fl">.897</span> <span class="op">-</span><span class="st"> </span><span class="fl">.005</span>,</a>
<a class="sourceLine" id="cb435-5" data-line-number="5">                   <span class="fl">.660</span> <span class="op">+</span><span class="st"> </span><span class="fl">.005</span>, <span class="fl">.959</span> <span class="op">-</span><span class="st"> </span><span class="fl">.003</span>),</a>
<a class="sourceLine" id="cb435-6" data-line-number="6">         <span class="dt">value =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="fl">1.9</span>, <span class="fl">1.1</span>, <span class="fl">.85</span>), <span class="dt">each =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb435-7" data-line-number="7">         <span class="dt">xintercept =</span> <span class="kw">c</span>(.<span class="dv">466</span>, <span class="fl">.597</span>, </a>
<a class="sourceLine" id="cb435-8" data-line-number="8">                        <span class="fl">.663</span>, <span class="fl">.897</span>,</a>
<a class="sourceLine" id="cb435-9" data-line-number="9">                        <span class="fl">.660</span>, <span class="fl">.959</span>),</a>
<a class="sourceLine" id="cb435-10" data-line-number="10">         <span class="dt">exemplar =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;dbeta(theta, 117, 103)&quot;</span>, <span class="st">&quot;dbeta(theta, 35.25, 9.75)&quot;</span>, <span class="st">&quot;dbeta(theta, 18, 4)&quot;</span>), <span class="dt">each =</span> <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb435-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">exemplar =</span> <span class="kw">factor</span>(exemplar, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;dbeta(theta, 117, 103)&quot;</span>, <span class="st">&quot;dbeta(theta, 35.25, 9.75)&quot;</span>, <span class="st">&quot;dbeta(theta, 18, 4)&quot;</span>)))</a>
<a class="sourceLine" id="cb435-12" data-line-number="12">  </a>
<a class="sourceLine" id="cb435-13" data-line-number="13"><span class="co"># the data for the annotation</span></a>
<a class="sourceLine" id="cb435-14" data-line-number="14">d_text &lt;-</a>
<a class="sourceLine" id="cb435-15" data-line-number="15"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">theta    =</span> <span class="kw">c</span>(.<span class="dv">532</span>, <span class="fl">.78</span>, <span class="fl">.82</span>),</a>
<a class="sourceLine" id="cb435-16" data-line-number="16">         <span class="dt">value    =</span> <span class="kw">c</span>(<span class="fl">3.5</span>, <span class="dv">2</span>, <span class="fl">1.6</span>),</a>
<a class="sourceLine" id="cb435-17" data-line-number="17">         <span class="dt">label    =</span> <span class="st">&quot;95% HDI&quot;</span>,</a>
<a class="sourceLine" id="cb435-18" data-line-number="18">         <span class="dt">exemplar =</span> <span class="kw">c</span>(<span class="st">&quot;dbeta(theta, 117, 103)&quot;</span>, <span class="st">&quot;dbeta(theta, 35.25, 9.75)&quot;</span>, <span class="st">&quot;dbeta(theta, 18, 4)&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb435-19" data-line-number="19"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">exemplar =</span> <span class="kw">factor</span>(exemplar, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;dbeta(theta, 117, 103)&quot;</span>, <span class="st">&quot;dbeta(theta, 35.25, 9.75)&quot;</span>, <span class="st">&quot;dbeta(theta, 18, 4)&quot;</span>)))</a>
<a class="sourceLine" id="cb435-20" data-line-number="20"></a>
<a class="sourceLine" id="cb435-21" data-line-number="21"><span class="co"># our main data tibble</span></a>
<a class="sourceLine" id="cb435-22" data-line-number="22"><span class="kw">tibble</span>(<span class="dt">theta =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb435-23" data-line-number="23">       <span class="dt">a     =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">117</span>, <span class="fl">35.25</span>, <span class="dv">18</span>), <span class="dt">each =</span> <span class="dv">100</span>),</a>
<a class="sourceLine" id="cb435-24" data-line-number="24">       <span class="dt">b     =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">103</span>, <span class="fl">9.75</span>, <span class="dv">4</span>),   <span class="dt">each =</span> <span class="dv">100</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb435-25" data-line-number="25"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">exemplar =</span> <span class="kw">ifelse</span>(a <span class="op">==</span><span class="st"> </span><span class="fl">35.25</span>, <span class="kw">str_c</span>(<span class="st">&quot;dbeta(theta, &quot;</span>, a, <span class="st">&quot;, &quot;</span>, b, <span class="st">&quot;)&quot;</span>),</a>
<a class="sourceLine" id="cb435-26" data-line-number="26">                           <span class="kw">str_c</span>(<span class="st">&quot;dbeta(theta, &quot;</span>, a <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">0</span>), <span class="st">&quot;, &quot;</span>, b <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">0</span>), <span class="st">&quot;)&quot;</span>)),</a>
<a class="sourceLine" id="cb435-27" data-line-number="27">         <span class="dt">density  =</span> <span class="kw">dbeta</span>(theta, <span class="dt">shape1 =</span> a, <span class="dt">shape2 =</span> b)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb435-28" data-line-number="28"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">exemplar =</span> <span class="kw">factor</span>(exemplar, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;dbeta(theta, 117, 103)&quot;</span>, <span class="st">&quot;dbeta(theta, 35.25, 9.75)&quot;</span>, <span class="st">&quot;dbeta(theta, 18, 4)&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb435-29" data-line-number="29"><span class="st">  </span></a>
<a class="sourceLine" id="cb435-30" data-line-number="30"><span class="st">  </span><span class="co"># the plot</span></a>
<a class="sourceLine" id="cb435-31" data-line-number="31"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb435-32" data-line-number="32"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> density),</a>
<a class="sourceLine" id="cb435-33" data-line-number="33">              <span class="dt">size =</span> <span class="dv">0</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb435-34" data-line-number="34"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">data =</span> d_line,</a>
<a class="sourceLine" id="cb435-35" data-line-number="35">             <span class="kw">aes</span>(<span class="dt">xintercept =</span> xintercept), </a>
<a class="sourceLine" id="cb435-36" data-line-number="36">             <span class="dt">linetype =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb435-37" data-line-number="37"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> d_line,</a>
<a class="sourceLine" id="cb435-38" data-line-number="38">            <span class="kw">aes</span>(<span class="dt">y =</span> value),</a>
<a class="sourceLine" id="cb435-39" data-line-number="39">            <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(.<span class="dv">15</span>,<span class="st">&quot;cm&quot;</span>), </a>
<a class="sourceLine" id="cb435-40" data-line-number="40">                          <span class="dt">ends =</span> <span class="st">&quot;both&quot;</span>, </a>
<a class="sourceLine" id="cb435-41" data-line-number="41">                          <span class="dt">type =</span> <span class="st">&quot;closed&quot;</span>),</a>
<a class="sourceLine" id="cb435-42" data-line-number="42">            <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb435-43" data-line-number="43"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> d_text,</a>
<a class="sourceLine" id="cb435-44" data-line-number="44">            <span class="kw">aes</span>(<span class="dt">y =</span> value, <span class="dt">label =</span> label),</a>
<a class="sourceLine" id="cb435-45" data-line-number="45">            <span class="dt">color =</span> <span class="st">&quot;grey0&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb435-46" data-line-number="46"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Posterior (beta)&quot;</span>, </a>
<a class="sourceLine" id="cb435-47" data-line-number="47">       <span class="dt">x =</span> <span class="kw">expression</span>(theta), </a>
<a class="sourceLine" id="cb435-48" data-line-number="48">       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;p(&quot;</span>, theta, <span class="st">&quot;|D)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb435-49" data-line-number="49"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb435-50" data-line-number="50"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>exemplar, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-26-1.png" /><!-- --></p>
<p>And if you wanted those HDI values in bulk, you might wrap the <code>hdi_of_icdf()</code> into another function for use in <code>purrr::map2()</code>.</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb436-1" data-line-number="1"><span class="co"># new function</span></a>
<a class="sourceLine" id="cb436-2" data-line-number="2">get_hdi &lt;-<span class="st"> </span><span class="cf">function</span>(a, b) {</a>
<a class="sourceLine" id="cb436-3" data-line-number="3">  <span class="kw">hdi_of_icdf</span>(<span class="dt">name   =</span> qbeta,</a>
<a class="sourceLine" id="cb436-4" data-line-number="4">              <span class="dt">shape1 =</span> a,</a>
<a class="sourceLine" id="cb436-5" data-line-number="5">              <span class="dt">shape2 =</span> b,</a>
<a class="sourceLine" id="cb436-6" data-line-number="6">              <span class="dt">width  =</span> <span class="fl">.95</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb436-7" data-line-number="7"><span class="st">    </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb436-8" data-line-number="8"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">key =</span> <span class="kw">c</span>(<span class="st">&quot;lower level&quot;</span>, <span class="st">&quot;upper level&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb436-9" data-line-number="9"><span class="st">    </span><span class="kw">spread</span>(<span class="dt">key =</span> key, <span class="dt">value =</span> value)</a>
<a class="sourceLine" id="cb436-10" data-line-number="10">}</a>
<a class="sourceLine" id="cb436-11" data-line-number="11"></a>
<a class="sourceLine" id="cb436-12" data-line-number="12"><span class="co"># put it to work</span></a>
<a class="sourceLine" id="cb436-13" data-line-number="13"><span class="kw">tibble</span>(<span class="st">`</span><span class="dt">figure position</span><span class="st">`</span> =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;middle&quot;</span>, <span class="st">&quot;right&quot;</span>),</a>
<a class="sourceLine" id="cb436-14" data-line-number="14">       <span class="dt">a                 =</span> <span class="kw">c</span>(<span class="dv">117</span>, <span class="fl">35.25</span>, <span class="dv">18</span>),</a>
<a class="sourceLine" id="cb436-15" data-line-number="15">       <span class="dt">b                 =</span> <span class="kw">c</span>(<span class="dv">103</span>, <span class="fl">9.75</span>, <span class="dv">4</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb436-16" data-line-number="16"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">hdi             =</span> purrr<span class="op">::</span><span class="kw">map2</span>(a, b, get_hdi)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb436-17" data-line-number="17"><span class="st">  </span><span class="kw">unnest</span>()</a></code></pre></div>
<pre><code>## # A tibble: 3 x 5
##   `figure position`     a      b `lower level` `upper level`
##   &lt;chr&gt;             &lt;dbl&gt;  &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;
## 1 left              117   103            0.466         0.597
## 2 middle             35.2   9.75         0.663         0.897
## 3 right              18     4            0.660         0.959</code></pre>
</div>
<div id="prior-knowledge-that-cannot-be-expressed-as-a-beta-distribution." class="section level3">
<h3><span class="header-section-number">6.4.2</span> Prior knowledge that cannot be expressed as a beta distribution.</h3>
<blockquote>
<p>The beauty of using a beta distribution to express prior knowledge is that the posterior distribution is again exactly a beta distribution, and therefore, no matter how much data we include, we always have an exact representation of the posterior distribution and a simple way of computing it. But not all prior knowledge can be expressed by a beta distribution, because the beta distribution can only be in the forms illustrated by Figure 6.1. If the prior knowledge cannot be expressed as a beta distribution, then we must use a different method to derive the posterior. In particular, we might revert to grid approximation as was explained in Section 5.5 (p. 116).</p>
</blockquote>
<p>For such a small section in the text, the underlying code is a bit of a beast. Fir kicks, we’ll practice two ways. First we’ll follow the code Kruschke used in the text. Our second attempt will be in a more <strong>tidyverse</strong> sort of way.</p>
<div id="figure-6.5-in-kruschke-style." class="section level4">
<h4><span class="header-section-number">6.4.2.1</span> Figure 6.5 in Kruschke style.</h4>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb438-1" data-line-number="1"><span class="co"># Fine teeth for Theta</span></a>
<a class="sourceLine" id="cb438-2" data-line-number="2">theta &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length =</span> <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb438-3" data-line-number="3"></a>
<a class="sourceLine" id="cb438-4" data-line-number="4"><span class="co"># Two triangular peaks on a small non-zero floor</span></a>
<a class="sourceLine" id="cb438-5" data-line-number="5">p_theta &lt;-</a>
<a class="sourceLine" id="cb438-6" data-line-number="6"><span class="st">  </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">200</span>), </a>
<a class="sourceLine" id="cb438-7" data-line-number="7">    <span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">100</span>, <span class="dt">length =</span> <span class="dv">50</span>), </a>
<a class="sourceLine" id="cb438-8" data-line-number="8">    <span class="kw">seq</span>(<span class="dv">100</span>, <span class="dv">1</span>, <span class="dt">length =</span> <span class="dv">50</span>), </a>
<a class="sourceLine" id="cb438-9" data-line-number="9">    <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">200</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb438-10" data-line-number="10"><span class="st">  </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb438-11" data-line-number="11"></a>
<a class="sourceLine" id="cb438-12" data-line-number="12"><span class="co"># Make p_theta sum to 1.0</span></a>
<a class="sourceLine" id="cb438-13" data-line-number="13">p_theta &lt;-<span class="st"> </span>p_theta <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(p_theta)</a></code></pre></div>
<p>Here’s Kruschke’s <code>BernGrid()</code> code in all its glory.</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb439-1" data-line-number="1">BernGrid =<span class="st"> </span><span class="cf">function</span>( Theta , pTheta , Data , <span class="dt">plotType=</span><span class="kw">c</span>(<span class="st">&quot;Points&quot;</span>,<span class="st">&quot;Bars&quot;</span>)[<span class="dv">2</span>] ,</a>
<a class="sourceLine" id="cb439-2" data-line-number="2">                     <span class="dt">showCentTend=</span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>,<span class="st">&quot;Mode&quot;</span>,<span class="st">&quot;None&quot;</span>)[<span class="dv">3</span>] ,</a>
<a class="sourceLine" id="cb439-3" data-line-number="3">                     <span class="dt">showHDI=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">FALSE</span>)[<span class="dv">2</span>] , <span class="dt">HDImass=</span><span class="fl">0.95</span> ,</a>
<a class="sourceLine" id="cb439-4" data-line-number="4">                     <span class="dt">showpD=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">FALSE</span>)[<span class="dv">2</span>] , <span class="dt">nToPlot=</span><span class="kw">length</span>(Theta) ) {</a>
<a class="sourceLine" id="cb439-5" data-line-number="5">  <span class="co"># Theta is vector of values between 0 and 1.</span></a>
<a class="sourceLine" id="cb439-6" data-line-number="6">  <span class="co"># pTheta is prior probability mass at each value of Theta</span></a>
<a class="sourceLine" id="cb439-7" data-line-number="7">  <span class="co"># Data is vector of 0&#39;s and 1&#39;s.</span></a>
<a class="sourceLine" id="cb439-8" data-line-number="8">  </a>
<a class="sourceLine" id="cb439-9" data-line-number="9">  <span class="co"># Check for input errors:</span></a>
<a class="sourceLine" id="cb439-10" data-line-number="10">  <span class="cf">if</span> ( <span class="kw">any</span>( Theta <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Theta <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> ) ) {</a>
<a class="sourceLine" id="cb439-11" data-line-number="11">    <span class="kw">stop</span>(<span class="st">&quot;Theta values must be between 0 and 1&quot;</span>)</a>
<a class="sourceLine" id="cb439-12" data-line-number="12">  }</a>
<a class="sourceLine" id="cb439-13" data-line-number="13">  <span class="cf">if</span> ( <span class="kw">any</span>( pTheta <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> ) ) {</a>
<a class="sourceLine" id="cb439-14" data-line-number="14">    <span class="kw">stop</span>(<span class="st">&quot;pTheta values must be non-negative&quot;</span>)</a>
<a class="sourceLine" id="cb439-15" data-line-number="15">  }</a>
<a class="sourceLine" id="cb439-16" data-line-number="16">  <span class="cf">if</span> ( <span class="op">!</span><span class="kw">isTRUE</span>(<span class="kw">all.equal</span>( <span class="kw">sum</span>(pTheta) , <span class="fl">1.0</span> )) )  {</a>
<a class="sourceLine" id="cb439-17" data-line-number="17">    <span class="kw">stop</span>(<span class="st">&quot;pTheta values must sum to 1.0&quot;</span>)</a>
<a class="sourceLine" id="cb439-18" data-line-number="18">  }</a>
<a class="sourceLine" id="cb439-19" data-line-number="19">  <span class="cf">if</span> ( <span class="op">!</span><span class="kw">all</span>( Data <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Data <span class="op">==</span><span class="st"> </span><span class="dv">0</span> ) ) {</a>
<a class="sourceLine" id="cb439-20" data-line-number="20">    <span class="kw">stop</span>(<span class="st">&quot;Data values must be 0 or 1&quot;</span>)</a>
<a class="sourceLine" id="cb439-21" data-line-number="21">  }</a>
<a class="sourceLine" id="cb439-22" data-line-number="22">  </a>
<a class="sourceLine" id="cb439-23" data-line-number="23">  <span class="co"># Create summary values of Data</span></a>
<a class="sourceLine" id="cb439-24" data-line-number="24">  z =<span class="st"> </span><span class="kw">sum</span>( Data ) <span class="co"># number of 1&#39;s in Data</span></a>
<a class="sourceLine" id="cb439-25" data-line-number="25">  N =<span class="st"> </span><span class="kw">length</span>( Data ) </a>
<a class="sourceLine" id="cb439-26" data-line-number="26"></a>
<a class="sourceLine" id="cb439-27" data-line-number="27">  <span class="co"># Compute the Bernoulli likelihood at each value of Theta:</span></a>
<a class="sourceLine" id="cb439-28" data-line-number="28">  pDataGivenTheta =<span class="st"> </span>Theta<span class="op">^</span>z <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>Theta)<span class="op">^</span>(N<span class="op">-</span>z)</a>
<a class="sourceLine" id="cb439-29" data-line-number="29">  <span class="co"># Compute the evidence and the posterior via Bayes&#39; rule:</span></a>
<a class="sourceLine" id="cb439-30" data-line-number="30">  pData =<span class="st"> </span><span class="kw">sum</span>( pDataGivenTheta <span class="op">*</span><span class="st"> </span>pTheta )</a>
<a class="sourceLine" id="cb439-31" data-line-number="31">  pThetaGivenData =<span class="st"> </span>pDataGivenTheta <span class="op">*</span><span class="st"> </span>pTheta <span class="op">/</span><span class="st"> </span>pData</a>
<a class="sourceLine" id="cb439-32" data-line-number="32">  </a>
<a class="sourceLine" id="cb439-33" data-line-number="33">  <span class="co"># Plot the results.</span></a>
<a class="sourceLine" id="cb439-34" data-line-number="34">  <span class="kw">layout</span>( <span class="kw">matrix</span>( <span class="kw">c</span>( <span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span> ) ,<span class="dt">nrow=</span><span class="dv">3</span> ,<span class="dt">ncol=</span><span class="dv">1</span> ,<span class="dt">byrow=</span><span class="ot">FALSE</span> ) ) <span class="co"># 3x1 panels</span></a>
<a class="sourceLine" id="cb439-35" data-line-number="35">  <span class="kw">par</span>( <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">0</span>) , <span class="dt">mgp=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="fl">0.7</span>,<span class="dv">0</span>) , <span class="dt">mai=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.3</span>,<span class="fl">0.1</span>) ) <span class="co"># margins</span></a>
<a class="sourceLine" id="cb439-36" data-line-number="36">  cexAxis =<span class="st"> </span><span class="fl">1.33</span></a>
<a class="sourceLine" id="cb439-37" data-line-number="37">  cexLab =<span class="st"> </span><span class="fl">1.75</span></a>
<a class="sourceLine" id="cb439-38" data-line-number="38">  <span class="co"># convert plotType to notation used by plot:</span></a>
<a class="sourceLine" id="cb439-39" data-line-number="39">  <span class="cf">if</span> ( plotType<span class="op">==</span><span class="st">&quot;Points&quot;</span> ) { plotType=<span class="st">&quot;p&quot;</span> }</a>
<a class="sourceLine" id="cb439-40" data-line-number="40">  <span class="cf">if</span> ( plotType<span class="op">==</span><span class="st">&quot;Bars&quot;</span> ) { plotType=<span class="st">&quot;h&quot;</span> }</a>
<a class="sourceLine" id="cb439-41" data-line-number="41">  dotsize =<span class="st"> </span><span class="dv">5</span> <span class="co"># how big to make the plotted dots</span></a>
<a class="sourceLine" id="cb439-42" data-line-number="42">  barsize =<span class="st"> </span><span class="dv">5</span> <span class="co"># how wide to make the bar lines    </span></a>
<a class="sourceLine" id="cb439-43" data-line-number="43">  <span class="co"># If the comb has a zillion teeth, it&#39;s too many to plot, so plot only a</span></a>
<a class="sourceLine" id="cb439-44" data-line-number="44">  <span class="co"># thinned out subset of the teeth.</span></a>
<a class="sourceLine" id="cb439-45" data-line-number="45">  nteeth =<span class="st"> </span><span class="kw">length</span>(Theta)</a>
<a class="sourceLine" id="cb439-46" data-line-number="46">  <span class="cf">if</span> ( nteeth <span class="op">&gt;</span><span class="st"> </span>nToPlot ) {</a>
<a class="sourceLine" id="cb439-47" data-line-number="47">    thinIdx =<span class="st"> </span><span class="kw">round</span>( <span class="kw">seq</span>( <span class="dv">1</span>, nteeth , <span class="dt">length=</span>nteeth ) )</a>
<a class="sourceLine" id="cb439-48" data-line-number="48">  } <span class="cf">else</span> { </a>
<a class="sourceLine" id="cb439-49" data-line-number="49">    thinIdx =<span class="st"> </span><span class="dv">1</span><span class="op">:</span>nteeth </a>
<a class="sourceLine" id="cb439-50" data-line-number="50">  }</a>
<a class="sourceLine" id="cb439-51" data-line-number="51"></a>
<a class="sourceLine" id="cb439-52" data-line-number="52">  <span class="co"># Plot the prior.</span></a>
<a class="sourceLine" id="cb439-53" data-line-number="53">  yLim =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1.1</span><span class="op">*</span><span class="kw">max</span>(<span class="kw">c</span>(pTheta,pThetaGivenData)))</a>
<a class="sourceLine" id="cb439-54" data-line-number="54">  <span class="kw">plot</span>( Theta[thinIdx] , pTheta[thinIdx] , <span class="dt">type=</span>plotType , </a>
<a class="sourceLine" id="cb439-55" data-line-number="55">        <span class="dt">pch=</span><span class="st">&quot;.&quot;</span> , <span class="dt">cex=</span>dotsize , <span class="dt">lwd=</span>barsize ,</a>
<a class="sourceLine" id="cb439-56" data-line-number="56">        <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>) , <span class="dt">ylim=</span>yLim , <span class="dt">cex.axis=</span>cexAxis ,</a>
<a class="sourceLine" id="cb439-57" data-line-number="57">        <span class="dt">xlab=</span><span class="kw">bquote</span>(theta) , <span class="dt">ylab=</span><span class="kw">bquote</span>(<span class="kw">p</span>(theta)) , <span class="dt">cex.lab=</span>cexLab ,</a>
<a class="sourceLine" id="cb439-58" data-line-number="58">        <span class="dt">main=</span><span class="st">&quot;Prior&quot;</span> , <span class="dt">cex.main=</span><span class="fl">1.5</span> , <span class="dt">col=</span><span class="st">&quot;skyblue&quot;</span> )</a>
<a class="sourceLine" id="cb439-59" data-line-number="59">  <span class="cf">if</span> ( showCentTend <span class="op">!=</span><span class="st"> &quot;None&quot;</span> ) {</a>
<a class="sourceLine" id="cb439-60" data-line-number="60">    <span class="cf">if</span> ( showCentTend <span class="op">==</span><span class="st"> &quot;Mean&quot;</span> ) {</a>
<a class="sourceLine" id="cb439-61" data-line-number="61">      meanTheta =<span class="st"> </span><span class="kw">sum</span>( Theta <span class="op">*</span><span class="st"> </span>pTheta ) </a>
<a class="sourceLine" id="cb439-62" data-line-number="62">      <span class="cf">if</span> ( meanTheta <span class="op">&gt;</span><span class="st"> </span><span class="fl">.5</span> ) {</a>
<a class="sourceLine" id="cb439-63" data-line-number="63">         textx =<span class="st"> </span><span class="dv">0</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb439-64" data-line-number="64">      } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb439-65" data-line-number="65">        textx =<span class="st"> </span><span class="dv">1</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb439-66" data-line-number="66">      }</a>
<a class="sourceLine" id="cb439-67" data-line-number="67">      <span class="kw">text</span>( textx , yLim[<span class="dv">2</span>] ,</a>
<a class="sourceLine" id="cb439-68" data-line-number="68">            <span class="kw">bquote</span>( <span class="st">&quot;mean=&quot;</span> <span class="op">*</span><span class="st"> </span>.(<span class="kw">signif</span>(meanTheta,<span class="dv">3</span>)) ) ,</a>
<a class="sourceLine" id="cb439-69" data-line-number="69">            <span class="dt">cex=</span><span class="fl">2.0</span> , <span class="dt">adj=</span>textadj )</a>
<a class="sourceLine" id="cb439-70" data-line-number="70">    }</a>
<a class="sourceLine" id="cb439-71" data-line-number="71">    <span class="cf">if</span> ( showCentTend <span class="op">==</span><span class="st"> &quot;Mode&quot;</span> ) {</a>
<a class="sourceLine" id="cb439-72" data-line-number="72">      modeTheta =<span class="st"> </span>Theta[ <span class="kw">which.max</span>( pTheta ) ]</a>
<a class="sourceLine" id="cb439-73" data-line-number="73">      <span class="cf">if</span> ( modeTheta <span class="op">&gt;</span><span class="st"> </span><span class="fl">.5</span> ) {</a>
<a class="sourceLine" id="cb439-74" data-line-number="74">        textx =<span class="st"> </span><span class="dv">0</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb439-75" data-line-number="75">      } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb439-76" data-line-number="76">        textx =<span class="st"> </span><span class="dv">1</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb439-77" data-line-number="77">      }</a>
<a class="sourceLine" id="cb439-78" data-line-number="78">      <span class="kw">text</span>( textx , yLim[<span class="dv">2</span>] ,</a>
<a class="sourceLine" id="cb439-79" data-line-number="79">            <span class="kw">bquote</span>( <span class="st">&quot;mode=&quot;</span> <span class="op">*</span><span class="st"> </span>.(<span class="kw">signif</span>(modeTheta,<span class="dv">3</span>)) ) ,</a>
<a class="sourceLine" id="cb439-80" data-line-number="80">            <span class="dt">cex=</span><span class="fl">2.0</span> , <span class="dt">adj=</span>textadj )</a>
<a class="sourceLine" id="cb439-81" data-line-number="81">    }</a>
<a class="sourceLine" id="cb439-82" data-line-number="82">  }</a>
<a class="sourceLine" id="cb439-83" data-line-number="83">  </a>
<a class="sourceLine" id="cb439-84" data-line-number="84">  <span class="co"># Mark the highest density interval. HDI points are not thinned in the plot.</span></a>
<a class="sourceLine" id="cb439-85" data-line-number="85">  <span class="cf">if</span> ( showHDI ) {</a>
<a class="sourceLine" id="cb439-86" data-line-number="86">    HDIinfo =<span class="st"> </span><span class="kw">HDIofGrid</span>( pTheta , <span class="dt">credMass=</span>HDImass )</a>
<a class="sourceLine" id="cb439-87" data-line-number="87">    <span class="kw">points</span>( Theta[ HDIinfo<span class="op">$</span>indices ] , </a>
<a class="sourceLine" id="cb439-88" data-line-number="88">            <span class="kw">rep</span>( HDIinfo<span class="op">$</span>height , <span class="kw">length</span>( HDIinfo<span class="op">$</span>indices ) ) , </a>
<a class="sourceLine" id="cb439-89" data-line-number="89">            <span class="dt">pch=</span><span class="st">&quot;-&quot;</span> , <span class="dt">cex=</span><span class="fl">1.0</span> )</a>
<a class="sourceLine" id="cb439-90" data-line-number="90">    <span class="kw">text</span>( <span class="kw">mean</span>( Theta[ HDIinfo<span class="op">$</span>indices ] ) , HDIinfo<span class="op">$</span>height ,</a>
<a class="sourceLine" id="cb439-91" data-line-number="91">          <span class="kw">bquote</span>( .(<span class="dv">100</span><span class="op">*</span><span class="kw">signif</span>(HDIinfo<span class="op">$</span>mass,<span class="dv">3</span>)) <span class="op">*</span><span class="st"> &quot;% HDI&quot;</span> ) ,</a>
<a class="sourceLine" id="cb439-92" data-line-number="92">          <span class="dt">adj=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="op">-</span><span class="fl">1.5</span>) , <span class="dt">cex=</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb439-93" data-line-number="93">    <span class="co"># Mark the left and right ends of the waterline. </span></a>
<a class="sourceLine" id="cb439-94" data-line-number="94">    <span class="co"># Find indices at ends of sub-intervals:</span></a>
<a class="sourceLine" id="cb439-95" data-line-number="95">    inLim =<span class="st"> </span>HDIinfo<span class="op">$</span>indices[<span class="dv">1</span>] <span class="co"># first point</span></a>
<a class="sourceLine" id="cb439-96" data-line-number="96">    <span class="cf">for</span> ( idx <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>(<span class="kw">length</span>(HDIinfo<span class="op">$</span>indices)<span class="op">-</span><span class="dv">1</span>) ) {</a>
<a class="sourceLine" id="cb439-97" data-line-number="97">      <span class="cf">if</span> ( ( HDIinfo<span class="op">$</span>indices[idx] <span class="op">!=</span><span class="st"> </span>HDIinfo<span class="op">$</span>indices[idx<span class="dv">-1</span>]<span class="op">+</span><span class="dv">1</span> ) <span class="op">|</span><span class="st"> </span><span class="co"># jumps on left, OR</span></a>
<a class="sourceLine" id="cb439-98" data-line-number="98"><span class="st">             </span>( HDIinfo<span class="op">$</span>indices[idx] <span class="op">!=</span><span class="st"> </span>HDIinfo<span class="op">$</span>indices[idx<span class="op">+</span><span class="dv">1</span>]<span class="op">-</span><span class="dv">1</span> ) ) { <span class="co"># jumps on right</span></a>
<a class="sourceLine" id="cb439-99" data-line-number="99">        inLim =<span class="st"> </span><span class="kw">c</span>(inLim,HDIinfo<span class="op">$</span>indices[idx]) <span class="co"># include idx</span></a>
<a class="sourceLine" id="cb439-100" data-line-number="100">      }</a>
<a class="sourceLine" id="cb439-101" data-line-number="101">    }</a>
<a class="sourceLine" id="cb439-102" data-line-number="102">    inLim =<span class="st"> </span><span class="kw">c</span>(inLim,HDIinfo<span class="op">$</span>indices[<span class="kw">length</span>(HDIinfo<span class="op">$</span>indices)]) <span class="co"># last point</span></a>
<a class="sourceLine" id="cb439-103" data-line-number="103">    <span class="co"># Mark vertical lines at ends of sub-intervals:</span></a>
<a class="sourceLine" id="cb439-104" data-line-number="104">    <span class="cf">for</span> ( idx <span class="cf">in</span> inLim ) {</a>
<a class="sourceLine" id="cb439-105" data-line-number="105">      <span class="kw">lines</span>( <span class="kw">c</span>(Theta[idx],Theta[idx]) , <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>,HDIinfo<span class="op">$</span>height) , <span class="dt">type=</span><span class="st">&quot;l&quot;</span> , <span class="dt">lty=</span><span class="dv">2</span> , </a>
<a class="sourceLine" id="cb439-106" data-line-number="106">             <span class="dt">lwd=</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb439-107" data-line-number="107">      <span class="kw">text</span>( Theta[idx] , HDIinfo<span class="op">$</span>height , <span class="kw">bquote</span>(.(<span class="kw">round</span>(Theta[idx],<span class="dv">3</span>))) ,</a>
<a class="sourceLine" id="cb439-108" data-line-number="108">            <span class="dt">adj=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="op">-</span><span class="fl">0.1</span>) , <span class="dt">cex=</span><span class="fl">1.2</span> )</a>
<a class="sourceLine" id="cb439-109" data-line-number="109">    }</a>
<a class="sourceLine" id="cb439-110" data-line-number="110">  }</a>
<a class="sourceLine" id="cb439-111" data-line-number="111">  </a>
<a class="sourceLine" id="cb439-112" data-line-number="112">  <span class="co"># Plot the likelihood: p(Data|Theta)</span></a>
<a class="sourceLine" id="cb439-113" data-line-number="113">  <span class="kw">plot</span>( Theta[thinIdx] , pDataGivenTheta[thinIdx] , <span class="dt">type=</span>plotType , </a>
<a class="sourceLine" id="cb439-114" data-line-number="114">        <span class="dt">pch=</span><span class="st">&quot;.&quot;</span> , <span class="dt">cex=</span>dotsize , <span class="dt">lwd=</span>barsize ,</a>
<a class="sourceLine" id="cb439-115" data-line-number="115">        <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>) , <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1.1</span><span class="op">*</span><span class="kw">max</span>(pDataGivenTheta)) , <span class="dt">cex.axis=</span>cexAxis ,</a>
<a class="sourceLine" id="cb439-116" data-line-number="116">        <span class="dt">xlab=</span><span class="kw">bquote</span>(theta) , <span class="dt">ylab=</span><span class="kw">bquote</span>( <span class="st">&quot;p(D|&quot;</span> <span class="op">*</span><span class="st"> </span>theta <span class="op">*</span><span class="st"> &quot;)&quot;</span> ) , <span class="dt">cex.lab=</span>cexLab ,</a>
<a class="sourceLine" id="cb439-117" data-line-number="117">        <span class="dt">main=</span><span class="st">&quot;Likelihood&quot;</span> , <span class="dt">cex.main=</span><span class="fl">1.5</span> , <span class="dt">col=</span><span class="st">&quot;skyblue&quot;</span> )</a>
<a class="sourceLine" id="cb439-118" data-line-number="118">  <span class="cf">if</span> ( z <span class="op">&gt;</span><span class="st"> </span><span class="fl">.5</span><span class="op">*</span>N ) { textx =<span class="st"> </span><span class="dv">0</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>) }</a>
<a class="sourceLine" id="cb439-119" data-line-number="119">  <span class="cf">else</span> { textx =<span class="st"> </span><span class="dv">1</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>) }</a>
<a class="sourceLine" id="cb439-120" data-line-number="120">  <span class="kw">text</span>( textx ,<span class="fl">1.0</span><span class="op">*</span><span class="kw">max</span>(pDataGivenTheta) ,<span class="dt">cex=</span><span class="fl">2.0</span></a>
<a class="sourceLine" id="cb439-121" data-line-number="121">    ,<span class="kw">bquote</span>( <span class="st">&quot;Data: z=&quot;</span> <span class="op">*</span><span class="st"> </span>.(z) <span class="op">*</span><span class="st"> &quot;,N=&quot;</span> <span class="op">*</span><span class="st"> </span>.(N) ) ,<span class="dt">adj=</span>textadj )</a>
<a class="sourceLine" id="cb439-122" data-line-number="122">  <span class="cf">if</span> ( showCentTend <span class="op">!=</span><span class="st"> &quot;None&quot;</span> ) {</a>
<a class="sourceLine" id="cb439-123" data-line-number="123">    <span class="cf">if</span> ( showCentTend <span class="op">==</span><span class="st"> &quot;Mean&quot;</span> ) {</a>
<a class="sourceLine" id="cb439-124" data-line-number="124">      meanTheta =<span class="st"> </span><span class="kw">sum</span>( Theta <span class="op">*</span><span class="st"> </span>pDataGivenTheta ) </a>
<a class="sourceLine" id="cb439-125" data-line-number="125">      <span class="cf">if</span> ( meanTheta <span class="op">&gt;</span><span class="st"> </span><span class="fl">.5</span> ) {</a>
<a class="sourceLine" id="cb439-126" data-line-number="126">        textx =<span class="st"> </span><span class="dv">0</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb439-127" data-line-number="127">      } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb439-128" data-line-number="128">        textx =<span class="st"> </span><span class="dv">1</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb439-129" data-line-number="129">      }</a>
<a class="sourceLine" id="cb439-130" data-line-number="130">      <span class="kw">text</span>( textx , <span class="fl">0.7</span><span class="op">*</span><span class="kw">max</span>(pDataGivenTheta) ,</a>
<a class="sourceLine" id="cb439-131" data-line-number="131">            <span class="kw">bquote</span>( <span class="st">&quot;mean=&quot;</span> <span class="op">*</span><span class="st"> </span>.(<span class="kw">signif</span>(meanTheta,<span class="dv">3</span>)) ) ,</a>
<a class="sourceLine" id="cb439-132" data-line-number="132">            <span class="dt">cex=</span><span class="fl">2.0</span> , <span class="dt">adj=</span>textadj )</a>
<a class="sourceLine" id="cb439-133" data-line-number="133">    }</a>
<a class="sourceLine" id="cb439-134" data-line-number="134">    <span class="cf">if</span> ( showCentTend <span class="op">==</span><span class="st"> &quot;Mode&quot;</span> ) {</a>
<a class="sourceLine" id="cb439-135" data-line-number="135">      modeTheta =<span class="st"> </span>Theta[ <span class="kw">which.max</span>( pDataGivenTheta ) ]</a>
<a class="sourceLine" id="cb439-136" data-line-number="136">      <span class="cf">if</span> ( modeTheta <span class="op">&gt;</span><span class="st"> </span><span class="fl">.5</span> ) {</a>
<a class="sourceLine" id="cb439-137" data-line-number="137">        textx =<span class="st"> </span><span class="dv">0</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb439-138" data-line-number="138">      } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb439-139" data-line-number="139">        textx =<span class="st"> </span><span class="dv">1</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb439-140" data-line-number="140">      }</a>
<a class="sourceLine" id="cb439-141" data-line-number="141">      <span class="kw">text</span>( textx , <span class="fl">0.7</span><span class="op">*</span><span class="kw">max</span>(pDataGivenTheta) ,</a>
<a class="sourceLine" id="cb439-142" data-line-number="142">            <span class="kw">bquote</span>( <span class="st">&quot;mode=&quot;</span> <span class="op">*</span><span class="st"> </span>.(<span class="kw">signif</span>(modeTheta,<span class="dv">3</span>)) ) ,</a>
<a class="sourceLine" id="cb439-143" data-line-number="143">            <span class="dt">cex=</span><span class="fl">2.0</span> , <span class="dt">adj=</span>textadj )</a>
<a class="sourceLine" id="cb439-144" data-line-number="144">    }</a>
<a class="sourceLine" id="cb439-145" data-line-number="145">  }</a>
<a class="sourceLine" id="cb439-146" data-line-number="146">  </a>
<a class="sourceLine" id="cb439-147" data-line-number="147">  <span class="co"># Plot the posterior.</span></a>
<a class="sourceLine" id="cb439-148" data-line-number="148">  yLim =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1.1</span><span class="op">*</span><span class="kw">max</span>(<span class="kw">c</span>(pTheta,pThetaGivenData)))</a>
<a class="sourceLine" id="cb439-149" data-line-number="149">  <span class="kw">plot</span>( Theta[thinIdx] , pThetaGivenData[thinIdx] , <span class="dt">type=</span>plotType , </a>
<a class="sourceLine" id="cb439-150" data-line-number="150">        <span class="dt">pch=</span><span class="st">&quot;.&quot;</span> , <span class="dt">cex=</span>dotsize , <span class="dt">lwd=</span>barsize ,</a>
<a class="sourceLine" id="cb439-151" data-line-number="151">        <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>) , <span class="dt">ylim=</span>yLim , <span class="dt">cex.axis=</span>cexAxis ,</a>
<a class="sourceLine" id="cb439-152" data-line-number="152">        <span class="dt">xlab=</span><span class="kw">bquote</span>(theta) , <span class="dt">ylab=</span><span class="kw">bquote</span>( <span class="st">&quot;p(&quot;</span> <span class="op">*</span><span class="st"> </span>theta <span class="op">*</span><span class="st"> &quot;|D)&quot;</span> ) , <span class="dt">cex.lab=</span>cexLab ,</a>
<a class="sourceLine" id="cb439-153" data-line-number="153">        <span class="dt">main=</span><span class="st">&quot;Posterior&quot;</span> , <span class="dt">cex.main=</span><span class="fl">1.5</span> , <span class="dt">col=</span><span class="st">&quot;skyblue&quot;</span> )</a>
<a class="sourceLine" id="cb439-154" data-line-number="154">  <span class="cf">if</span> ( showCentTend <span class="op">!=</span><span class="st"> &quot;None&quot;</span> ) {</a>
<a class="sourceLine" id="cb439-155" data-line-number="155">    <span class="cf">if</span> ( showCentTend <span class="op">==</span><span class="st"> &quot;Mean&quot;</span> ) {</a>
<a class="sourceLine" id="cb439-156" data-line-number="156">      meanTheta =<span class="st"> </span><span class="kw">sum</span>( Theta <span class="op">*</span><span class="st"> </span>pThetaGivenData ) </a>
<a class="sourceLine" id="cb439-157" data-line-number="157">      <span class="cf">if</span> ( meanTheta <span class="op">&gt;</span><span class="st"> </span><span class="fl">.5</span> ) {</a>
<a class="sourceLine" id="cb439-158" data-line-number="158">        textx =<span class="st"> </span><span class="dv">0</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb439-159" data-line-number="159">      } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb439-160" data-line-number="160">        textx =<span class="st"> </span><span class="dv">1</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb439-161" data-line-number="161">      }</a>
<a class="sourceLine" id="cb439-162" data-line-number="162">      <span class="kw">text</span>( textx , yLim[<span class="dv">2</span>] ,</a>
<a class="sourceLine" id="cb439-163" data-line-number="163">            <span class="kw">bquote</span>( <span class="st">&quot;mean=&quot;</span> <span class="op">*</span><span class="st"> </span>.(<span class="kw">signif</span>(meanTheta,<span class="dv">3</span>)) ) ,</a>
<a class="sourceLine" id="cb439-164" data-line-number="164">            <span class="dt">cex=</span><span class="fl">2.0</span> , <span class="dt">adj=</span>textadj )</a>
<a class="sourceLine" id="cb439-165" data-line-number="165">    }</a>
<a class="sourceLine" id="cb439-166" data-line-number="166">    <span class="cf">if</span> ( showCentTend <span class="op">==</span><span class="st"> &quot;Mode&quot;</span> ) {</a>
<a class="sourceLine" id="cb439-167" data-line-number="167">      modeTheta =<span class="st"> </span>Theta[ <span class="kw">which.max</span>( pThetaGivenData ) ]</a>
<a class="sourceLine" id="cb439-168" data-line-number="168">      <span class="cf">if</span> ( modeTheta <span class="op">&gt;</span><span class="st"> </span><span class="fl">.5</span> ) {</a>
<a class="sourceLine" id="cb439-169" data-line-number="169">        textx =<span class="st"> </span><span class="dv">0</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb439-170" data-line-number="170">      } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb439-171" data-line-number="171">        textx =<span class="st"> </span><span class="dv">1</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb439-172" data-line-number="172">      }</a>
<a class="sourceLine" id="cb439-173" data-line-number="173">      <span class="kw">text</span>( textx , yLim[<span class="dv">2</span>] ,</a>
<a class="sourceLine" id="cb439-174" data-line-number="174">            <span class="kw">bquote</span>( <span class="st">&quot;mode=&quot;</span> <span class="op">*</span><span class="st"> </span>.(<span class="kw">signif</span>(modeTheta,<span class="dv">3</span>)) ) ,</a>
<a class="sourceLine" id="cb439-175" data-line-number="175">            <span class="dt">cex=</span><span class="fl">2.0</span> , <span class="dt">adj=</span>textadj )</a>
<a class="sourceLine" id="cb439-176" data-line-number="176">    }</a>
<a class="sourceLine" id="cb439-177" data-line-number="177">  }</a>
<a class="sourceLine" id="cb439-178" data-line-number="178"></a>
<a class="sourceLine" id="cb439-179" data-line-number="179">  </a>
<a class="sourceLine" id="cb439-180" data-line-number="180">  <span class="co"># Plot marginal likelihood pData:</span></a>
<a class="sourceLine" id="cb439-181" data-line-number="181">  <span class="cf">if</span> ( showpD ) {</a>
<a class="sourceLine" id="cb439-182" data-line-number="182">    meanTheta =<span class="st"> </span><span class="kw">sum</span>( Theta <span class="op">*</span><span class="st"> </span>pThetaGivenData ) </a>
<a class="sourceLine" id="cb439-183" data-line-number="183">    <span class="cf">if</span> ( meanTheta <span class="op">&gt;</span><span class="st"> </span><span class="fl">.5</span> ) {</a>
<a class="sourceLine" id="cb439-184" data-line-number="184">      textx =<span class="st"> </span><span class="dv">0</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb439-185" data-line-number="185">    } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb439-186" data-line-number="186">      textx =<span class="st"> </span><span class="dv">1</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb439-187" data-line-number="187">    }</a>
<a class="sourceLine" id="cb439-188" data-line-number="188">    <span class="kw">text</span>( textx , <span class="fl">0.75</span><span class="op">*</span><span class="kw">max</span>(pThetaGivenData) , <span class="dt">cex=</span><span class="fl">2.0</span> ,</a>
<a class="sourceLine" id="cb439-189" data-line-number="189">            <span class="kw">bquote</span>( <span class="st">&quot;p(D)=&quot;</span> <span class="op">*</span><span class="st"> </span>.(<span class="kw">signif</span>(pData,<span class="dv">3</span>)) ) ,<span class="dt">adj=</span>textadj )</a>
<a class="sourceLine" id="cb439-190" data-line-number="190">  }</a>
<a class="sourceLine" id="cb439-191" data-line-number="191">  </a>
<a class="sourceLine" id="cb439-192" data-line-number="192">  <span class="co"># Mark the highest density interval. HDI points are not thinned in the plot.</span></a>
<a class="sourceLine" id="cb439-193" data-line-number="193">  <span class="cf">if</span> ( showHDI ) {</a>
<a class="sourceLine" id="cb439-194" data-line-number="194">    HDIinfo =<span class="st"> </span><span class="kw">HDIofGrid</span>( pThetaGivenData , <span class="dt">credMass=</span>HDImass )</a>
<a class="sourceLine" id="cb439-195" data-line-number="195">    <span class="kw">points</span>( Theta[ HDIinfo<span class="op">$</span>indices ] , </a>
<a class="sourceLine" id="cb439-196" data-line-number="196">            <span class="kw">rep</span>( HDIinfo<span class="op">$</span>height , <span class="kw">length</span>( HDIinfo<span class="op">$</span>indices ) ) , </a>
<a class="sourceLine" id="cb439-197" data-line-number="197">            <span class="dt">pch=</span><span class="st">&quot;-&quot;</span> , <span class="dt">cex=</span><span class="fl">1.0</span> )</a>
<a class="sourceLine" id="cb439-198" data-line-number="198">    <span class="kw">text</span>( <span class="kw">mean</span>( Theta[ HDIinfo<span class="op">$</span>indices ] ) , HDIinfo<span class="op">$</span>height ,</a>
<a class="sourceLine" id="cb439-199" data-line-number="199">             <span class="kw">bquote</span>( .(<span class="dv">100</span><span class="op">*</span><span class="kw">signif</span>(HDIinfo<span class="op">$</span>mass,<span class="dv">3</span>)) <span class="op">*</span><span class="st"> &quot;% HDI&quot;</span> ) ,</a>
<a class="sourceLine" id="cb439-200" data-line-number="200">             <span class="dt">adj=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="op">-</span><span class="fl">1.5</span>) , <span class="dt">cex=</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb439-201" data-line-number="201">    <span class="co"># Mark the left and right ends of the waterline. </span></a>
<a class="sourceLine" id="cb439-202" data-line-number="202">    <span class="co"># Find indices at ends of sub-intervals:</span></a>
<a class="sourceLine" id="cb439-203" data-line-number="203">    inLim =<span class="st"> </span>HDIinfo<span class="op">$</span>indices[<span class="dv">1</span>] <span class="co"># first point</span></a>
<a class="sourceLine" id="cb439-204" data-line-number="204">    <span class="cf">for</span> ( idx <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>(<span class="kw">length</span>(HDIinfo<span class="op">$</span>indices)<span class="op">-</span><span class="dv">1</span>) ) {</a>
<a class="sourceLine" id="cb439-205" data-line-number="205">      <span class="cf">if</span> ( ( HDIinfo<span class="op">$</span>indices[idx] <span class="op">!=</span><span class="st"> </span>HDIinfo<span class="op">$</span>indices[idx<span class="dv">-1</span>]<span class="op">+</span><span class="dv">1</span> ) <span class="op">|</span><span class="st"> </span><span class="co"># jumps on left, OR</span></a>
<a class="sourceLine" id="cb439-206" data-line-number="206"><span class="st">        </span>( HDIinfo<span class="op">$</span>indices[idx] <span class="op">!=</span><span class="st"> </span>HDIinfo<span class="op">$</span>indices[idx<span class="op">+</span><span class="dv">1</span>]<span class="op">-</span><span class="dv">1</span> ) ) { <span class="co"># jumps on right</span></a>
<a class="sourceLine" id="cb439-207" data-line-number="207">        inLim =<span class="st"> </span><span class="kw">c</span>(inLim,HDIinfo<span class="op">$</span>indices[idx]) <span class="co"># include idx</span></a>
<a class="sourceLine" id="cb439-208" data-line-number="208">      }</a>
<a class="sourceLine" id="cb439-209" data-line-number="209">    }</a>
<a class="sourceLine" id="cb439-210" data-line-number="210">    inLim =<span class="st"> </span><span class="kw">c</span>(inLim,HDIinfo<span class="op">$</span>indices[<span class="kw">length</span>(HDIinfo<span class="op">$</span>indices)]) <span class="co"># last point</span></a>
<a class="sourceLine" id="cb439-211" data-line-number="211">    <span class="co"># Mark vertical lines at ends of sub-intervals:</span></a>
<a class="sourceLine" id="cb439-212" data-line-number="212">    <span class="cf">for</span> ( idx <span class="cf">in</span> inLim ) {</a>
<a class="sourceLine" id="cb439-213" data-line-number="213">      <span class="kw">lines</span>( <span class="kw">c</span>(Theta[idx],Theta[idx]) , <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>,HDIinfo<span class="op">$</span>height) , <span class="dt">type=</span><span class="st">&quot;l&quot;</span> , <span class="dt">lty=</span><span class="dv">2</span> , </a>
<a class="sourceLine" id="cb439-214" data-line-number="214">             <span class="dt">lwd=</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb439-215" data-line-number="215">      <span class="kw">text</span>( Theta[idx] , HDIinfo<span class="op">$</span>height , <span class="kw">bquote</span>(.(<span class="kw">round</span>(Theta[idx],<span class="dv">3</span>))) ,</a>
<a class="sourceLine" id="cb439-216" data-line-number="216">            <span class="dt">adj=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="op">-</span><span class="fl">0.1</span>) , <span class="dt">cex=</span><span class="fl">1.2</span> )</a>
<a class="sourceLine" id="cb439-217" data-line-number="217">    }</a>
<a class="sourceLine" id="cb439-218" data-line-number="218">  }</a>
<a class="sourceLine" id="cb439-219" data-line-number="219">  </a>
<a class="sourceLine" id="cb439-220" data-line-number="220">  <span class="co"># return( pThetaGivenData )</span></a>
<a class="sourceLine" id="cb439-221" data-line-number="221">} <span class="co"># end of function</span></a></code></pre></div>
<p>You plot using Kruschke’s method, like so.</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb440-1" data-line-number="1">Data &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">13</span>), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">14</span>))</a>
<a class="sourceLine" id="cb440-2" data-line-number="2"></a>
<a class="sourceLine" id="cb440-3" data-line-number="3"><span class="kw">BernGrid</span>(theta, p_theta, Data, <span class="dt">plotType =</span> <span class="st">&quot;Bars&quot;</span>,</a>
<a class="sourceLine" id="cb440-4" data-line-number="4">         <span class="dt">showCentTend =</span> <span class="st">&quot;None&quot;</span>, <span class="dt">showHDI =</span> <span class="ot">FALSE</span>, <span class="dt">showpD =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-30-1.png" /><!-- --></p>
<p>The method works fine. But, I’m not a fan. It’s clear Kruschke put a lot of thought into the <code>BernGrid()</code> function. However, its inner workings are too opaque, for me, which leads to our next section…</p>
</div>
<div id="figure-6.5-in-tidyverse-style." class="section level4">
<h4><span class="header-section-number">6.4.2.2</span> Figure 6.5 in <strong>tidyverse</strong> style.</h4>
<p>Here we’ll be plotting with <strong>ggplot2</strong>. But let’s first get the data into a tibble.</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb441-1" data-line-number="1"><span class="co"># we need these to compute the likelihood</span></a>
<a class="sourceLine" id="cb441-2" data-line-number="2">n &lt;-<span class="st"> </span><span class="dv">27</span></a>
<a class="sourceLine" id="cb441-3" data-line-number="3">z &lt;-<span class="st"> </span><span class="dv">14</span></a>
<a class="sourceLine" id="cb441-4" data-line-number="4"></a>
<a class="sourceLine" id="cb441-5" data-line-number="5">trial_data &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dt">times =</span> n <span class="op">-</span><span class="st"> </span>z), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dt">times =</span> z))        <span class="co"># (i.e., Data)</span></a>
<a class="sourceLine" id="cb441-6" data-line-number="6"></a>
<a class="sourceLine" id="cb441-7" data-line-number="7">d &lt;-</a>
<a class="sourceLine" id="cb441-8" data-line-number="8"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">theta =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">1000</span>),       <span class="co"># (i.e., Theta)</span></a>
<a class="sourceLine" id="cb441-9" data-line-number="9">         <span class="dt">Prior =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">200</span>),                                  <span class="co"># (i.e., pTheta)</span></a>
<a class="sourceLine" id="cb441-10" data-line-number="10">                   <span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">100</span>, <span class="dt">length =</span> <span class="dv">50</span>), </a>
<a class="sourceLine" id="cb441-11" data-line-number="11">                   <span class="kw">seq</span>(<span class="dv">100</span>, <span class="dv">1</span>, <span class="dt">length =</span> <span class="dv">50</span>), </a>
<a class="sourceLine" id="cb441-12" data-line-number="12">                   <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">200</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb441-13" data-line-number="13"><span class="st">           </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb441-14" data-line-number="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Prior      =</span> Prior <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(Prior),</a>
<a class="sourceLine" id="cb441-15" data-line-number="15">         <span class="dt">Likelihood =</span> <span class="kw">bernoulli_likelihood</span>(<span class="dt">theta =</span> theta,        <span class="co"># (i.e., pDataGivenTheta)</span></a>
<a class="sourceLine" id="cb441-16" data-line-number="16">                                           <span class="dt">data  =</span> trial_data)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb441-17" data-line-number="17"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">evidence  =</span> <span class="kw">sum</span>(Likelihood <span class="op">*</span><span class="st"> </span>Prior)) <span class="op">%&gt;%</span><span class="st">                </span><span class="co"># (i.e., pData)</span></a>
<a class="sourceLine" id="cb441-18" data-line-number="18"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Posterior =</span> Likelihood <span class="op">*</span><span class="st"> </span>Prior <span class="op">/</span><span class="st"> </span>evidence)              <span class="co"># (i.e., pThetaGivenData)</span></a>
<a class="sourceLine" id="cb441-19" data-line-number="19">  </a>
<a class="sourceLine" id="cb441-20" data-line-number="20"><span class="kw">glimpse</span>(d)</a></code></pre></div>
<pre><code>## Observations: 1,000
## Variables: 5
## $ theta      &lt;dbl&gt; 0.000000000, 0.001001001, 0.002002002, 0.003003003, 0…
## $ Prior      &lt;dbl&gt; 9.174312e-05, 9.174312e-05, 9.174312e-05, 9.174312e-0…
## $ Likelihood &lt;dbl&gt; 0.000000e+00, 1.000988e-42, 1.618784e-38, 4.664454e-3…
## $ evidence   &lt;dbl&gt; 3.546798e-10, 3.546798e-10, 3.546798e-10, 3.546798e-1…
## $ Posterior  &lt;dbl&gt; 0.000000e+00, 2.589202e-37, 4.187221e-33, 1.206529e-3…</code></pre>
<p>With our nice tibble in hand, we’ll plot the prior, likelihood, and posterior one at a time.</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb443-1" data-line-number="1"><span class="co"># prior</span></a>
<a class="sourceLine" id="cb443-2" data-line-number="2">(p1 &lt;-</a>
<a class="sourceLine" id="cb443-3" data-line-number="3"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb443-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb443-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> Prior),</a>
<a class="sourceLine" id="cb443-6" data-line-number="6">              <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb443-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Prior&quot;</span>,</a>
<a class="sourceLine" id="cb443-8" data-line-number="8">       <span class="dt">x =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb443-9" data-line-number="9">       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;p(&quot;</span>, theta, <span class="st">&quot;)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb443-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb443-11" data-line-number="11"> )</a></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-32-1.png" /><!-- --></p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb444-1" data-line-number="1"><span class="co"># likelihood</span></a>
<a class="sourceLine" id="cb444-2" data-line-number="2">(p2 &lt;-</a>
<a class="sourceLine" id="cb444-3" data-line-number="3"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb444-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb444-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> Likelihood),</a>
<a class="sourceLine" id="cb444-6" data-line-number="6">              <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb444-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Likelihood&quot;</span>,</a>
<a class="sourceLine" id="cb444-8" data-line-number="8">       <span class="dt">x =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb444-9" data-line-number="9">       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;p(D|&quot;</span>, theta, <span class="st">&quot;)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb444-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb444-11" data-line-number="11"> )</a></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-32-2.png" /><!-- --></p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb445-1" data-line-number="1"><span class="co"># posterior</span></a>
<a class="sourceLine" id="cb445-2" data-line-number="2">(p3 &lt;-</a>
<a class="sourceLine" id="cb445-3" data-line-number="3"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb445-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></a>
<a class="sourceLine" id="cb445-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> Posterior),</a>
<a class="sourceLine" id="cb445-6" data-line-number="6">              <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb445-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Posterior&quot;</span>,</a>
<a class="sourceLine" id="cb445-8" data-line-number="8">       <span class="dt">x =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb445-9" data-line-number="9">       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;p(&quot;</span>, theta, <span class="st">&quot;|D)&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb445-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb445-11" data-line-number="11"> )</a></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-32-3.png" /><!-- --></p>
<p>Note how we saved each the plots as objects. If we want to stack the plots one atop another like they’re presented in Figure 6.5, we can use the <code>grid.arrange()</code> function from the <a href="https://cran.r-project.org/web/packages/gridExtra/index.html"><strong>gridExtra</strong> package</a>.</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb446-1" data-line-number="1"><span class="kw">library</span>(gridExtra)</a>
<a class="sourceLine" id="cb446-2" data-line-number="2"></a>
<a class="sourceLine" id="cb446-3" data-line-number="3"><span class="kw">grid.arrange</span>(p1, p2, p3)</a></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-33-1.png" /><!-- --></p>
</div>
</div>
</div>
<div id="summary" class="section level2">
<h2><span class="header-section-number">6.5</span> Summary</h2>
<blockquote>
<p>The main point of this chapter was to demonstrate how Bayesian inference works when Bayes’ rule can be solved analytically, using mathematics alone, without numerical approximation…</p>
<p>Unfortunately, there are two severe limitations with this approach… Thus, although it is interesting and educational to see how Bayes’ rule can be solved analytically, we will have to abandon exact mathematical solutions when doing complex applications. We will instead use Markov chain Monte Carlo (MCMC) methods. (p. 139)</p>
</blockquote>
<p>And if you’re looking at this project, I imagine that’s exactly what you’re looking for. We want to use the power of a particular kind of MCMC, Hamiltonian Monte Carlo, through the interface of the <a href="https://github.com/paul-buerkner/brms"><strong>brms</strong> package</a>. Get excited. It’s coming.</p>
</div>
<div id="reference-5" class="section level2 unnumbered">
<h2>Reference</h2>
<p><a href="https://sites.google.com/site/doingbayesiandataanalysis/">Kruschke, J. K. (2015). <em>Doing Bayesian data analysis, Second Edition: A tutorial with R, JAGS, and Stan.</em> Burlington, MA: Academic Press/Elsevier.</a></p>
</div>
<div id="session-info-5" class="section level2 unnumbered">
<h2>Session info</h2>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb447-1" data-line-number="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>## R version 3.6.0 (2019-04-26)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS High Sierra 10.13.6
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] gridExtra_2.3   forcats_0.4.0   stringr_1.4.0   dplyr_0.8.3    
##  [5] purrr_0.3.2     readr_1.3.1     tidyr_1.0.0     tibble_2.1.3   
##  [9] ggplot2_3.2.1   tidyverse_1.2.1
## 
## loaded via a namespace (and not attached):
##  [1] tidyselect_0.2.5 xfun_0.10        reshape2_1.4.3   haven_2.1.0     
##  [5] lattice_0.20-38  colorspace_1.4-1 vctrs_0.2.0      generics_0.0.2  
##  [9] htmltools_0.4.0  yaml_2.2.0       utf8_1.1.4       rlang_0.4.0     
## [13] pillar_1.4.2     glue_1.3.1       withr_2.1.2      modelr_0.1.4    
## [17] readxl_1.3.1     lifecycle_0.1.0  plyr_1.8.4       munsell_0.5.0   
## [21] gtable_0.3.0     cellranger_1.1.0 rvest_0.3.4      evaluate_0.14   
## [25] labeling_0.3     knitr_1.23       fansi_0.4.0      broom_0.5.2     
## [29] Rcpp_1.0.2       scales_1.0.0     backports_1.1.5  jsonlite_1.6    
## [33] hms_0.4.2        digest_0.6.21    stringi_1.4.3    grid_3.6.0      
## [37] cli_1.1.0        tools_3.6.0      magrittr_1.5     lazyeval_0.2.2  
## [41] crayon_1.3.4     pkgconfig_2.0.3  zeallot_0.1.0    ellipsis_0.3.0  
## [45] xml2_1.2.0       lubridate_1.7.4  assertthat_0.2.1 rmarkdown_1.13  
## [49] httr_1.4.0       rstudioapi_0.10  R6_2.4.0         nlme_3.1-139    
## [53] compiler_3.6.0</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bayes-rule.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="markov-chain-monte-carlo.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
