<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Inferring a Binomial Probability via Exact Mathematical Analysis | Doing Bayesian Data Analysis in brms and the tidyverse</title>
  <meta name="description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Inferring a Binomial Probability via Exact Mathematical Analysis | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="github-repo" content="ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Inferring a Binomial Probability via Exact Mathematical Analysis | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2020-09-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bayes-rule.html"/>
<link rel="next" href="markov-chain-monte-carlo.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What and why</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#we-have-updates"><i class="fa fa-check"></i>We have updates</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.1.0."><i class="fa fa-check"></i>Version 0.1.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.2.0."><i class="fa fa-check"></i>Version 0.2.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.3.0."><i class="fa fa-check"></i>Version 0.3.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#were-not-done-yet-and-i-could-use-your-help."><i class="fa fa-check"></i>We’re not done yet and I could use your help.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#thank-yous-are-in-order"><i class="fa fa-check"></i>Thank-you’s are in order</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html"><i class="fa fa-check"></i><b>1</b> What’s in This Book (Read This First!)</a><ul>
<li class="chapter" data-level="1.1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#real-people-can-read-this-book"><i class="fa fa-check"></i><b>1.1</b> Real people can read this book</a></li>
<li class="chapter" data-level="1.2" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-in-this-book"><i class="fa fa-check"></i><b>1.2</b> What’s in this book</a></li>
<li class="chapter" data-level="1.3" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-new-in-the-second-edition"><i class="fa fa-check"></i><b>1.3</b> What’s new in the second edition</a></li>
<li class="chapter" data-level="1.4" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#gimme-feedback-be-polite"><i class="fa fa-check"></i><b>1.4</b> Gimme feedback (be polite)</a></li>
<li class="chapter" data-level="1.5" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#thank-you"><i class="fa fa-check"></i><b>1.5</b> Thank you!</a></li>
<li class="chapter" data-level="" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html"><i class="fa fa-check"></i><b>2</b> Introduction: Credibility, Models, and Parameters</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#bayesian-inference-is-reallocation-of-credibility-across-possibilities"><i class="fa fa-check"></i><b>2.1</b> Bayesian inference is reallocation of credibility across possibilities</a><ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#data-are-noisy-and-inferences-are-probabilistic."><i class="fa fa-check"></i><b>2.1.1</b> Data are noisy and inferences are probabilistic.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#possibilities-are-parameter-values-in-descriptive-models"><i class="fa fa-check"></i><b>2.2</b> Possibilities are parameter values in descriptive models</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#the-steps-of-bayesian-data-analysis"><i class="fa fa-check"></i><b>2.3</b> The steps of Bayesian data analysis</a></li>
<li class="chapter" data-level="" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html"><i class="fa fa-check"></i><b>3</b> The R Programming Language</a><ul>
<li class="chapter" data-level="3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-software"><i class="fa fa-check"></i><b>3.1</b> Get the software</a><ul>
<li class="chapter" data-level="3.1.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-look-at-rstudio."><i class="fa fa-check"></i><b>3.1.1</b> A look at RStudio.</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-simple-example-of-r-in-action"><i class="fa fa-check"></i><b>3.2</b> A simple example of R in action</a><ul>
<li class="chapter" data-level="3.2.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-programs-used-with-this-book."><i class="fa fa-check"></i><b>3.2.1</b> Get the programs used with this book.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#basic-commands-and-operators-in-r"><i class="fa fa-check"></i><b>3.3</b> Basic commands and operators in R</a><ul>
<li class="chapter" data-level="3.3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#getting-help-in-r."><i class="fa fa-check"></i><b>3.3.1</b> Getting help in R.</a></li>
<li class="chapter" data-level="3.3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#arithmetic-and-logical-operators."><i class="fa fa-check"></i><b>3.3.2</b> Arithmetic and logical operators.</a></li>
<li class="chapter" data-level="3.3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#assignment-relational-operators-and-tests-of-equality."><i class="fa fa-check"></i><b>3.3.3</b> Assignment, relational operators, and tests of equality.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-types"><i class="fa fa-check"></i><b>3.4</b> Variable types</a><ul>
<li class="chapter" data-level="3.4.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#vector."><i class="fa fa-check"></i><b>3.4.1</b> Vector.</a></li>
<li class="chapter" data-level="3.4.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#factor."><i class="fa fa-check"></i><b>3.4.2</b> Factor.</a></li>
<li class="chapter" data-level="3.4.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#matrix-and-array."><i class="fa fa-check"></i><b>3.4.3</b> Matrix and array.</a></li>
<li class="chapter" data-level="3.4.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#list-and-data-frame."><i class="fa fa-check"></i><b>3.4.4</b> List and data frame.</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#loading-and-saving-data"><i class="fa fa-check"></i><b>3.5</b> Loading and saving data</a><ul>
<li class="chapter" data-level="3.5.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#the-read.csv-read_csv-and-read.table-read_table-functions."><i class="fa fa-check"></i><b>3.5.1</b> The <del>read.csv</del> <code>read_csv()</code> and <del>read.table</del> <code>read_table()</code> functions.</a></li>
<li class="chapter" data-level="3.5.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#saving-data-from-r."><i class="fa fa-check"></i><b>3.5.2</b> Saving data from R.</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#some-utility-functions"><i class="fa fa-check"></i><b>3.6</b> Some utility functions</a></li>
<li class="chapter" data-level="3.7" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-in-r"><i class="fa fa-check"></i><b>3.7</b> Programming in R</a><ul>
<li class="chapter" data-level="3.7.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-names-in-r."><i class="fa fa-check"></i><b>3.7.1</b> Variable names in R.</a></li>
<li class="chapter" data-level="3.7.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#running-a-program."><i class="fa fa-check"></i><b>3.7.2</b> Running a program.</a></li>
<li class="chapter" data-level="3.7.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-a-function."><i class="fa fa-check"></i><b>3.7.3</b> Programming a function.</a></li>
<li class="chapter" data-level="3.7.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#conditions-and-loops."><i class="fa fa-check"></i><b>3.7.4</b> Conditions and loops.</a></li>
<li class="chapter" data-level="3.7.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#measuring-processing-time."><i class="fa fa-check"></i><b>3.7.5</b> Measuring processing time.</a></li>
<li class="chapter" data-level="3.7.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#debugging."><i class="fa fa-check"></i><b>3.7.6</b> Debugging.</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#graphical-plots-opening-and-saving"><i class="fa fa-check"></i><b>3.8</b> Graphical plots: Opening and saving</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html"><i class="fa fa-check"></i><b>4</b> What is This Stuff Called Probability?</a><ul>
<li class="chapter" data-level="4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#the-set-of-all-possible-events"><i class="fa fa-check"></i><b>4.1</b> The set of all possible events</a></li>
<li class="chapter" data-level="4.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-outside-or-inside-the-head"><i class="fa fa-check"></i><b>4.2</b> Probability: Outside or inside the head</a><ul>
<li class="chapter" data-level="4.2.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#outside-the-head-long-run-relative-frequency."><i class="fa fa-check"></i><b>4.2.1</b> Outside the head: Long-run relative frequency.</a></li>
<li class="chapter" data-level="4.2.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#inside-the-head-subjective-belief."><i class="fa fa-check"></i><b>4.2.2</b> Inside the head: Subjective belief.</a></li>
<li class="chapter" data-level="4.2.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probabilities-assign-numbers-to-possibilities."><i class="fa fa-check"></i><b>4.2.3</b> Probabilities assign numbers to possibilities.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-distributions"><i class="fa fa-check"></i><b>4.3</b> Probability distributions</a><ul>
<li class="chapter" data-level="4.3.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#discrete-distributions-probability-mass."><i class="fa fa-check"></i><b>4.3.1</b> Discrete distributions: Probability mass.</a></li>
<li class="chapter" data-level="4.3.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#continuous-distributions-rendezvous-with-density."><i class="fa fa-check"></i><b>4.3.2</b> Continuous distributions: Rendezvous with density.</a></li>
<li class="chapter" data-level="4.3.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#mean-and-variance-of-a-distribution."><i class="fa fa-check"></i><b>4.3.3</b> Mean and variance of a distribution.</a></li>
<li class="chapter" data-level="4.3.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#highest-density-interval-hdi."><i class="fa fa-check"></i><b>4.3.4</b> Highest density interval (HDI).</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#two-way-distributions"><i class="fa fa-check"></i><b>4.4</b> Two-way distributions</a><ul>
<li class="chapter" data-level="4.4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#conditional-probability."><i class="fa fa-check"></i><b>4.4.1</b> Conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes-rule.html"><a href="bayes-rule.html"><i class="fa fa-check"></i><b>5</b> Bayes’ Rule</a><ul>
<li class="chapter" data-level="5.1" data-path="bayes-rule.html"><a href="bayes-rule.html#bayes-rule-1"><i class="fa fa-check"></i><b>5.1</b> Bayes’ rule</a><ul>
<li class="chapter" data-level="5.1.1" data-path="bayes-rule.html"><a href="bayes-rule.html#derived-from-definitions-of-conditional-probability."><i class="fa fa-check"></i><b>5.1.1</b> Derived from definitions of conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bayes-rule.html"><a href="bayes-rule.html#applied-to-parameters-and-data"><i class="fa fa-check"></i><b>5.2</b> Applied to parameters and data</a></li>
<li class="chapter" data-level="5.3" data-path="bayes-rule.html"><a href="bayes-rule.html#complete-examples-estimating-bias-in-a-coin"><i class="fa fa-check"></i><b>5.3</b> Complete examples: Estimating bias in a coin</a><ul>
<li class="chapter" data-level="5.3.1" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-sample-size-on-the-posterior."><i class="fa fa-check"></i><b>5.3.1</b> Influence of sample size on the posterior.</a></li>
<li class="chapter" data-level="5.3.2" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-prior-on-the-posterior."><i class="fa fa-check"></i><b>5.3.2</b> Influence of prior on the posterior.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="bayes-rule.html"><a href="bayes-rule.html#why-bayesian-inference-can-be-difficult"><i class="fa fa-check"></i><b>5.4</b> Why Bayesian inference can be difficult</a></li>
<li class="chapter" data-level="" data-path="bayes-rule.html"><a href="bayes-rule.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><i class="fa fa-check"></i><b>6</b> Inferring a Binomial Probability via Exact Mathematical Analysis</a><ul>
<li class="chapter" data-level="6.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-likelihood-function-the-bernoulli-distribution"><i class="fa fa-check"></i><b>6.1</b> The likelihood function: The Bernoulli distribution</a></li>
<li class="chapter" data-level="6.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#a-description-of-credibilities-the-beta-distribution"><i class="fa fa-check"></i><b>6.2</b> A description of credibilities: The beta distribution</a><ul>
<li class="chapter" data-level="6.2.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#specifying-a-beta-prior."><i class="fa fa-check"></i><b>6.2.1</b> Specifying a beta prior.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-posterior-beta"><i class="fa fa-check"></i><b>6.3</b> The posterior beta</a><ul>
<li class="chapter" data-level="6.3.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#posterior-is-compromise-of-prior-and-likelihood."><i class="fa fa-check"></i><b>6.3.1</b> Posterior is compromise of prior and likelihood.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#examples"><i class="fa fa-check"></i><b>6.4</b> Examples</a><ul>
<li class="chapter" data-level="6.4.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.1</b> Prior knowledge expressed as a beta distribution.</a></li>
<li class="chapter" data-level="6.4.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-that-cannot-be-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.2</b> Prior knowledge that cannot be expressed as a beta distribution.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#summary"><i class="fa fa-check"></i><b>6.5</b> Summary</a></li>
<li class="chapter" data-level="" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>7</b> Markov Chain Monte Carlo</a><ul>
<li class="chapter" data-level="7.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#approximating-a-distribution-with-a-large-sample"><i class="fa fa-check"></i><b>7.1</b> Approximating a distribution with a large sample</a></li>
<li class="chapter" data-level="7.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-simple-case-of-the-metropolis-algorithm"><i class="fa fa-check"></i><b>7.2</b> A simple case of the Metropolis algorithm</a><ul>
<li class="chapter" data-level="7.2.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-politician-stumbles-upon-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.2.1</b> A politician stumbles upon the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.2.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-random-walk."><i class="fa fa-check"></i><b>7.2.2</b> A random walk.</a></li>
<li class="chapter" data-level="7.2.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#general-properties-of-a-random-walk."><i class="fa fa-check"></i><b>7.2.3</b> General properties of a random walk.</a></li>
<li class="chapter" data-level="7.2.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#why-we-care."><i class="fa fa-check"></i><b>7.2.4</b> Why we care.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-metropolis-algorithm-more-generally"><i class="fa fa-check"></i><b>7.3</b> The Metropolis algorithm more generally</a><ul>
<li class="chapter" data-level="7.3.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#metropolis-algorithm-applied-to-bernoulli-likelihood-and-beta-prior."><i class="fa fa-check"></i><b>7.3.1</b> Metropolis algorithm applied to Bernoulli likelihood and beta prior.</a></li>
<li class="chapter" data-level="7.3.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#summary-of-metropolis-algorithm."><i class="fa fa-check"></i><b>7.3.2</b> Summary of Metropolis algorithm.</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#toward-gibbs-sampling-estimating-two-coin-biases"><i class="fa fa-check"></i><b>7.4</b> Toward Gibbs sampling: Estimating two coin biases</a><ul>
<li class="chapter" data-level="7.4.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#prior-likelihood-and-posterior-for-two-biases."><i class="fa fa-check"></i><b>7.4.1</b> Prior, likelihood and posterior for two biases.</a></li>
<li class="chapter" data-level="7.4.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-exact-formal-analysis."><i class="fa fa-check"></i><b>7.4.2</b> The posterior via exact formal analysis.</a></li>
<li class="chapter" data-level="7.4.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.4.3</b> The posterior via the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.4.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#gibbs-hamiltonian-monte-carlo-sampling."><i class="fa fa-check"></i><b>7.4.4</b> <del>Gibbs</del> Hamiltonian Monte Carlo sampling.</a></li>
<li class="chapter" data-level="7.4.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#is-there-a-difference-between-biases"><i class="fa fa-check"></i><b>7.4.5</b> Is there a difference between biases?</a></li>
<li class="chapter" data-level="7.4.6" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#terminology-mcmc."><i class="fa fa-check"></i><b>7.4.6</b> Terminology: MCMC.</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness-accuracy-and-efficiency"><i class="fa fa-check"></i><b>7.5</b> MCMC representativeness, accuracy, and efficiency</a><ul>
<li class="chapter" data-level="7.5.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness."><i class="fa fa-check"></i><b>7.5.1</b> MCMC representativeness.</a></li>
<li class="chapter" data-level="7.5.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-accuracy."><i class="fa fa-check"></i><b>7.5.2</b> MCMC accuracy.</a></li>
<li class="chapter" data-level="7.5.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-efficiency."><i class="fa fa-check"></i><b>7.5.3</b> MCMC efficiency.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="jags-brms.html"><a href="jags-brms.html"><i class="fa fa-check"></i><b>8</b> <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="8.1" data-path="jags-brms.html"><a href="jags-brms.html#jags-brms-and-its-relation-to-r"><i class="fa fa-check"></i><b>8.1</b> <del>JAGS</del> brms and its relation to R</a></li>
<li class="chapter" data-level="8.2" data-path="jags-brms.html"><a href="jags-brms.html#a-complete-example"><i class="fa fa-check"></i><b>8.2</b> A complete example</a><ul>
<li class="chapter" data-level="8.2.1" data-path="jags-brms.html"><a href="jags-brms.html#load-data."><i class="fa fa-check"></i><b>8.2.1</b> Load data.</a></li>
<li class="chapter" data-level="8.2.2" data-path="jags-brms.html"><a href="jags-brms.html#specify-model."><i class="fa fa-check"></i><b>8.2.2</b> Specify model.</a></li>
<li class="chapter" data-level="8.2.3" data-path="jags-brms.html"><a href="jags-brms.html#initialize-chains."><i class="fa fa-check"></i><b>8.2.3</b> Initialize chains.</a></li>
<li class="chapter" data-level="8.2.4" data-path="jags-brms.html"><a href="jags-brms.html#generate-chains."><i class="fa fa-check"></i><b>8.2.4</b> Generate chains.</a></li>
<li class="chapter" data-level="8.2.5" data-path="jags-brms.html"><a href="jags-brms.html#examine-chains."><i class="fa fa-check"></i><b>8.2.5</b> Examine chains.</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="jags-brms.html"><a href="jags-brms.html#simplified-scripts-for-frequently-used-analyses"><i class="fa fa-check"></i><b>8.3</b> Simplified scripts for frequently used analyses</a></li>
<li class="chapter" data-level="8.4" data-path="jags-brms.html"><a href="jags-brms.html#example-difference-of-biases"><i class="fa fa-check"></i><b>8.4</b> Example: Difference of biases</a></li>
<li class="chapter" data-level="8.5" data-path="jags-brms.html"><a href="jags-brms.html#sampling-from-the-prior-distribution-in-jags-brms"><i class="fa fa-check"></i><b>8.5</b> Sampling from the prior distribution in <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="8.6" data-path="jags-brms.html"><a href="jags-brms.html#probability-distributions-available-in-jags-brms"><i class="fa fa-check"></i><b>8.6</b> Probability distributions available in <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="8.6.1" data-path="jags-brms.html"><a href="jags-brms.html#defining-new-likelihood-functions."><i class="fa fa-check"></i><b>8.6.1</b> Defining new likelihood functions.</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="jags-brms.html"><a href="jags-brms.html#faster-sampling-with-parallel-processing-in-runjags-brmsbrm"><i class="fa fa-check"></i><b>8.7</b> Faster sampling with parallel processing in <del>runjags</del> <code>brms::brm()</code></a></li>
<li class="chapter" data-level="8.8" data-path="jags-brms.html"><a href="jags-brms.html#tips-for-expanding-jags-brms-models"><i class="fa fa-check"></i><b>8.8</b> Tips for expanding <del>JAGS</del> brms models</a></li>
<li class="chapter" data-level="" data-path="jags-brms.html"><a href="jags-brms.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>9</b> Hierarchical Models</a><ul>
<li class="chapter" data-level="9.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-single-coin-from-a-single-mint"><i class="fa fa-check"></i><b>9.1</b> A single coin from a single mint</a><ul>
<li class="chapter" data-level="9.1.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation."><i class="fa fa-check"></i><b>9.1.1</b> Posterior via grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#multiple-coins-from-a-single-mint"><i class="fa fa-check"></i><b>9.2</b> Multiple coins from a single mint</a><ul>
<li class="chapter" data-level="9.2.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation.-1"><i class="fa fa-check"></i><b>9.2.1</b> Posterior via grid approximation.</a></li>
<li class="chapter" data-level="9.2.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-realistic-model-with-mcmc."><i class="fa fa-check"></i><b>9.2.2</b> A realistic model with MCMC.</a></li>
<li class="chapter" data-level="9.2.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#doing-it-with-jags-brms."><i class="fa fa-check"></i><b>9.2.3</b> Doing it with <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="9.2.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-therapeutic-touch."><i class="fa fa-check"></i><b>9.2.4</b> Example: Therapeutic touch.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#shrinkage-in-hierarchical-models"><i class="fa fa-check"></i><b>9.3</b> Shrinkage in hierarchical models</a></li>
<li class="chapter" data-level="9.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#speeding-up-jags-brms"><i class="fa fa-check"></i><b>9.4</b> Speeding up <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="9.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#extending-the-hierarchy-subjects-within-categories"><i class="fa fa-check"></i><b>9.5</b> Extending the hierarchy: Subjects within categories</a><ul>
<li class="chapter" data-level="9.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-baseball-batting-abilities-by-position."><i class="fa fa-check"></i><b>9.5.1</b> Example: Baseball batting abilities by position.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hierarchical-models.html"><a href="hierarchical-models.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html"><i class="fa fa-check"></i><b>10</b> Model Comparison and Hierarchical Modeling</a><ul>
<li class="chapter" data-level="10.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#general-formula-and-the-bayes-factor"><i class="fa fa-check"></i><b>10.1</b> General formula and the Bayes factor</a></li>
<li class="chapter" data-level="10.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#example-two-factories-of-coins"><i class="fa fa-check"></i><b>10.2</b> Example: Two factories of coins</a><ul>
<li class="chapter" data-level="10.2.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-formal-analysis."><i class="fa fa-check"></i><b>10.2.1</b> Solution by formal analysis.</a></li>
<li class="chapter" data-level="10.2.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-grid-approximation."><i class="fa fa-check"></i><b>10.2.2</b> Solution by grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-mcmc"><i class="fa fa-check"></i><b>10.3</b> Solution by MCMC</a><ul>
<li class="chapter" data-level="10.3.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#nonhierarchical-mcmc-computation-of-each-models-marginal-likelihood."><i class="fa fa-check"></i><b>10.3.1</b> Nonhierarchical MCMC computation of each model’s marginal likelihood.</a></li>
<li class="chapter" data-level="10.3.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#hierarchical-mcmc-computation-of-relative-model-probability-is-not-available-in-brms-well-cover-information-criteria-instead."><i class="fa fa-check"></i><b>10.3.2</b> Hierarchical MCMC computation <del>of relative model probability</del> is not available in brms: We’ll cover information criteria instead.</a></li>
<li class="chapter" data-level="10.3.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#models-with-different-noise-distributions-in-jags-brms."><i class="fa fa-check"></i><b>10.3.3</b> Models with different “noise” distributions in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#prediction-model-averaging"><i class="fa fa-check"></i><b>10.4</b> Prediction: Model averaging</a></li>
<li class="chapter" data-level="10.5" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#model-complexity-naturally-accounted-for"><i class="fa fa-check"></i><b>10.5</b> Model complexity naturally accounted for</a><ul>
<li class="chapter" data-level="10.5.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#caveats-regarding-nested-model-comparison."><i class="fa fa-check"></i><b>10.5.1</b> Caveats regarding nested model comparison.</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#extreme-sensitivity-to-prior-distribution"><i class="fa fa-check"></i><b>10.6</b> Extreme sensitivity to prior distribution</a><ul>
<li class="chapter" data-level="10.6.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#priors-of-different-models-should-be-equally-informed."><i class="fa fa-check"></i><b>10.6.1</b> Priors of different models should be equally informed.</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#bonus-theres-danger-ahead"><i class="fa fa-check"></i><b>10.7</b> Bonus: There’s danger ahead</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html"><i class="fa fa-check"></i><b>11</b> Null Hypothesis Significance Testing</a><ul>
<li class="chapter" data-level="11.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#paved-with-good-intentions"><i class="fa fa-check"></i><b>11.1</b> Paved with good intentions</a><ul>
<li class="chapter" data-level="11.1.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#definition-of-p-value."><i class="fa fa-check"></i><b>11.1.1</b> Definition of <span class="math inline">\(p\)</span> value.</a></li>
<li class="chapter" data-level="11.1.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-n."><i class="fa fa-check"></i><b>11.1.2</b> With intention to fix <span class="math inline">\(N\)</span>.</a></li>
<li class="chapter" data-level="11.1.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-z."><i class="fa fa-check"></i><b>11.1.3</b> With intention to fix <span class="math inline">\(z\)</span>.</a></li>
<li class="chapter" data-level="11.1.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-duration."><i class="fa fa-check"></i><b>11.1.4</b> With intention to fix duration.</a></li>
<li class="chapter" data-level="11.1.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-make-multiple-tests."><i class="fa fa-check"></i><b>11.1.5</b> With intention to make multiple tests.</a></li>
<li class="chapter" data-level="11.1.6" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#soul-searching."><i class="fa fa-check"></i><b>11.1.6</b> Soul searching.</a></li>
<li class="chapter" data-level="11.1.7" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis."><i class="fa fa-check"></i><b>11.1.7</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#prior-knowledge"><i class="fa fa-check"></i><b>11.2</b> Prior knowledge</a><ul>
<li class="chapter" data-level="11.2.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-analysis."><i class="fa fa-check"></i><b>11.2.1</b> NHST analysis.</a></li>
<li class="chapter" data-level="11.2.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis.-1"><i class="fa fa-check"></i><b>11.2.2</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#confidence-interval-and-highest-density-interval"><i class="fa fa-check"></i><b>11.3</b> Confidence interval and highest density interval</a><ul>
<li class="chapter" data-level="11.3.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#ci-depends-on-intention."><i class="fa fa-check"></i><b>11.3.1</b> CI depends on intention.</a></li>
<li class="chapter" data-level="11.3.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-hdi."><i class="fa fa-check"></i><b>11.3.2</b> Bayesian HDI.</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#multiple-comparisons"><i class="fa fa-check"></i><b>11.4</b> Multiple comparisons</a><ul>
<li class="chapter" data-level="11.4.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-correction-for-experiment-wise-error."><i class="fa fa-check"></i><b>11.4.1</b> NHST correction for experiment wise error.</a></li>
<li class="chapter" data-level="11.4.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#just-one-bayesian-posterior-no-matter-how-you-look-at-it."><i class="fa fa-check"></i><b>11.4.2</b> Just one Bayesian posterior no matter how you look at it.</a></li>
<li class="chapter" data-level="11.4.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#how-bayesian-analysis-mitigates-false-alarms."><i class="fa fa-check"></i><b>11.4.3</b> How Bayesian analysis mitigates false alarms.</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#what-a-sampling-distribution-is-good-for"><i class="fa fa-check"></i><b>11.5</b> What a sampling distribution is good for</a><ul>
<li class="chapter" data-level="11.5.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#planning-an-experiment."><i class="fa fa-check"></i><b>11.5.1</b> Planning an experiment.</a></li>
<li class="chapter" data-level="11.5.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#exploring-model-predictions-posterior-predictive-check."><i class="fa fa-check"></i><b>11.5.2</b> Exploring model predictions (posterior predictive check).</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#session-info-10"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><i class="fa fa-check"></i><b>12</b> Bayesian Approaches to Testing a Point (“Null”) Hypothesis</a><ul>
<li class="chapter" data-level="12.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-estimation-approach"><i class="fa fa-check"></i><b>12.1</b> The estimation approach</a><ul>
<li class="chapter" data-level="12.1.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#region-of-practical-equivalence."><i class="fa fa-check"></i><b>12.1.1</b> Region of practical equivalence.</a></li>
<li class="chapter" data-level="12.1.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#some-examples."><i class="fa fa-check"></i><b>12.1.2</b> Some examples.</a></li>
<li class="chapter" data-level="12.1.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#differences-of-correlated-parameters."><i class="fa fa-check"></i><b>12.1.3</b> Differences of correlated parameters.</a></li>
<li class="chapter" data-level="12.1.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#why-hdi-and-not-equal-tailed-interval"><i class="fa fa-check"></i><b>12.1.4</b> Why HDI and not equal-tailed interval?</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-model-comparison-approach"><i class="fa fa-check"></i><b>12.2</b> The model-comparison approach</a><ul>
<li class="chapter" data-level="12.2.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#is-a-coin-fair-or-not"><i class="fa fa-check"></i><b>12.2.1</b> Is a coin fair or not?</a></li>
<li class="chapter" data-level="12.2.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#bayes-factor-can-accept-null-with-poor-precision."><i class="fa fa-check"></i><b>12.2.2</b> Bayes’ factor can accept null with poor precision.</a></li>
<li class="chapter" data-level="12.2.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#are-different-groups-equal-or-not"><i class="fa fa-check"></i><b>12.2.3</b> Are different groups equal or not?</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#relations-of-parameter-estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.3</b> Relations of parameter estimation and model comparison</a></li>
<li class="chapter" data-level="12.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.4</b> Estimation and model comparison?</a></li>
<li class="chapter" data-level="" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#session-info-11"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html"><i class="fa fa-check"></i><b>13</b> Goals, Power, and Sample Size</a><ul>
<li class="chapter" data-level="13.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-will-to-power"><i class="fa fa-check"></i><b>13.1</b> The will to power</a><ul>
<li class="chapter" data-level="13.1.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#goals-and-obstacles."><i class="fa fa-check"></i><b>13.1.1</b> Goals and obstacles.</a></li>
<li class="chapter" data-level="13.1.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power."><i class="fa fa-check"></i><b>13.1.2</b> Power.</a></li>
<li class="chapter" data-level="13.1.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sample-size."><i class="fa fa-check"></i><b>13.1.3</b> Sample size.</a></li>
<li class="chapter" data-level="13.1.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#other-expressions-of-goals."><i class="fa fa-check"></i><b>13.1.4</b> Other expressions of goals.</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#computing-power-and-sample-size"><i class="fa fa-check"></i><b>13.2</b> Computing power and sample size</a><ul>
<li class="chapter" data-level="13.2.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-to-exclude-a-null-value."><i class="fa fa-check"></i><b>13.2.1</b> When the goal is to exclude a null value.</a></li>
<li class="chapter" data-level="13.2.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#formal-solution-and-implementation-in-r."><i class="fa fa-check"></i><b>13.2.2</b> Formal solution and implementation in R.</a></li>
<li class="chapter" data-level="13.2.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-precision."><i class="fa fa-check"></i><b>13.2.3</b> When the goal is precision.</a></li>
<li class="chapter" data-level="13.2.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#monte-carlo-approximation-of-power."><i class="fa fa-check"></i><b>13.2.4</b> Monte Carlo approximation of power.</a></li>
<li class="chapter" data-level="13.2.5" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-from-idealized-or-actual-data."><i class="fa fa-check"></i><b>13.2.5</b> Power from idealized or actual data.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sequential-testing-and-the-goal-of-precision"><i class="fa fa-check"></i><b>13.3</b> Sequential testing and the goal of precision</a><ul>
<li class="chapter" data-level="13.3.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#examples-ofsequential-tests."><i class="fa fa-check"></i><b>13.3.1</b> Examples ofsequential tests.</a></li>
<li class="chapter" data-level="13.3.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#average-behavior-of-sequential-tests."><i class="fa fa-check"></i><b>13.3.2</b> Average behavior of sequential tests.</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#discussion"><i class="fa fa-check"></i><b>13.4</b> Discussion</a><ul>
<li class="chapter" data-level="13.4.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-and-multiple-comparisons."><i class="fa fa-check"></i><b>13.4.1</b> Power and multiple comparisons.</a></li>
<li class="chapter" data-level="13.4.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-prospective-retrospective-and-replication."><i class="fa fa-check"></i><b>13.4.2</b> Power: prospective, retrospective, and replication.</a></li>
<li class="chapter" data-level="13.4.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-analysis-requires-verisimilitude-of-simulated-data."><i class="fa fa-check"></i><b>13.4.3</b> Power analysis requires verisimilitude of simulated data.</a></li>
<li class="chapter" data-level="13.4.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-importance-of-planning."><i class="fa fa-check"></i><b>13.4.4</b> The importance of planning.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#session-info-12"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="stan.html"><a href="stan.html"><i class="fa fa-check"></i><b>14</b> Stan</a><ul>
<li class="chapter" data-level="14.1" data-path="stan.html"><a href="stan.html#hmc-sampling"><i class="fa fa-check"></i><b>14.1</b> HMC sampling</a></li>
<li class="chapter" data-level="14.2" data-path="stan.html"><a href="stan.html#installing-stan"><i class="fa fa-check"></i><b>14.2</b> Installing Stan</a></li>
<li class="chapter" data-level="14.3" data-path="stan.html"><a href="stan.html#a-complete-example-1"><i class="fa fa-check"></i><b>14.3</b> A Complete example</a><ul>
<li class="chapter" data-level="14.3.1" data-path="stan.html"><a href="stan.html#reusing-the-compiled-model."><i class="fa fa-check"></i><b>14.3.1</b> Reusing the compiled model.</a></li>
<li class="chapter" data-level="14.3.2" data-path="stan.html"><a href="stan.html#general-structure-of-stan-model-specification."><i class="fa fa-check"></i><b>14.3.2</b> General structure of Stan model specification.</a></li>
<li class="chapter" data-level="14.3.3" data-path="stan.html"><a href="stan.html#think-log-probability-to-think-like-stan."><i class="fa fa-check"></i><b>14.3.3</b> Think log probability to think like Stan.</a></li>
<li class="chapter" data-level="14.3.4" data-path="stan.html"><a href="stan.html#sampling-the-prior-in-stan."><i class="fa fa-check"></i><b>14.3.4</b> Sampling the prior in Stan.</a></li>
<li class="chapter" data-level="14.3.5" data-path="stan.html"><a href="stan.html#simplified-scripts-for-frequently-used-analyses."><i class="fa fa-check"></i><b>14.3.5</b> Simplified scripts for frequently used analyses.</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="stan.html"><a href="stan.html#specify-models-top-down-in-stan"><i class="fa fa-check"></i><b>14.4</b> Specify models top-down in Stan</a></li>
<li class="chapter" data-level="14.5" data-path="stan.html"><a href="stan.html#limitations-and-extras"><i class="fa fa-check"></i><b>14.5</b> Limitations and extras</a></li>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#session-info-13"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>15</b> Overview of the Generalized Linear Model</a><ul>
<li class="chapter" data-level="15.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#types-of-variables"><i class="fa fa-check"></i><b>15.1</b> Types of variables</a><ul>
<li class="chapter" data-level="15.1.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#predictor-and-predicted-variables."><i class="fa fa-check"></i><b>15.1.1</b> Predictor and predicted variables.</a></li>
<li class="chapter" data-level="15.1.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#scale-types-metric-ordinal-nominal-and-count."><i class="fa fa-check"></i><b>15.1.2</b> Scale types: metric, ordinal, nominal, and count.</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-combination-of-predictors"><i class="fa fa-check"></i><b>15.2</b> Linear combination of predictors</a><ul>
<li class="chapter" data-level="15.2.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-function-of-a-single-metric-predictor."><i class="fa fa-check"></i><b>15.2.1</b> Linear function of a single metric predictor.</a></li>
<li class="chapter" data-level="15.2.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#additive-combination-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.2</b> Additive combination of metric predictors.</a></li>
<li class="chapter" data-level="15.2.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nonadditive-interaction-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.3</b> Nonadditive interaction of metric predictors.</a></li>
<li class="chapter" data-level="15.2.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nominal-predictors."><i class="fa fa-check"></i><b>15.2.4</b> Nominal predictors.</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linking-from-combined-predictors-to-noisy-predicted-data"><i class="fa fa-check"></i><b>15.3</b> Linking from combined predictors to noisy predicted data</a><ul>
<li class="chapter" data-level="15.3.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predictors-to-predicted-central-tendency."><i class="fa fa-check"></i><b>15.3.1</b> From predictors to predicted central tendency.</a></li>
<li class="chapter" data-level="15.3.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predicted-central-tendency-to-noisy-data."><i class="fa fa-check"></i><b>15.3.2</b> From predicted central tendency to noisy data.</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#formal-expression-of-the-glm"><i class="fa fa-check"></i><b>15.4</b> Formal expression of the GLM</a><ul>
<li class="chapter" data-level="15.4.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#cases-of-the-glm."><i class="fa fa-check"></i><b>15.4.1</b> Cases of the GLM.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#session-info-14"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html"><i class="fa fa-check"></i><b>16</b> Metric-Predicted Variable on One or Two Groups</a><ul>
<li class="chapter" data-level="16.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#estimating-the-mean-and-standard-deviation-of-a-normal-distribution"><i class="fa fa-check"></i><b>16.1</b> Estimating the mean and standard deviation of a normal distribution</a><ul>
<li class="chapter" data-level="16.1.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#solution-by-mathematical-analysis-heads-up-on-precision."><i class="fa fa-check"></i><b>16.1.1</b> <del>Solution by mathematical analysis</del> Heads up on precision.</a></li>
<li class="chapter" data-level="16.1.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#approximation-by-mcmc-in-jags-hmc-in-brms."><i class="fa fa-check"></i><b>16.1.2</b> Approximation by <del>MCMC in JAGS</del> HMC in brms.</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#outliers-and-robust-estimation-the-t-distribution"><i class="fa fa-check"></i><b>16.2</b> Outliers and robust estimation: The <span class="math inline">\(t\)</span> distribution</a><ul>
<li class="chapter" data-level="16.2.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-jags-brms."><i class="fa fa-check"></i><b>16.2.1</b> Using the <span class="math inline">\(t\)</span> distribution in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="16.2.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-stan."><i class="fa fa-check"></i><b>16.2.2</b> Using the <span class="math inline">\(t\)</span> distribution in Stan.</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#two-groups"><i class="fa fa-check"></i><b>16.3</b> Two groups</a><ul>
<li class="chapter" data-level="16.3.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#analysis-by-nhst."><i class="fa fa-check"></i><b>16.3.1</b> Analysis by NHST.</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#other-noise-distributions-and-transforming-data"><i class="fa fa-check"></i><b>16.4</b> Other noise distributions and transforming data</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#session-info-15"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html"><i class="fa fa-check"></i><b>17</b> Metric Predicted Variable with One Metric Predictor</a><ul>
<li class="chapter" data-level="17.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#simple-linear-regression"><i class="fa fa-check"></i><b>17.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="17.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression"><i class="fa fa-check"></i><b>17.2</b> Robust linear regression</a><ul>
<li class="chapter" data-level="17.2.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-jags-brms."><i class="fa fa-check"></i><b>17.2.1</b> Robust linear regression in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.2.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-stan."><i class="fa fa-check"></i><b>17.2.2</b> Robust linear regression in Stan.</a></li>
<li class="chapter" data-level="17.2.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#stan-or-jags"><i class="fa fa-check"></i><b>17.2.3</b> Stan or JAGS?</a></li>
<li class="chapter" data-level="17.2.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#interpreting-the-posterior-distribution."><i class="fa fa-check"></i><b>17.2.4</b> Interpreting the posterior distribution.</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#hierarchical-regression-on-individuals-within-groups"><i class="fa fa-check"></i><b>17.3</b> Hierarchical regression on individuals within groups</a><ul>
<li class="chapter" data-level="17.3.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>17.3.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.3.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-posterior-distribution-shrinkage-and-prediction."><i class="fa fa-check"></i><b>17.3.2</b> The posterior distribution: Shrinkage and prediction.</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#quadratic-trend-and-weighted-data"><i class="fa fa-check"></i><b>17.4</b> Quadratic trend and weighted data</a><ul>
<li class="chapter" data-level="17.4.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#results-and-interpretation."><i class="fa fa-check"></i><b>17.4.1</b> Results and interpretation.</a></li>
<li class="chapter" data-level="17.4.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#further-extensions."><i class="fa fa-check"></i><b>17.4.2</b> Further extensions.</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#procedure-and-perils-for-expanding-a-model"><i class="fa fa-check"></i><b>17.5</b> Procedure and perils for expanding a model</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#session-info-16"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html"><i class="fa fa-check"></i><b>18</b> Metric Predicted Variable with Multiple Metric Predictors</a><ul>
<li class="chapter" data-level="18.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiple-linear-regression"><i class="fa fa-check"></i><b>18.1</b> Multiple linear regression</a><ul>
<li class="chapter" data-level="18.1.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-perils-of-correlated-predictors."><i class="fa fa-check"></i><b>18.1.1</b> The perils of correlated predictors.</a></li>
<li class="chapter" data-level="18.1.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-model-and-implementation."><i class="fa fa-check"></i><b>18.1.2</b> The model and implementation.</a></li>
<li class="chapter" data-level="18.1.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-posterior-distribution."><i class="fa fa-check"></i><b>18.1.3</b> The posterior distribution.</a></li>
<li class="chapter" data-level="18.1.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#redundant-predictors."><i class="fa fa-check"></i><b>18.1.4</b> Redundant predictors.</a></li>
<li class="chapter" data-level="18.1.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#informative-priors-sparse-data-and-correlated-predictors."><i class="fa fa-check"></i><b>18.1.5</b> Informative priors, sparse data, and correlated predictors.</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiplicative-interaction-of-metric-predictors"><i class="fa fa-check"></i><b>18.2</b> Multiplicative interaction of metric predictors</a><ul>
<li class="chapter" data-level="18.2.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#an-example."><i class="fa fa-check"></i><b>18.2.1</b> An example.</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#shrinkage-of-regression-coefficients"><i class="fa fa-check"></i><b>18.3</b> Shrinkage of regression coefficients</a></li>
<li class="chapter" data-level="18.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection"><i class="fa fa-check"></i><b>18.4</b> Variable selection</a><ul>
<li class="chapter" data-level="18.4.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#inclusion-probability-is-strongly-affected-by-vagueness-of-prior."><i class="fa fa-check"></i><b>18.4.1</b> Inclusion probability is strongly affected by vagueness of prior.</a></li>
<li class="chapter" data-level="18.4.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection-with-hierarchical-shrinkage."><i class="fa fa-check"></i><b>18.4.2</b> Variable selection with hierarchical shrinkage.</a></li>
<li class="chapter" data-level="18.4.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#what-to-report-and-what-to-conclude."><i class="fa fa-check"></i><b>18.4.3</b> What to report and what to conclude.</a></li>
<li class="chapter" data-level="18.4.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-computational-methods."><i class="fa fa-check"></i><b>18.4.4</b> Caution: Computational methods.</a></li>
<li class="chapter" data-level="18.4.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-interaction-variables."><i class="fa fa-check"></i><b>18.4.5</b> Caution: Interaction variables.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#session-info-17"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html"><i class="fa fa-check"></i><b>19</b> Metric Predicted Variable with One Nominal Predictor</a><ul>
<li class="chapter" data-level="19.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#describing-multiple-groups-of-metric-data"><i class="fa fa-check"></i><b>19.1</b> Describing multiple groups of metric data</a></li>
<li class="chapter" data-level="19.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#traditional-analysis-of-variance"><i class="fa fa-check"></i><b>19.2</b> Traditional analysis of variance</a></li>
<li class="chapter" data-level="19.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#hierarchical-bayesian-approach"><i class="fa fa-check"></i><b>19.3</b> Hierarchical Bayesian approach</a><ul>
<li class="chapter" data-level="19.3.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#implementation-in-jags-brms."><i class="fa fa-check"></i><b>19.3.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="19.3.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-and-death."><i class="fa fa-check"></i><b>19.3.2</b> Example: Sex and death.</a></li>
<li class="chapter" data-level="19.3.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#contrasts."><i class="fa fa-check"></i><b>19.3.3</b> Contrasts.</a></li>
<li class="chapter" data-level="19.3.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#multiple-comparisons-and-shrinkage."><i class="fa fa-check"></i><b>19.3.4</b> Multiple comparisons and shrinkage.</a></li>
<li class="chapter" data-level="19.3.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#the-two-group-case."><i class="fa fa-check"></i><b>19.3.5</b> The two-group case.</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#including-a-metric-predictor"><i class="fa fa-check"></i><b>19.4</b> Including a metric predictor</a><ul>
<li class="chapter" data-level="19.4.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-death-and-size."><i class="fa fa-check"></i><b>19.4.1</b> Example: Sex, death, and size.</a></li>
<li class="chapter" data-level="19.4.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#analogous-to-traditional-ancova."><i class="fa fa-check"></i><b>19.4.2</b> Analogous to traditional ANCOVA.</a></li>
<li class="chapter" data-level="19.4.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#relation-to-hierarchical-linear-regression."><i class="fa fa-check"></i><b>19.4.3</b> Relation to hierarchical linear regression.</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#heterogeneous-variances-and-robustness-against-outliers"><i class="fa fa-check"></i><b>19.5</b> Heterogeneous variances and robustness against outliers</a><ul>
<li class="chapter" data-level="19.5.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-contrast-of-means-with-different-variances."><i class="fa fa-check"></i><b>19.5.1</b> Example: Contrast of means with different variances.</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#exercises-walk-out-an-effect-size"><i class="fa fa-check"></i><b>19.6</b> <del>Exercises</del> Walk out an effect size</a><ul>
<li class="chapter" data-level="19.6.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#populations-and-samples."><i class="fa fa-check"></i><b>19.6.1</b> Populations and samples.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#session-info-18"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html"><i class="fa fa-check"></i><b>20</b> Metric Predicted Variable with Multiple Nominal Predictors</a><ul>
<li class="chapter" data-level="20.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#describing-groups-of-metric-data-with-multiple-nominal-predictors"><i class="fa fa-check"></i><b>20.1</b> Describing groups of metric data with multiple nominal predictors</a><ul>
<li class="chapter" data-level="20.1.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction."><i class="fa fa-check"></i><b>20.1.1</b> Interaction.</a></li>
<li class="chapter" data-level="20.1.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#traditional-anova."><i class="fa fa-check"></i><b>20.1.2</b> Traditional ANOVA.</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#hierarchical-bayesian-approach-1"><i class="fa fa-check"></i><b>20.2</b> Hierarchical Bayesian approach</a><ul>
<li class="chapter" data-level="20.2.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>20.2.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="20.2.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#example-its-only-money."><i class="fa fa-check"></i><b>20.2.2</b> Example: It’s only money.</a></li>
<li class="chapter" data-level="20.2.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#main-effect-contrasts."><i class="fa fa-check"></i><b>20.2.3</b> Main effect contrasts.</a></li>
<li class="chapter" data-level="20.2.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction-contrasts-and-simple-effects."><i class="fa fa-check"></i><b>20.2.4</b> Interaction contrasts and simple effects.</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#rescaling-can-change-interactions-homogeneity-and-normality"><i class="fa fa-check"></i><b>20.3</b> Rescaling can change interactions, homogeneity, and normality</a></li>
<li class="chapter" data-level="20.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#heterogeneous-variances-and-robustness-against-outliers-1"><i class="fa fa-check"></i><b>20.4</b> Heterogeneous variances and robustness against outliers</a></li>
<li class="chapter" data-level="20.5" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#within-subject-designs"><i class="fa fa-check"></i><b>20.5</b> Within-subject designs</a><ul>
<li class="chapter" data-level="20.5.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#why-use-a-within-subject-design-and-why-not"><i class="fa fa-check"></i><b>20.5.1</b> Why use a within-subject design? And why not?</a></li>
<li class="chapter" data-level="20.5.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#split-plot-design."><i class="fa fa-check"></i><b>20.5.2</b> Split-plot design.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#session-info-19"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#footnote"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html"><i class="fa fa-check"></i><b>21</b> Dichotomous Predicted Variable</a><ul>
<li class="chapter" data-level="21.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-metric-predictors"><i class="fa fa-check"></i><b>21.1</b> Multiple metric predictors</a><ul>
<li class="chapter" data-level="21.1.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#the-model-and-implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>21.1.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="21.1.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#example-height-weight-and-gender."><i class="fa fa-check"></i><b>21.1.2</b> Example: Height, weight, and gender.</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interpreting-the-regression-coefficients"><i class="fa fa-check"></i><b>21.2</b> Interpreting the regression coefficients</a><ul>
<li class="chapter" data-level="21.2.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#log-odds."><i class="fa fa-check"></i><b>21.2.1</b> Log odds.</a></li>
<li class="chapter" data-level="21.2.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#when-there-are-few-1s-or-0s-in-the-data."><i class="fa fa-check"></i><b>21.2.2</b> When there are few 1’s or 0’s in the data.</a></li>
<li class="chapter" data-level="21.2.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#correlated-predictors."><i class="fa fa-check"></i><b>21.2.3</b> Correlated predictors.</a></li>
<li class="chapter" data-level="21.2.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interaction-of-metric-predictors."><i class="fa fa-check"></i><b>21.2.4</b> Interaction of metric predictors.</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#robust-logistic-regression"><i class="fa fa-check"></i><b>21.3</b> Robust logistic regression</a></li>
<li class="chapter" data-level="21.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#nominal-predictors"><i class="fa fa-check"></i><b>21.4</b> Nominal predictors</a><ul>
<li class="chapter" data-level="21.4.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#single-group."><i class="fa fa-check"></i><b>21.4.1</b> Single group.</a></li>
<li class="chapter" data-level="21.4.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-groups."><i class="fa fa-check"></i><b>21.4.2</b> Multiple groups.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#session-info-20"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html"><i class="fa fa-check"></i><b>22</b> Nominal Predicted Variable</a><ul>
<li class="chapter" data-level="22.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-regression"><i class="fa fa-check"></i><b>22.1</b> Softmax regression</a><ul>
<li class="chapter" data-level="22.1.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-reduces-to-logistic-for-two-outcomes."><i class="fa fa-check"></i><b>22.1.1</b> Softmax reduces to logistic for two outcomes.</a></li>
<li class="chapter" data-level="22.1.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#independence-from-irrelevant-attributes."><i class="fa fa-check"></i><b>22.1.2</b> Independence from irrelevant attributes.</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#conditional-logistic-regression"><i class="fa fa-check"></i><b>22.2</b> Conditional logistic regression</a></li>
<li class="chapter" data-level="22.3" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#implementation-in-jags-brms"><i class="fa fa-check"></i><b>22.3</b> Implementation in <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="22.3.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-model."><i class="fa fa-check"></i><b>22.3.1</b> Softmax model.</a></li>
<li class="chapter" data-level="22.3.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#conditional-logistic-model."><i class="fa fa-check"></i><b>22.3.2</b> Conditional logistic model.</a></li>
<li class="chapter" data-level="22.3.3" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#results-interpreting-the-regression-coefficients."><i class="fa fa-check"></i><b>22.3.3</b> Results: Interpreting the regression coefficients.</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#generalizations-and-variations-of-the-models"><i class="fa fa-check"></i><b>22.4</b> Generalizations and variations of the models</a></li>
<li class="chapter" data-level="" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#session-info-21"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html"><i class="fa fa-check"></i><b>23</b> Ordinal Predicted Variable</a><ul>
<li class="chapter" data-level="23.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#modeling-ordinal-data-with-an-underlying-metric-variable"><i class="fa fa-check"></i><b>23.1</b> Modeling ordinal data with an underlying metric variable</a></li>
<li class="chapter" data-level="23.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-a-single-group"><i class="fa fa-check"></i><b>23.2</b> The case of a single group</a><ul>
<li class="chapter" data-level="23.2.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-3"><i class="fa fa-check"></i><b>23.2.1</b> Implementation in <del>JAGS</del> <strong>brms</strong>.</a></li>
<li class="chapter" data-level="23.2.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#examples-bayesian-estimation-recovers-true-parameter-values."><i class="fa fa-check"></i><b>23.2.2</b> Examples: Bayesian estimation recovers true parameter values.</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-two-groups"><i class="fa fa-check"></i><b>23.3</b> The case of two groups</a><ul>
<li class="chapter" data-level="23.3.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-4"><i class="fa fa-check"></i><b>23.3.1</b> Implementation in <del>JAGS</del> <strong>brms</strong>.</a></li>
<li class="chapter" data-level="23.3.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#examples-not-funny."><i class="fa fa-check"></i><b>23.3.2</b> Examples: Not funny.</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-metric-predictors"><i class="fa fa-check"></i><b>23.4</b> The Case of metric predictors</a><ul>
<li class="chapter" data-level="23.4.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-5"><i class="fa fa-check"></i><b>23.4.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="23.4.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#example-happiness-and-money."><i class="fa fa-check"></i><b>23.4.2</b> Example: Happiness and money.</a></li>
<li class="chapter" data-level="23.4.3" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#example-moviesthey-dont-make-em-like-they-used-to."><i class="fa fa-check"></i><b>23.4.3</b> Example: Movies–They don’t make ’em like they used to.</a></li>
<li class="chapter" data-level="23.4.4" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#why-are-some-thresholds-outside-the-data"><i class="fa fa-check"></i><b>23.4.4</b> Why are some thresholds outside the data?</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#posterior-prediction"><i class="fa fa-check"></i><b>23.5</b> Posterior prediction</a></li>
<li class="chapter" data-level="23.6" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#generalizations-and-extensions"><i class="fa fa-check"></i><b>23.6</b> Generalizations and extensions</a></li>
<li class="chapter" data-level="" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#session-info-22"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html"><i class="fa fa-check"></i><b>24</b> Count Predicted Variable</a><ul>
<li class="chapter" data-level="24.1" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#poisson-exponential-model"><i class="fa fa-check"></i><b>24.1</b> Poisson exponential model</a><ul>
<li class="chapter" data-level="24.1.1" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#data-structure."><i class="fa fa-check"></i><b>24.1.1</b> Data structure.</a></li>
<li class="chapter" data-level="24.1.2" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#exponential-link-function."><i class="fa fa-check"></i><b>24.1.2</b> Exponential link function.</a></li>
<li class="chapter" data-level="24.1.3" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#poisson-noise-distribution."><i class="fa fa-check"></i><b>24.1.3</b> Poisson noise distribution.</a></li>
<li class="chapter" data-level="24.1.4" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#the-complete-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>24.1.4</b> The complete model and implementation in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#example-hair-eye-go-again"><i class="fa fa-check"></i><b>24.2</b> Example: Hair eye go again</a></li>
<li class="chapter" data-level="24.3" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#example-interaction-contrasts-shrinkage-and-omnibus-test"><i class="fa fa-check"></i><b>24.3</b> Example: Interaction contrasts, shrinkage, and omnibus test</a></li>
<li class="chapter" data-level="24.4" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#log-linear-models-for-contingency-tables-bonus-alternative-parameterization"><i class="fa fa-check"></i><b>24.4</b> <del>Log-linear models for contingency tables</del> Bonus: Alternative parameterization</a></li>
<li class="chapter" data-level="" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#session-info-23"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html"><i class="fa fa-check"></i><b>25</b> Tools in the Trunk</a><ul>
<li class="chapter" data-level="25.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reporting-a-bayesian-analysis"><i class="fa fa-check"></i><b>25.1</b> Reporting a Bayesian analysis</a><ul>
<li class="chapter" data-level="25.1.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#essential-points."><i class="fa fa-check"></i><b>25.1.1</b> Essential points.</a></li>
<li class="chapter" data-level="25.1.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#optional-points."><i class="fa fa-check"></i><b>25.1.2</b> Optional points.</a></li>
<li class="chapter" data-level="25.1.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#helpful-points."><i class="fa fa-check"></i><b>25.1.3</b> Helpful points.</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#functions-for-computing-highest-density-intervals"><i class="fa fa-check"></i><b>25.2</b> Functions for computing highest density intervals</a><ul>
<li class="chapter" data-level="25.2.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-grid-approximation."><i class="fa fa-check"></i><b>25.2.1</b> R code for computing HDI of a grid approximation.</a></li>
<li class="chapter" data-level="25.2.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#hdi-of-unimodal-distribution-is-shortest-interval."><i class="fa fa-check"></i><b>25.2.2</b> HDI of unimodal distribution is shortest interval.</a></li>
<li class="chapter" data-level="25.2.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-mcmc-sample."><i class="fa fa-check"></i><b>25.2.3</b> R code for computing HDI of a MCMC sample.</a></li>
<li class="chapter" data-level="25.2.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-function."><i class="fa fa-check"></i><b>25.2.4</b> R code for computing HDI of a function.</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reparameterization"><i class="fa fa-check"></i><b>25.3</b> Reparameterization</a></li>
<li class="chapter" data-level="25.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#censored-data-in-jags-brms"><i class="fa fa-check"></i><b>25.4</b> Censored Data in <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="25.5" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#what-next"><i class="fa fa-check"></i><b>25.5</b> What Next?</a></li>
<li class="chapter" data-level="" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#session-info-24"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Doing Bayesian Data Analysis</em> in brms and the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="inferring-a-binomial-probability-via-exact-mathematical-analysis" class="section level1">
<h1><span class="header-section-number">6</span> Inferring a Binomial Probability via Exact Mathematical Analysis</h1>
<blockquote>
<p>This chapter presents an example of how to do Bayesian inference using pure analytical mathematics without any approximations. Ultimately, we will not use the pure analytical approach for complex applications, but this chapter is important for two reasons. <em>First</em>, the relatively simple mathematics in this chapter nicely reveal the underlying concepts of Bayesian inference on a continuous parameter. The simple formulas show how the continuous allocation of credibility changes systematically as data accumulate. The examples provide an important conceptual foundation for subsequent approximation methods, because the examples give you a clear sense of what is being approximated. <em>Second</em>, the distributions introduced in this chapter, especially the beta distribution, will be used repeatedly in subsequent chapters. <span class="citation">(Kruschke, <a href="#ref-kruschkeDoingBayesianData2015" role="doc-biblioref">2015</a>, p. 123, <em>emphasis</em> added)</span></p>
</blockquote>
<div id="the-likelihood-function-the-bernoulli-distribution" class="section level2">
<h2><span class="header-section-number">6.1</span> The likelihood function: The Bernoulli distribution</h2>
<p>If we denote a set of possible outcomes as <span class="math inline">\(\{y_i\}\)</span> Kruschke’s Bernoulli likelihood function for a set of <span class="math inline">\(N\)</span> trials follows the form</p>
<p><span class="math display">\[p(\{y_i\} | \theta) = \theta^z \cdot (1 - \theta) ^ {N - z},\]</span></p>
<p>where <span class="math inline">\(z\)</span> is the number of 1’s in the data (i.e., heads in a series of coin flips) and the sole parameter a given observation will be a 1 is <span class="math inline">\(\theta\)</span> (i.e., the probability; <span class="math inline">\(p(y_i = 1 | \theta)\)</span>).</p>
<p>If you follow that equation closely, here is how we might express it in <strong>R</strong>.</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb381-1"></a>bernoulli_likelihood &lt;-<span class="st"> </span><span class="cf">function</span>(theta, data) {</span>
<span id="cb381-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb381-2"></a>  </span>
<span id="cb381-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb381-3"></a>  <span class="co"># `theta` = success probability parameter ranging from 0 to 1</span></span>
<span id="cb381-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb381-4"></a>  <span class="co"># `data`  = the vector of data (i.e., a series of 0s and 1s)</span></span>
<span id="cb381-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb381-5"></a>  n &lt;-<span class="st"> </span><span class="kw">length</span>(data)</span>
<span id="cb381-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb381-6"></a>  z &lt;-<span class="st"> </span><span class="kw">sum</span>(data)</span>
<span id="cb381-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb381-7"></a>  </span>
<span id="cb381-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb381-8"></a>  <span class="kw">return</span>(theta<span class="op">^</span>z <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>theta)<span class="op">^</span>(n <span class="op">-</span><span class="st"> </span><span class="kw">sum</span>(data)))</span>
<span id="cb381-9"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb381-9"></a>  </span>
<span id="cb381-10"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb381-10"></a>}</span></code></pre></div>
<p>This will come in handy in just a bit.</p>
</div>
<div id="a-description-of-credibilities-the-beta-distribution" class="section level2">
<h2><span class="header-section-number">6.2</span> A description of credibilities: The beta distribution</h2>
<blockquote>
<p>In this chapter, we use purely mathematical analysis, with no numerical approximation, to derive the mathematical form of the posterior credibilities of parameter values. To do this, we need a mathematical description of the prior allocation of credibilities…</p>
<p>In principle, we could use any probability density function supported on the interval [0, 1]. When we intend to apply Bayes’ rule (Equation 5.7, p. 106), however, there are two desiderata for mathematical tractability. First, it would be convenient if the product of <span class="math inline">\(p(y | \theta)\)</span> and <span class="math inline">\(p(\theta)\)</span>, which is in the numerator of Bayes’ rule, results in a function of the same form as <span class="math inline">\(p(\theta)\)</span>… Second, we desire the denominator of Bayes’ rule (Equation 5.9, p. 107), namely <span class="math inline">\(\int \text d \; \theta p(y | \theta) p(\theta)\)</span>, to be solvable analytically. This quality also depends on how the form of the function <span class="math inline">\(p(\theta)\)</span> relates to the form of the function <span class="math inline">\(p(y | \theta)\)</span>. When the forms of <span class="math inline">\(p(y | \theta)\)</span> and <span class="math inline">\(p(\theta)\)</span> combine so that the posterior distribution has the same form as the prior distribution, then <span class="math inline">\(p(\theta)\)</span> is called a <em>conjugate prior</em> for <span class="math inline">\(p(y | \theta)\)</span>. (p. 127 <em>emphasis</em> in the original)</p>
</blockquote>
<p>When we want a conjugate prior for <span class="math inline">\(\theta\)</span> of the Bernoulli likelihood, the <em>beta distribution</em> is a handy choice. Beta has two parameters, <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> (also sometimes called <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>), and the density is defined as</p>
<p><span class="math display">\[\begin{align*}
p(\theta | a, b) &amp; = \operatorname{beta} (\theta | a, b) \\
                 &amp; = \frac{\theta^{(a - 1)} \; (1 - \theta)^{(b - 1)}}{B(a, b)},
\end{align*}\]</span></p>
<p>where <span class="math inline">\(B(a, b)\)</span> is a normalizing constant, keeping the results in a probability metric, and <span class="math inline">\(B(.)\)</span> is the Beta function. Kruschke then clarified that the beta distribution and the Beta function are not the same. In <strong>R</strong>, we use the beta density with the <code>dbeta()</code> function, whereas we use the Beta function with <code>beta()</code>. In this project, we’ll primarily use <code>dbeta()</code>. But to give a sense, notice that when given the same input for <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, the two functions return very different values.</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb382-1"></a>theta &lt;-<span class="st"> </span><span class="fl">.5</span></span>
<span id="cb382-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb382-2"></a>a     &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb382-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb382-3"></a>b     &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb382-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb382-4"></a></span>
<span id="cb382-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb382-5"></a><span class="kw">dbeta</span>(theta, a, b)</span></code></pre></div>
<pre><code>## [1] 1.875</code></pre>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb384-1"></a><span class="kw">beta</span>(a, b)</span></code></pre></div>
<pre><code>## [1] 0.03333333</code></pre>
<p>The <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> parameters are also called <em>shape</em> parameters. And indeed, if we look at the parameters of the <code>dbeta()</code> function in <strong>R</strong>, we’ll see that <span class="math inline">\(a\)</span> is called <code>shape1</code> and <span class="math inline">\(b\)</span> is called <code>shape2</code>.</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb386-1"></a><span class="kw">print</span>(dbeta)</span></code></pre></div>
<pre><code>## function (x, shape1, shape2, ncp = 0, log = FALSE) 
## {
##     if (missing(ncp)) 
##         .Call(C_dbeta, x, shape1, shape2, log)
##     else .Call(C_dnbeta, x, shape1, shape2, ncp, log)
## }
## &lt;bytecode: 0x7fcdedd81e20&gt;
## &lt;environment: namespace:stats&gt;</code></pre>
<p>You can learn more about the <code>dbeta()</code> function <a href="https://www.rdocumentation.org/packages/stats/versions/3.5.2/topics/Beta">here</a>.</p>
<p>Before we make Figure 6.1, we’ll need some data.</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb388-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb388-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb388-2"></a></span>
<span id="cb388-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb388-3"></a>length &lt;-<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb388-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb388-4"></a></span>
<span id="cb388-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb388-5"></a>d &lt;-</span>
<span id="cb388-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb388-6"></a><span class="st">  </span><span class="kw">crossing</span>(<span class="dt">shape1 =</span> <span class="kw">c</span>(.<span class="dv">1</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>),</span>
<span id="cb388-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb388-7"></a>           <span class="dt">shape2 =</span> <span class="kw">c</span>(.<span class="dv">1</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)) <span class="op">%&gt;%</span></span>
<span id="cb388-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb388-8"></a><span class="st">  </span><span class="kw">expand</span>(<span class="kw">nesting</span>(shape1, shape2),</span>
<span id="cb388-9"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb388-9"></a>         <span class="dt">x =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> length)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb388-10"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb388-10"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">a     =</span> <span class="kw">str_c</span>(<span class="st">&quot;a = &quot;</span>, shape1),</span>
<span id="cb388-11"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb388-11"></a>         <span class="dt">b     =</span> <span class="kw">str_c</span>(<span class="st">&quot;b = &quot;</span>, shape2),</span>
<span id="cb388-12"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb388-12"></a>         <span class="dt">group =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>length, <span class="dt">each =</span> <span class="dv">25</span>))</span>
<span id="cb388-13"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb388-13"></a></span>
<span id="cb388-14"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb388-14"></a><span class="kw">head</span>(d)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 6
##   shape1 shape2        x a       b       group
##    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;int&gt;
## 1    0.1    0.1 0        a = 0.1 b = 0.1     1
## 2    0.1    0.1 0.000100 a = 0.1 b = 0.1     1
## 3    0.1    0.1 0.000200 a = 0.1 b = 0.1     1
## 4    0.1    0.1 0.000300 a = 0.1 b = 0.1     1
## 5    0.1    0.1 0.000400 a = 0.1 b = 0.1     1
## 6    0.1    0.1 0.000500 a = 0.1 b = 0.1     1</code></pre>
<p>Now we’re ready for our Figure 6.1.</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb390-1"></a>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb390-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb390-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">group =</span> group)) <span class="op">+</span></span>
<span id="cb390-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb390-3"></a><span class="st">  </span></span>
<span id="cb390-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb390-4"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">dbeta</span>(x, <span class="dt">shape1 =</span> shape1, <span class="dt">shape2 =</span> shape2)),</span>
<span id="cb390-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb390-5"></a>            <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>, <span class="dt">size =</span> <span class="fl">1.25</span>) <span class="op">+</span></span>
<span id="cb390-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb390-6"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="kw">expression</span>(theta), <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.5</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb390-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb390-7"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">3</span>)) <span class="op">+</span></span>
<span id="cb390-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb390-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Examples of the beta distribution&quot;</span>,</span>
<span id="cb390-9"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb390-9"></a>       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">p</span>(theta<span class="op">*</span><span class="st">&quot;|&quot;</span><span class="op">*</span>a<span class="op">*</span><span class="st">&quot;, &quot;</span><span class="op">*</span>b))) <span class="op">+</span></span>
<span id="cb390-10"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb390-10"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb390-11"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb390-11"></a><span class="st">  </span><span class="kw">facet_grid</span>(b<span class="op">~</span>a)</span></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;" /></p>
<blockquote>
<p>Notice that as <span class="math inline">\(a\)</span> gets bigger (left to right across columns of Figure 6.1), the bulk of the distribution moves rightward over higher values of <span class="math inline">\(\theta\)</span>, but as <span class="math inline">\(b\)</span> gets bigger (top to bottom across rows of Figure 6.1), the bulk of the distribution moves leftward over lower values of <span class="math inline">\(\theta\)</span>. Notice that as <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> get bigger together, the beta distribution gets narrower. (p. 127).</p>
</blockquote>
<p>We have a lot of practice with the beta distribution waiting for us in the chapters to come. If you like informal tutorials, you might also check out <a href="https://twitter.com/karinknudson">Karin Knudson</a>’s nice blog post, <a href="https://karinknudson.com/dirichletprocesses.html"><em>Beta distributions, Dirichlet distributions and Dirichlet processes</em></a>.</p>
<div id="specifying-a-beta-prior." class="section level3">
<h3><span class="header-section-number">6.2.1</span> Specifying a beta prior.</h3>
<blockquote>
<p>It is useful to know the central tendency and spread of the beta distribution expressed in terms of <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>. It turns out that the mean of the <span class="math inline">\(\operatorname{beta}(\theta | a, b)\)</span> distribution is <span class="math inline">\(\mu = a / (a + b)\)</span> and the mode is <span class="math inline">\(\omega = (a − 1) / (a + b − 2)\)</span> for <span class="math inline">\(a &gt; 1\)</span> and <span class="math inline">\(b &gt; 1\)</span> (<span class="math inline">\(\mu\)</span> is Greek letter mu and <span class="math inline">\(\omega\)</span> is Greek letter omega)… The spread of the beta distribution is related to the “concentration” <span class="math inline">\(\kappa = a + b\)</span> (<span class="math inline">\(\kappa\)</span> is Greek letter kappa). You can see from Figure 6.1 that as <span class="math inline">\(\kappa = a + b\)</span> gets larger, the beta distribution gets narrower or more concentrated. (p. 129)</p>
</blockquote>
<p>As such, if you’d like to specify a beta distribution in terms of <span class="math inline">\(\omega\)</span> and <span class="math inline">\(\kappa\)</span>, it’d follow the form</p>
<p><span class="math display">\[\operatorname{beta} \big (\alpha = \omega (\kappa - 2) + 1, \beta = (1 - \omega) \cdot (\kappa - 2) + 1 \big ),\]</span></p>
<p>as long as <span class="math inline">\(\kappa &gt; 2\)</span>. Kruschke further clarified:</p>
<blockquote>
<p>The value we choose for the prior <span class="math inline">\(\kappa\)</span> can be thought of this way: It is the number of new flips of the coin that we would need to make us teeter between the new data and the prior belief about <span class="math inline">\(\mu\)</span>. If we would only need a few new flips to sway our beliefs, then our prior beliefs should be represented by a small <span class="math inline">\(\kappa\)</span>. If we would need a large number of new flips to sway us away from our prior beliefs about <span class="math inline">\(\mu\)</span>, then our prior beliefs are worth a very large <span class="math inline">\(\kappa\)</span>. (p. 129)</p>
</blockquote>
<p>He went on to clarify why we might prefer the mode to the mean when discussing the central tendency of a beta distribution.</p>
<blockquote>
<p>The mode can be more intuitive than the mean, especially for skewed distributions, because the mode is where the distribution reaches its tallest height, which is easy to visualize. The mean in a skewed distribution is somewhere away from the mode, in the direction of the longer tail. (pp. 129–130)</p>
</blockquote>
<p>Figure 6.2 helped contrast the mean and mode for beta. We’ll use the same process for Figure 6.2 and create the data, first.</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb391-1"></a>d &lt;-</span>
<span id="cb391-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb391-2"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">shape1 =</span> <span class="kw">c</span>(<span class="fl">5.6</span>, <span class="fl">17.6</span>, <span class="dv">5</span>, <span class="dv">17</span>),</span>
<span id="cb391-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb391-3"></a>         <span class="dt">shape2 =</span> <span class="kw">c</span>(<span class="fl">1.4</span>, <span class="fl">4.4</span>, <span class="dv">2</span>, <span class="dv">5</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb391-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb391-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">a        =</span> <span class="kw">str_c</span>(<span class="st">&quot;a = &quot;</span>, shape1),</span>
<span id="cb391-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb391-5"></a>         <span class="dt">b        =</span> <span class="kw">str_c</span>(<span class="st">&quot;b = &quot;</span>, shape2),</span>
<span id="cb391-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb391-6"></a>         <span class="dt">kappa    =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;kappa==7&quot;</span>, <span class="st">&quot;kappa==22&quot;</span>), <span class="dt">times =</span> <span class="dv">2</span>),</span>
<span id="cb391-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb391-7"></a>         <span class="dt">mu_omega =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;mu==0.8&quot;</span>, <span class="st">&quot;omega==0.8&quot;</span>), <span class="dt">each =</span> <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb391-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb391-8"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">kappa =</span> <span class="kw">factor</span>(kappa, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;kappa==7&quot;</span>, <span class="st">&quot;kappa==22&quot;</span>)),</span>
<span id="cb391-9"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb391-9"></a>         <span class="dt">label =</span> <span class="kw">str_c</span>(a, <span class="st">&quot;, &quot;</span>, b)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb391-10"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb391-10"></a><span class="st">  </span><span class="kw">expand</span>(<span class="kw">nesting</span>(shape1, shape2, a, b, label, kappa, mu_omega), </span>
<span id="cb391-11"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb391-11"></a>         <span class="dt">x =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> length))</span>
<span id="cb391-12"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb391-12"></a></span>
<span id="cb391-13"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb391-13"></a><span class="kw">head</span>(d)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 8
##   shape1 shape2 a     b     label        kappa    mu_omega          x
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;        &lt;fct&gt;    &lt;chr&gt;         &lt;dbl&gt;
## 1      5      2 a = 5 b = 2 a = 5, b = 2 kappa==7 omega==0.8 0       
## 2      5      2 a = 5 b = 2 a = 5, b = 2 kappa==7 omega==0.8 0.000100
## 3      5      2 a = 5 b = 2 a = 5, b = 2 kappa==7 omega==0.8 0.000200
## 4      5      2 a = 5 b = 2 a = 5, b = 2 kappa==7 omega==0.8 0.000300
## 5      5      2 a = 5 b = 2 a = 5, b = 2 kappa==7 omega==0.8 0.000400
## 6      5      2 a = 5 b = 2 a = 5, b = 2 kappa==7 omega==0.8 0.000500</code></pre>
<p>Here’s Figure 6.2.</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb393-1"></a>d <span class="op">%&gt;%</span></span>
<span id="cb393-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb393-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></span>
<span id="cb393-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb393-3"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">.8</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb393-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb393-4"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">dbeta</span>(x, <span class="dt">shape1 =</span> shape1, <span class="dt">shape2 =</span> shape2)),</span>
<span id="cb393-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb393-5"></a>            <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>, <span class="dt">size =</span> <span class="fl">1.25</span>) <span class="op">+</span></span>
<span id="cb393-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb393-6"></a><span class="st">  </span></span>
<span id="cb393-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb393-7"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> . <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(label) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="dv">1</span>),</span>
<span id="cb393-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb393-8"></a>            <span class="kw">aes</span>(<span class="dt">x =</span> <span class="fl">.025</span>, <span class="dt">y =</span> <span class="fl">4.75</span>, <span class="dt">label =</span> label),</span>
<span id="cb393-9"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb393-9"></a>            <span class="dt">hjust =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb393-10"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb393-10"></a><span class="st">  </span></span>
<span id="cb393-11"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb393-11"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="kw">expression</span>(theta), <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.8</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb393-12"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb393-12"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="kw">expression</span>(<span class="kw">p</span>(theta<span class="op">*</span><span class="st">&quot;|&quot;</span><span class="op">*</span>a<span class="op">*</span><span class="st">&quot;, &quot;</span><span class="op">*</span>b))) <span class="op">+</span></span>
<span id="cb393-13"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb393-13"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">5</span>)) <span class="op">+</span></span>
<span id="cb393-14"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb393-14"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb393-15"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb393-15"></a><span class="st">  </span><span class="kw">facet_grid</span>(mu_omega<span class="op">~</span>kappa, <span class="dt">labeller =</span> label_parsed)</span></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-9-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>In lines 264 to 290 in his <code>DBDA2E-utilities.R</code> file, Kruschke provided a series of <code>betaABfrom...()</code> functions that will allow us to compute the <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> parameters from measures of central tendency (i.e., mean and mode) and of spread (i.e., <span class="math inline">\(\kappa\)</span> and <span class="math inline">\(\sigma\)</span>). Here are those bits of his code.</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb394-1"></a><span class="co"># Shape parameters from central tendency and scale:</span></span>
<span id="cb394-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb394-2"></a>betaABfromMeanKappa &lt;-<span class="st"> </span><span class="cf">function</span>(mean, kappa) {</span>
<span id="cb394-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb394-3"></a>  <span class="cf">if</span> (mean <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">|</span><span class="st"> </span>mean <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>) <span class="kw">stop</span>(<span class="st">&quot;must have 0 &lt; mean &lt; 1&quot;</span>)</span>
<span id="cb394-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb394-4"></a>  <span class="cf">if</span> (kappa <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="kw">stop</span>(<span class="st">&quot;kappa must be &gt; 0&quot;</span>)</span>
<span id="cb394-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb394-5"></a>  a &lt;-<span class="st"> </span>mean <span class="op">*</span><span class="st"> </span>kappa</span>
<span id="cb394-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb394-6"></a>  b &lt;-<span class="st"> </span>(<span class="fl">1.0</span> <span class="op">-</span><span class="st"> </span>mean) <span class="op">*</span><span class="st"> </span>kappa</span>
<span id="cb394-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb394-7"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">a =</span> a, <span class="dt">b =</span> b))</span>
<span id="cb394-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb394-8"></a>}</span>
<span id="cb394-9"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb394-9"></a></span>
<span id="cb394-10"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb394-10"></a>betaABfromModeKappa &lt;-<span class="st"> </span><span class="cf">function</span>(mode, kappa) {</span>
<span id="cb394-11"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb394-11"></a>  <span class="cf">if</span> (mode <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">|</span><span class="st"> </span>mode <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>) <span class="kw">stop</span>(<span class="st">&quot;must have 0 &lt; mode &lt; 1&quot;</span>)</span>
<span id="cb394-12"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb394-12"></a>  <span class="cf">if</span> (kappa <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span>) <span class="kw">stop</span>(<span class="st">&quot;kappa must be &gt; 2 for mode parameterization&quot;</span>)</span>
<span id="cb394-13"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb394-13"></a>  a &lt;-<span class="st"> </span>mode <span class="op">*</span><span class="st"> </span>(kappa <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb394-14"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb394-14"></a>  b &lt;-<span class="st"> </span>(<span class="fl">1.0</span> <span class="op">-</span><span class="st"> </span>mode) <span class="op">*</span><span class="st"> </span>(kappa <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb394-15"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb394-15"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">a =</span> a, <span class="dt">b =</span> b))</span>
<span id="cb394-16"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb394-16"></a>}</span>
<span id="cb394-17"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb394-17"></a></span>
<span id="cb394-18"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb394-18"></a>betaABfromMeanSD &lt;-<span class="st"> </span><span class="cf">function</span>(mean, sd) {</span>
<span id="cb394-19"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb394-19"></a>  <span class="cf">if</span> (mean <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">|</span><span class="st"> </span>mean <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>) <span class="kw">stop</span>(<span class="st">&quot;must have 0 &lt; mean &lt; 1&quot;</span>)</span>
<span id="cb394-20"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb394-20"></a>  <span class="cf">if</span> (sd <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="kw">stop</span>(<span class="st">&quot;sd must be &gt; 0&quot;</span>)</span>
<span id="cb394-21"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb394-21"></a>  kappa &lt;-<span class="st"> </span>mean <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>mean)<span class="op">/</span>sd<span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb394-22"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb394-22"></a>  <span class="cf">if</span> (kappa <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="kw">stop</span>(<span class="st">&quot;invalid combination of mean and sd&quot;</span>)</span>
<span id="cb394-23"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb394-23"></a>  a &lt;-<span class="st"> </span>mean <span class="op">*</span><span class="st"> </span>kappa</span>
<span id="cb394-24"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb394-24"></a>  b &lt;-<span class="st"> </span>(<span class="fl">1.0</span> <span class="op">-</span><span class="st"> </span>mean) <span class="op">*</span><span class="st"> </span>kappa</span>
<span id="cb394-25"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb394-25"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">a =</span> a, <span class="dt">b =</span> b))</span>
<span id="cb394-26"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb394-26"></a>}</span></code></pre></div>
<p>You can use them like so.</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb395-1"></a><span class="kw">betaABfromMeanKappa</span>(<span class="dt">mean =</span> <span class="fl">.25</span>, <span class="dt">kappa =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## $a
## [1] 1
## 
## $b
## [1] 3</code></pre>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb397-1"></a><span class="kw">betaABfromModeKappa</span>(<span class="dt">mode =</span> <span class="fl">.25</span>, <span class="dt">kappa =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## $a
## [1] 1.5
## 
## $b
## [1] 2.5</code></pre>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb399-1"></a><span class="kw">betaABfromMeanSD</span>(<span class="dt">mean =</span> <span class="fl">.5</span>, <span class="dt">sd =</span> <span class="fl">.1</span>)</span></code></pre></div>
<pre><code>## $a
## [1] 12
## 
## $b
## [1] 12</code></pre>
<p>You can also save the results as an object, which can then be indexed by parameter.</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb401-1"></a>beta_param &lt;-<span class="st"> </span><span class="kw">betaABfromModeKappa</span>(<span class="dt">mode =</span> <span class="fl">.25</span>, <span class="dt">kappa =</span> <span class="dv">4</span>)</span>
<span id="cb401-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb401-2"></a></span>
<span id="cb401-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb401-3"></a>beta_param<span class="op">$</span>a</span></code></pre></div>
<pre><code>## [1] 1.5</code></pre>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb403-1"></a>beta_param<span class="op">$</span>b</span></code></pre></div>
<pre><code>## [1] 2.5</code></pre>
<p>We’ll find this trick quite handy in the sections to come.</p>
</div>
</div>
<div id="the-posterior-beta" class="section level2">
<h2><span class="header-section-number">6.3</span> The posterior beta</h2>
<p>I’m not going to reproduce all of Formula 6.8. But this a fine opportunity to re-express Bayes’ rule in terms of <span class="math inline">\(z\)</span> and <span class="math inline">\(N\)</span>,</p>
<p><span class="math display">\[p(\theta | z, N) = \frac{p(z, N | \theta) \; p(\theta)}{p(z, N)}.\]</span></p>
<div id="posterior-is-compromise-of-prior-and-likelihood." class="section level3">
<h3><span class="header-section-number">6.3.1</span> Posterior is compromise of prior and likelihood.</h3>
<p>You might wonder how Kruschke computed the HDI values for Figure 6.3. Remember our <code>hdi_of_icdf()</code> function from back in Chapter 4? Yep, that’s how. Here’s that code, again.</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-1"></a>hdi_of_icdf &lt;-<span class="st"> </span><span class="cf">function</span>(name, <span class="dt">width =</span> <span class="fl">.95</span>, <span class="dt">tol =</span> <span class="fl">1e-8</span>, ... ) {</span>
<span id="cb405-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-2"></a>  </span>
<span id="cb405-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-3"></a>  <span class="co"># Arguments:</span></span>
<span id="cb405-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-4"></a>  <span class="co">#   `name` is R&#39;s name for the inverse cumulative density function</span></span>
<span id="cb405-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-5"></a>  <span class="co">#   of the distribution.</span></span>
<span id="cb405-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-6"></a>  <span class="co">#   `width` is the desired mass of the HDI region.</span></span>
<span id="cb405-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-7"></a>  <span class="co">#   `tol` is passed to R&#39;s optimize function.</span></span>
<span id="cb405-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-8"></a>  <span class="co"># Return value:</span></span>
<span id="cb405-9"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-9"></a>  <span class="co">#   Highest density iterval (HDI) limits in a vector.</span></span>
<span id="cb405-10"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-10"></a>  <span class="co"># Example of use: For determining HDI of a beta(30, 12) distribution, type</span></span>
<span id="cb405-11"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-11"></a>  <span class="co">#   `hdi_of_icdf(qbeta, shape1 = 30, shape2 = 12)`</span></span>
<span id="cb405-12"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-12"></a>  <span class="co">#   Notice that the parameters of the `name` must be explicitly stated;</span></span>
<span id="cb405-13"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-13"></a>  <span class="co">#   e.g., `hdi_of_icdf(qbeta, 30, 12)` does not work.</span></span>
<span id="cb405-14"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-14"></a>  <span class="co"># Adapted and corrected from Greg Snow&#39;s TeachingDemos package.</span></span>
<span id="cb405-15"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-15"></a>  </span>
<span id="cb405-16"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-16"></a>  incredible_mass &lt;-<span class="st"> </span><span class="fl">1.0</span> <span class="op">-</span><span class="st"> </span>width</span>
<span id="cb405-17"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-17"></a>  interval_width &lt;-<span class="st"> </span><span class="cf">function</span>(low_tail_prob, name, width, ...) {</span>
<span id="cb405-18"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-18"></a>    <span class="kw">name</span>(width <span class="op">+</span><span class="st"> </span>low_tail_prob, ...) <span class="op">-</span><span class="st"> </span><span class="kw">name</span>(low_tail_prob, ...)</span>
<span id="cb405-19"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-19"></a>  }</span>
<span id="cb405-20"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-20"></a>  </span>
<span id="cb405-21"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-21"></a>  opt_info &lt;-<span class="st"> </span><span class="kw">optimize</span>(interval_width, <span class="kw">c</span>(<span class="dv">0</span>, incredible_mass), </span>
<span id="cb405-22"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-22"></a>                       <span class="dt">name =</span> name, <span class="dt">width =</span> width, </span>
<span id="cb405-23"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-23"></a>                       <span class="dt">tol =</span> tol, ...)</span>
<span id="cb405-24"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-24"></a>  </span>
<span id="cb405-25"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-25"></a>  hdi_lower_tail_prob &lt;-<span class="st"> </span>opt_info<span class="op">$</span>minimum</span>
<span id="cb405-26"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-26"></a>  </span>
<span id="cb405-27"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-27"></a>  <span class="kw">return</span>(<span class="kw">c</span>(<span class="kw">name</span>(hdi_lower_tail_prob, ...),</span>
<span id="cb405-28"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-28"></a>           <span class="kw">name</span>(width <span class="op">+</span><span class="st"> </span>hdi_lower_tail_prob, ...)))</span>
<span id="cb405-29"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-29"></a>  </span>
<span id="cb405-30"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb405-30"></a>}</span></code></pre></div>
<p>Recall it’s based off of the <code>HDIofICDF()</code> function from Kruschke’s <code>DBDA2E-utilities.R</code> file. I’ve altered Kruschke’s formatting a little bit, but the guts of the code are unchanged. Our <code>hdi_of_icdf()</code> function will take the <code>name</code> of an “inverse cumulative density function” and its parameters and then return an HDI range, as defined by the <code>width</code> parameter. Since the prior at the top of Figure 6.3 is <span class="math inline">\(\operatorname{beta}(5, 5)\)</span>, we can use <code>hdi_of_icdf()</code> to calculate the HDI like so.</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb406-1"></a><span class="kw">hdi_of_icdf</span>(<span class="dt">name =</span> qbeta,</span>
<span id="cb406-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb406-2"></a>            <span class="dt">shape1 =</span> <span class="dv">5</span>,</span>
<span id="cb406-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb406-3"></a>            <span class="dt">shape2 =</span> <span class="dv">5</span>,</span>
<span id="cb406-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb406-4"></a>            <span class="dt">width  =</span> <span class="fl">.95</span>)</span></code></pre></div>
<pre><code>## [1] 0.2120085 0.7879915</code></pre>
<p>Here they are for the posterior distribution at the bottom of the figure.</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb408-1"></a><span class="kw">hdi_of_icdf</span>(<span class="dt">name =</span> qbeta,</span>
<span id="cb408-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb408-2"></a>            <span class="dt">shape1 =</span> <span class="dv">6</span>,</span>
<span id="cb408-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb408-3"></a>            <span class="dt">shape2 =</span> <span class="dv">14</span>)</span></code></pre></div>
<pre><code>## [1] 0.1142339 0.4967144</code></pre>
<p>Note that since we set <code>width  = .95</code> as the default, we can leave it out if we want to stick with the conventional 95% intervals.</p>
<p>Here are the mean calculations from the last paragraph on page 134.</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb410-1"></a>n &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb410-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb410-2"></a>z &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb410-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb410-3"></a>a &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb410-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb410-4"></a>b &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb410-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb410-5"></a></span>
<span id="cb410-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb410-6"></a>(proportion_heads &lt;-<span class="st"> </span>z <span class="op">/</span><span class="st"> </span>n)</span></code></pre></div>
<pre><code>## [1] 0.1</code></pre>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb412-1"></a>(prior_mean &lt;-<span class="st"> </span>a <span class="op">/</span><span class="st"> </span>(a <span class="op">+</span><span class="st"> </span>b))</span></code></pre></div>
<pre><code>## [1] 0.5</code></pre>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb414-1"></a>(posterior_mean &lt;-<span class="st"> </span>(z <span class="op">+</span><span class="st"> </span>a) <span class="op">/</span><span class="st"> </span>(n <span class="op">+</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>b))</span></code></pre></div>
<pre><code>## [1] 0.3</code></pre>
<p>In order to make the plots for Figure 6.3, we’ll want to compute the prior, likelihood, and posterior density values across a densely-packed range of <span class="math inline">\(\theta\)</span> values.</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb416-1"></a>trial_data &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">9</span>), <span class="dv">1</span>)</span>
<span id="cb416-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb416-2"></a></span>
<span id="cb416-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb416-3"></a>d &lt;-</span>
<span id="cb416-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb416-4"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">theta =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">100</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb416-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb416-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Prior (beta)</span><span class="st">`</span>           =<span class="st"> </span><span class="kw">dbeta</span>(theta, </span>
<span id="cb416-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb416-6"></a>                                          <span class="dt">shape1 =</span> a, </span>
<span id="cb416-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb416-7"></a>                                          <span class="dt">shape2 =</span> b),</span>
<span id="cb416-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb416-8"></a>         <span class="st">`</span><span class="dt">Likelihood (Bernoulli)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">bernoulli_likelihood</span>(<span class="dt">theta =</span> theta, </span>
<span id="cb416-9"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb416-9"></a>                                                         <span class="dt">data  =</span> trial_data),</span>
<span id="cb416-10"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb416-10"></a>         <span class="st">`</span><span class="dt">Posterior (beta)</span><span class="st">`</span>       =<span class="st"> </span><span class="kw">dbeta</span>(theta, </span>
<span id="cb416-11"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb416-11"></a>                                          <span class="dt">shape1 =</span> <span class="dv">6</span>, </span>
<span id="cb416-12"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb416-12"></a>                                          <span class="dt">shape2 =</span> <span class="dv">14</span>))</span>
<span id="cb416-13"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb416-13"></a></span>
<span id="cb416-14"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb416-14"></a><span class="kw">glimpse</span>(d)</span></code></pre></div>
<pre><code>## Rows: 100
## Columns: 4
## $ theta                    &lt;dbl&gt; 0.00000000, 0.01010101, 0.02020202, 0.030303…
## $ `Prior (beta)`           &lt;dbl&gt; 0.000000e+00, 6.297429e-06, 9.670878e-05, 4.…
## $ `Likelihood (Bernoulli)` &lt;dbl&gt; 0.000000000, 0.009218977, 0.016812166, 0.022…
## $ `Posterior (beta)`       &lt;dbl&gt; 0.000000e+00, 1.500163e-05, 4.201284e-04, 2.…</code></pre>
<p>To make things easier on ourselves, we’ll also make two additional data objects to annotate the plots with lines and text.</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb418-1"></a><span class="co"># the data for the in-plot lines</span></span>
<span id="cb418-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb418-2"></a>line &lt;-</span>
<span id="cb418-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb418-3"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">theta      =</span> <span class="kw">c</span>(.<span class="dv">212</span> <span class="op">+</span><span class="st"> </span><span class="fl">.008</span>, <span class="fl">.788</span> <span class="op">-</span><span class="st"> </span><span class="fl">.008</span>, <span class="fl">.114</span> <span class="op">+</span><span class="st"> </span><span class="fl">.004</span>, <span class="fl">.497</span> <span class="op">-</span><span class="st"> </span><span class="fl">.005</span>),</span>
<span id="cb418-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb418-4"></a>         <span class="dt">value      =</span> <span class="kw">rep</span>(<span class="kw">c</span>(.<span class="dv">51</span>, <span class="fl">.66</span>), <span class="dt">each =</span> <span class="dv">2</span>),</span>
<span id="cb418-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb418-5"></a>         <span class="dt">xintercept =</span> <span class="kw">c</span>(.<span class="dv">212</span>, <span class="fl">.788</span>, <span class="fl">.114</span>, <span class="fl">.497</span>),</span>
<span id="cb418-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb418-6"></a>         <span class="dt">key        =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Prior (beta)&quot;</span>, <span class="st">&quot;Posterior (beta)&quot;</span>), <span class="dt">each =</span> <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb418-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb418-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">key =</span> <span class="kw">factor</span>(key, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Prior (beta)&quot;</span>, <span class="st">&quot;Likelihood (Bernoulli)&quot;</span>, <span class="st">&quot;Posterior (beta)&quot;</span>)))</span>
<span id="cb418-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb418-8"></a>  </span>
<span id="cb418-9"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb418-9"></a><span class="co"># the data for the annotation</span></span>
<span id="cb418-10"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb418-10"></a>text &lt;-</span>
<span id="cb418-11"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb418-11"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">theta =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.3</span>),</span>
<span id="cb418-12"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb418-12"></a>         <span class="dt">value =</span> <span class="kw">c</span>(.<span class="dv">8</span>, <span class="fl">1.125</span>),</span>
<span id="cb418-13"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb418-13"></a>         <span class="dt">label =</span> <span class="st">&quot;95% HDI&quot;</span>,</span>
<span id="cb418-14"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb418-14"></a>         <span class="dt">key   =</span> <span class="kw">c</span>(<span class="st">&quot;Prior (beta)&quot;</span>, <span class="st">&quot;Posterior (beta)&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb418-15"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb418-15"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">key =</span> <span class="kw">factor</span>(key, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Prior (beta)&quot;</span>, <span class="st">&quot;Likelihood (Bernoulli)&quot;</span>, <span class="st">&quot;Posterior (beta)&quot;</span>)))</span></code></pre></div>
<p>Finally, here’s our Figure 6.3.</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-1"></a><span class="kw">library</span>(cowplot)</span>
<span id="cb419-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-2"></a></span>
<span id="cb419-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-3"></a>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb419-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-4"></a><span class="st">  </span><span class="kw">gather</span>(key, value, <span class="op">-</span>theta) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb419-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">key =</span> <span class="kw">factor</span>(key, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Prior (beta)&quot;</span>, <span class="st">&quot;Likelihood (Bernoulli)&quot;</span>, <span class="st">&quot;Posterior (beta)&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb419-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-6"></a><span class="st">  </span></span>
<span id="cb419-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-7"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">y =</span> value, )) <span class="op">+</span></span>
<span id="cb419-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-8"></a><span class="st">  </span><span class="co"># densities</span></span>
<span id="cb419-9"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-9"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> value),</span>
<span id="cb419-10"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-10"></a>              <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="op">+</span></span>
<span id="cb419-11"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-11"></a><span class="st">  </span><span class="co"># dashed vertical lines</span></span>
<span id="cb419-12"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-12"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">data =</span> line,</span>
<span id="cb419-13"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-13"></a>             <span class="kw">aes</span>(<span class="dt">xintercept =</span> xintercept), </span>
<span id="cb419-14"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-14"></a>             <span class="dt">linetype =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb419-15"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-15"></a><span class="st">  </span><span class="co"># arrows</span></span>
<span id="cb419-16"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-16"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> line,</span>
<span id="cb419-17"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-17"></a>            <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(.<span class="dv">15</span>,<span class="st">&quot;cm&quot;</span>), </span>
<span id="cb419-18"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-18"></a>                          <span class="dt">ends =</span> <span class="st">&quot;both&quot;</span>, </span>
<span id="cb419-19"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-19"></a>                          <span class="dt">type =</span> <span class="st">&quot;closed&quot;</span>),</span>
<span id="cb419-20"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-20"></a>            <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb419-21"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-21"></a><span class="st">  </span><span class="co"># text</span></span>
<span id="cb419-22"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-22"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> text,</span>
<span id="cb419-23"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-23"></a>            <span class="kw">aes</span>(<span class="dt">label =</span> label),</span>
<span id="cb419-24"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-24"></a>            <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb419-25"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-25"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(theta),</span>
<span id="cb419-26"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-26"></a>       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb419-27"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-27"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="dt">ncol =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb419-28"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb419-28"></a><span class="st">  </span><span class="kw">theme_cowplot</span>()</span></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-19-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Note how we loaded the <a href="https://wilkelab.org/cowplot"><strong>cowplot</strong> package</a>. We played around a bit with plotting conventions in the previous chapters. From this chapter onward we’ll explore plotting conventions in a more deliberate fashion. One quick way to alter the look and feel of a plot is by altering its theme. The <strong>cowplot</strong> package includes several theme options. In this chapter, we’ll focus on making simple and conventional looking plots with the <code>theme_cowplot()</code> function.</p>
</div>
</div>
<div id="examples" class="section level2">
<h2><span class="header-section-number">6.4</span> Examples</h2>
<div id="prior-knowledge-expressed-as-a-beta-distribution." class="section level3">
<h3><span class="header-section-number">6.4.1</span> Prior knowledge expressed as a beta distribution.</h3>
<p>If you flip an unaltered freshly-minted coin 20 times and end up with 17 heads, 85% of those trials are heads.</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb420-1"></a> <span class="dv">100</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">17</span> <span class="op">/</span><span class="st"> </span><span class="dv">20</span>)</span></code></pre></div>
<pre><code>## [1] 85</code></pre>
<p>In the first paragraph of this section, Kruschke suggested we consider a beta prior with a mode of <span class="math inline">\(\omega = .5\)</span> and an effective sample size <span class="math inline">\(\kappa = 500\)</span>. We might use Kruschke’s <code>betaABfromModeKappa()</code> function to use those values to compute the corresponding <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> parameters for the beta distribution.</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb422-1"></a><span class="kw">betaABfromModeKappa</span>(<span class="dt">mode =</span> <span class="fl">.5</span>, <span class="dt">kappa =</span> <span class="dv">500</span>)</span></code></pre></div>
<pre><code>## $a
## [1] 250
## 
## $b
## [1] 250</code></pre>
<p>Confusingly, Kruschke switched from <span class="math inline">\(\operatorname{beta(250, 250)}\)</span> in the prose to <span class="math inline">\(\operatorname{beta(100, 100)}\)</span> in Figure 6.4.a, which he acknowledged in his <a href="https://sites.google.com/site/doingbayesiandataanalysis/corrigenda">Corrigenda</a>. We’ll stick with <span class="math inline">\(\operatorname{beta(100, 100)}\)</span>, which corresponds to <span class="math inline">\(\omega = .5\)</span> and <span class="math inline">\(\kappa = 200\)</span>.</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb424-1"></a><span class="kw">betaABfromModeKappa</span>(<span class="dt">mode =</span> <span class="fl">.5</span>, <span class="dt">kappa =</span> <span class="dv">200</span>)</span></code></pre></div>
<pre><code>## $a
## [1] 100
## 
## $b
## [1] 100</code></pre>
<p>Here’s how to use those values and some of the equations from above to make the data necessary for the left column of Figure 6.4.</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-1"></a><span class="co"># define the prior</span></span>
<span id="cb426-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-2"></a>beta_param &lt;-<span class="st"> </span><span class="kw">betaABfromModeKappa</span>(<span class="dt">mode =</span> <span class="fl">.5</span>, <span class="dt">kappa =</span> <span class="dv">200</span>)</span>
<span id="cb426-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-3"></a></span>
<span id="cb426-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-4"></a><span class="co"># compute the corresponding HDIs</span></span>
<span id="cb426-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-5"></a>prior_hdi &lt;-</span>
<span id="cb426-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-6"></a><span class="st">  </span><span class="kw">hdi_of_icdf</span>(<span class="dt">name =</span> qbeta,</span>
<span id="cb426-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-7"></a>              <span class="dt">shape1 =</span> beta_param<span class="op">$</span>a,</span>
<span id="cb426-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-8"></a>              <span class="dt">shape2 =</span> beta_param<span class="op">$</span>b,</span>
<span id="cb426-9"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-9"></a>              <span class="dt">width =</span> <span class="fl">.95</span>)</span>
<span id="cb426-10"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-10"></a></span>
<span id="cb426-11"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-11"></a><span class="co"># define the data</span></span>
<span id="cb426-12"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-12"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb426-13"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-13"></a>z &lt;-<span class="st"> </span><span class="dv">17</span></span>
<span id="cb426-14"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-14"></a></span>
<span id="cb426-15"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-15"></a>trial_data &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dt">times =</span> n <span class="op">-</span><span class="st"> </span>z), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dt">times =</span> z))</span>
<span id="cb426-16"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-16"></a></span>
<span id="cb426-17"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-17"></a><span class="co"># compute the HDIs for the posterior</span></span>
<span id="cb426-18"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-18"></a>post_hdi &lt;-</span>
<span id="cb426-19"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-19"></a><span class="st">  </span><span class="kw">hdi_of_icdf</span>(<span class="dt">name =</span> qbeta,</span>
<span id="cb426-20"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-20"></a>              <span class="dt">shape1 =</span> z <span class="op">+</span><span class="st"> </span>beta_param<span class="op">$</span>a,</span>
<span id="cb426-21"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-21"></a>              <span class="dt">shape2 =</span> n <span class="op">-</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>beta_param<span class="op">$</span>b,</span>
<span id="cb426-22"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-22"></a>              <span class="dt">width =</span> <span class="fl">.95</span>)</span>
<span id="cb426-23"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-23"></a></span>
<span id="cb426-24"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-24"></a><span class="co"># use the above to compute the prior, the likelihood, and the posterior</span></span>
<span id="cb426-25"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-25"></a><span class="co"># densities using the grid approximation approach</span></span>
<span id="cb426-26"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-26"></a>d &lt;-</span>
<span id="cb426-27"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-27"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">theta =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="fl">1e3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb426-28"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-28"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prior      =</span> <span class="kw">dbeta</span>(theta, </span>
<span id="cb426-29"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-29"></a>                            <span class="dt">shape1 =</span> beta_param<span class="op">$</span>a, </span>
<span id="cb426-30"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-30"></a>                            <span class="dt">shape2 =</span> beta_param<span class="op">$</span>b),</span>
<span id="cb426-31"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-31"></a>         <span class="dt">likelihood =</span> <span class="kw">bernoulli_likelihood</span>(<span class="dt">theta =</span> theta, </span>
<span id="cb426-32"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-32"></a>                                           <span class="dt">data  =</span> trial_data),</span>
<span id="cb426-33"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-33"></a>         <span class="dt">posterior  =</span> <span class="kw">dbeta</span>(theta, </span>
<span id="cb426-34"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-34"></a>                            <span class="dt">shape1 =</span> z <span class="op">+</span><span class="st"> </span>beta_param<span class="op">$</span>a, </span>
<span id="cb426-35"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-35"></a>                            <span class="dt">shape2 =</span> n <span class="op">-</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>beta_param<span class="op">$</span>b))</span>
<span id="cb426-36"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-36"></a></span>
<span id="cb426-37"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-37"></a><span class="co"># what have we done?</span></span>
<span id="cb426-38"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb426-38"></a><span class="kw">glimpse</span>(d)</span></code></pre></div>
<pre><code>## Rows: 1,000
## Columns: 4
## $ theta      &lt;dbl&gt; 0.000000000, 0.001001001, 0.002002002, 0.003003003, 0.0040…
## $ prior      &lt;dbl&gt; 0.000000e+00, 4.526977e-237, 2.598214e-207, 6.376221e-190,…
## $ likelihood &lt;dbl&gt; 0.000000e+00, 1.014103e-51, 1.325213e-46, 1.301756e-43, 1.…
## $ posterior  &lt;dbl&gt; 0.000000e+00, 3.226730e-282, 2.420099e-247, 5.833988e-227,…</code></pre>
<p>We’re finally ready to plot the prior, the likelihood, and the posterior for the left column of Figure 6.4.</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb428-1"></a><span class="co">## Figure 6.4, left column</span></span>
<span id="cb428-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb428-2"></a><span class="co"># prior</span></span>
<span id="cb428-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb428-3"></a>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb428-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb428-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> prior)) <span class="op">+</span></span>
<span id="cb428-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb428-5"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb428-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb428-6"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> . <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(theta <span class="op">&gt;</span><span class="st"> </span>prior_hdi[<span class="dv">1</span>] <span class="op">&amp;</span><span class="st"> </span>theta <span class="op">&lt;</span><span class="st"> </span>prior_hdi[<span class="dv">2</span>]),</span>
<span id="cb428-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb428-7"></a>              <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="op">+</span></span>
<span id="cb428-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb428-8"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">x =</span> prior_hdi[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="fl">.005</span>, <span class="dt">xend =</span> prior_hdi[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span><span class="fl">.005</span>,</span>
<span id="cb428-9"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb428-9"></a>               <span class="dt">y =</span> <span class="fl">1.8</span>, <span class="dt">yend =</span> <span class="fl">1.8</span>,</span>
<span id="cb428-10"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb428-10"></a>               <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(.<span class="dv">15</span>,<span class="st">&quot;cm&quot;</span>), </span>
<span id="cb428-11"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb428-11"></a>                             <span class="dt">ends =</span> <span class="st">&quot;both&quot;</span>, </span>
<span id="cb428-12"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb428-12"></a>                             <span class="dt">type =</span> <span class="st">&quot;closed&quot;</span>),</span>
<span id="cb428-13"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb428-13"></a>               <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb428-14"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb428-14"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">.5</span>, <span class="dt">y =</span> <span class="fl">3.5</span>, </span>
<span id="cb428-15"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb428-15"></a>           <span class="dt">label =</span> <span class="st">&quot;95% HDI&quot;</span>) <span class="op">+</span></span>
<span id="cb428-16"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb428-16"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Prior (beta)&quot;</span>,</span>
<span id="cb428-17"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb428-17"></a>       <span class="dt">x =</span> <span class="kw">expression</span>(theta),</span>
<span id="cb428-18"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb428-18"></a>       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">dbeta</span>(theta<span class="op">*</span><span class="st">&quot;|&quot;</span><span class="op">*</span><span class="dv">100</span><span class="op">*</span><span class="st">&quot;, &quot;</span><span class="op">*</span><span class="dv">100</span>))) <span class="op">+</span></span>
<span id="cb428-19"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb428-19"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">12</span>)) <span class="op">+</span></span>
<span id="cb428-20"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb428-20"></a><span class="st">  </span><span class="kw">theme_cowplot</span>()</span></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-24-1.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb429-1"></a><span class="co"># likelihood</span></span>
<span id="cb429-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb429-2"></a>d <span class="op">%&gt;%</span><span class="st">   </span></span>
<span id="cb429-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb429-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> likelihood)) <span class="op">+</span></span>
<span id="cb429-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb429-4"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">size =</span> <span class="dv">0</span>, <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="op">+</span></span>
<span id="cb429-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb429-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Likelihood (Bernoulli)&quot;</span>,</span>
<span id="cb429-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb429-6"></a>       <span class="dt">x =</span> <span class="kw">expression</span>(theta),</span>
<span id="cb429-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb429-7"></a>       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">p</span>(D<span class="op">*</span><span class="st">&quot;|&quot;</span><span class="op">*</span>theta))) <span class="op">+</span></span>
<span id="cb429-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb429-8"></a><span class="st">  </span><span class="kw">theme_cowplot</span>()</span></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-24-2.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb430-1"></a><span class="co"># posterior</span></span>
<span id="cb430-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb430-2"></a>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb430-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb430-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> posterior)) <span class="op">+</span></span>
<span id="cb430-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb430-4"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb430-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb430-5"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> . <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(theta <span class="op">&gt;</span><span class="st"> </span>post_hdi[<span class="dv">1</span>] <span class="op">&amp;</span><span class="st"> </span>theta <span class="op">&lt;</span><span class="st"> </span>post_hdi[<span class="dv">2</span>]),</span>
<span id="cb430-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb430-6"></a>              <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="op">+</span></span>
<span id="cb430-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb430-7"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">x =</span> post_hdi[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="fl">.005</span>, <span class="dt">xend =</span> post_hdi[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span><span class="fl">.005</span>,</span>
<span id="cb430-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb430-8"></a>               <span class="dt">y =</span> <span class="dv">2</span>, <span class="dt">yend =</span> <span class="dv">2</span>,</span>
<span id="cb430-9"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb430-9"></a>               <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(.<span class="dv">15</span>, <span class="st">&quot;cm&quot;</span>), </span>
<span id="cb430-10"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb430-10"></a>                             <span class="dt">ends =</span> <span class="st">&quot;both&quot;</span>, </span>
<span id="cb430-11"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb430-11"></a>                             <span class="dt">type =</span> <span class="st">&quot;closed&quot;</span>),</span>
<span id="cb430-12"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb430-12"></a>               <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb430-13"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb430-13"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">.532</span>, <span class="dt">y =</span> <span class="fl">3.5</span>, </span>
<span id="cb430-14"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb430-14"></a>           <span class="dt">label =</span> <span class="st">&quot;95% HDI&quot;</span>) <span class="op">+</span></span>
<span id="cb430-15"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb430-15"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Posterior (beta)&quot;</span>,</span>
<span id="cb430-16"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb430-16"></a>       <span class="dt">x =</span> <span class="kw">expression</span>(theta),</span>
<span id="cb430-17"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb430-17"></a>       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">dbeta</span>(theta<span class="op">*</span><span class="st">&quot;|&quot;</span><span class="op">*</span><span class="dv">117</span><span class="op">*</span><span class="st">&quot;, &quot;</span><span class="op">*</span><span class="dv">103</span>))) <span class="op">+</span></span>
<span id="cb430-18"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb430-18"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">12</span>)) <span class="op">+</span></span>
<span id="cb430-19"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb430-19"></a><span class="st">  </span><span class="kw">theme_cowplot</span>()</span></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-24-3.png" width="480" style="display: block; margin: auto;" />
Here are the exact HDI values for the prior and posterior densities.</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb431-1"></a>prior_hdi</span></code></pre></div>
<pre><code>## [1] 0.4309509 0.5690491</code></pre>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb433-1"></a>post_hdi</span></code></pre></div>
<pre><code>## [1] 0.4660154 0.5974595</code></pre>
<p>If you double back to page 129 in the text, you’ll see Kruschke defined the mode of a beta density as</p>
<p><span class="math display">\[\omega_\text{beta} = (a - 1) / (a + b - 2)\]</span></p>
<p>whenever <span class="math inline">\(a &gt; 1\)</span> and <span class="math inline">\(b &gt; 1\)</span>. Thus we can compute the modes for our prior and posterior densities like this.</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb435-1"></a>(beta_param<span class="op">$</span>a <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span>(beta_param<span class="op">$</span>a <span class="op">+</span><span class="st"> </span>beta_param<span class="op">$</span>b <span class="op">-</span><span class="st"> </span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.5</code></pre>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb437-1"></a>(z <span class="op">+</span><span class="st"> </span>beta_param<span class="op">$</span>a <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span>(z <span class="op">+</span><span class="st"> </span>beta_param<span class="op">$</span>a <span class="op">+</span><span class="st"> </span>n <span class="op">-</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>beta_param<span class="op">$</span>b <span class="op">-</span><span class="st"> </span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.5321101</code></pre>
<p>For the next example, we consider the probability a professional basketball player will make free a throw. We have the same likelihood based on 17 successes our of 20 trials, but this time our prior is based on <span class="math inline">\(\omega = .75\)</span> and <span class="math inline">\(\kappa = 25\)</span>. Here we update those values and our <code>d</code> data for the plot.</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb439-1"></a><span class="co"># update the beta parameters for the prior</span></span>
<span id="cb439-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb439-2"></a>beta_param<span class="op">$</span>a &lt;-<span class="st"> </span><span class="fl">18.25</span></span>
<span id="cb439-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb439-3"></a>beta_param<span class="op">$</span>b &lt;-<span class="st"> </span><span class="fl">6.75</span></span>
<span id="cb439-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb439-4"></a></span>
<span id="cb439-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb439-5"></a><span class="co"># update the HDIs</span></span>
<span id="cb439-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb439-6"></a>prior_hdi &lt;-</span>
<span id="cb439-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb439-7"></a><span class="st">  </span><span class="kw">hdi_of_icdf</span>(<span class="dt">name =</span> qbeta,</span>
<span id="cb439-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb439-8"></a>              <span class="dt">shape1 =</span> beta_param<span class="op">$</span>a,</span>
<span id="cb439-9"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb439-9"></a>              <span class="dt">shape2 =</span> beta_param<span class="op">$</span>b,</span>
<span id="cb439-10"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb439-10"></a>              <span class="dt">width =</span> <span class="fl">.95</span>)</span>
<span id="cb439-11"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb439-11"></a></span>
<span id="cb439-12"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb439-12"></a>post_hdi &lt;-</span>
<span id="cb439-13"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb439-13"></a><span class="st">  </span><span class="kw">hdi_of_icdf</span>(<span class="dt">name =</span> qbeta,</span>
<span id="cb439-14"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb439-14"></a>              <span class="dt">shape1 =</span> z <span class="op">+</span><span class="st"> </span>beta_param<span class="op">$</span>a,</span>
<span id="cb439-15"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb439-15"></a>              <span class="dt">shape2 =</span> n <span class="op">-</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>beta_param<span class="op">$</span>b,</span>
<span id="cb439-16"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb439-16"></a>              <span class="dt">width =</span> <span class="fl">.95</span>)</span>
<span id="cb439-17"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb439-17"></a></span>
<span id="cb439-18"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb439-18"></a><span class="co"># update the data</span></span>
<span id="cb439-19"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb439-19"></a>d &lt;-</span>
<span id="cb439-20"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb439-20"></a><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb439-21"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb439-21"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prior     =</span> <span class="kw">dbeta</span>(theta, </span>
<span id="cb439-22"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb439-22"></a>                           <span class="dt">shape1 =</span> beta_param<span class="op">$</span>a, </span>
<span id="cb439-23"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb439-23"></a>                           <span class="dt">shape2 =</span> beta_param<span class="op">$</span>b),</span>
<span id="cb439-24"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb439-24"></a>         <span class="dt">posterior =</span> <span class="kw">dbeta</span>(theta, </span>
<span id="cb439-25"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb439-25"></a>                           <span class="dt">shape1 =</span> z <span class="op">+</span><span class="st"> </span>beta_param<span class="op">$</span>a, </span>
<span id="cb439-26"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb439-26"></a>                           <span class="dt">shape2 =</span> n <span class="op">-</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>beta_param<span class="op">$</span>b))</span></code></pre></div>
<p>With our updated values in hand, we’re ready to make our versions of the middle column of Figure 6.4.</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb440-1"></a><span class="co">## plot Figure 6.4, middle column!</span></span>
<span id="cb440-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb440-2"></a><span class="co"># prior</span></span>
<span id="cb440-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb440-3"></a>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb440-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb440-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> prior)) <span class="op">+</span></span>
<span id="cb440-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb440-5"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb440-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb440-6"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> . <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(theta <span class="op">&gt;</span><span class="st"> </span>prior_hdi[<span class="dv">1</span>] <span class="op">&amp;</span><span class="st"> </span>theta <span class="op">&lt;</span><span class="st"> </span>prior_hdi[<span class="dv">2</span>]),</span>
<span id="cb440-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb440-7"></a>              <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="op">+</span></span>
<span id="cb440-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb440-8"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">x =</span> prior_hdi[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="fl">.005</span>, <span class="dt">xend =</span> prior_hdi[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span><span class="fl">.005</span>,</span>
<span id="cb440-9"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb440-9"></a>               <span class="dt">y =</span> <span class="fl">0.75</span>, <span class="dt">yend =</span> <span class="fl">0.75</span>,</span>
<span id="cb440-10"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb440-10"></a>               <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(.<span class="dv">15</span>,<span class="st">&quot;cm&quot;</span>), </span>
<span id="cb440-11"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb440-11"></a>                             <span class="dt">ends =</span> <span class="st">&quot;both&quot;</span>, </span>
<span id="cb440-12"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb440-12"></a>                             <span class="dt">type =</span> <span class="st">&quot;closed&quot;</span>),</span>
<span id="cb440-13"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb440-13"></a>               <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb440-14"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb440-14"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">.75</span>, <span class="dt">y =</span> <span class="fl">1.5</span>, </span>
<span id="cb440-15"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb440-15"></a>           <span class="dt">label =</span> <span class="st">&quot;95% HDI&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb440-16"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb440-16"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Prior (beta)&quot;</span>,</span>
<span id="cb440-17"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb440-17"></a>       <span class="dt">x =</span> <span class="kw">expression</span>(theta),</span>
<span id="cb440-18"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb440-18"></a>       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">dbeta</span>(theta<span class="op">*</span><span class="st">&quot;|&quot;</span><span class="op">*</span><span class="fl">18.25</span><span class="op">*</span><span class="st">&quot;, &quot;</span><span class="op">*</span><span class="fl">6.75</span>))) <span class="op">+</span></span>
<span id="cb440-19"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb440-19"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">7</span>)) <span class="op">+</span></span>
<span id="cb440-20"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb440-20"></a><span class="st">  </span><span class="kw">theme_cowplot</span>()</span></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-28-1.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb441-1"></a><span class="co"># likelihood, which is the same as the last time</span></span>
<span id="cb441-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb441-2"></a>d <span class="op">%&gt;%</span><span class="st">   </span></span>
<span id="cb441-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb441-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> likelihood)) <span class="op">+</span></span>
<span id="cb441-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb441-4"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">size =</span> <span class="dv">0</span>, <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="op">+</span></span>
<span id="cb441-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb441-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Likelihood (Bernoulli)&quot;</span>,</span>
<span id="cb441-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb441-6"></a>       <span class="dt">x =</span> <span class="kw">expression</span>(theta),</span>
<span id="cb441-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb441-7"></a>       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">p</span>(D<span class="op">*</span><span class="st">&quot;|&quot;</span><span class="op">*</span>theta))) <span class="op">+</span></span>
<span id="cb441-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb441-8"></a><span class="st">  </span><span class="kw">theme_cowplot</span>()</span></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-28-2.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb442-1"></a><span class="co"># posterior</span></span>
<span id="cb442-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb442-2"></a>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb442-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb442-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> posterior)) <span class="op">+</span></span>
<span id="cb442-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb442-4"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb442-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb442-5"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> . <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(theta <span class="op">&gt;</span><span class="st"> </span>post_hdi[<span class="dv">1</span>] <span class="op">&amp;</span><span class="st"> </span>theta <span class="op">&lt;</span><span class="st"> </span>post_hdi[<span class="dv">2</span>]),</span>
<span id="cb442-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb442-6"></a>              <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="op">+</span></span>
<span id="cb442-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb442-7"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">x =</span> post_hdi[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="fl">.005</span>, <span class="dt">xend =</span> post_hdi[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span><span class="fl">.005</span>,</span>
<span id="cb442-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb442-8"></a>               <span class="dt">y =</span> <span class="dv">1</span>, <span class="dt">yend =</span> <span class="dv">1</span>,</span>
<span id="cb442-9"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb442-9"></a>               <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(.<span class="dv">15</span>, <span class="st">&quot;cm&quot;</span>), </span>
<span id="cb442-10"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb442-10"></a>                             <span class="dt">ends =</span> <span class="st">&quot;both&quot;</span>, </span>
<span id="cb442-11"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb442-11"></a>                             <span class="dt">type =</span> <span class="st">&quot;closed&quot;</span>),</span>
<span id="cb442-12"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb442-12"></a>               <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb442-13"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb442-13"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">.797</span>, <span class="dt">y =</span> <span class="dv">2</span>, </span>
<span id="cb442-14"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb442-14"></a>           <span class="dt">label =</span> <span class="st">&quot;95% HDI&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb442-15"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb442-15"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Posterior (beta)&quot;</span>,</span>
<span id="cb442-16"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb442-16"></a>       <span class="dt">x =</span> <span class="kw">expression</span>(theta),</span>
<span id="cb442-17"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb442-17"></a>       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">dbeta</span>(theta<span class="op">*</span><span class="st">&quot;|&quot;</span><span class="op">*</span><span class="fl">35.25</span><span class="op">*</span><span class="st">&quot;, &quot;</span><span class="op">*</span><span class="fl">9.75</span>))) <span class="op">+</span></span>
<span id="cb442-18"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb442-18"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">7</span>)) <span class="op">+</span></span>
<span id="cb442-19"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb442-19"></a><span class="st">  </span><span class="kw">theme_cowplot</span>()</span></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-28-3.png" width="480" style="display: block; margin: auto;" /></p>
<p>Here are the exact HDI values for the prior and posterior densities.</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb443-1"></a>prior_hdi</span></code></pre></div>
<pre><code>## [1] 0.5581935 0.8915815</code></pre>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb445-1"></a>post_hdi</span></code></pre></div>
<pre><code>## [1] 0.6629078 0.8966491</code></pre>
<p>Here are the the modes for our prior and posterior densities.</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb447-1"></a>(beta_param<span class="op">$</span>a <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span>(beta_param<span class="op">$</span>a <span class="op">+</span><span class="st"> </span>beta_param<span class="op">$</span>b <span class="op">-</span><span class="st"> </span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.75</code></pre>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb449-1"></a>(z <span class="op">+</span><span class="st"> </span>beta_param<span class="op">$</span>a <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span>(z <span class="op">+</span><span class="st"> </span>beta_param<span class="op">$</span>a <span class="op">+</span><span class="st"> </span>n <span class="op">-</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>beta_param<span class="op">$</span>b <span class="op">-</span><span class="st"> </span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.7965116</code></pre>
<p>For our final example, we consider the tendency of a newly discovered substance on a distant planet to be blue versus green. Just as in the previous two examples, we discover 17 out of 20 trials come up positive (i.e., blue). This time we have a noncommittal uniform prior, <span class="math inline">\(\operatorname{beta}(1, 1)\)</span>. Here’s how to plot the results, as shown in the right column of Figure 6.4.</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-1"></a><span class="co"># update beta_param</span></span>
<span id="cb451-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-2"></a>beta_param<span class="op">$</span>a &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb451-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-3"></a>beta_param<span class="op">$</span>b &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb451-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-4"></a></span>
<span id="cb451-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-5"></a><span class="co"># update the HDIs</span></span>
<span id="cb451-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-6"></a>prior_hdi &lt;-</span>
<span id="cb451-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-7"></a><span class="st">  </span><span class="kw">hdi_of_icdf</span>(<span class="dt">name =</span> qbeta,</span>
<span id="cb451-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-8"></a>              <span class="dt">shape1 =</span> beta_param<span class="op">$</span>a,</span>
<span id="cb451-9"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-9"></a>              <span class="dt">shape2 =</span> beta_param<span class="op">$</span>b,</span>
<span id="cb451-10"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-10"></a>              <span class="dt">width =</span> <span class="fl">.95</span>)</span>
<span id="cb451-11"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-11"></a></span>
<span id="cb451-12"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-12"></a>post_hdi &lt;-</span>
<span id="cb451-13"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-13"></a><span class="st">  </span><span class="kw">hdi_of_icdf</span>(<span class="dt">name =</span> qbeta,</span>
<span id="cb451-14"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-14"></a>              <span class="dt">shape1 =</span> z <span class="op">+</span><span class="st"> </span>beta_param<span class="op">$</span>a,</span>
<span id="cb451-15"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-15"></a>              <span class="dt">shape2 =</span> n <span class="op">-</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>beta_param<span class="op">$</span>b,</span>
<span id="cb451-16"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-16"></a>              <span class="dt">width =</span> <span class="fl">.95</span>)</span>
<span id="cb451-17"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-17"></a></span>
<span id="cb451-18"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-18"></a><span class="co"># update the data</span></span>
<span id="cb451-19"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-19"></a>d &lt;-</span>
<span id="cb451-20"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-20"></a><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb451-21"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-21"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prior     =</span> <span class="kw">dbeta</span>(theta, </span>
<span id="cb451-22"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-22"></a>                           <span class="dt">shape1 =</span> beta_param<span class="op">$</span>a, </span>
<span id="cb451-23"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-23"></a>                           <span class="dt">shape2 =</span> beta_param<span class="op">$</span>b),</span>
<span id="cb451-24"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-24"></a>         <span class="dt">posterior =</span> <span class="kw">dbeta</span>(theta, </span>
<span id="cb451-25"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-25"></a>                           <span class="dt">shape1 =</span> z <span class="op">+</span><span class="st"> </span>beta_param<span class="op">$</span>a, </span>
<span id="cb451-26"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-26"></a>                           <span class="dt">shape2 =</span> n <span class="op">-</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>beta_param<span class="op">$</span>b))</span>
<span id="cb451-27"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-27"></a></span>
<span id="cb451-28"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-28"></a></span>
<span id="cb451-29"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-29"></a><span class="co">## plot Figure 6.4, rightmost column!</span></span>
<span id="cb451-30"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-30"></a><span class="co"># prior</span></span>
<span id="cb451-31"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-31"></a>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb451-32"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-32"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> prior)) <span class="op">+</span></span>
<span id="cb451-33"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-33"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="op">+</span></span>
<span id="cb451-34"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-34"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Prior (beta)&quot;</span>,</span>
<span id="cb451-35"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-35"></a>       <span class="dt">x =</span> <span class="kw">expression</span>(theta),</span>
<span id="cb451-36"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-36"></a>       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">dbeta</span>(theta<span class="op">*</span><span class="st">&quot;|&quot;</span><span class="op">*</span><span class="dv">1</span><span class="op">*</span><span class="st">&quot;, &quot;</span><span class="op">*</span><span class="dv">1</span>))) <span class="op">+</span></span>
<span id="cb451-37"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-37"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">5</span>)) <span class="op">+</span></span>
<span id="cb451-38"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb451-38"></a><span class="st">  </span><span class="kw">theme_cowplot</span>()</span></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-31-1.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb452-1"></a><span class="co"># likelihood, which is the same as the last two examples</span></span>
<span id="cb452-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb452-2"></a>d <span class="op">%&gt;%</span><span class="st">   </span></span>
<span id="cb452-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb452-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> likelihood)) <span class="op">+</span></span>
<span id="cb452-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb452-4"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">size =</span> <span class="dv">0</span>, <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="op">+</span></span>
<span id="cb452-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb452-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Likelihood (Bernoulli)&quot;</span>,</span>
<span id="cb452-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb452-6"></a>       <span class="dt">x =</span> <span class="kw">expression</span>(theta),</span>
<span id="cb452-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb452-7"></a>       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">p</span>(D<span class="op">*</span><span class="st">&quot;|&quot;</span><span class="op">*</span>theta))) <span class="op">+</span></span>
<span id="cb452-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb452-8"></a><span class="st">  </span><span class="kw">theme_cowplot</span>()</span></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-31-2.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb453-1"></a><span class="co"># posterior</span></span>
<span id="cb453-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb453-2"></a>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb453-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb453-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> posterior)) <span class="op">+</span></span>
<span id="cb453-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb453-4"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb453-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb453-5"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> . <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(theta <span class="op">&gt;</span><span class="st"> </span>post_hdi[<span class="dv">1</span>] <span class="op">&amp;</span><span class="st"> </span>theta <span class="op">&lt;</span><span class="st"> </span>post_hdi[<span class="dv">2</span>]),</span>
<span id="cb453-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb453-6"></a>              <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="op">+</span></span>
<span id="cb453-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb453-7"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">x =</span> post_hdi[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="fl">.005</span>, <span class="dt">xend =</span> post_hdi[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span><span class="fl">.005</span>,</span>
<span id="cb453-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb453-8"></a>               <span class="dt">y =</span> <span class="fl">0.8</span>, <span class="dt">yend =</span> <span class="fl">0.8</span>,</span>
<span id="cb453-9"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb453-9"></a>               <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(.<span class="dv">15</span>, <span class="st">&quot;cm&quot;</span>), </span>
<span id="cb453-10"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb453-10"></a>                             <span class="dt">ends =</span> <span class="st">&quot;both&quot;</span>, </span>
<span id="cb453-11"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb453-11"></a>                             <span class="dt">type =</span> <span class="st">&quot;closed&quot;</span>),</span>
<span id="cb453-12"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb453-12"></a>               <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb453-13"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb453-13"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> (post_hdi[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>post_hdi[<span class="dv">2</span>]) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">y =</span> <span class="fl">1.5</span>, </span>
<span id="cb453-14"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb453-14"></a>           <span class="dt">label =</span> <span class="st">&quot;95% HDI&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb453-15"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb453-15"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Posterior (beta)&quot;</span>,</span>
<span id="cb453-16"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb453-16"></a>       <span class="dt">x =</span> <span class="kw">expression</span>(theta),</span>
<span id="cb453-17"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb453-17"></a>       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">dbeta</span>(theta<span class="op">*</span><span class="st">&quot;|&quot;</span><span class="op">*</span><span class="dv">18</span><span class="op">*</span><span class="st">&quot;, &quot;</span><span class="op">*</span><span class="dv">4</span>))) <span class="op">+</span></span>
<span id="cb453-18"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb453-18"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">5</span>)) <span class="op">+</span></span>
<span id="cb453-19"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb453-19"></a><span class="st">  </span><span class="kw">theme_cowplot</span>()</span></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-31-3.png" width="480" style="display: block; margin: auto;" /></p>
<p>Here are the exact HDI values for the posterior density.</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb454-1"></a>post_hdi</span></code></pre></div>
<pre><code>## [1] 0.6599474 0.9591231</code></pre>
<p>Because both the <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> parameters for our beta prior are 1, we can’t use the formula from above to compute the mode. I hope this makes sense if you look back at the plot. The density for <span class="math inline">\(\operatorname{beta}(1, 1)\)</span> is uniform and has no mode. We can, at least, compute the mode for the posterior.</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb456-1"></a>(z <span class="op">+</span><span class="st"> </span>beta_param<span class="op">$</span>a <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span>(z <span class="op">+</span><span class="st"> </span>beta_param<span class="op">$</span>a <span class="op">+</span><span class="st"> </span>n <span class="op">-</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>beta_param<span class="op">$</span>b <span class="op">-</span><span class="st"> </span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.85</code></pre>
</div>
<div id="prior-knowledge-that-cannot-be-expressed-as-a-beta-distribution." class="section level3">
<h3><span class="header-section-number">6.4.2</span> Prior knowledge that cannot be expressed as a beta distribution.</h3>
<blockquote>
<p>The beauty of using a beta distribution to express prior knowledge is that the posterior distribution is again exactly a beta distribution, and therefore, no matter how much data we include, we always have an exact representation of the posterior distribution and a simple way of computing it. But not all prior knowledge can be expressed by a beta distribution, because the beta distribution can only be in the forms illustrated by Figure 6.1. If the prior knowledge cannot be expressed as a beta distribution, then we must use a different method to derive the posterior. In particular, we might revert to grid approximation as was explained in Section 5.5 (p. 116).</p>
</blockquote>
<p>For such a small section in the text, the underlying code is a bit of a beast. Fir kicks, we’ll practice two ways. First we’ll follow the code Kruschke used in the text. Our second attempt will be in a more <strong>tidyverse</strong> sort of way.</p>
<div id="figure-6.5-in-kruschke-style." class="section level4">
<h4><span class="header-section-number">6.4.2.1</span> Figure 6.5 in Kruschke style.</h4>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb458-1"></a><span class="co"># Fine teeth for Theta</span></span>
<span id="cb458-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb458-2"></a>theta &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">length =</span> <span class="dv">1000</span>)</span>
<span id="cb458-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb458-3"></a></span>
<span id="cb458-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb458-4"></a><span class="co"># Two triangular peaks on a small non-zero floor</span></span>
<span id="cb458-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb458-5"></a>p_theta &lt;-</span>
<span id="cb458-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb458-6"></a><span class="st">  </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">200</span>), </span>
<span id="cb458-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb458-7"></a>    <span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">100</span>, <span class="dt">length =</span> <span class="dv">50</span>), </span>
<span id="cb458-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb458-8"></a>    <span class="kw">seq</span>(<span class="dv">100</span>, <span class="dv">1</span>, <span class="dt">length =</span> <span class="dv">50</span>), </span>
<span id="cb458-9"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb458-9"></a>    <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">200</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb458-10"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb458-10"></a><span class="st">  </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">2</span>)</span>
<span id="cb458-11"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb458-11"></a></span>
<span id="cb458-12"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb458-12"></a><span class="co"># Make p_theta sum to 1.0</span></span>
<span id="cb458-13"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb458-13"></a>p_theta &lt;-<span class="st"> </span>p_theta <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(p_theta)</span></code></pre></div>
<p>Here’s Kruschke’s <code>BernGrid()</code> code in all its glory.</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-1"></a>BernGrid =<span class="st"> </span><span class="cf">function</span>( Theta , pTheta , Data , <span class="dt">plotType=</span><span class="kw">c</span>(<span class="st">&quot;Points&quot;</span>,<span class="st">&quot;Bars&quot;</span>)[<span class="dv">2</span>] ,</span>
<span id="cb459-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-2"></a>                     <span class="dt">showCentTend=</span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>,<span class="st">&quot;Mode&quot;</span>,<span class="st">&quot;None&quot;</span>)[<span class="dv">3</span>] ,</span>
<span id="cb459-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-3"></a>                     <span class="dt">showHDI=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">FALSE</span>)[<span class="dv">2</span>] , <span class="dt">HDImass=</span><span class="fl">0.95</span> ,</span>
<span id="cb459-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-4"></a>                     <span class="dt">showpD=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">FALSE</span>)[<span class="dv">2</span>] , <span class="dt">nToPlot=</span><span class="kw">length</span>(Theta) ) {</span>
<span id="cb459-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-5"></a>  <span class="co"># Theta is vector of values between 0 and 1.</span></span>
<span id="cb459-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-6"></a>  <span class="co"># pTheta is prior probability mass at each value of Theta</span></span>
<span id="cb459-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-7"></a>  <span class="co"># Data is vector of 0&#39;s and 1&#39;s.</span></span>
<span id="cb459-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-8"></a>  </span>
<span id="cb459-9"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-9"></a>  <span class="co"># Check for input errors:</span></span>
<span id="cb459-10"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-10"></a>  <span class="cf">if</span> ( <span class="kw">any</span>( Theta <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Theta <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> ) ) {</span>
<span id="cb459-11"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-11"></a>    <span class="kw">stop</span>(<span class="st">&quot;Theta values must be between 0 and 1&quot;</span>)</span>
<span id="cb459-12"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-12"></a>  }</span>
<span id="cb459-13"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-13"></a>  <span class="cf">if</span> ( <span class="kw">any</span>( pTheta <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> ) ) {</span>
<span id="cb459-14"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-14"></a>    <span class="kw">stop</span>(<span class="st">&quot;pTheta values must be non-negative&quot;</span>)</span>
<span id="cb459-15"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-15"></a>  }</span>
<span id="cb459-16"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-16"></a>  <span class="cf">if</span> ( <span class="op">!</span><span class="kw">isTRUE</span>(<span class="kw">all.equal</span>( <span class="kw">sum</span>(pTheta) , <span class="fl">1.0</span> )) )  {</span>
<span id="cb459-17"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-17"></a>    <span class="kw">stop</span>(<span class="st">&quot;pTheta values must sum to 1.0&quot;</span>)</span>
<span id="cb459-18"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-18"></a>  }</span>
<span id="cb459-19"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-19"></a>  <span class="cf">if</span> ( <span class="op">!</span><span class="kw">all</span>( Data <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Data <span class="op">==</span><span class="st"> </span><span class="dv">0</span> ) ) {</span>
<span id="cb459-20"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-20"></a>    <span class="kw">stop</span>(<span class="st">&quot;Data values must be 0 or 1&quot;</span>)</span>
<span id="cb459-21"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-21"></a>  }</span>
<span id="cb459-22"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-22"></a>  </span>
<span id="cb459-23"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-23"></a>  <span class="co"># Create summary values of Data</span></span>
<span id="cb459-24"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-24"></a>  z =<span class="st"> </span><span class="kw">sum</span>( Data ) <span class="co"># number of 1&#39;s in Data</span></span>
<span id="cb459-25"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-25"></a>  N =<span class="st"> </span><span class="kw">length</span>( Data ) </span>
<span id="cb459-26"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-26"></a></span>
<span id="cb459-27"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-27"></a>  <span class="co"># Compute the Bernoulli likelihood at each value of Theta:</span></span>
<span id="cb459-28"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-28"></a>  pDataGivenTheta =<span class="st"> </span>Theta<span class="op">^</span>z <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>Theta)<span class="op">^</span>(N<span class="op">-</span>z)</span>
<span id="cb459-29"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-29"></a>  <span class="co"># Compute the evidence and the posterior via Bayes&#39; rule:</span></span>
<span id="cb459-30"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-30"></a>  pData =<span class="st"> </span><span class="kw">sum</span>( pDataGivenTheta <span class="op">*</span><span class="st"> </span>pTheta )</span>
<span id="cb459-31"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-31"></a>  pThetaGivenData =<span class="st"> </span>pDataGivenTheta <span class="op">*</span><span class="st"> </span>pTheta <span class="op">/</span><span class="st"> </span>pData</span>
<span id="cb459-32"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-32"></a>  </span>
<span id="cb459-33"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-33"></a>  <span class="co"># Plot the results.</span></span>
<span id="cb459-34"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-34"></a>  <span class="kw">layout</span>( <span class="kw">matrix</span>( <span class="kw">c</span>( <span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span> ) ,<span class="dt">nrow=</span><span class="dv">3</span> ,<span class="dt">ncol=</span><span class="dv">1</span> ,<span class="dt">byrow=</span><span class="ot">FALSE</span> ) ) <span class="co"># 3x1 panels</span></span>
<span id="cb459-35"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-35"></a>  <span class="kw">par</span>( <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">0</span>) , <span class="dt">mgp=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="fl">0.7</span>,<span class="dv">0</span>) , <span class="dt">mai=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.3</span>,<span class="fl">0.1</span>) ) <span class="co"># margins</span></span>
<span id="cb459-36"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-36"></a>  cexAxis =<span class="st"> </span><span class="fl">1.33</span></span>
<span id="cb459-37"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-37"></a>  cexLab =<span class="st"> </span><span class="fl">1.75</span></span>
<span id="cb459-38"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-38"></a>  <span class="co"># convert plotType to notation used by plot:</span></span>
<span id="cb459-39"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-39"></a>  <span class="cf">if</span> ( plotType<span class="op">==</span><span class="st">&quot;Points&quot;</span> ) { plotType=<span class="st">&quot;p&quot;</span> }</span>
<span id="cb459-40"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-40"></a>  <span class="cf">if</span> ( plotType<span class="op">==</span><span class="st">&quot;Bars&quot;</span> ) { plotType=<span class="st">&quot;h&quot;</span> }</span>
<span id="cb459-41"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-41"></a>  dotsize =<span class="st"> </span><span class="dv">5</span> <span class="co"># how big to make the plotted dots</span></span>
<span id="cb459-42"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-42"></a>  barsize =<span class="st"> </span><span class="dv">5</span> <span class="co"># how wide to make the bar lines    </span></span>
<span id="cb459-43"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-43"></a>  <span class="co"># If the comb has a zillion teeth, it&#39;s too many to plot, so plot only a</span></span>
<span id="cb459-44"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-44"></a>  <span class="co"># thinned out subset of the teeth.</span></span>
<span id="cb459-45"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-45"></a>  nteeth =<span class="st"> </span><span class="kw">length</span>(Theta)</span>
<span id="cb459-46"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-46"></a>  <span class="cf">if</span> ( nteeth <span class="op">&gt;</span><span class="st"> </span>nToPlot ) {</span>
<span id="cb459-47"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-47"></a>    thinIdx =<span class="st"> </span><span class="kw">round</span>( <span class="kw">seq</span>( <span class="dv">1</span>, nteeth , <span class="dt">length=</span>nteeth ) )</span>
<span id="cb459-48"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-48"></a>  } <span class="cf">else</span> { </span>
<span id="cb459-49"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-49"></a>    thinIdx =<span class="st"> </span><span class="dv">1</span><span class="op">:</span>nteeth </span>
<span id="cb459-50"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-50"></a>  }</span>
<span id="cb459-51"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-51"></a></span>
<span id="cb459-52"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-52"></a>  <span class="co"># Plot the prior.</span></span>
<span id="cb459-53"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-53"></a>  yLim =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1.1</span><span class="op">*</span><span class="kw">max</span>(<span class="kw">c</span>(pTheta,pThetaGivenData)))</span>
<span id="cb459-54"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-54"></a>  <span class="kw">plot</span>( Theta[thinIdx] , pTheta[thinIdx] , <span class="dt">type=</span>plotType , </span>
<span id="cb459-55"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-55"></a>        <span class="dt">pch=</span><span class="st">&quot;.&quot;</span> , <span class="dt">cex=</span>dotsize , <span class="dt">lwd=</span>barsize ,</span>
<span id="cb459-56"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-56"></a>        <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>) , <span class="dt">ylim=</span>yLim , <span class="dt">cex.axis=</span>cexAxis ,</span>
<span id="cb459-57"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-57"></a>        <span class="dt">xlab=</span><span class="kw">bquote</span>(theta) , <span class="dt">ylab=</span><span class="kw">bquote</span>(<span class="kw">p</span>(theta)) , <span class="dt">cex.lab=</span>cexLab ,</span>
<span id="cb459-58"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-58"></a>        <span class="dt">main=</span><span class="st">&quot;Prior&quot;</span> , <span class="dt">cex.main=</span><span class="fl">1.5</span> , <span class="dt">col=</span><span class="st">&quot;skyblue&quot;</span> )</span>
<span id="cb459-59"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-59"></a>  <span class="cf">if</span> ( showCentTend <span class="op">!=</span><span class="st"> &quot;None&quot;</span> ) {</span>
<span id="cb459-60"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-60"></a>    <span class="cf">if</span> ( showCentTend <span class="op">==</span><span class="st"> &quot;Mean&quot;</span> ) {</span>
<span id="cb459-61"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-61"></a>      meanTheta =<span class="st"> </span><span class="kw">sum</span>( Theta <span class="op">*</span><span class="st"> </span>pTheta ) </span>
<span id="cb459-62"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-62"></a>      <span class="cf">if</span> ( meanTheta <span class="op">&gt;</span><span class="st"> </span><span class="fl">.5</span> ) {</span>
<span id="cb459-63"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-63"></a>         textx =<span class="st"> </span><span class="dv">0</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb459-64"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-64"></a>      } <span class="cf">else</span> {</span>
<span id="cb459-65"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-65"></a>        textx =<span class="st"> </span><span class="dv">1</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb459-66"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-66"></a>      }</span>
<span id="cb459-67"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-67"></a>      <span class="kw">text</span>( textx , yLim[<span class="dv">2</span>] ,</span>
<span id="cb459-68"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-68"></a>            <span class="kw">bquote</span>( <span class="st">&quot;mean=&quot;</span> <span class="op">*</span><span class="st"> </span>.(<span class="kw">signif</span>(meanTheta,<span class="dv">3</span>)) ) ,</span>
<span id="cb459-69"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-69"></a>            <span class="dt">cex=</span><span class="fl">2.0</span> , <span class="dt">adj=</span>textadj )</span>
<span id="cb459-70"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-70"></a>    }</span>
<span id="cb459-71"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-71"></a>    <span class="cf">if</span> ( showCentTend <span class="op">==</span><span class="st"> &quot;Mode&quot;</span> ) {</span>
<span id="cb459-72"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-72"></a>      modeTheta =<span class="st"> </span>Theta[ <span class="kw">which.max</span>( pTheta ) ]</span>
<span id="cb459-73"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-73"></a>      <span class="cf">if</span> ( modeTheta <span class="op">&gt;</span><span class="st"> </span><span class="fl">.5</span> ) {</span>
<span id="cb459-74"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-74"></a>        textx =<span class="st"> </span><span class="dv">0</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb459-75"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-75"></a>      } <span class="cf">else</span> {</span>
<span id="cb459-76"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-76"></a>        textx =<span class="st"> </span><span class="dv">1</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb459-77"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-77"></a>      }</span>
<span id="cb459-78"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-78"></a>      <span class="kw">text</span>( textx , yLim[<span class="dv">2</span>] ,</span>
<span id="cb459-79"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-79"></a>            <span class="kw">bquote</span>( <span class="st">&quot;mode=&quot;</span> <span class="op">*</span><span class="st"> </span>.(<span class="kw">signif</span>(modeTheta,<span class="dv">3</span>)) ) ,</span>
<span id="cb459-80"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-80"></a>            <span class="dt">cex=</span><span class="fl">2.0</span> , <span class="dt">adj=</span>textadj )</span>
<span id="cb459-81"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-81"></a>    }</span>
<span id="cb459-82"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-82"></a>  }</span>
<span id="cb459-83"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-83"></a>  </span>
<span id="cb459-84"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-84"></a>  <span class="co"># Mark the highest density interval. HDI points are not thinned in the plot.</span></span>
<span id="cb459-85"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-85"></a>  <span class="cf">if</span> ( showHDI ) {</span>
<span id="cb459-86"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-86"></a>    HDIinfo =<span class="st"> </span><span class="kw">HDIofGrid</span>( pTheta , <span class="dt">credMass=</span>HDImass )</span>
<span id="cb459-87"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-87"></a>    <span class="kw">points</span>( Theta[ HDIinfo<span class="op">$</span>indices ] , </span>
<span id="cb459-88"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-88"></a>            <span class="kw">rep</span>( HDIinfo<span class="op">$</span>height , <span class="kw">length</span>( HDIinfo<span class="op">$</span>indices ) ) , </span>
<span id="cb459-89"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-89"></a>            <span class="dt">pch=</span><span class="st">&quot;-&quot;</span> , <span class="dt">cex=</span><span class="fl">1.0</span> )</span>
<span id="cb459-90"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-90"></a>    <span class="kw">text</span>( <span class="kw">mean</span>( Theta[ HDIinfo<span class="op">$</span>indices ] ) , HDIinfo<span class="op">$</span>height ,</span>
<span id="cb459-91"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-91"></a>          <span class="kw">bquote</span>( .(<span class="dv">100</span><span class="op">*</span><span class="kw">signif</span>(HDIinfo<span class="op">$</span>mass,<span class="dv">3</span>)) <span class="op">*</span><span class="st"> &quot;% HDI&quot;</span> ) ,</span>
<span id="cb459-92"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-92"></a>          <span class="dt">adj=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="op">-</span><span class="fl">1.5</span>) , <span class="dt">cex=</span><span class="fl">1.5</span> )</span>
<span id="cb459-93"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-93"></a>    <span class="co"># Mark the left and right ends of the waterline. </span></span>
<span id="cb459-94"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-94"></a>    <span class="co"># Find indices at ends of sub-intervals:</span></span>
<span id="cb459-95"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-95"></a>    inLim =<span class="st"> </span>HDIinfo<span class="op">$</span>indices[<span class="dv">1</span>] <span class="co"># first point</span></span>
<span id="cb459-96"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-96"></a>    <span class="cf">for</span> ( idx <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>(<span class="kw">length</span>(HDIinfo<span class="op">$</span>indices)<span class="op">-</span><span class="dv">1</span>) ) {</span>
<span id="cb459-97"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-97"></a>      <span class="cf">if</span> ( ( HDIinfo<span class="op">$</span>indices[idx] <span class="op">!=</span><span class="st"> </span>HDIinfo<span class="op">$</span>indices[idx<span class="dv">-1</span>]<span class="op">+</span><span class="dv">1</span> ) <span class="op">|</span><span class="st"> </span><span class="co"># jumps on left, OR</span></span>
<span id="cb459-98"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-98"></a><span class="st">             </span>( HDIinfo<span class="op">$</span>indices[idx] <span class="op">!=</span><span class="st"> </span>HDIinfo<span class="op">$</span>indices[idx<span class="op">+</span><span class="dv">1</span>]<span class="op">-</span><span class="dv">1</span> ) ) { <span class="co"># jumps on right</span></span>
<span id="cb459-99"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-99"></a>        inLim =<span class="st"> </span><span class="kw">c</span>(inLim,HDIinfo<span class="op">$</span>indices[idx]) <span class="co"># include idx</span></span>
<span id="cb459-100"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-100"></a>      }</span>
<span id="cb459-101"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-101"></a>    }</span>
<span id="cb459-102"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-102"></a>    inLim =<span class="st"> </span><span class="kw">c</span>(inLim,HDIinfo<span class="op">$</span>indices[<span class="kw">length</span>(HDIinfo<span class="op">$</span>indices)]) <span class="co"># last point</span></span>
<span id="cb459-103"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-103"></a>    <span class="co"># Mark vertical lines at ends of sub-intervals:</span></span>
<span id="cb459-104"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-104"></a>    <span class="cf">for</span> ( idx <span class="cf">in</span> inLim ) {</span>
<span id="cb459-105"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-105"></a>      <span class="kw">lines</span>( <span class="kw">c</span>(Theta[idx],Theta[idx]) , <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>,HDIinfo<span class="op">$</span>height) , <span class="dt">type=</span><span class="st">&quot;l&quot;</span> , <span class="dt">lty=</span><span class="dv">2</span> , </span>
<span id="cb459-106"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-106"></a>             <span class="dt">lwd=</span><span class="fl">1.5</span> )</span>
<span id="cb459-107"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-107"></a>      <span class="kw">text</span>( Theta[idx] , HDIinfo<span class="op">$</span>height , <span class="kw">bquote</span>(.(<span class="kw">round</span>(Theta[idx],<span class="dv">3</span>))) ,</span>
<span id="cb459-108"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-108"></a>            <span class="dt">adj=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="op">-</span><span class="fl">0.1</span>) , <span class="dt">cex=</span><span class="fl">1.2</span> )</span>
<span id="cb459-109"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-109"></a>    }</span>
<span id="cb459-110"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-110"></a>  }</span>
<span id="cb459-111"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-111"></a>  </span>
<span id="cb459-112"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-112"></a>  <span class="co"># Plot the likelihood: p(Data|Theta)</span></span>
<span id="cb459-113"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-113"></a>  <span class="kw">plot</span>( Theta[thinIdx] , pDataGivenTheta[thinIdx] , <span class="dt">type=</span>plotType , </span>
<span id="cb459-114"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-114"></a>        <span class="dt">pch=</span><span class="st">&quot;.&quot;</span> , <span class="dt">cex=</span>dotsize , <span class="dt">lwd=</span>barsize ,</span>
<span id="cb459-115"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-115"></a>        <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>) , <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1.1</span><span class="op">*</span><span class="kw">max</span>(pDataGivenTheta)) , <span class="dt">cex.axis=</span>cexAxis ,</span>
<span id="cb459-116"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-116"></a>        <span class="dt">xlab=</span><span class="kw">bquote</span>(theta) , <span class="dt">ylab=</span><span class="kw">bquote</span>( <span class="st">&quot;p(D|&quot;</span> <span class="op">*</span><span class="st"> </span>theta <span class="op">*</span><span class="st"> &quot;)&quot;</span> ) , <span class="dt">cex.lab=</span>cexLab ,</span>
<span id="cb459-117"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-117"></a>        <span class="dt">main=</span><span class="st">&quot;Likelihood&quot;</span> , <span class="dt">cex.main=</span><span class="fl">1.5</span> , <span class="dt">col=</span><span class="st">&quot;skyblue&quot;</span> )</span>
<span id="cb459-118"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-118"></a>  <span class="cf">if</span> ( z <span class="op">&gt;</span><span class="st"> </span><span class="fl">.5</span><span class="op">*</span>N ) { textx =<span class="st"> </span><span class="dv">0</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>) }</span>
<span id="cb459-119"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-119"></a>  <span class="cf">else</span> { textx =<span class="st"> </span><span class="dv">1</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>) }</span>
<span id="cb459-120"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-120"></a>  <span class="kw">text</span>( textx ,<span class="fl">1.0</span><span class="op">*</span><span class="kw">max</span>(pDataGivenTheta) ,<span class="dt">cex=</span><span class="fl">2.0</span></span>
<span id="cb459-121"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-121"></a>    ,<span class="kw">bquote</span>( <span class="st">&quot;Data: z=&quot;</span> <span class="op">*</span><span class="st"> </span>.(z) <span class="op">*</span><span class="st"> &quot;,N=&quot;</span> <span class="op">*</span><span class="st"> </span>.(N) ) ,<span class="dt">adj=</span>textadj )</span>
<span id="cb459-122"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-122"></a>  <span class="cf">if</span> ( showCentTend <span class="op">!=</span><span class="st"> &quot;None&quot;</span> ) {</span>
<span id="cb459-123"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-123"></a>    <span class="cf">if</span> ( showCentTend <span class="op">==</span><span class="st"> &quot;Mean&quot;</span> ) {</span>
<span id="cb459-124"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-124"></a>      meanTheta =<span class="st"> </span><span class="kw">sum</span>( Theta <span class="op">*</span><span class="st"> </span>pDataGivenTheta ) </span>
<span id="cb459-125"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-125"></a>      <span class="cf">if</span> ( meanTheta <span class="op">&gt;</span><span class="st"> </span><span class="fl">.5</span> ) {</span>
<span id="cb459-126"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-126"></a>        textx =<span class="st"> </span><span class="dv">0</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb459-127"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-127"></a>      } <span class="cf">else</span> {</span>
<span id="cb459-128"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-128"></a>        textx =<span class="st"> </span><span class="dv">1</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb459-129"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-129"></a>      }</span>
<span id="cb459-130"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-130"></a>      <span class="kw">text</span>( textx , <span class="fl">0.7</span><span class="op">*</span><span class="kw">max</span>(pDataGivenTheta) ,</span>
<span id="cb459-131"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-131"></a>            <span class="kw">bquote</span>( <span class="st">&quot;mean=&quot;</span> <span class="op">*</span><span class="st"> </span>.(<span class="kw">signif</span>(meanTheta,<span class="dv">3</span>)) ) ,</span>
<span id="cb459-132"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-132"></a>            <span class="dt">cex=</span><span class="fl">2.0</span> , <span class="dt">adj=</span>textadj )</span>
<span id="cb459-133"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-133"></a>    }</span>
<span id="cb459-134"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-134"></a>    <span class="cf">if</span> ( showCentTend <span class="op">==</span><span class="st"> &quot;Mode&quot;</span> ) {</span>
<span id="cb459-135"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-135"></a>      modeTheta =<span class="st"> </span>Theta[ <span class="kw">which.max</span>( pDataGivenTheta ) ]</span>
<span id="cb459-136"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-136"></a>      <span class="cf">if</span> ( modeTheta <span class="op">&gt;</span><span class="st"> </span><span class="fl">.5</span> ) {</span>
<span id="cb459-137"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-137"></a>        textx =<span class="st"> </span><span class="dv">0</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb459-138"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-138"></a>      } <span class="cf">else</span> {</span>
<span id="cb459-139"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-139"></a>        textx =<span class="st"> </span><span class="dv">1</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb459-140"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-140"></a>      }</span>
<span id="cb459-141"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-141"></a>      <span class="kw">text</span>( textx , <span class="fl">0.7</span><span class="op">*</span><span class="kw">max</span>(pDataGivenTheta) ,</span>
<span id="cb459-142"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-142"></a>            <span class="kw">bquote</span>( <span class="st">&quot;mode=&quot;</span> <span class="op">*</span><span class="st"> </span>.(<span class="kw">signif</span>(modeTheta,<span class="dv">3</span>)) ) ,</span>
<span id="cb459-143"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-143"></a>            <span class="dt">cex=</span><span class="fl">2.0</span> , <span class="dt">adj=</span>textadj )</span>
<span id="cb459-144"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-144"></a>    }</span>
<span id="cb459-145"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-145"></a>  }</span>
<span id="cb459-146"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-146"></a>  </span>
<span id="cb459-147"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-147"></a>  <span class="co"># Plot the posterior.</span></span>
<span id="cb459-148"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-148"></a>  yLim =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1.1</span><span class="op">*</span><span class="kw">max</span>(<span class="kw">c</span>(pTheta,pThetaGivenData)))</span>
<span id="cb459-149"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-149"></a>  <span class="kw">plot</span>( Theta[thinIdx] , pThetaGivenData[thinIdx] , <span class="dt">type=</span>plotType , </span>
<span id="cb459-150"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-150"></a>        <span class="dt">pch=</span><span class="st">&quot;.&quot;</span> , <span class="dt">cex=</span>dotsize , <span class="dt">lwd=</span>barsize ,</span>
<span id="cb459-151"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-151"></a>        <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>) , <span class="dt">ylim=</span>yLim , <span class="dt">cex.axis=</span>cexAxis ,</span>
<span id="cb459-152"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-152"></a>        <span class="dt">xlab=</span><span class="kw">bquote</span>(theta) , <span class="dt">ylab=</span><span class="kw">bquote</span>( <span class="st">&quot;p(&quot;</span> <span class="op">*</span><span class="st"> </span>theta <span class="op">*</span><span class="st"> &quot;|D)&quot;</span> ) , <span class="dt">cex.lab=</span>cexLab ,</span>
<span id="cb459-153"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-153"></a>        <span class="dt">main=</span><span class="st">&quot;Posterior&quot;</span> , <span class="dt">cex.main=</span><span class="fl">1.5</span> , <span class="dt">col=</span><span class="st">&quot;skyblue&quot;</span> )</span>
<span id="cb459-154"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-154"></a>  <span class="cf">if</span> ( showCentTend <span class="op">!=</span><span class="st"> &quot;None&quot;</span> ) {</span>
<span id="cb459-155"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-155"></a>    <span class="cf">if</span> ( showCentTend <span class="op">==</span><span class="st"> &quot;Mean&quot;</span> ) {</span>
<span id="cb459-156"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-156"></a>      meanTheta =<span class="st"> </span><span class="kw">sum</span>( Theta <span class="op">*</span><span class="st"> </span>pThetaGivenData ) </span>
<span id="cb459-157"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-157"></a>      <span class="cf">if</span> ( meanTheta <span class="op">&gt;</span><span class="st"> </span><span class="fl">.5</span> ) {</span>
<span id="cb459-158"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-158"></a>        textx =<span class="st"> </span><span class="dv">0</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb459-159"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-159"></a>      } <span class="cf">else</span> {</span>
<span id="cb459-160"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-160"></a>        textx =<span class="st"> </span><span class="dv">1</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb459-161"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-161"></a>      }</span>
<span id="cb459-162"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-162"></a>      <span class="kw">text</span>( textx , yLim[<span class="dv">2</span>] ,</span>
<span id="cb459-163"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-163"></a>            <span class="kw">bquote</span>( <span class="st">&quot;mean=&quot;</span> <span class="op">*</span><span class="st"> </span>.(<span class="kw">signif</span>(meanTheta,<span class="dv">3</span>)) ) ,</span>
<span id="cb459-164"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-164"></a>            <span class="dt">cex=</span><span class="fl">2.0</span> , <span class="dt">adj=</span>textadj )</span>
<span id="cb459-165"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-165"></a>    }</span>
<span id="cb459-166"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-166"></a>    <span class="cf">if</span> ( showCentTend <span class="op">==</span><span class="st"> &quot;Mode&quot;</span> ) {</span>
<span id="cb459-167"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-167"></a>      modeTheta =<span class="st"> </span>Theta[ <span class="kw">which.max</span>( pThetaGivenData ) ]</span>
<span id="cb459-168"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-168"></a>      <span class="cf">if</span> ( modeTheta <span class="op">&gt;</span><span class="st"> </span><span class="fl">.5</span> ) {</span>
<span id="cb459-169"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-169"></a>        textx =<span class="st"> </span><span class="dv">0</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb459-170"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-170"></a>      } <span class="cf">else</span> {</span>
<span id="cb459-171"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-171"></a>        textx =<span class="st"> </span><span class="dv">1</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb459-172"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-172"></a>      }</span>
<span id="cb459-173"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-173"></a>      <span class="kw">text</span>( textx , yLim[<span class="dv">2</span>] ,</span>
<span id="cb459-174"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-174"></a>            <span class="kw">bquote</span>( <span class="st">&quot;mode=&quot;</span> <span class="op">*</span><span class="st"> </span>.(<span class="kw">signif</span>(modeTheta,<span class="dv">3</span>)) ) ,</span>
<span id="cb459-175"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-175"></a>            <span class="dt">cex=</span><span class="fl">2.0</span> , <span class="dt">adj=</span>textadj )</span>
<span id="cb459-176"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-176"></a>    }</span>
<span id="cb459-177"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-177"></a>  }</span>
<span id="cb459-178"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-178"></a></span>
<span id="cb459-179"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-179"></a>  </span>
<span id="cb459-180"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-180"></a>  <span class="co"># Plot marginal likelihood pData:</span></span>
<span id="cb459-181"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-181"></a>  <span class="cf">if</span> ( showpD ) {</span>
<span id="cb459-182"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-182"></a>    meanTheta =<span class="st"> </span><span class="kw">sum</span>( Theta <span class="op">*</span><span class="st"> </span>pThetaGivenData ) </span>
<span id="cb459-183"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-183"></a>    <span class="cf">if</span> ( meanTheta <span class="op">&gt;</span><span class="st"> </span><span class="fl">.5</span> ) {</span>
<span id="cb459-184"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-184"></a>      textx =<span class="st"> </span><span class="dv">0</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb459-185"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-185"></a>    } <span class="cf">else</span> {</span>
<span id="cb459-186"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-186"></a>      textx =<span class="st"> </span><span class="dv">1</span> ; textadj =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb459-187"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-187"></a>    }</span>
<span id="cb459-188"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-188"></a>    <span class="kw">text</span>( textx , <span class="fl">0.75</span><span class="op">*</span><span class="kw">max</span>(pThetaGivenData) , <span class="dt">cex=</span><span class="fl">2.0</span> ,</span>
<span id="cb459-189"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-189"></a>            <span class="kw">bquote</span>( <span class="st">&quot;p(D)=&quot;</span> <span class="op">*</span><span class="st"> </span>.(<span class="kw">signif</span>(pData,<span class="dv">3</span>)) ) ,<span class="dt">adj=</span>textadj )</span>
<span id="cb459-190"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-190"></a>  }</span>
<span id="cb459-191"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-191"></a>  </span>
<span id="cb459-192"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-192"></a>  <span class="co"># Mark the highest density interval. HDI points are not thinned in the plot.</span></span>
<span id="cb459-193"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-193"></a>  <span class="cf">if</span> ( showHDI ) {</span>
<span id="cb459-194"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-194"></a>    HDIinfo =<span class="st"> </span><span class="kw">HDIofGrid</span>( pThetaGivenData , <span class="dt">credMass=</span>HDImass )</span>
<span id="cb459-195"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-195"></a>    <span class="kw">points</span>( Theta[ HDIinfo<span class="op">$</span>indices ] , </span>
<span id="cb459-196"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-196"></a>            <span class="kw">rep</span>( HDIinfo<span class="op">$</span>height , <span class="kw">length</span>( HDIinfo<span class="op">$</span>indices ) ) , </span>
<span id="cb459-197"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-197"></a>            <span class="dt">pch=</span><span class="st">&quot;-&quot;</span> , <span class="dt">cex=</span><span class="fl">1.0</span> )</span>
<span id="cb459-198"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-198"></a>    <span class="kw">text</span>( <span class="kw">mean</span>( Theta[ HDIinfo<span class="op">$</span>indices ] ) , HDIinfo<span class="op">$</span>height ,</span>
<span id="cb459-199"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-199"></a>             <span class="kw">bquote</span>( .(<span class="dv">100</span><span class="op">*</span><span class="kw">signif</span>(HDIinfo<span class="op">$</span>mass,<span class="dv">3</span>)) <span class="op">*</span><span class="st"> &quot;% HDI&quot;</span> ) ,</span>
<span id="cb459-200"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-200"></a>             <span class="dt">adj=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="op">-</span><span class="fl">1.5</span>) , <span class="dt">cex=</span><span class="fl">1.5</span> )</span>
<span id="cb459-201"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-201"></a>    <span class="co"># Mark the left and right ends of the waterline. </span></span>
<span id="cb459-202"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-202"></a>    <span class="co"># Find indices at ends of sub-intervals:</span></span>
<span id="cb459-203"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-203"></a>    inLim =<span class="st"> </span>HDIinfo<span class="op">$</span>indices[<span class="dv">1</span>] <span class="co"># first point</span></span>
<span id="cb459-204"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-204"></a>    <span class="cf">for</span> ( idx <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>(<span class="kw">length</span>(HDIinfo<span class="op">$</span>indices)<span class="op">-</span><span class="dv">1</span>) ) {</span>
<span id="cb459-205"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-205"></a>      <span class="cf">if</span> ( ( HDIinfo<span class="op">$</span>indices[idx] <span class="op">!=</span><span class="st"> </span>HDIinfo<span class="op">$</span>indices[idx<span class="dv">-1</span>]<span class="op">+</span><span class="dv">1</span> ) <span class="op">|</span><span class="st"> </span><span class="co"># jumps on left, OR</span></span>
<span id="cb459-206"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-206"></a><span class="st">        </span>( HDIinfo<span class="op">$</span>indices[idx] <span class="op">!=</span><span class="st"> </span>HDIinfo<span class="op">$</span>indices[idx<span class="op">+</span><span class="dv">1</span>]<span class="op">-</span><span class="dv">1</span> ) ) { <span class="co"># jumps on right</span></span>
<span id="cb459-207"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-207"></a>        inLim =<span class="st"> </span><span class="kw">c</span>(inLim,HDIinfo<span class="op">$</span>indices[idx]) <span class="co"># include idx</span></span>
<span id="cb459-208"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-208"></a>      }</span>
<span id="cb459-209"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-209"></a>    }</span>
<span id="cb459-210"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-210"></a>    inLim =<span class="st"> </span><span class="kw">c</span>(inLim,HDIinfo<span class="op">$</span>indices[<span class="kw">length</span>(HDIinfo<span class="op">$</span>indices)]) <span class="co"># last point</span></span>
<span id="cb459-211"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-211"></a>    <span class="co"># Mark vertical lines at ends of sub-intervals:</span></span>
<span id="cb459-212"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-212"></a>    <span class="cf">for</span> ( idx <span class="cf">in</span> inLim ) {</span>
<span id="cb459-213"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-213"></a>      <span class="kw">lines</span>( <span class="kw">c</span>(Theta[idx],Theta[idx]) , <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>,HDIinfo<span class="op">$</span>height) , <span class="dt">type=</span><span class="st">&quot;l&quot;</span> , <span class="dt">lty=</span><span class="dv">2</span> , </span>
<span id="cb459-214"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-214"></a>             <span class="dt">lwd=</span><span class="fl">1.5</span> )</span>
<span id="cb459-215"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-215"></a>      <span class="kw">text</span>( Theta[idx] , HDIinfo<span class="op">$</span>height , <span class="kw">bquote</span>(.(<span class="kw">round</span>(Theta[idx],<span class="dv">3</span>))) ,</span>
<span id="cb459-216"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-216"></a>            <span class="dt">adj=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="op">-</span><span class="fl">0.1</span>) , <span class="dt">cex=</span><span class="fl">1.2</span> )</span>
<span id="cb459-217"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-217"></a>    }</span>
<span id="cb459-218"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-218"></a>  }</span>
<span id="cb459-219"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-219"></a>  </span>
<span id="cb459-220"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-220"></a>  <span class="co"># return( pThetaGivenData )</span></span>
<span id="cb459-221"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb459-221"></a>} <span class="co"># end of function</span></span></code></pre></div>
<p>You plot using Kruschke’s method, like so.</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb460-1"></a>Data &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">13</span>), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">14</span>))</span>
<span id="cb460-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb460-2"></a></span>
<span id="cb460-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb460-3"></a><span class="kw">BernGrid</span>(theta, p_theta, Data, <span class="dt">plotType =</span> <span class="st">&quot;Bars&quot;</span>,</span>
<span id="cb460-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb460-4"></a>         <span class="dt">showCentTend =</span> <span class="st">&quot;None&quot;</span>, <span class="dt">showHDI =</span> <span class="ot">FALSE</span>, <span class="dt">showpD =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-36-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>The method works fine. But, I’m not a fan. It’s clear Kruschke put a lot of thought into the <code>BernGrid()</code> function. However, its inner workings are too opaque, for me, which leads to our next section…</p>
</div>
<div id="figure-6.5-in-tidyverse-style." class="section level4">
<h4><span class="header-section-number">6.4.2.2</span> Figure 6.5 in <strong>tidyverse</strong> style.</h4>
<p>Here we’ll be plotting with <strong>ggplot2</strong>. But let’s first get the data into a tibble.</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb461-1"></a><span class="co"># we need these to compute the likelihood</span></span>
<span id="cb461-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb461-2"></a>n &lt;-<span class="st"> </span><span class="dv">27</span></span>
<span id="cb461-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb461-3"></a>z &lt;-<span class="st"> </span><span class="dv">14</span></span>
<span id="cb461-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb461-4"></a></span>
<span id="cb461-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb461-5"></a>trial_data &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dt">times =</span> n <span class="op">-</span><span class="st"> </span>z), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dt">times =</span> z))        <span class="co"># (i.e., Data)</span></span>
<span id="cb461-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb461-6"></a></span>
<span id="cb461-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb461-7"></a>d &lt;-</span>
<span id="cb461-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb461-8"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">theta =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">1000</span>),       <span class="co"># (i.e., Theta)</span></span>
<span id="cb461-9"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb461-9"></a>         <span class="dt">Prior =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">200</span>),                                  <span class="co"># (i.e., pTheta)</span></span>
<span id="cb461-10"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb461-10"></a>                   <span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">100</span>, <span class="dt">length =</span> <span class="dv">50</span>), </span>
<span id="cb461-11"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb461-11"></a>                   <span class="kw">seq</span>(<span class="dv">100</span>, <span class="dv">1</span>, <span class="dt">length =</span> <span class="dv">50</span>), </span>
<span id="cb461-12"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb461-12"></a>                   <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">200</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb461-13"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb461-13"></a><span class="st">           </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb461-14"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb461-14"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Prior      =</span> Prior <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(Prior),</span>
<span id="cb461-15"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb461-15"></a>         <span class="dt">Likelihood =</span> <span class="kw">bernoulli_likelihood</span>(<span class="dt">theta =</span> theta,        <span class="co"># (i.e., pDataGivenTheta)</span></span>
<span id="cb461-16"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb461-16"></a>                                           <span class="dt">data  =</span> trial_data)) <span class="op">%&gt;%</span></span>
<span id="cb461-17"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb461-17"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">evidence =</span> <span class="kw">sum</span>(Likelihood <span class="op">*</span><span class="st"> </span>Prior)) <span class="op">%&gt;%</span><span class="st">                 </span><span class="co"># (i.e., pData)</span></span>
<span id="cb461-18"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb461-18"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Posterior =</span> Likelihood <span class="op">*</span><span class="st"> </span>Prior <span class="op">/</span><span class="st"> </span>evidence)              <span class="co"># (i.e., pThetaGivenData)</span></span>
<span id="cb461-19"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb461-19"></a>  </span>
<span id="cb461-20"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb461-20"></a><span class="kw">glimpse</span>(d)</span></code></pre></div>
<pre><code>## Rows: 1,000
## Columns: 5
## $ theta      &lt;dbl&gt; 0.000000000, 0.001001001, 0.002002002, 0.003003003, 0.0040…
## $ Prior      &lt;dbl&gt; 9.174312e-05, 9.174312e-05, 9.174312e-05, 9.174312e-05, 9.…
## $ Likelihood &lt;dbl&gt; 0.000000e+00, 1.000988e-42, 1.618784e-38, 4.664454e-36, 2.…
## $ evidence   &lt;dbl&gt; 3.546798e-10, 3.546798e-10, 3.546798e-10, 3.546798e-10, 3.…
## $ Posterior  &lt;dbl&gt; 0.000000e+00, 2.589202e-37, 4.187221e-33, 1.206529e-30, 6.…</code></pre>
<p>With our nice tibble in hand, we’ll plot the prior, likelihood, and posterior one at a time.</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb463-1"></a><span class="co"># prior</span></span>
<span id="cb463-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb463-2"></a>(p1 &lt;-</span>
<span id="cb463-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb463-3"></a><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb463-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb463-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></span>
<span id="cb463-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb463-5"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> Prior),</span>
<span id="cb463-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb463-6"></a>              <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="op">+</span></span>
<span id="cb463-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb463-7"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Prior&quot;</span>,</span>
<span id="cb463-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb463-8"></a>       <span class="dt">x =</span> <span class="kw">expression</span>(theta),</span>
<span id="cb463-9"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb463-9"></a>       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">p</span>(theta))) <span class="op">+</span></span>
<span id="cb463-10"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb463-10"></a><span class="st">  </span><span class="kw">theme_cowplot</span>()</span>
<span id="cb463-11"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb463-11"></a> )</span></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-38-1.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb464-1"></a><span class="co"># likelihood</span></span>
<span id="cb464-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb464-2"></a>(p2 &lt;-</span>
<span id="cb464-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb464-3"></a><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb464-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb464-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></span>
<span id="cb464-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb464-5"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> Likelihood),</span>
<span id="cb464-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb464-6"></a>              <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="op">+</span></span>
<span id="cb464-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb464-7"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Likelihood&quot;</span>,</span>
<span id="cb464-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb464-8"></a>       <span class="dt">x =</span> <span class="kw">expression</span>(theta),</span>
<span id="cb464-9"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb464-9"></a>       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">p</span>(D<span class="op">*</span><span class="st">&quot;|&quot;</span><span class="op">*</span>theta))) <span class="op">+</span></span>
<span id="cb464-10"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb464-10"></a><span class="st">  </span><span class="kw">theme_cowplot</span>()</span>
<span id="cb464-11"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb464-11"></a> )</span></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-38-2.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb465-1"></a><span class="co"># posterior</span></span>
<span id="cb465-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb465-2"></a>(p3 &lt;-</span>
<span id="cb465-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb465-3"></a><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb465-4"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb465-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta)) <span class="op">+</span></span>
<span id="cb465-5"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb465-5"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> Posterior),</span>
<span id="cb465-6"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb465-6"></a>              <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="op">+</span></span>
<span id="cb465-7"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb465-7"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Posterior&quot;</span>,</span>
<span id="cb465-8"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb465-8"></a>       <span class="dt">x =</span> <span class="kw">expression</span>(theta),</span>
<span id="cb465-9"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb465-9"></a>       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">p</span>(theta<span class="op">*</span><span class="st">&quot;|&quot;</span><span class="op">*</span>D))) <span class="op">+</span></span>
<span id="cb465-10"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb465-10"></a><span class="st">  </span><span class="kw">theme_cowplot</span>()</span>
<span id="cb465-11"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb465-11"></a> )</span></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-38-3.png" width="480" style="display: block; margin: auto;" /></p>
<p>Note how we saved each the plots as objects. There are many ways to combine multiple ggplots, such as stacking them one atop another like they’re presented in Figure 6.5. One of the earliest methods I learned was the good old <a href="http://www.cookbook-r.com/Graphs/Multiple_graphs_on_one_page_(ggplot2)/"><code>multiplot()</code> function</a>. For a long time I relied on <code>grid.arrange()</code> from the <a href="https://CRAN.R-project.org/package=gridExtra"><strong>gridExtra</strong> package</a> <span class="citation">(Auguie, <a href="#ref-R-gridExtra" role="doc-biblioref">2017</a>)</span>. But it’s hard to beat the elegant syntax from <a href="https://twitter.com/thomasp85">Thomas Lin Pedersen</a>’s <span class="citation">(<a href="#ref-R-patchwork" role="doc-biblioref">2019</a><a href="#ref-R-patchwork" role="doc-biblioref">b</a>)</span> <a href="https://patchwork.data-imaginist.com/"><strong>patchwork</strong> package</a>.</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb466-1"></a><span class="kw">library</span>(patchwork)</span>
<span id="cb466-2"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb466-2"></a></span>
<span id="cb466-3"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb466-3"></a>p1 <span class="op">/</span><span class="st"> </span>p2 <span class="op">/</span><span class="st"> </span>p3</span></code></pre></div>
<p><img src="06_files/figure-gfm/unnamed-chunk-39-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>We could have taken this same approach to combine all our subplots from the three columns and three rows of Figure 6.4. You can learn more about how to use <strong>patchwork</strong> this way <a href="https://patchwork.data-imaginist.com/articles/patchwork.html">here</a>. We’ll have many more opportunities to practice as we progress through the chapters.</p>
</div>
</div>
</div>
<div id="summary" class="section level2">
<h2><span class="header-section-number">6.5</span> Summary</h2>
<blockquote>
<p>The main point of this chapter was to demonstrate how Bayesian inference works when Bayes’ rule can be solved analytically, using mathematics alone, without numerical approximation…</p>
<p>Unfortunately, there are two severe limitations with this approach… Thus, although it is interesting and educational to see how Bayes’ rule can be solved analytically, we will have to abandon exact mathematical solutions when doing complex applications. We will instead use Markov chain Monte Carlo (MCMC) methods. (p. 139)</p>
</blockquote>
<p>And if you’re using this project, I imagine that’s exactly what you’re looking for. We want to use the power of a particular kind of MCMC, Hamiltonian Monte Carlo, through the interface of the <a href="https://github.com/paul-buerkner/brms"><strong>brms</strong> package</a>. Get excited. It’s coming.</p>
</div>
<div id="session-info-5" class="section level2 unnumbered">
<h2>Session info</h2>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#cb467-1"></a><span class="kw">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 3.6.3 (2020-02-29)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Catalina 10.15.3
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] patchwork_1.0.1.9000 cowplot_1.0.0.9000   forcats_0.5.0       
##  [4] stringr_1.4.0        dplyr_1.0.1          purrr_0.3.4         
##  [7] readr_1.3.1          tidyr_1.1.1          tibble_3.0.3        
## [10] ggplot2_3.3.2        tidyverse_1.3.0     
## 
## loaded via a namespace (and not attached):
##  [1] tidyselect_1.1.0 xfun_0.13        haven_2.2.0      lattice_0.20-38 
##  [5] colorspace_1.4-1 vctrs_0.3.4      generics_0.0.2   htmltools_0.5.0 
##  [9] yaml_2.2.1       utf8_1.1.4       rlang_0.4.7      pillar_1.4.6    
## [13] glue_1.4.2       withr_2.2.0      DBI_1.1.0        dbplyr_1.4.2    
## [17] modelr_0.1.6     readxl_1.3.1     lifecycle_0.2.0  munsell_0.5.0   
## [21] gtable_0.3.0     cellranger_1.1.0 rvest_0.3.5      evaluate_0.14   
## [25] labeling_0.3     knitr_1.28       fansi_0.4.1      broom_0.5.5     
## [29] Rcpp_1.0.5       scales_1.1.1     backports_1.1.9  jsonlite_1.7.0  
## [33] farver_2.0.3     fs_1.4.1         hms_0.5.3        digest_0.6.25   
## [37] stringi_1.4.6    bookdown_0.18    grid_3.6.3       cli_2.0.2       
## [41] tools_3.6.3      magrittr_1.5     crayon_1.3.4     pkgconfig_2.0.3 
## [45] ellipsis_0.3.1   xml2_1.3.1       reprex_0.3.0     lubridate_1.7.8 
## [49] assertthat_0.2.1 rmarkdown_2.1    httr_1.4.1       rstudioapi_0.11 
## [53] R6_2.4.1         nlme_3.1-144     compiler_3.6.3</code></pre>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-R-gridExtra">
<p>Auguie, B. (2017). <em>gridExtra: Miscellaneous functions for "grid" graphics</em>. <a href="https://CRAN.R-project.org/package=gridExtra">https://CRAN.R-project.org/package=gridExtra</a></p>
</div>
<div id="ref-kruschkeDoingBayesianData2015">
<p>Kruschke, J. K. (2015). <em>Doing Bayesian data analysis: A tutorial with R, JAGS, and Stan</em>. Academic Press. <a href="https://sites.google.com/site/doingbayesiandataanalysis/">https://sites.google.com/site/doingbayesiandataanalysis/</a></p>
</div>
<div id="ref-R-patchwork">
<p>Pedersen, T. L. (2019b). <em>patchwork: The composer of plots</em>. <a href="https://CRAN.R-project.org/package=patchwork">https://CRAN.R-project.org/package=patchwork</a></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bayes-rule.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="markov-chain-monte-carlo.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
