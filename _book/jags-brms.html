<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 JAGS brms | Doing Bayesian Data Analysis in brms and the tidyverse</title>
  <meta name="description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="8 JAGS brms | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="github-repo" content="ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 JAGS brms | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2020-09-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="markov-chain-monte-carlo.html"/>
<link rel="next" href="hierarchical-models.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What and why</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#we-have-updates"><i class="fa fa-check"></i>We have updates</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.1.0."><i class="fa fa-check"></i>Version 0.1.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.2.0."><i class="fa fa-check"></i>Version 0.2.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.3.0."><i class="fa fa-check"></i>Version 0.3.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#were-not-done-yet-and-i-could-use-your-help."><i class="fa fa-check"></i>We’re not done yet and I could use your help.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#thank-yous-are-in-order"><i class="fa fa-check"></i>Thank-you’s are in order</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html"><i class="fa fa-check"></i><b>1</b> What’s in This Book (Read This First!)</a><ul>
<li class="chapter" data-level="1.1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#real-people-can-read-this-book"><i class="fa fa-check"></i><b>1.1</b> Real people can read this book</a></li>
<li class="chapter" data-level="1.2" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-in-this-book"><i class="fa fa-check"></i><b>1.2</b> What’s in this book</a></li>
<li class="chapter" data-level="1.3" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-new-in-the-second-edition"><i class="fa fa-check"></i><b>1.3</b> What’s new in the second edition</a></li>
<li class="chapter" data-level="1.4" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#gimme-feedback-be-polite"><i class="fa fa-check"></i><b>1.4</b> Gimme feedback (be polite)</a></li>
<li class="chapter" data-level="1.5" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#thank-you"><i class="fa fa-check"></i><b>1.5</b> Thank you!</a></li>
<li class="chapter" data-level="" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html"><i class="fa fa-check"></i><b>2</b> Introduction: Credibility, Models, and Parameters</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#bayesian-inference-is-reallocation-of-credibility-across-possibilities"><i class="fa fa-check"></i><b>2.1</b> Bayesian inference is reallocation of credibility across possibilities</a><ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#data-are-noisy-and-inferences-are-probabilistic."><i class="fa fa-check"></i><b>2.1.1</b> Data are noisy and inferences are probabilistic.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#possibilities-are-parameter-values-in-descriptive-models"><i class="fa fa-check"></i><b>2.2</b> Possibilities are parameter values in descriptive models</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#the-steps-of-bayesian-data-analysis"><i class="fa fa-check"></i><b>2.3</b> The steps of Bayesian data analysis</a></li>
<li class="chapter" data-level="" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html"><i class="fa fa-check"></i><b>3</b> The R Programming Language</a><ul>
<li class="chapter" data-level="3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-software"><i class="fa fa-check"></i><b>3.1</b> Get the software</a><ul>
<li class="chapter" data-level="3.1.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-look-at-rstudio."><i class="fa fa-check"></i><b>3.1.1</b> A look at RStudio.</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-simple-example-of-r-in-action"><i class="fa fa-check"></i><b>3.2</b> A simple example of R in action</a><ul>
<li class="chapter" data-level="3.2.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-programs-used-with-this-book."><i class="fa fa-check"></i><b>3.2.1</b> Get the programs used with this book.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#basic-commands-and-operators-in-r"><i class="fa fa-check"></i><b>3.3</b> Basic commands and operators in R</a><ul>
<li class="chapter" data-level="3.3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#getting-help-in-r."><i class="fa fa-check"></i><b>3.3.1</b> Getting help in R.</a></li>
<li class="chapter" data-level="3.3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#arithmetic-and-logical-operators."><i class="fa fa-check"></i><b>3.3.2</b> Arithmetic and logical operators.</a></li>
<li class="chapter" data-level="3.3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#assignment-relational-operators-and-tests-of-equality."><i class="fa fa-check"></i><b>3.3.3</b> Assignment, relational operators, and tests of equality.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-types"><i class="fa fa-check"></i><b>3.4</b> Variable types</a><ul>
<li class="chapter" data-level="3.4.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#vector."><i class="fa fa-check"></i><b>3.4.1</b> Vector.</a></li>
<li class="chapter" data-level="3.4.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#factor."><i class="fa fa-check"></i><b>3.4.2</b> Factor.</a></li>
<li class="chapter" data-level="3.4.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#matrix-and-array."><i class="fa fa-check"></i><b>3.4.3</b> Matrix and array.</a></li>
<li class="chapter" data-level="3.4.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#list-and-data-frame."><i class="fa fa-check"></i><b>3.4.4</b> List and data frame.</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#loading-and-saving-data"><i class="fa fa-check"></i><b>3.5</b> Loading and saving data</a><ul>
<li class="chapter" data-level="3.5.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#the-read.csv-read_csv-and-read.table-read_table-functions."><i class="fa fa-check"></i><b>3.5.1</b> The <del>read.csv</del> <code>read_csv()</code> and <del>read.table</del> <code>read_table()</code> functions.</a></li>
<li class="chapter" data-level="3.5.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#saving-data-from-r."><i class="fa fa-check"></i><b>3.5.2</b> Saving data from R.</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#some-utility-functions"><i class="fa fa-check"></i><b>3.6</b> Some utility functions</a></li>
<li class="chapter" data-level="3.7" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-in-r"><i class="fa fa-check"></i><b>3.7</b> Programming in R</a><ul>
<li class="chapter" data-level="3.7.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-names-in-r."><i class="fa fa-check"></i><b>3.7.1</b> Variable names in R.</a></li>
<li class="chapter" data-level="3.7.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#running-a-program."><i class="fa fa-check"></i><b>3.7.2</b> Running a program.</a></li>
<li class="chapter" data-level="3.7.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-a-function."><i class="fa fa-check"></i><b>3.7.3</b> Programming a function.</a></li>
<li class="chapter" data-level="3.7.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#conditions-and-loops."><i class="fa fa-check"></i><b>3.7.4</b> Conditions and loops.</a></li>
<li class="chapter" data-level="3.7.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#measuring-processing-time."><i class="fa fa-check"></i><b>3.7.5</b> Measuring processing time.</a></li>
<li class="chapter" data-level="3.7.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#debugging."><i class="fa fa-check"></i><b>3.7.6</b> Debugging.</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#graphical-plots-opening-and-saving"><i class="fa fa-check"></i><b>3.8</b> Graphical plots: Opening and saving</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html"><i class="fa fa-check"></i><b>4</b> What is This Stuff Called Probability?</a><ul>
<li class="chapter" data-level="4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#the-set-of-all-possible-events"><i class="fa fa-check"></i><b>4.1</b> The set of all possible events</a></li>
<li class="chapter" data-level="4.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-outside-or-inside-the-head"><i class="fa fa-check"></i><b>4.2</b> Probability: Outside or inside the head</a><ul>
<li class="chapter" data-level="4.2.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#outside-the-head-long-run-relative-frequency."><i class="fa fa-check"></i><b>4.2.1</b> Outside the head: Long-run relative frequency.</a></li>
<li class="chapter" data-level="4.2.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#inside-the-head-subjective-belief."><i class="fa fa-check"></i><b>4.2.2</b> Inside the head: Subjective belief.</a></li>
<li class="chapter" data-level="4.2.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probabilities-assign-numbers-to-possibilities."><i class="fa fa-check"></i><b>4.2.3</b> Probabilities assign numbers to possibilities.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-distributions"><i class="fa fa-check"></i><b>4.3</b> Probability distributions</a><ul>
<li class="chapter" data-level="4.3.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#discrete-distributions-probability-mass."><i class="fa fa-check"></i><b>4.3.1</b> Discrete distributions: Probability mass.</a></li>
<li class="chapter" data-level="4.3.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#continuous-distributions-rendezvous-with-density."><i class="fa fa-check"></i><b>4.3.2</b> Continuous distributions: Rendezvous with density.</a></li>
<li class="chapter" data-level="4.3.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#mean-and-variance-of-a-distribution."><i class="fa fa-check"></i><b>4.3.3</b> Mean and variance of a distribution.</a></li>
<li class="chapter" data-level="4.3.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#highest-density-interval-hdi."><i class="fa fa-check"></i><b>4.3.4</b> Highest density interval (HDI).</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#two-way-distributions"><i class="fa fa-check"></i><b>4.4</b> Two-way distributions</a><ul>
<li class="chapter" data-level="4.4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#conditional-probability."><i class="fa fa-check"></i><b>4.4.1</b> Conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes-rule.html"><a href="bayes-rule.html"><i class="fa fa-check"></i><b>5</b> Bayes’ Rule</a><ul>
<li class="chapter" data-level="5.1" data-path="bayes-rule.html"><a href="bayes-rule.html#bayes-rule-1"><i class="fa fa-check"></i><b>5.1</b> Bayes’ rule</a><ul>
<li class="chapter" data-level="5.1.1" data-path="bayes-rule.html"><a href="bayes-rule.html#derived-from-definitions-of-conditional-probability."><i class="fa fa-check"></i><b>5.1.1</b> Derived from definitions of conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bayes-rule.html"><a href="bayes-rule.html#applied-to-parameters-and-data"><i class="fa fa-check"></i><b>5.2</b> Applied to parameters and data</a></li>
<li class="chapter" data-level="5.3" data-path="bayes-rule.html"><a href="bayes-rule.html#complete-examples-estimating-bias-in-a-coin"><i class="fa fa-check"></i><b>5.3</b> Complete examples: Estimating bias in a coin</a><ul>
<li class="chapter" data-level="5.3.1" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-sample-size-on-the-posterior."><i class="fa fa-check"></i><b>5.3.1</b> Influence of sample size on the posterior.</a></li>
<li class="chapter" data-level="5.3.2" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-prior-on-the-posterior."><i class="fa fa-check"></i><b>5.3.2</b> Influence of prior on the posterior.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="bayes-rule.html"><a href="bayes-rule.html#why-bayesian-inference-can-be-difficult"><i class="fa fa-check"></i><b>5.4</b> Why Bayesian inference can be difficult</a></li>
<li class="chapter" data-level="" data-path="bayes-rule.html"><a href="bayes-rule.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><i class="fa fa-check"></i><b>6</b> Inferring a Binomial Probability via Exact Mathematical Analysis</a><ul>
<li class="chapter" data-level="6.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-likelihood-function-the-bernoulli-distribution"><i class="fa fa-check"></i><b>6.1</b> The likelihood function: The Bernoulli distribution</a></li>
<li class="chapter" data-level="6.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#a-description-of-credibilities-the-beta-distribution"><i class="fa fa-check"></i><b>6.2</b> A description of credibilities: The beta distribution</a><ul>
<li class="chapter" data-level="6.2.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#specifying-a-beta-prior."><i class="fa fa-check"></i><b>6.2.1</b> Specifying a beta prior.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-posterior-beta"><i class="fa fa-check"></i><b>6.3</b> The posterior beta</a><ul>
<li class="chapter" data-level="6.3.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#posterior-is-compromise-of-prior-and-likelihood."><i class="fa fa-check"></i><b>6.3.1</b> Posterior is compromise of prior and likelihood.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#examples"><i class="fa fa-check"></i><b>6.4</b> Examples</a><ul>
<li class="chapter" data-level="6.4.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.1</b> Prior knowledge expressed as a beta distribution.</a></li>
<li class="chapter" data-level="6.4.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-that-cannot-be-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.2</b> Prior knowledge that cannot be expressed as a beta distribution.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#summary"><i class="fa fa-check"></i><b>6.5</b> Summary</a></li>
<li class="chapter" data-level="" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>7</b> Markov Chain Monte Carlo</a><ul>
<li class="chapter" data-level="7.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#approximating-a-distribution-with-a-large-sample"><i class="fa fa-check"></i><b>7.1</b> Approximating a distribution with a large sample</a></li>
<li class="chapter" data-level="7.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-simple-case-of-the-metropolis-algorithm"><i class="fa fa-check"></i><b>7.2</b> A simple case of the Metropolis algorithm</a><ul>
<li class="chapter" data-level="7.2.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-politician-stumbles-upon-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.2.1</b> A politician stumbles upon the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.2.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-random-walk."><i class="fa fa-check"></i><b>7.2.2</b> A random walk.</a></li>
<li class="chapter" data-level="7.2.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#general-properties-of-a-random-walk."><i class="fa fa-check"></i><b>7.2.3</b> General properties of a random walk.</a></li>
<li class="chapter" data-level="7.2.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#why-we-care."><i class="fa fa-check"></i><b>7.2.4</b> Why we care.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-metropolis-algorithm-more-generally"><i class="fa fa-check"></i><b>7.3</b> The Metropolis algorithm more generally</a><ul>
<li class="chapter" data-level="7.3.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#metropolis-algorithm-applied-to-bernoulli-likelihood-and-beta-prior."><i class="fa fa-check"></i><b>7.3.1</b> Metropolis algorithm applied to Bernoulli likelihood and beta prior.</a></li>
<li class="chapter" data-level="7.3.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#summary-of-metropolis-algorithm."><i class="fa fa-check"></i><b>7.3.2</b> Summary of Metropolis algorithm.</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#toward-gibbs-sampling-estimating-two-coin-biases"><i class="fa fa-check"></i><b>7.4</b> Toward Gibbs sampling: Estimating two coin biases</a><ul>
<li class="chapter" data-level="7.4.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#prior-likelihood-and-posterior-for-two-biases."><i class="fa fa-check"></i><b>7.4.1</b> Prior, likelihood and posterior for two biases.</a></li>
<li class="chapter" data-level="7.4.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-exact-formal-analysis."><i class="fa fa-check"></i><b>7.4.2</b> The posterior via exact formal analysis.</a></li>
<li class="chapter" data-level="7.4.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.4.3</b> The posterior via the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.4.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#gibbs-hamiltonian-monte-carlo-sampling."><i class="fa fa-check"></i><b>7.4.4</b> <del>Gibbs</del> Hamiltonian Monte Carlo sampling.</a></li>
<li class="chapter" data-level="7.4.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#is-there-a-difference-between-biases"><i class="fa fa-check"></i><b>7.4.5</b> Is there a difference between biases?</a></li>
<li class="chapter" data-level="7.4.6" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#terminology-mcmc."><i class="fa fa-check"></i><b>7.4.6</b> Terminology: MCMC.</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness-accuracy-and-efficiency"><i class="fa fa-check"></i><b>7.5</b> MCMC representativeness, accuracy, and efficiency</a><ul>
<li class="chapter" data-level="7.5.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness."><i class="fa fa-check"></i><b>7.5.1</b> MCMC representativeness.</a></li>
<li class="chapter" data-level="7.5.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-accuracy."><i class="fa fa-check"></i><b>7.5.2</b> MCMC accuracy.</a></li>
<li class="chapter" data-level="7.5.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-efficiency."><i class="fa fa-check"></i><b>7.5.3</b> MCMC efficiency.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="jags-brms.html"><a href="jags-brms.html"><i class="fa fa-check"></i><b>8</b> <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="8.1" data-path="jags-brms.html"><a href="jags-brms.html#jags-brms-and-its-relation-to-r"><i class="fa fa-check"></i><b>8.1</b> <del>JAGS</del> brms and its relation to R</a></li>
<li class="chapter" data-level="8.2" data-path="jags-brms.html"><a href="jags-brms.html#a-complete-example"><i class="fa fa-check"></i><b>8.2</b> A complete example</a><ul>
<li class="chapter" data-level="8.2.1" data-path="jags-brms.html"><a href="jags-brms.html#load-data."><i class="fa fa-check"></i><b>8.2.1</b> Load data.</a></li>
<li class="chapter" data-level="8.2.2" data-path="jags-brms.html"><a href="jags-brms.html#specify-model."><i class="fa fa-check"></i><b>8.2.2</b> Specify model.</a></li>
<li class="chapter" data-level="8.2.3" data-path="jags-brms.html"><a href="jags-brms.html#initialize-chains."><i class="fa fa-check"></i><b>8.2.3</b> Initialize chains.</a></li>
<li class="chapter" data-level="8.2.4" data-path="jags-brms.html"><a href="jags-brms.html#generate-chains."><i class="fa fa-check"></i><b>8.2.4</b> Generate chains.</a></li>
<li class="chapter" data-level="8.2.5" data-path="jags-brms.html"><a href="jags-brms.html#examine-chains."><i class="fa fa-check"></i><b>8.2.5</b> Examine chains.</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="jags-brms.html"><a href="jags-brms.html#simplified-scripts-for-frequently-used-analyses"><i class="fa fa-check"></i><b>8.3</b> Simplified scripts for frequently used analyses</a></li>
<li class="chapter" data-level="8.4" data-path="jags-brms.html"><a href="jags-brms.html#example-difference-of-biases"><i class="fa fa-check"></i><b>8.4</b> Example: Difference of biases</a></li>
<li class="chapter" data-level="8.5" data-path="jags-brms.html"><a href="jags-brms.html#sampling-from-the-prior-distribution-in-jags-brms"><i class="fa fa-check"></i><b>8.5</b> Sampling from the prior distribution in <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="8.6" data-path="jags-brms.html"><a href="jags-brms.html#probability-distributions-available-in-jags-brms"><i class="fa fa-check"></i><b>8.6</b> Probability distributions available in <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="8.6.1" data-path="jags-brms.html"><a href="jags-brms.html#defining-new-likelihood-functions."><i class="fa fa-check"></i><b>8.6.1</b> Defining new likelihood functions.</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="jags-brms.html"><a href="jags-brms.html#faster-sampling-with-parallel-processing-in-runjags-brmsbrm"><i class="fa fa-check"></i><b>8.7</b> Faster sampling with parallel processing in <del>runjags</del> <code>brms::brm()</code></a></li>
<li class="chapter" data-level="8.8" data-path="jags-brms.html"><a href="jags-brms.html#tips-for-expanding-jags-brms-models"><i class="fa fa-check"></i><b>8.8</b> Tips for expanding <del>JAGS</del> brms models</a></li>
<li class="chapter" data-level="" data-path="jags-brms.html"><a href="jags-brms.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>9</b> Hierarchical Models</a><ul>
<li class="chapter" data-level="9.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-single-coin-from-a-single-mint"><i class="fa fa-check"></i><b>9.1</b> A single coin from a single mint</a><ul>
<li class="chapter" data-level="9.1.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation."><i class="fa fa-check"></i><b>9.1.1</b> Posterior via grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#multiple-coins-from-a-single-mint"><i class="fa fa-check"></i><b>9.2</b> Multiple coins from a single mint</a><ul>
<li class="chapter" data-level="9.2.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation.-1"><i class="fa fa-check"></i><b>9.2.1</b> Posterior via grid approximation.</a></li>
<li class="chapter" data-level="9.2.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-realistic-model-with-mcmc."><i class="fa fa-check"></i><b>9.2.2</b> A realistic model with MCMC.</a></li>
<li class="chapter" data-level="9.2.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#doing-it-with-jags-brms."><i class="fa fa-check"></i><b>9.2.3</b> Doing it with <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="9.2.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-therapeutic-touch."><i class="fa fa-check"></i><b>9.2.4</b> Example: Therapeutic touch.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#shrinkage-in-hierarchical-models"><i class="fa fa-check"></i><b>9.3</b> Shrinkage in hierarchical models</a></li>
<li class="chapter" data-level="9.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#speeding-up-jags-brms"><i class="fa fa-check"></i><b>9.4</b> Speeding up <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="9.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#extending-the-hierarchy-subjects-within-categories"><i class="fa fa-check"></i><b>9.5</b> Extending the hierarchy: Subjects within categories</a><ul>
<li class="chapter" data-level="9.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-baseball-batting-abilities-by-position."><i class="fa fa-check"></i><b>9.5.1</b> Example: Baseball batting abilities by position.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hierarchical-models.html"><a href="hierarchical-models.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html"><i class="fa fa-check"></i><b>10</b> Model Comparison and Hierarchical Modeling</a><ul>
<li class="chapter" data-level="10.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#general-formula-and-the-bayes-factor"><i class="fa fa-check"></i><b>10.1</b> General formula and the Bayes factor</a></li>
<li class="chapter" data-level="10.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#example-two-factories-of-coins"><i class="fa fa-check"></i><b>10.2</b> Example: Two factories of coins</a><ul>
<li class="chapter" data-level="10.2.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-formal-analysis."><i class="fa fa-check"></i><b>10.2.1</b> Solution by formal analysis.</a></li>
<li class="chapter" data-level="10.2.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-grid-approximation."><i class="fa fa-check"></i><b>10.2.2</b> Solution by grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-mcmc"><i class="fa fa-check"></i><b>10.3</b> Solution by MCMC</a><ul>
<li class="chapter" data-level="10.3.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#nonhierarchical-mcmc-computation-of-each-models-marginal-likelihood."><i class="fa fa-check"></i><b>10.3.1</b> Nonhierarchical MCMC computation of each model’s marginal likelihood.</a></li>
<li class="chapter" data-level="10.3.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#hierarchical-mcmc-computation-of-relative-model-probability-is-not-available-in-brms-well-cover-information-criteria-instead."><i class="fa fa-check"></i><b>10.3.2</b> Hierarchical MCMC computation <del>of relative model probability</del> is not available in brms: We’ll cover information criteria instead.</a></li>
<li class="chapter" data-level="10.3.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#models-with-different-noise-distributions-in-jags-brms."><i class="fa fa-check"></i><b>10.3.3</b> Models with different “noise” distributions in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#prediction-model-averaging"><i class="fa fa-check"></i><b>10.4</b> Prediction: Model averaging</a></li>
<li class="chapter" data-level="10.5" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#model-complexity-naturally-accounted-for"><i class="fa fa-check"></i><b>10.5</b> Model complexity naturally accounted for</a><ul>
<li class="chapter" data-level="10.5.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#caveats-regarding-nested-model-comparison."><i class="fa fa-check"></i><b>10.5.1</b> Caveats regarding nested model comparison.</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#extreme-sensitivity-to-prior-distribution"><i class="fa fa-check"></i><b>10.6</b> Extreme sensitivity to prior distribution</a><ul>
<li class="chapter" data-level="10.6.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#priors-of-different-models-should-be-equally-informed."><i class="fa fa-check"></i><b>10.6.1</b> Priors of different models should be equally informed.</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#bonus-theres-danger-ahead"><i class="fa fa-check"></i><b>10.7</b> Bonus: There’s danger ahead</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html"><i class="fa fa-check"></i><b>11</b> Null Hypothesis Significance Testing</a><ul>
<li class="chapter" data-level="11.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#paved-with-good-intentions"><i class="fa fa-check"></i><b>11.1</b> Paved with good intentions</a><ul>
<li class="chapter" data-level="11.1.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#definition-of-p-value."><i class="fa fa-check"></i><b>11.1.1</b> Definition of <span class="math inline">\(p\)</span> value.</a></li>
<li class="chapter" data-level="11.1.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-n."><i class="fa fa-check"></i><b>11.1.2</b> With intention to fix <span class="math inline">\(N\)</span>.</a></li>
<li class="chapter" data-level="11.1.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-z."><i class="fa fa-check"></i><b>11.1.3</b> With intention to fix <span class="math inline">\(z\)</span>.</a></li>
<li class="chapter" data-level="11.1.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-duration."><i class="fa fa-check"></i><b>11.1.4</b> With intention to fix duration.</a></li>
<li class="chapter" data-level="11.1.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-make-multiple-tests."><i class="fa fa-check"></i><b>11.1.5</b> With intention to make multiple tests.</a></li>
<li class="chapter" data-level="11.1.6" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#soul-searching."><i class="fa fa-check"></i><b>11.1.6</b> Soul searching.</a></li>
<li class="chapter" data-level="11.1.7" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis."><i class="fa fa-check"></i><b>11.1.7</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#prior-knowledge"><i class="fa fa-check"></i><b>11.2</b> Prior knowledge</a><ul>
<li class="chapter" data-level="11.2.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-analysis."><i class="fa fa-check"></i><b>11.2.1</b> NHST analysis.</a></li>
<li class="chapter" data-level="11.2.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis.-1"><i class="fa fa-check"></i><b>11.2.2</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#confidence-interval-and-highest-density-interval"><i class="fa fa-check"></i><b>11.3</b> Confidence interval and highest density interval</a><ul>
<li class="chapter" data-level="11.3.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#ci-depends-on-intention."><i class="fa fa-check"></i><b>11.3.1</b> CI depends on intention.</a></li>
<li class="chapter" data-level="11.3.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-hdi."><i class="fa fa-check"></i><b>11.3.2</b> Bayesian HDI.</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#multiple-comparisons"><i class="fa fa-check"></i><b>11.4</b> Multiple comparisons</a><ul>
<li class="chapter" data-level="11.4.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-correction-for-experiment-wise-error."><i class="fa fa-check"></i><b>11.4.1</b> NHST correction for experiment wise error.</a></li>
<li class="chapter" data-level="11.4.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#just-one-bayesian-posterior-no-matter-how-you-look-at-it."><i class="fa fa-check"></i><b>11.4.2</b> Just one Bayesian posterior no matter how you look at it.</a></li>
<li class="chapter" data-level="11.4.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#how-bayesian-analysis-mitigates-false-alarms."><i class="fa fa-check"></i><b>11.4.3</b> How Bayesian analysis mitigates false alarms.</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#what-a-sampling-distribution-is-good-for"><i class="fa fa-check"></i><b>11.5</b> What a sampling distribution is good for</a><ul>
<li class="chapter" data-level="11.5.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#planning-an-experiment."><i class="fa fa-check"></i><b>11.5.1</b> Planning an experiment.</a></li>
<li class="chapter" data-level="11.5.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#exploring-model-predictions-posterior-predictive-check."><i class="fa fa-check"></i><b>11.5.2</b> Exploring model predictions (posterior predictive check).</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#session-info-10"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><i class="fa fa-check"></i><b>12</b> Bayesian Approaches to Testing a Point (“Null”) Hypothesis</a><ul>
<li class="chapter" data-level="12.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-estimation-approach"><i class="fa fa-check"></i><b>12.1</b> The estimation approach</a><ul>
<li class="chapter" data-level="12.1.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#region-of-practical-equivalence."><i class="fa fa-check"></i><b>12.1.1</b> Region of practical equivalence.</a></li>
<li class="chapter" data-level="12.1.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#some-examples."><i class="fa fa-check"></i><b>12.1.2</b> Some examples.</a></li>
<li class="chapter" data-level="12.1.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#differences-of-correlated-parameters."><i class="fa fa-check"></i><b>12.1.3</b> Differences of correlated parameters.</a></li>
<li class="chapter" data-level="12.1.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#why-hdi-and-not-equal-tailed-interval"><i class="fa fa-check"></i><b>12.1.4</b> Why HDI and not equal-tailed interval?</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-model-comparison-approach"><i class="fa fa-check"></i><b>12.2</b> The model-comparison approach</a><ul>
<li class="chapter" data-level="12.2.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#is-a-coin-fair-or-not"><i class="fa fa-check"></i><b>12.2.1</b> Is a coin fair or not?</a></li>
<li class="chapter" data-level="12.2.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#bayes-factor-can-accept-null-with-poor-precision."><i class="fa fa-check"></i><b>12.2.2</b> Bayes’ factor can accept null with poor precision.</a></li>
<li class="chapter" data-level="12.2.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#are-different-groups-equal-or-not"><i class="fa fa-check"></i><b>12.2.3</b> Are different groups equal or not?</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#relations-of-parameter-estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.3</b> Relations of parameter estimation and model comparison</a></li>
<li class="chapter" data-level="12.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.4</b> Estimation and model comparison?</a></li>
<li class="chapter" data-level="" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#session-info-11"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html"><i class="fa fa-check"></i><b>13</b> Goals, Power, and Sample Size</a><ul>
<li class="chapter" data-level="13.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-will-to-power"><i class="fa fa-check"></i><b>13.1</b> The will to power</a><ul>
<li class="chapter" data-level="13.1.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#goals-and-obstacles."><i class="fa fa-check"></i><b>13.1.1</b> Goals and obstacles.</a></li>
<li class="chapter" data-level="13.1.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power."><i class="fa fa-check"></i><b>13.1.2</b> Power.</a></li>
<li class="chapter" data-level="13.1.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sample-size."><i class="fa fa-check"></i><b>13.1.3</b> Sample size.</a></li>
<li class="chapter" data-level="13.1.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#other-expressions-of-goals."><i class="fa fa-check"></i><b>13.1.4</b> Other expressions of goals.</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#computing-power-and-sample-size"><i class="fa fa-check"></i><b>13.2</b> Computing power and sample size</a><ul>
<li class="chapter" data-level="13.2.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-to-exclude-a-null-value."><i class="fa fa-check"></i><b>13.2.1</b> When the goal is to exclude a null value.</a></li>
<li class="chapter" data-level="13.2.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#formal-solution-and-implementation-in-r."><i class="fa fa-check"></i><b>13.2.2</b> Formal solution and implementation in R.</a></li>
<li class="chapter" data-level="13.2.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-precision."><i class="fa fa-check"></i><b>13.2.3</b> When the goal is precision.</a></li>
<li class="chapter" data-level="13.2.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#monte-carlo-approximation-of-power."><i class="fa fa-check"></i><b>13.2.4</b> Monte Carlo approximation of power.</a></li>
<li class="chapter" data-level="13.2.5" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-from-idealized-or-actual-data."><i class="fa fa-check"></i><b>13.2.5</b> Power from idealized or actual data.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sequential-testing-and-the-goal-of-precision"><i class="fa fa-check"></i><b>13.3</b> Sequential testing and the goal of precision</a><ul>
<li class="chapter" data-level="13.3.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#examples-ofsequential-tests."><i class="fa fa-check"></i><b>13.3.1</b> Examples ofsequential tests.</a></li>
<li class="chapter" data-level="13.3.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#average-behavior-of-sequential-tests."><i class="fa fa-check"></i><b>13.3.2</b> Average behavior of sequential tests.</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#discussion"><i class="fa fa-check"></i><b>13.4</b> Discussion</a><ul>
<li class="chapter" data-level="13.4.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-and-multiple-comparisons."><i class="fa fa-check"></i><b>13.4.1</b> Power and multiple comparisons.</a></li>
<li class="chapter" data-level="13.4.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-prospective-retrospective-and-replication."><i class="fa fa-check"></i><b>13.4.2</b> Power: prospective, retrospective, and replication.</a></li>
<li class="chapter" data-level="13.4.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-analysis-requires-verisimilitude-of-simulated-data."><i class="fa fa-check"></i><b>13.4.3</b> Power analysis requires verisimilitude of simulated data.</a></li>
<li class="chapter" data-level="13.4.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-importance-of-planning."><i class="fa fa-check"></i><b>13.4.4</b> The importance of planning.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#session-info-12"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="stan.html"><a href="stan.html"><i class="fa fa-check"></i><b>14</b> Stan</a><ul>
<li class="chapter" data-level="14.1" data-path="stan.html"><a href="stan.html#hmc-sampling"><i class="fa fa-check"></i><b>14.1</b> HMC sampling</a></li>
<li class="chapter" data-level="14.2" data-path="stan.html"><a href="stan.html#installing-stan"><i class="fa fa-check"></i><b>14.2</b> Installing Stan</a></li>
<li class="chapter" data-level="14.3" data-path="stan.html"><a href="stan.html#a-complete-example-1"><i class="fa fa-check"></i><b>14.3</b> A Complete example</a><ul>
<li class="chapter" data-level="14.3.1" data-path="stan.html"><a href="stan.html#reusing-the-compiled-model."><i class="fa fa-check"></i><b>14.3.1</b> Reusing the compiled model.</a></li>
<li class="chapter" data-level="14.3.2" data-path="stan.html"><a href="stan.html#general-structure-of-stan-model-specification."><i class="fa fa-check"></i><b>14.3.2</b> General structure of Stan model specification.</a></li>
<li class="chapter" data-level="14.3.3" data-path="stan.html"><a href="stan.html#think-log-probability-to-think-like-stan."><i class="fa fa-check"></i><b>14.3.3</b> Think log probability to think like Stan.</a></li>
<li class="chapter" data-level="14.3.4" data-path="stan.html"><a href="stan.html#sampling-the-prior-in-stan."><i class="fa fa-check"></i><b>14.3.4</b> Sampling the prior in Stan.</a></li>
<li class="chapter" data-level="14.3.5" data-path="stan.html"><a href="stan.html#simplified-scripts-for-frequently-used-analyses."><i class="fa fa-check"></i><b>14.3.5</b> Simplified scripts for frequently used analyses.</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="stan.html"><a href="stan.html#specify-models-top-down-in-stan"><i class="fa fa-check"></i><b>14.4</b> Specify models top-down in Stan</a></li>
<li class="chapter" data-level="14.5" data-path="stan.html"><a href="stan.html#limitations-and-extras"><i class="fa fa-check"></i><b>14.5</b> Limitations and extras</a></li>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#session-info-13"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>15</b> Overview of the Generalized Linear Model</a><ul>
<li class="chapter" data-level="15.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#types-of-variables"><i class="fa fa-check"></i><b>15.1</b> Types of variables</a><ul>
<li class="chapter" data-level="15.1.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#predictor-and-predicted-variables."><i class="fa fa-check"></i><b>15.1.1</b> Predictor and predicted variables.</a></li>
<li class="chapter" data-level="15.1.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#scale-types-metric-ordinal-nominal-and-count."><i class="fa fa-check"></i><b>15.1.2</b> Scale types: metric, ordinal, nominal, and count.</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-combination-of-predictors"><i class="fa fa-check"></i><b>15.2</b> Linear combination of predictors</a><ul>
<li class="chapter" data-level="15.2.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-function-of-a-single-metric-predictor."><i class="fa fa-check"></i><b>15.2.1</b> Linear function of a single metric predictor.</a></li>
<li class="chapter" data-level="15.2.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#additive-combination-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.2</b> Additive combination of metric predictors.</a></li>
<li class="chapter" data-level="15.2.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nonadditive-interaction-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.3</b> Nonadditive interaction of metric predictors.</a></li>
<li class="chapter" data-level="15.2.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nominal-predictors."><i class="fa fa-check"></i><b>15.2.4</b> Nominal predictors.</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linking-from-combined-predictors-to-noisy-predicted-data"><i class="fa fa-check"></i><b>15.3</b> Linking from combined predictors to noisy predicted data</a><ul>
<li class="chapter" data-level="15.3.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predictors-to-predicted-central-tendency."><i class="fa fa-check"></i><b>15.3.1</b> From predictors to predicted central tendency.</a></li>
<li class="chapter" data-level="15.3.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predicted-central-tendency-to-noisy-data."><i class="fa fa-check"></i><b>15.3.2</b> From predicted central tendency to noisy data.</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#formal-expression-of-the-glm"><i class="fa fa-check"></i><b>15.4</b> Formal expression of the GLM</a><ul>
<li class="chapter" data-level="15.4.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#cases-of-the-glm."><i class="fa fa-check"></i><b>15.4.1</b> Cases of the GLM.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#session-info-14"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html"><i class="fa fa-check"></i><b>16</b> Metric-Predicted Variable on One or Two Groups</a><ul>
<li class="chapter" data-level="16.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#estimating-the-mean-and-standard-deviation-of-a-normal-distribution"><i class="fa fa-check"></i><b>16.1</b> Estimating the mean and standard deviation of a normal distribution</a><ul>
<li class="chapter" data-level="16.1.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#solution-by-mathematical-analysis-heads-up-on-precision."><i class="fa fa-check"></i><b>16.1.1</b> <del>Solution by mathematical analysis</del> Heads up on precision.</a></li>
<li class="chapter" data-level="16.1.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#approximation-by-mcmc-in-jags-hmc-in-brms."><i class="fa fa-check"></i><b>16.1.2</b> Approximation by <del>MCMC in JAGS</del> HMC in brms.</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#outliers-and-robust-estimation-the-t-distribution"><i class="fa fa-check"></i><b>16.2</b> Outliers and robust estimation: The <span class="math inline">\(t\)</span> distribution</a><ul>
<li class="chapter" data-level="16.2.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-jags-brms."><i class="fa fa-check"></i><b>16.2.1</b> Using the <span class="math inline">\(t\)</span> distribution in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="16.2.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-stan."><i class="fa fa-check"></i><b>16.2.2</b> Using the <span class="math inline">\(t\)</span> distribution in Stan.</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#two-groups"><i class="fa fa-check"></i><b>16.3</b> Two groups</a><ul>
<li class="chapter" data-level="16.3.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#analysis-by-nhst."><i class="fa fa-check"></i><b>16.3.1</b> Analysis by NHST.</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#other-noise-distributions-and-transforming-data"><i class="fa fa-check"></i><b>16.4</b> Other noise distributions and transforming data</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#session-info-15"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html"><i class="fa fa-check"></i><b>17</b> Metric Predicted Variable with One Metric Predictor</a><ul>
<li class="chapter" data-level="17.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#simple-linear-regression"><i class="fa fa-check"></i><b>17.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="17.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression"><i class="fa fa-check"></i><b>17.2</b> Robust linear regression</a><ul>
<li class="chapter" data-level="17.2.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-jags-brms."><i class="fa fa-check"></i><b>17.2.1</b> Robust linear regression in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.2.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-stan."><i class="fa fa-check"></i><b>17.2.2</b> Robust linear regression in Stan.</a></li>
<li class="chapter" data-level="17.2.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#stan-or-jags"><i class="fa fa-check"></i><b>17.2.3</b> Stan or JAGS?</a></li>
<li class="chapter" data-level="17.2.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#interpreting-the-posterior-distribution."><i class="fa fa-check"></i><b>17.2.4</b> Interpreting the posterior distribution.</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#hierarchical-regression-on-individuals-within-groups"><i class="fa fa-check"></i><b>17.3</b> Hierarchical regression on individuals within groups</a><ul>
<li class="chapter" data-level="17.3.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>17.3.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.3.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-posterior-distribution-shrinkage-and-prediction."><i class="fa fa-check"></i><b>17.3.2</b> The posterior distribution: Shrinkage and prediction.</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#quadratic-trend-and-weighted-data"><i class="fa fa-check"></i><b>17.4</b> Quadratic trend and weighted data</a><ul>
<li class="chapter" data-level="17.4.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#results-and-interpretation."><i class="fa fa-check"></i><b>17.4.1</b> Results and interpretation.</a></li>
<li class="chapter" data-level="17.4.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#further-extensions."><i class="fa fa-check"></i><b>17.4.2</b> Further extensions.</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#procedure-and-perils-for-expanding-a-model"><i class="fa fa-check"></i><b>17.5</b> Procedure and perils for expanding a model</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#session-info-16"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html"><i class="fa fa-check"></i><b>18</b> Metric Predicted Variable with Multiple Metric Predictors</a><ul>
<li class="chapter" data-level="18.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiple-linear-regression"><i class="fa fa-check"></i><b>18.1</b> Multiple linear regression</a><ul>
<li class="chapter" data-level="18.1.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-perils-of-correlated-predictors."><i class="fa fa-check"></i><b>18.1.1</b> The perils of correlated predictors.</a></li>
<li class="chapter" data-level="18.1.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-model-and-implementation."><i class="fa fa-check"></i><b>18.1.2</b> The model and implementation.</a></li>
<li class="chapter" data-level="18.1.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-posterior-distribution."><i class="fa fa-check"></i><b>18.1.3</b> The posterior distribution.</a></li>
<li class="chapter" data-level="18.1.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#redundant-predictors."><i class="fa fa-check"></i><b>18.1.4</b> Redundant predictors.</a></li>
<li class="chapter" data-level="18.1.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#informative-priors-sparse-data-and-correlated-predictors."><i class="fa fa-check"></i><b>18.1.5</b> Informative priors, sparse data, and correlated predictors.</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiplicative-interaction-of-metric-predictors"><i class="fa fa-check"></i><b>18.2</b> Multiplicative interaction of metric predictors</a><ul>
<li class="chapter" data-level="18.2.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#an-example."><i class="fa fa-check"></i><b>18.2.1</b> An example.</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#shrinkage-of-regression-coefficients"><i class="fa fa-check"></i><b>18.3</b> Shrinkage of regression coefficients</a></li>
<li class="chapter" data-level="18.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection"><i class="fa fa-check"></i><b>18.4</b> Variable selection</a><ul>
<li class="chapter" data-level="18.4.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#inclusion-probability-is-strongly-affected-by-vagueness-of-prior."><i class="fa fa-check"></i><b>18.4.1</b> Inclusion probability is strongly affected by vagueness of prior.</a></li>
<li class="chapter" data-level="18.4.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection-with-hierarchical-shrinkage."><i class="fa fa-check"></i><b>18.4.2</b> Variable selection with hierarchical shrinkage.</a></li>
<li class="chapter" data-level="18.4.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#what-to-report-and-what-to-conclude."><i class="fa fa-check"></i><b>18.4.3</b> What to report and what to conclude.</a></li>
<li class="chapter" data-level="18.4.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-computational-methods."><i class="fa fa-check"></i><b>18.4.4</b> Caution: Computational methods.</a></li>
<li class="chapter" data-level="18.4.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-interaction-variables."><i class="fa fa-check"></i><b>18.4.5</b> Caution: Interaction variables.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#session-info-17"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html"><i class="fa fa-check"></i><b>19</b> Metric Predicted Variable with One Nominal Predictor</a><ul>
<li class="chapter" data-level="19.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#describing-multiple-groups-of-metric-data"><i class="fa fa-check"></i><b>19.1</b> Describing multiple groups of metric data</a></li>
<li class="chapter" data-level="19.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#traditional-analysis-of-variance"><i class="fa fa-check"></i><b>19.2</b> Traditional analysis of variance</a></li>
<li class="chapter" data-level="19.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#hierarchical-bayesian-approach"><i class="fa fa-check"></i><b>19.3</b> Hierarchical Bayesian approach</a><ul>
<li class="chapter" data-level="19.3.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#implementation-in-jags-brms."><i class="fa fa-check"></i><b>19.3.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="19.3.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-and-death."><i class="fa fa-check"></i><b>19.3.2</b> Example: Sex and death.</a></li>
<li class="chapter" data-level="19.3.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#contrasts."><i class="fa fa-check"></i><b>19.3.3</b> Contrasts.</a></li>
<li class="chapter" data-level="19.3.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#multiple-comparisons-and-shrinkage."><i class="fa fa-check"></i><b>19.3.4</b> Multiple comparisons and shrinkage.</a></li>
<li class="chapter" data-level="19.3.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#the-two-group-case."><i class="fa fa-check"></i><b>19.3.5</b> The two-group case.</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#including-a-metric-predictor"><i class="fa fa-check"></i><b>19.4</b> Including a metric predictor</a><ul>
<li class="chapter" data-level="19.4.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-death-and-size."><i class="fa fa-check"></i><b>19.4.1</b> Example: Sex, death, and size.</a></li>
<li class="chapter" data-level="19.4.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#analogous-to-traditional-ancova."><i class="fa fa-check"></i><b>19.4.2</b> Analogous to traditional ANCOVA.</a></li>
<li class="chapter" data-level="19.4.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#relation-to-hierarchical-linear-regression."><i class="fa fa-check"></i><b>19.4.3</b> Relation to hierarchical linear regression.</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#heterogeneous-variances-and-robustness-against-outliers"><i class="fa fa-check"></i><b>19.5</b> Heterogeneous variances and robustness against outliers</a><ul>
<li class="chapter" data-level="19.5.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-contrast-of-means-with-different-variances."><i class="fa fa-check"></i><b>19.5.1</b> Example: Contrast of means with different variances.</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#exercises-walk-out-an-effect-size"><i class="fa fa-check"></i><b>19.6</b> <del>Exercises</del> Walk out an effect size</a><ul>
<li class="chapter" data-level="19.6.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#populations-and-samples."><i class="fa fa-check"></i><b>19.6.1</b> Populations and samples.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#session-info-18"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html"><i class="fa fa-check"></i><b>20</b> Metric Predicted Variable with Multiple Nominal Predictors</a><ul>
<li class="chapter" data-level="20.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#describing-groups-of-metric-data-with-multiple-nominal-predictors"><i class="fa fa-check"></i><b>20.1</b> Describing groups of metric data with multiple nominal predictors</a><ul>
<li class="chapter" data-level="20.1.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction."><i class="fa fa-check"></i><b>20.1.1</b> Interaction.</a></li>
<li class="chapter" data-level="20.1.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#traditional-anova."><i class="fa fa-check"></i><b>20.1.2</b> Traditional ANOVA.</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#hierarchical-bayesian-approach-1"><i class="fa fa-check"></i><b>20.2</b> Hierarchical Bayesian approach</a><ul>
<li class="chapter" data-level="20.2.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>20.2.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="20.2.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#example-its-only-money."><i class="fa fa-check"></i><b>20.2.2</b> Example: It’s only money.</a></li>
<li class="chapter" data-level="20.2.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#main-effect-contrasts."><i class="fa fa-check"></i><b>20.2.3</b> Main effect contrasts.</a></li>
<li class="chapter" data-level="20.2.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction-contrasts-and-simple-effects."><i class="fa fa-check"></i><b>20.2.4</b> Interaction contrasts and simple effects.</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#rescaling-can-change-interactions-homogeneity-and-normality"><i class="fa fa-check"></i><b>20.3</b> Rescaling can change interactions, homogeneity, and normality</a></li>
<li class="chapter" data-level="20.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#heterogeneous-variances-and-robustness-against-outliers-1"><i class="fa fa-check"></i><b>20.4</b> Heterogeneous variances and robustness against outliers</a></li>
<li class="chapter" data-level="20.5" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#within-subject-designs"><i class="fa fa-check"></i><b>20.5</b> Within-subject designs</a><ul>
<li class="chapter" data-level="20.5.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#why-use-a-within-subject-design-and-why-not"><i class="fa fa-check"></i><b>20.5.1</b> Why use a within-subject design? And why not?</a></li>
<li class="chapter" data-level="20.5.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#split-plot-design."><i class="fa fa-check"></i><b>20.5.2</b> Split-plot design.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#session-info-19"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#footnote"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html"><i class="fa fa-check"></i><b>21</b> Dichotomous Predicted Variable</a><ul>
<li class="chapter" data-level="21.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-metric-predictors"><i class="fa fa-check"></i><b>21.1</b> Multiple metric predictors</a><ul>
<li class="chapter" data-level="21.1.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#the-model-and-implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>21.1.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="21.1.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#example-height-weight-and-gender."><i class="fa fa-check"></i><b>21.1.2</b> Example: Height, weight, and gender.</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interpreting-the-regression-coefficients"><i class="fa fa-check"></i><b>21.2</b> Interpreting the regression coefficients</a><ul>
<li class="chapter" data-level="21.2.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#log-odds."><i class="fa fa-check"></i><b>21.2.1</b> Log odds.</a></li>
<li class="chapter" data-level="21.2.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#when-there-are-few-1s-or-0s-in-the-data."><i class="fa fa-check"></i><b>21.2.2</b> When there are few 1’s or 0’s in the data.</a></li>
<li class="chapter" data-level="21.2.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#correlated-predictors."><i class="fa fa-check"></i><b>21.2.3</b> Correlated predictors.</a></li>
<li class="chapter" data-level="21.2.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interaction-of-metric-predictors."><i class="fa fa-check"></i><b>21.2.4</b> Interaction of metric predictors.</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#robust-logistic-regression"><i class="fa fa-check"></i><b>21.3</b> Robust logistic regression</a></li>
<li class="chapter" data-level="21.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#nominal-predictors"><i class="fa fa-check"></i><b>21.4</b> Nominal predictors</a><ul>
<li class="chapter" data-level="21.4.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#single-group."><i class="fa fa-check"></i><b>21.4.1</b> Single group.</a></li>
<li class="chapter" data-level="21.4.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-groups."><i class="fa fa-check"></i><b>21.4.2</b> Multiple groups.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#session-info-20"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html"><i class="fa fa-check"></i><b>22</b> Nominal Predicted Variable</a><ul>
<li class="chapter" data-level="22.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-regression"><i class="fa fa-check"></i><b>22.1</b> Softmax regression</a><ul>
<li class="chapter" data-level="22.1.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-reduces-to-logistic-for-two-outcomes."><i class="fa fa-check"></i><b>22.1.1</b> Softmax reduces to logistic for two outcomes.</a></li>
<li class="chapter" data-level="22.1.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#independence-from-irrelevant-attributes."><i class="fa fa-check"></i><b>22.1.2</b> Independence from irrelevant attributes.</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#conditional-logistic-regression"><i class="fa fa-check"></i><b>22.2</b> Conditional logistic regression</a></li>
<li class="chapter" data-level="22.3" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#implementation-in-jags-brms"><i class="fa fa-check"></i><b>22.3</b> Implementation in <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="22.3.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-model."><i class="fa fa-check"></i><b>22.3.1</b> Softmax model.</a></li>
<li class="chapter" data-level="22.3.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#conditional-logistic-model."><i class="fa fa-check"></i><b>22.3.2</b> Conditional logistic model.</a></li>
<li class="chapter" data-level="22.3.3" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#results-interpreting-the-regression-coefficients."><i class="fa fa-check"></i><b>22.3.3</b> Results: Interpreting the regression coefficients.</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#generalizations-and-variations-of-the-models"><i class="fa fa-check"></i><b>22.4</b> Generalizations and variations of the models</a></li>
<li class="chapter" data-level="" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#session-info-21"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html"><i class="fa fa-check"></i><b>23</b> Ordinal Predicted Variable</a><ul>
<li class="chapter" data-level="23.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#modeling-ordinal-data-with-an-underlying-metric-variable"><i class="fa fa-check"></i><b>23.1</b> Modeling ordinal data with an underlying metric variable</a></li>
<li class="chapter" data-level="23.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-a-single-group"><i class="fa fa-check"></i><b>23.2</b> The case of a single group</a><ul>
<li class="chapter" data-level="23.2.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-3"><i class="fa fa-check"></i><b>23.2.1</b> Implementation in <del>JAGS</del> <strong>brms</strong>.</a></li>
<li class="chapter" data-level="23.2.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#examples-bayesian-estimation-recovers-true-parameter-values."><i class="fa fa-check"></i><b>23.2.2</b> Examples: Bayesian estimation recovers true parameter values.</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-two-groups"><i class="fa fa-check"></i><b>23.3</b> The case of two groups</a><ul>
<li class="chapter" data-level="23.3.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-4"><i class="fa fa-check"></i><b>23.3.1</b> Implementation in <del>JAGS</del> <strong>brms</strong>.</a></li>
<li class="chapter" data-level="23.3.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#examples-not-funny."><i class="fa fa-check"></i><b>23.3.2</b> Examples: Not funny.</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-metric-predictors"><i class="fa fa-check"></i><b>23.4</b> The Case of metric predictors</a><ul>
<li class="chapter" data-level="23.4.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-5"><i class="fa fa-check"></i><b>23.4.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="23.4.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#example-happiness-and-money."><i class="fa fa-check"></i><b>23.4.2</b> Example: Happiness and money.</a></li>
<li class="chapter" data-level="23.4.3" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#example-moviesthey-dont-make-em-like-they-used-to."><i class="fa fa-check"></i><b>23.4.3</b> Example: Movies–They don’t make ’em like they used to.</a></li>
<li class="chapter" data-level="23.4.4" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#why-are-some-thresholds-outside-the-data"><i class="fa fa-check"></i><b>23.4.4</b> Why are some thresholds outside the data?</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#posterior-prediction"><i class="fa fa-check"></i><b>23.5</b> Posterior prediction</a></li>
<li class="chapter" data-level="23.6" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#generalizations-and-extensions"><i class="fa fa-check"></i><b>23.6</b> Generalizations and extensions</a></li>
<li class="chapter" data-level="" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#session-info-22"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html"><i class="fa fa-check"></i><b>24</b> Count Predicted Variable</a><ul>
<li class="chapter" data-level="24.1" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#poisson-exponential-model"><i class="fa fa-check"></i><b>24.1</b> Poisson exponential model</a><ul>
<li class="chapter" data-level="24.1.1" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#data-structure."><i class="fa fa-check"></i><b>24.1.1</b> Data structure.</a></li>
<li class="chapter" data-level="24.1.2" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#exponential-link-function."><i class="fa fa-check"></i><b>24.1.2</b> Exponential link function.</a></li>
<li class="chapter" data-level="24.1.3" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#poisson-noise-distribution."><i class="fa fa-check"></i><b>24.1.3</b> Poisson noise distribution.</a></li>
<li class="chapter" data-level="24.1.4" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#the-complete-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>24.1.4</b> The complete model and implementation in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#example-hair-eye-go-again"><i class="fa fa-check"></i><b>24.2</b> Example: Hair eye go again</a></li>
<li class="chapter" data-level="24.3" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#example-interaction-contrasts-shrinkage-and-omnibus-test"><i class="fa fa-check"></i><b>24.3</b> Example: Interaction contrasts, shrinkage, and omnibus test</a></li>
<li class="chapter" data-level="24.4" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#log-linear-models-for-contingency-tables-bonus-alternative-parameterization"><i class="fa fa-check"></i><b>24.4</b> <del>Log-linear models for contingency tables</del> Bonus: Alternative parameterization</a></li>
<li class="chapter" data-level="" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#session-info-23"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html"><i class="fa fa-check"></i><b>25</b> Tools in the Trunk</a><ul>
<li class="chapter" data-level="25.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reporting-a-bayesian-analysis"><i class="fa fa-check"></i><b>25.1</b> Reporting a Bayesian analysis</a><ul>
<li class="chapter" data-level="25.1.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#essential-points."><i class="fa fa-check"></i><b>25.1.1</b> Essential points.</a></li>
<li class="chapter" data-level="25.1.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#optional-points."><i class="fa fa-check"></i><b>25.1.2</b> Optional points.</a></li>
<li class="chapter" data-level="25.1.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#helpful-points."><i class="fa fa-check"></i><b>25.1.3</b> Helpful points.</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#functions-for-computing-highest-density-intervals"><i class="fa fa-check"></i><b>25.2</b> Functions for computing highest density intervals</a><ul>
<li class="chapter" data-level="25.2.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-grid-approximation."><i class="fa fa-check"></i><b>25.2.1</b> R code for computing HDI of a grid approximation.</a></li>
<li class="chapter" data-level="25.2.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#hdi-of-unimodal-distribution-is-shortest-interval."><i class="fa fa-check"></i><b>25.2.2</b> HDI of unimodal distribution is shortest interval.</a></li>
<li class="chapter" data-level="25.2.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-mcmc-sample."><i class="fa fa-check"></i><b>25.2.3</b> R code for computing HDI of a MCMC sample.</a></li>
<li class="chapter" data-level="25.2.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-function."><i class="fa fa-check"></i><b>25.2.4</b> R code for computing HDI of a function.</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reparameterization"><i class="fa fa-check"></i><b>25.3</b> Reparameterization</a></li>
<li class="chapter" data-level="25.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#censored-data-in-jags-brms"><i class="fa fa-check"></i><b>25.4</b> Censored Data in <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="25.5" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#what-next"><i class="fa fa-check"></i><b>25.5</b> What Next?</a></li>
<li class="chapter" data-level="" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#session-info-24"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Doing Bayesian Data Analysis</em> in brms and the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="jags-brms" class="section level1">
<h1><span class="header-section-number">8</span> <del>JAGS</del> brms</h1>
<p>We, of course, will be using <strong>brms</strong> in place of JAGS.</p>
<div id="jags-brms-and-its-relation-to-r" class="section level2">
<h2><span class="header-section-number">8.1</span> <del>JAGS</del> brms and its relation to R</h2>
<p>In the opening paragraph in his <a href="https://github.com/paul-buerkner/brms">GitHub repository for <strong>brms</strong></a>, Bürkner explained:</p>
<blockquote>
<p>The <strong>brms</strong> package provides an interface to fit Bayesian generalized (non-)linear multivariate multilevel models using Stan, which is a C++ package for performing full Bayesian inference (see <a href="http://mc-stan.org/">http://mc-stan.org/</a>). The formula syntax is very similar to that of the package lme4 to provide a familiar and simple interface for performing regression analyses. A wide range of response distributions are supported, allowing users to fit – among others – linear, robust linear, count data, survival, response times, ordinal, zero-inflated, and even self-defined mixture models all in a multilevel context. Further modeling options include non-linear and smooth terms, auto-correlation structures, censored data, missing value imputation, and quite a few more. In addition, all parameters of the response distribution can be predicted in order to perform distributional regression. Multivariate models (i.e., models with multiple response variables) can be fit, as well. Prior specifications are flexible and explicitly encourage users to apply prior distributions that actually reflect their beliefs. Model fit can easily be assessed and compared with posterior predictive checks, cross-validation, and Bayes factors. (<strong>emphasis</strong> in the original)</p>
</blockquote>
<p>Bürkner’s <strong>brms</strong> repository includes many helpful links, such as to where <a href="https://CRAN.R-project.org/package=brms"><strong>brms</strong> lives on CRAN</a>, a <a href="https://paul-buerkner.github.io/blog/brms-blogposts/">list of blog posts</a> highlighting <strong>brms</strong>, and <a href="https://discourse.mc-stan.org">a forum</a> where users can ask questions about <strong>brms</strong> in specific or about Stan in general.</p>
<p>You can install the current official version of <strong>brms</strong> in the same way you would any other <strong>R</strong> package (i.e., <code>install.packages("brms", dependencies = T)</code>). If you want the current developmental version, you could download it from GitHub by executing the following.</p>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="jags-brms.html#cb557-1"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw">requireNamespace</span>(<span class="st">&quot;devtools&quot;</span>)) {</span>
<span id="cb557-2"><a href="jags-brms.html#cb557-2"></a>  <span class="kw">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</span>
<span id="cb557-3"><a href="jags-brms.html#cb557-3"></a>}</span>
<span id="cb557-4"><a href="jags-brms.html#cb557-4"></a>devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;paul-buerkner/brms&quot;</span>)</span></code></pre></div>
</div>
<div id="a-complete-example" class="section level2">
<h2><span class="header-section-number">8.2</span> A complete example</h2>
<p>We express the likelihood for our coin toss example as</p>
<p><span class="math display">\[y_{i} \sim \operatorname{Bernoulli}(\theta).\]</span></p>
<p>Our prior will be</p>
<p><span class="math display">\[\theta \sim \operatorname{Beta}(\alpha, \beta).\]</span></p>
<p>Kruschke pictured the relationships among the data, the likelihood, and the prior in the model diagram in Figure 8.2 (p. 196). If you’re tricky, you can make those in <strong>R</strong>. I’m not going to walk my method out in great detail in this ebook. If you want a step-by-step tutorial, check my blog post, <a href="https://solomonkurz.netlify.app/post/make-model-diagrams-kruschke-style/"><em>Make model diagrams, Kruschke style</em></a>. Here’s the code for our version of Figure 8.2.</p>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="jags-brms.html#cb558-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb558-2"><a href="jags-brms.html#cb558-2"></a><span class="kw">library</span>(patchwork)</span>
<span id="cb558-3"><a href="jags-brms.html#cb558-3"></a></span>
<span id="cb558-4"><a href="jags-brms.html#cb558-4"></a><span class="co"># plot of a beta density</span></span>
<span id="cb558-5"><a href="jags-brms.html#cb558-5"></a>p1 &lt;-</span>
<span id="cb558-6"><a href="jags-brms.html#cb558-6"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">.01</span>, <span class="dt">to =</span> <span class="fl">.99</span>, <span class="dt">by =</span> <span class="fl">.01</span>),</span>
<span id="cb558-7"><a href="jags-brms.html#cb558-7"></a>         <span class="dt">d =</span> (<span class="kw">dbeta</span>(x, <span class="dv">2</span>, <span class="dv">2</span>)) <span class="op">/</span><span class="st"> </span><span class="kw">max</span>(<span class="kw">dbeta</span>(x, <span class="dv">2</span>, <span class="dv">2</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb558-8"><a href="jags-brms.html#cb558-8"></a><span class="st">  </span></span>
<span id="cb558-9"><a href="jags-brms.html#cb558-9"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> d)) <span class="op">+</span></span>
<span id="cb558-10"><a href="jags-brms.html#cb558-10"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">size =</span> <span class="dv">0</span>) <span class="op">+</span></span>
<span id="cb558-11"><a href="jags-brms.html#cb558-11"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb558-12"><a href="jags-brms.html#cb558-12"></a>           <span class="dt">x =</span> <span class="fl">.5</span>, <span class="dt">y =</span> <span class="fl">.2</span>,</span>
<span id="cb558-13"><a href="jags-brms.html#cb558-13"></a>           <span class="dt">label =</span> <span class="st">&quot;beta&quot;</span>,</span>
<span id="cb558-14"><a href="jags-brms.html#cb558-14"></a>           <span class="dt">size =</span> <span class="dv">7</span>) <span class="op">+</span></span>
<span id="cb558-15"><a href="jags-brms.html#cb558-15"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb558-16"><a href="jags-brms.html#cb558-16"></a>           <span class="dt">x =</span> <span class="fl">.5</span>, <span class="dt">y =</span> <span class="fl">.6</span>,</span>
<span id="cb558-17"><a href="jags-brms.html#cb558-17"></a>           <span class="dt">label =</span> <span class="st">&quot;italic(A)*&#39;, &#39;*italic(B)&quot;</span>, </span>
<span id="cb558-18"><a href="jags-brms.html#cb558-18"></a>           <span class="dt">size =</span> <span class="dv">7</span>, <span class="dt">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="dt">parse =</span> <span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb558-19"><a href="jags-brms.html#cb558-19"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span></span>
<span id="cb558-20"><a href="jags-brms.html#cb558-20"></a><span class="st">  </span><span class="kw">theme_void</span>() <span class="op">+</span></span>
<span id="cb558-21"><a href="jags-brms.html#cb558-21"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> <span class="fl">0.5</span>))</span>
<span id="cb558-22"><a href="jags-brms.html#cb558-22"></a></span>
<span id="cb558-23"><a href="jags-brms.html#cb558-23"></a><span class="co">## an annotated arrow</span></span>
<span id="cb558-24"><a href="jags-brms.html#cb558-24"></a><span class="co"># save our custom arrow settings</span></span>
<span id="cb558-25"><a href="jags-brms.html#cb558-25"></a>my_arrow &lt;-<span class="st"> </span><span class="kw">arrow</span>(<span class="dt">angle =</span> <span class="dv">20</span>, <span class="dt">length =</span> <span class="kw">unit</span>(<span class="fl">0.35</span>, <span class="st">&quot;cm&quot;</span>), <span class="dt">type =</span> <span class="st">&quot;closed&quot;</span>)</span>
<span id="cb558-26"><a href="jags-brms.html#cb558-26"></a>p2 &lt;-</span>
<span id="cb558-27"><a href="jags-brms.html#cb558-27"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x    =</span> <span class="fl">.5</span>,</span>
<span id="cb558-28"><a href="jags-brms.html#cb558-28"></a>         <span class="dt">y    =</span> <span class="dv">1</span>,</span>
<span id="cb558-29"><a href="jags-brms.html#cb558-29"></a>         <span class="dt">xend =</span> <span class="fl">.5</span>,</span>
<span id="cb558-30"><a href="jags-brms.html#cb558-30"></a>         <span class="dt">yend =</span> <span class="dv">0</span>) <span class="op">%&gt;%</span></span>
<span id="cb558-31"><a href="jags-brms.html#cb558-31"></a><span class="st">  </span></span>
<span id="cb558-32"><a href="jags-brms.html#cb558-32"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend,</span>
<span id="cb558-33"><a href="jags-brms.html#cb558-33"></a>             <span class="dt">y =</span> y, <span class="dt">yend =</span> yend)) <span class="op">+</span></span>
<span id="cb558-34"><a href="jags-brms.html#cb558-34"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">arrow =</span> my_arrow) <span class="op">+</span></span>
<span id="cb558-35"><a href="jags-brms.html#cb558-35"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb558-36"><a href="jags-brms.html#cb558-36"></a>           <span class="dt">x =</span> <span class="fl">.375</span>, <span class="dt">y =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>,</span>
<span id="cb558-37"><a href="jags-brms.html#cb558-37"></a>           <span class="dt">label =</span> <span class="st">&quot;&#39;~&#39;&quot;</span>,</span>
<span id="cb558-38"><a href="jags-brms.html#cb558-38"></a>           <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="dt">parse =</span> T) <span class="op">+</span></span>
<span id="cb558-39"><a href="jags-brms.html#cb558-39"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb558-40"><a href="jags-brms.html#cb558-40"></a><span class="st">  </span><span class="kw">theme_void</span>()</span>
<span id="cb558-41"><a href="jags-brms.html#cb558-41"></a></span>
<span id="cb558-42"><a href="jags-brms.html#cb558-42"></a><span class="co"># bar plot of Bernoulli data</span></span>
<span id="cb558-43"><a href="jags-brms.html#cb558-43"></a>p3 &lt;-</span>
<span id="cb558-44"><a href="jags-brms.html#cb558-44"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>,</span>
<span id="cb558-45"><a href="jags-brms.html#cb558-45"></a>         <span class="dt">d =</span> (<span class="kw">dbinom</span>(x, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="fl">.6</span>)) <span class="op">/</span><span class="st"> </span><span class="kw">max</span>(<span class="kw">dbinom</span>(x, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="fl">.6</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb558-46"><a href="jags-brms.html#cb558-46"></a><span class="st">  </span></span>
<span id="cb558-47"><a href="jags-brms.html#cb558-47"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> d)) <span class="op">+</span></span>
<span id="cb558-48"><a href="jags-brms.html#cb558-48"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">width =</span> <span class="fl">.4</span>) <span class="op">+</span></span>
<span id="cb558-49"><a href="jags-brms.html#cb558-49"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb558-50"><a href="jags-brms.html#cb558-50"></a>           <span class="dt">x =</span> <span class="fl">.5</span>, <span class="dt">y =</span> <span class="fl">.2</span>,</span>
<span id="cb558-51"><a href="jags-brms.html#cb558-51"></a>           <span class="dt">label =</span> <span class="st">&quot;Bernoulli&quot;</span>,</span>
<span id="cb558-52"><a href="jags-brms.html#cb558-52"></a>           <span class="dt">size =</span> <span class="dv">7</span>) <span class="op">+</span></span>
<span id="cb558-53"><a href="jags-brms.html#cb558-53"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb558-54"><a href="jags-brms.html#cb558-54"></a>           <span class="dt">x =</span> <span class="fl">.5</span>, <span class="dt">y =</span> <span class="fl">.94</span>,</span>
<span id="cb558-55"><a href="jags-brms.html#cb558-55"></a>           <span class="dt">label =</span> <span class="st">&quot;theta&quot;</span>, </span>
<span id="cb558-56"><a href="jags-brms.html#cb558-56"></a>           <span class="dt">size =</span> <span class="dv">7</span>, <span class="dt">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="dt">parse =</span> T) <span class="op">+</span></span>
<span id="cb558-57"><a href="jags-brms.html#cb558-57"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="op">-</span>.<span class="dv">75</span>, <span class="fl">1.75</span>) <span class="op">+</span></span>
<span id="cb558-58"><a href="jags-brms.html#cb558-58"></a><span class="st">  </span><span class="kw">theme_void</span>() <span class="op">+</span></span>
<span id="cb558-59"><a href="jags-brms.html#cb558-59"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> <span class="fl">0.5</span>))</span>
<span id="cb558-60"><a href="jags-brms.html#cb558-60"></a></span>
<span id="cb558-61"><a href="jags-brms.html#cb558-61"></a><span class="co"># another annotated arrow</span></span>
<span id="cb558-62"><a href="jags-brms.html#cb558-62"></a>p4 &lt;-</span>
<span id="cb558-63"><a href="jags-brms.html#cb558-63"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x     =</span> <span class="kw">c</span>(.<span class="dv">375</span>, <span class="fl">.625</span>),</span>
<span id="cb558-64"><a href="jags-brms.html#cb558-64"></a>         <span class="dt">y     =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>),</span>
<span id="cb558-65"><a href="jags-brms.html#cb558-65"></a>         <span class="dt">label =</span> <span class="kw">c</span>(<span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;italic(i)&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb558-66"><a href="jags-brms.html#cb558-66"></a><span class="st">  </span></span>
<span id="cb558-67"><a href="jags-brms.html#cb558-67"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">label =</span> label)) <span class="op">+</span></span>
<span id="cb558-68"><a href="jags-brms.html#cb558-68"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">size =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">7</span>), <span class="dt">parse =</span> T, <span class="dt">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="op">+</span></span>
<span id="cb558-69"><a href="jags-brms.html#cb558-69"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">x =</span> <span class="fl">.5</span>, <span class="dt">xend =</span> <span class="fl">.5</span>,</span>
<span id="cb558-70"><a href="jags-brms.html#cb558-70"></a>               <span class="dt">y =</span> <span class="dv">1</span>, <span class="dt">yend =</span> <span class="dv">0</span>,</span>
<span id="cb558-71"><a href="jags-brms.html#cb558-71"></a>               <span class="dt">arrow =</span> my_arrow) <span class="op">+</span></span>
<span id="cb558-72"><a href="jags-brms.html#cb558-72"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb558-73"><a href="jags-brms.html#cb558-73"></a><span class="st">  </span><span class="kw">theme_void</span>()</span>
<span id="cb558-74"><a href="jags-brms.html#cb558-74"></a></span>
<span id="cb558-75"><a href="jags-brms.html#cb558-75"></a><span class="co"># some text</span></span>
<span id="cb558-76"><a href="jags-brms.html#cb558-76"></a>p5 &lt;-</span>
<span id="cb558-77"><a href="jags-brms.html#cb558-77"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x     =</span> <span class="dv">1</span>,</span>
<span id="cb558-78"><a href="jags-brms.html#cb558-78"></a>         <span class="dt">y     =</span> <span class="fl">.5</span>,</span>
<span id="cb558-79"><a href="jags-brms.html#cb558-79"></a>         <span class="dt">label =</span> <span class="st">&quot;italic(y[i])&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb558-80"><a href="jags-brms.html#cb558-80"></a><span class="st">  </span></span>
<span id="cb558-81"><a href="jags-brms.html#cb558-81"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">label =</span> label)) <span class="op">+</span></span>
<span id="cb558-82"><a href="jags-brms.html#cb558-82"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">size =</span> <span class="dv">7</span>, <span class="dt">parse =</span> T, <span class="dt">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="op">+</span></span>
<span id="cb558-83"><a href="jags-brms.html#cb558-83"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="dv">0</span>, <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb558-84"><a href="jags-brms.html#cb558-84"></a><span class="st">  </span><span class="kw">theme_void</span>()</span></code></pre></div>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="jags-brms.html#cb559-1"></a>layout &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb559-2"><a href="jags-brms.html#cb559-2"></a>  <span class="kw">area</span>(<span class="dt">t =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">2</span>, <span class="dt">l =</span> <span class="dv">1</span>, <span class="dt">r =</span> <span class="dv">1</span>),</span>
<span id="cb559-3"><a href="jags-brms.html#cb559-3"></a>  <span class="kw">area</span>(<span class="dt">t =</span> <span class="dv">3</span>, <span class="dt">b =</span> <span class="dv">3</span>, <span class="dt">l =</span> <span class="dv">1</span>, <span class="dt">r =</span> <span class="dv">1</span>),</span>
<span id="cb559-4"><a href="jags-brms.html#cb559-4"></a>  <span class="kw">area</span>(<span class="dt">t =</span> <span class="dv">4</span>, <span class="dt">b =</span> <span class="dv">5</span>, <span class="dt">l =</span> <span class="dv">1</span>, <span class="dt">r =</span> <span class="dv">1</span>),</span>
<span id="cb559-5"><a href="jags-brms.html#cb559-5"></a>  <span class="kw">area</span>(<span class="dt">t =</span> <span class="dv">6</span>, <span class="dt">b =</span> <span class="dv">6</span>, <span class="dt">l =</span> <span class="dv">1</span>, <span class="dt">r =</span> <span class="dv">1</span>),</span>
<span id="cb559-6"><a href="jags-brms.html#cb559-6"></a>  <span class="kw">area</span>(<span class="dt">t =</span> <span class="dv">7</span>, <span class="dt">b =</span> <span class="dv">7</span>, <span class="dt">l =</span> <span class="dv">1</span>, <span class="dt">r =</span> <span class="dv">1</span>)</span>
<span id="cb559-7"><a href="jags-brms.html#cb559-7"></a>)</span>
<span id="cb559-8"><a href="jags-brms.html#cb559-8"></a></span>
<span id="cb559-9"><a href="jags-brms.html#cb559-9"></a>(p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span>p4 <span class="op">+</span><span class="st"> </span>p5) <span class="op">+</span><span class="st"> </span></span>
<span id="cb559-10"><a href="jags-brms.html#cb559-10"></a><span class="st">  </span><span class="kw">plot_layout</span>(<span class="dt">design =</span> layout) <span class="op">&amp;</span></span>
<span id="cb559-11"><a href="jags-brms.html#cb559-11"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="op">&amp;</span></span>
<span id="cb559-12"><a href="jags-brms.html#cb559-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span> <span class="kw">margin</span>(<span class="dv">0</span>, <span class="fl">5.5</span>, <span class="dv">0</span>, <span class="fl">5.5</span>))</span></code></pre></div>
<p><img src="08_files/figure-gfm/unnamed-chunk-4-1.png" width="192" style="display: block; margin: auto;" /></p>
<blockquote>
<p>Diagrams like Figure 8.2 should be scanned from the bottom up. This is because models of data always start with the data, then conceive of a likelihood function that describes the data values in terms of meaningful parameters, and finally determine a prior distribution over the parameters. (p. 196)</p>
</blockquote>
<div id="load-data." class="section level3">
<h3><span class="header-section-number">8.2.1</span> Load data.</h3>
<p>“Logically, models of data start with the data. We must know their basic scale and structure to conceive of a descriptive model” (p. 197).</p>
<p>Here we load the data with the <code>readr::read_csv()</code> function, the <strong>tidyverse</strong> version of base <strong>R</strong> <code>read.csv()</code>.</p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="jags-brms.html#cb560-1"></a>my_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data.R/z15N50.csv&quot;</span>)</span></code></pre></div>
<p>Unlike what Kruschke wrote about JAGS, the <strong>brms</strong> package does not require us to convert the data into a list. It can handle data in lists or data frames, of which <a href="https://cran.r-project.org/web/packages/tibble/vignettes/tibble.html">tibbles are a special case</a>. Here are what the data look like.</p>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="jags-brms.html#cb561-1"></a><span class="kw">glimpse</span>(my_data)</span></code></pre></div>
<pre><code>## Rows: 50
## Columns: 1
## $ y &lt;dbl&gt; 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, …</code></pre>
<p>We might visualize them in a bar plot.</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="jags-brms.html#cb563-1"></a><span class="kw">library</span>(cowplot)</span>
<span id="cb563-2"><a href="jags-brms.html#cb563-2"></a></span>
<span id="cb563-3"><a href="jags-brms.html#cb563-3"></a>my_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb563-4"><a href="jags-brms.html#cb563-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y =</span> y <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb563-5"><a href="jags-brms.html#cb563-5"></a><span class="st">  </span></span>
<span id="cb563-6"><a href="jags-brms.html#cb563-6"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y)) <span class="op">+</span></span>
<span id="cb563-7"><a href="jags-brms.html#cb563-7"></a><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span></span>
<span id="cb563-8"><a href="jags-brms.html#cb563-8"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">expansion</span>(<span class="dt">mult =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))) <span class="op">+</span></span>
<span id="cb563-9"><a href="jags-brms.html#cb563-9"></a><span class="st">  </span><span class="kw">theme_minimal_hgrid</span>()</span></code></pre></div>
<p><img src="08_files/figure-gfm/unnamed-chunk-7-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>For the past couple chapters, we’ve been using the <code>cowplot::theme_cowplot()</code> theme for our plots. The <strong>cowplot</strong> package, however, includes a few more. The <code>theme_minimal_grid()</code> is similar, but subtracts the axis lines and adds in minimalistic grid lines. In his <span class="citation">(<a href="#ref-Wilke2019Themes" role="doc-biblioref">2019</a><a href="#ref-Wilke2019Themes" role="doc-biblioref">b</a>)</span> [Themes vignette], however, Wilke explained that vertical gridlines are often unsightly in bar plots. To avoid offending Wilke with our grid lines, we used the <code>theme_minimal_hgrid()</code> theme, which only added horizontal grid lines.</p>
<p>Anyway, if you wanted to compute “Ntotal”, the number of rows in our tibble, one way is with <code>count()</code>.</p>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="jags-brms.html#cb564-1"></a>my_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb564-2"><a href="jags-brms.html#cb564-2"></a><span class="st">  </span><span class="kw">count</span>()</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##       n
##   &lt;int&gt;
## 1    50</code></pre>
<p>However, we’re not going to do anything with an “Ntotal” value. For <strong>brms</strong>, the data are fine in their current data frame form. No need for a <code>dataList</code>.</p>
</div>
<div id="specify-model." class="section level3">
<h3><span class="header-section-number">8.2.2</span> Specify model.</h3>
<p>Let’s open <strong>brms</strong>.</p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="jags-brms.html#cb566-1"></a><span class="kw">library</span>(brms)</span></code></pre></div>
<p>The <strong>brms</strong> package does not have code blocks following the JAGS format or the sequence in Kurschke’s diagrams. Rather, its syntax is modeled in part after the popular frequentist mixed-effects package, <a href="https://cran.r-project.org/web/packages/lme4/index.html"><strong>lme4</strong></a>. To learn more about how <strong>brms</strong> compares to <strong>lme4</strong>, see Bürkner’s <span class="citation">(<a href="#ref-burknerBrmsPackageBayesian2017" role="doc-biblioref">2017</a>)</span> overview, <a href="https://cran.r-project.org/web/packages/brms/vignettes/brms_overview.pdf"><em>brms: An R package for Bayesian multilevel models
using Stan</em></a>.</p>
<p>The primary function in <strong>brms</strong> is <code>brm()</code>. Into this one function we will specify the data, the model, the likelihood function, the prior(s), and any technical settings such as the number of MCMC chains, iterations, and so forth. You can order the arguments in any way you like. My typical practice is to start with <code>data</code>, <code>family</code> (i.e., the likelihood function), the model <code>formula</code>, and my <code>prior</code>s. If there are any technical specifications such as the number of MCMC iterations I’d like to change from their default values, I usually do that last.</p>
<p>Here’s how to fit the model.</p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="jags-brms.html#cb567-1"></a>fit8<span class="fl">.1</span> &lt;-</span>
<span id="cb567-2"><a href="jags-brms.html#cb567-2"></a><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data, </span>
<span id="cb567-3"><a href="jags-brms.html#cb567-3"></a>      <span class="dt">family =</span> <span class="kw">bernoulli</span>(<span class="dt">link =</span> identity),</span>
<span id="cb567-4"><a href="jags-brms.html#cb567-4"></a>      <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb567-5"><a href="jags-brms.html#cb567-5"></a>      <span class="kw">prior</span>(<span class="kw">beta</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">class =</span> Intercept),</span>
<span id="cb567-6"><a href="jags-brms.html#cb567-6"></a>      <span class="dt">iter =</span> <span class="dv">500</span> <span class="op">+</span><span class="st"> </span><span class="dv">3334</span>, <span class="dt">warmup =</span> <span class="dv">500</span>, <span class="dt">chains =</span> <span class="dv">3</span>,</span>
<span id="cb567-7"><a href="jags-brms.html#cb567-7"></a>      <span class="dt">seed =</span> <span class="dv">8</span>,</span>
<span id="cb567-8"><a href="jags-brms.html#cb567-8"></a>      <span class="dt">file =</span> <span class="st">&quot;fits/fit08.01&quot;</span>)</span></code></pre></div>
<p>Also note our use of the <code>file</code> argument. This automatically saved my fit object as an external file. You don’t have to do that and you can avoid doing so by omitting the <code>file</code> argument. For a more detailed explanation of the <code>brms::brm()</code> function, spend some time with the <code>brm</code> section of the <a href="https://CRAN.R-project.org/package=brms"><strong>brms</strong> reference manual</a> <span class="citation">(Bürkner, <a href="#ref-R-brms" role="doc-biblioref">2020</a><a href="#ref-R-brms" role="doc-biblioref">a</a>)</span>.</p>
</div>
<div id="initialize-chains." class="section level3">
<h3><span class="header-section-number">8.2.3</span> Initialize chains.</h3>
<p>In Stan, and in <strong>brms</strong> by extension, the initial values have default settings. In the <a href="https://mc-stan.org/docs/2_24/reference-manual/initialization.html">Initialization section of the Program Execution chapter</a> in the <em>Stan reference manual, Version 2.24</em> <span class="citation">(Stan Development Team, <a href="#ref-standevelopmentteamStanReferenceManual2020" role="doc-biblioref">2020</a><a href="#ref-standevelopmentteamStanReferenceManual2020" role="doc-biblioref">a</a>)</span> we read</p>
<blockquote>
<p>If there are no user-supplied initial values, the default initialization strategy is to initialize the unconstrained parameters directly with values drawn uniformly from the interval <span class="math inline">\((−2, 2)\)</span>. The bounds of this initialization can be changed but it is always symmetric around 0. The value of 0 is special in that it represents the median of the initialization. An unconstrained value of 0 corresponds to different parameter values depending on the constraints declared on the parameters.</p>
</blockquote>
<p>In general, I do not recommend setting custom initial values in <strong>brms</strong> or Stan. Under the hood, Stan will transform the parameters to the unconstrained space in models where they are bounded. In our Bernoulli model, <span class="math inline">\(\theta\)</span> is bounded at 0 and 1. A little further down in the same section, we read</p>
<blockquote>
<p>For parameters bounded above and below, the initial value of 0 on the unconstrained scale corresponds to a value at the midpoint of the constraint interval. For probability parameters, bounded below by 0 and above by 1, the transform is the inverse logit, so that an initial unconstrained value of 0 corresponds to a constrained value of 0.5, -2 corresponds to 0.12 and 2 to 0.88. Bounds other than 0 and 1 are just scaled and translated.</p>
</blockquote>
<p>If you want to play around with this, have at it. In my experience, the only time it helps to set these manually is when you want to fix them to zero. You can do that by specifying <code>inits = 0</code> within <code>brm()</code>.</p>
</div>
<div id="generate-chains." class="section level3">
<h3><span class="header-section-number">8.2.4</span> Generate chains.</h3>
<p>By default, <strong>brms</strong> will use 4 chains of 2,000 iterations each. The type of MCMC <strong>brms</strong> uses is Hamiltonian Monte Carlo (HMC). You can learn more about HMC at the Stan website, <a href="https://mc-stan.org">https://mc-stan.org</a>, which includes resources such as the <a href="https://mc-stan.org/docs/2_24/stan-users-guide/index.html"><em>Stan user’s guide</em></a> <span class="citation">(Stan Development Team, <a href="#ref-standevelopmentteamStanUserGuide2020" role="doc-biblioref">2020</a><a href="#ref-standevelopmentteamStanUserGuide2020" role="doc-biblioref">b</a>)</span>, the <a href="https://mc-stan.org/docs/2_24/reference-manual/"><em>Stan reference manual</em></a> <span class="citation">(Stan Development Team, <a href="#ref-standevelopmentteamStanReferenceManual2020" role="doc-biblioref">2020</a><a href="#ref-standevelopmentteamStanReferenceManual2020" role="doc-biblioref">a</a>)</span>, and a list of <a href="https://mc-stan.org/users/documentation/tutorials">tutorials</a>. McElreath has a <a href="https://www.youtube.com/watch?v=BWEtS3HuU5A&amp;t=163s&amp;frags=pl%2Cwn">nice intro lecture</a> on MCMC in general and HMC in particular. Michael Bentacourt has some good lectures on Stan and HMC, such as <a href="https://www.youtube.com/watch?v=pHsuIaPbNbY&amp;t=2638s&amp;frags=pl%2Cwn">here</a> and <a href="https://www.youtube.com/watch?v=jUSZboSq1zg&amp;t=1325s&amp;frags=pl%2Cwn">here</a>. And, of course, we will cover HMC with Kruschke in <a href="stan.html#stan">Chapter 14</a>.</p>
<p>Within each HMC chain, the first <span class="math inline">\(n\)</span> iterations are warmups. Within the Stan-HMC paradigm, <a href="https://andrewgelman.com/2017/12/15/burn-vs-warm-iterative-simulation-algorithms/">warmups are somewhat analogous to but not synonymous with burn-in iterations</a> as done by the Gibbs sampling in JAGS. But HMC warmups are like Gibbs burn-ins in that both are discarded and not used to describe the posterior. As such, the <strong>brms</strong> default settings yield 1,000 post-warmup iterations for each of the 4 HMC chains. However, we specified <code>iter = 500 + 3334, warmup = 500, chains = 3</code>. Thus instead of defaults, we have 3 HMC chains. Each chain has 500 + 3,334 = 3,834 total iterations, of which 500 were discarded <code>warmup</code> iterations.</p>
<p>To learn more about the warmup stage in Stan, check out the <a href="https://mc-stan.org/docs/2_24/reference-manual/hmc-algorithm-parameters.html">HMC Algorithm Parameters section of the MCMC Sampling chapter</a> of the <em>Stan reference manual</em>.</p>
</div>
<div id="examine-chains." class="section level3">
<h3><span class="header-section-number">8.2.5</span> Examine chains.</h3>
<p>The <code>brms::plot()</code> function returns a density and trace plot for each model parameter.</p>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="jags-brms.html#cb568-1"></a><span class="kw">plot</span>(fit8<span class="fl">.1</span>)</span></code></pre></div>
<p><img src="08_files/figure-gfm/unnamed-chunk-10-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>If you want to display each chain as its own density, you can use the handy <code>mcmc_dens_overlay()</code> function from the <a href="https://CRAN.R-project.org/package=bayesplot"><strong>bayesplot</strong> package</a>.</p>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="jags-brms.html#cb569-1"></a><span class="kw">library</span>(bayesplot)</span></code></pre></div>
<p>But before we do so, we’ll need to export the posterior samples into a data frame, for which we’ll employ <code>posterior_samples()</code>.</p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="jags-brms.html#cb570-1"></a>post &lt;-<span class="st"> </span><span class="kw">posterior_samples</span>(fit8<span class="fl">.1</span>, <span class="dt">add_chain =</span> T)</span></code></pre></div>
<p>Note the <code>add_chain = T</code> argument, which will allow us to differentiate the draws by their chain of origin. But anyway, here are the overlaid densities.</p>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="jags-brms.html#cb571-1"></a><span class="kw">mcmc_dens_overlay</span>(post, <span class="dt">pars =</span> <span class="kw">c</span>(<span class="st">&quot;b_Intercept&quot;</span>)) <span class="op">+</span></span>
<span id="cb571-2"><a href="jags-brms.html#cb571-2"></a><span class="st">  </span><span class="kw">theme_minimal_hgrid</span>()</span></code></pre></div>
<p><img src="08_files/figure-gfm/unnamed-chunk-13-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>The <code>bayesplot::mcmc_acf()</code> function will give us the autocorrelation plots.</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="jags-brms.html#cb572-1"></a><span class="kw">mcmc_acf</span>(post, <span class="dt">pars =</span> <span class="st">&quot;b_Intercept&quot;</span>, <span class="dt">lags =</span> <span class="dv">35</span>) <span class="op">+</span></span>
<span id="cb572-2"><a href="jags-brms.html#cb572-2"></a><span class="st">  </span><span class="kw">theme_minimal_hgrid</span>()</span></code></pre></div>
<p><img src="08_files/figure-gfm/unnamed-chunk-14-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>With <strong>brms</strong> functions, we get a sole <span class="math inline">\(\widehat R\)</span> value for each parameter rather than a running vector.</p>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="jags-brms.html#cb573-1"></a><span class="kw">rhat</span>(fit8<span class="fl">.1</span>)[<span class="st">&quot;b_Intercept&quot;</span>]</span></code></pre></div>
<pre><code>## b_Intercept 
##     1.00023</code></pre>
<p>We’ll have to employ <code>brms::as.mcmc()</code> and <code>coda::gelman.plot()</code> to make our running <span class="math inline">\(\widehat R\)</span> plot.</p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="jags-brms.html#cb575-1"></a>fit8<span class="fl">.1</span>_c &lt;-<span class="st"> </span><span class="kw">as.mcmc</span>(fit8<span class="fl">.1</span>)</span>
<span id="cb575-2"><a href="jags-brms.html#cb575-2"></a></span>
<span id="cb575-3"><a href="jags-brms.html#cb575-3"></a>coda<span class="op">::</span><span class="kw">gelman.plot</span>(fit8<span class="fl">.1</span>_c[, <span class="st">&quot;b_Intercept&quot;</span>, ])</span></code></pre></div>
<p><img src="08_files/figure-gfm/unnamed-chunk-16-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>For whatever reason, many of the package developers within the Stan/<strong>brms</strong> ecosystem don’t seem interested in shrink factor plots, like this.</p>
<div id="the-plotpost-function-how-to-plot-your-brms-posterior-distributions." class="section level4">
<h4><span class="header-section-number">8.2.5.1</span> <del>The <code>plotPost</code> function</del> How to plot your brms posterior distributions.</h4>
<p>We’ll get into plotting in just a moment. But before we do, here’s a summary of the model.</p>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="jags-brms.html#cb576-1"></a><span class="kw">print</span>(fit8<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>##  Family: bernoulli 
##   Links: mu = identity 
## Formula: y ~ 1 
##    Data: my_data (Number of observations: 50) 
## Samples: 3 chains, each with iter = 3834; warmup = 500; thin = 1;
##          total post-warmup samples = 10002
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept     0.32      0.06     0.20     0.44 1.00     3678     4655
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>To summarize a posterior in terms of central tendency, <strong>brms</strong> defaults to the mean value (i.e., the value in the ‘Estimate’ column of the <code>print()</code> output). In many of the other convenience functions, you can also request the median instead. For example, we can use the <code>robust = T</code> argument to get the ‘Estimate’ in terms of the median.</p>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="jags-brms.html#cb578-1"></a><span class="kw">posterior_summary</span>(fit8<span class="fl">.1</span>, <span class="dt">robust =</span> T)</span></code></pre></div>
<pre><code>##                Estimate  Est.Error        Q2.5       Q97.5
## b_Intercept   0.3141617 0.06271755   0.2005124   0.4431792
## lp__        -30.5225409 0.29765551 -32.6877346 -30.3052625</code></pre>
<p>Across functions, the intervals default to 95%. With <code>print()</code> and <code>summary()</code> you can adjust the level with a <code>prob</code> argument. For example, here we’ll use 50% intervals.</p>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="jags-brms.html#cb580-1"></a><span class="kw">print</span>(fit8<span class="fl">.1</span>, <span class="dt">prob =</span> <span class="fl">.5</span>)</span></code></pre></div>
<pre><code>##  Family: bernoulli 
##   Links: mu = identity 
## Formula: y ~ 1 
##    Data: my_data (Number of observations: 50) 
## Samples: 3 chains, each with iter = 3834; warmup = 500; thin = 1;
##          total post-warmup samples = 10002
## 
## Population-Level Effects: 
##           Estimate Est.Error l-50% CI u-50% CI Rhat Bulk_ESS Tail_ESS
## Intercept     0.32      0.06     0.27     0.36 1.00     3678     4655
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>But in many other <strong>brms</strong> convenience functions, you can use the <code>probs</code> argument to request specific percentile summaries.</p>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="jags-brms.html#cb582-1"></a><span class="kw">posterior_summary</span>(fit8<span class="fl">.1</span>, <span class="dt">probs =</span> <span class="kw">c</span>(.<span class="dv">025</span>, <span class="fl">.25</span>, <span class="fl">.75</span>, <span class="fl">.975</span>))</span></code></pre></div>
<pre><code>##                Estimate  Est.Error        Q2.5         Q25         Q75       Q97.5
## b_Intercept   0.3160697 0.06246065   0.2005124   0.2726816   0.3572829   0.4431792
## lp__        -30.7894587 0.68273271 -32.6877346 -30.9497913 -30.3546844 -30.3052625</code></pre>
<p>Regardless of what <code>prob</code> or <code>probs</code> levels you use, <strong>brms</strong> functions always return percentile-based estimates. All this central tendency and interval talk will be important in a moment…</p>
<p>When plotting the posterior distribution of a parameter estimated with <strong>brms</strong>, you typically do so working with the results of an object returned by <code>posterior_samples()</code>. Recall we already saved those samples as <code>post</code>.</p>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="jags-brms.html#cb584-1"></a><span class="kw">head</span>(post)</span></code></pre></div>
<pre><code>##   b_Intercept      lp__ chain iter
## 1   0.3885602 -31.04295     1  501
## 2   0.4013501 -31.28580     1  502
## 3   0.3733681 -30.79754     1  503
## 4   0.3764648 -30.84373     1  504
## 5   0.3862548 -31.00268     1  505
## 6   0.2774595 -30.42087     1  506</code></pre>
<p>With <code>post</code> in hand, we can use <strong>ggplot2</strong> to do the typical distributional plots, such as with <code>geom_histogram()</code>.</p>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb586-1"><a href="jags-brms.html#cb586-1"></a>post <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb586-2"><a href="jags-brms.html#cb586-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> b_Intercept)) <span class="op">+</span></span>
<span id="cb586-3"><a href="jags-brms.html#cb586-3"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>,</span>
<span id="cb586-4"><a href="jags-brms.html#cb586-4"></a>                 <span class="dt">size =</span> <span class="fl">.2</span>) <span class="op">+</span></span>
<span id="cb586-5"><a href="jags-brms.html#cb586-5"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">expansion</span>(<span class="dt">mult =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))) <span class="op">+</span></span>
<span id="cb586-6"><a href="jags-brms.html#cb586-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Theta via ggplot2::geom_histogram()&quot;</span>,</span>
<span id="cb586-7"><a href="jags-brms.html#cb586-7"></a>       <span class="dt">x =</span> <span class="kw">expression</span>(theta)) <span class="op">+</span></span>
<span id="cb586-8"><a href="jags-brms.html#cb586-8"></a><span class="st">  </span><span class="kw">theme_minimal_hgrid</span>()</span></code></pre></div>
<p><img src="08_files/figure-gfm/unnamed-chunk-22-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>The <code>bayesplot::mcmc_areas()</code> function offers a nice way to depict the posterior densities, along with their percentile-based 50% and 95% ranges.</p>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="jags-brms.html#cb587-1"></a><span class="kw">mcmc_areas</span>(</span>
<span id="cb587-2"><a href="jags-brms.html#cb587-2"></a>  post, </span>
<span id="cb587-3"><a href="jags-brms.html#cb587-3"></a>  <span class="dt">pars =</span> <span class="kw">c</span>(<span class="st">&quot;b_Intercept&quot;</span>),</span>
<span id="cb587-4"><a href="jags-brms.html#cb587-4"></a>  <span class="dt">prob =</span> <span class="fl">0.5</span>,</span>
<span id="cb587-5"><a href="jags-brms.html#cb587-5"></a>  <span class="dt">prob_outer =</span> <span class="fl">0.95</span>,</span>
<span id="cb587-6"><a href="jags-brms.html#cb587-6"></a>  <span class="dt">point_est =</span> <span class="st">&quot;mean&quot;</span></span>
<span id="cb587-7"><a href="jags-brms.html#cb587-7"></a>) <span class="op">+</span></span>
<span id="cb587-8"><a href="jags-brms.html#cb587-8"></a><span class="st">  </span><span class="kw">scale_y_discrete</span>(<span class="dt">expand =</span> <span class="kw">expansion</span>(<span class="dt">mult =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))) <span class="op">+</span></span>
<span id="cb587-9"><a href="jags-brms.html#cb587-9"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Theta via bayesplot::mcmc_areas()&quot;</span>,</span>
<span id="cb587-10"><a href="jags-brms.html#cb587-10"></a>       <span class="dt">x =</span> <span class="kw">expression</span>(theta)) <span class="op">+</span></span>
<span id="cb587-11"><a href="jags-brms.html#cb587-11"></a><span class="st">  </span><span class="kw">theme_minimal_hgrid</span>()</span></code></pre></div>
<p><img src="08_files/figure-gfm/unnamed-chunk-23-1.png" width="384" style="display: block; margin: auto;" /></p>
<p><strong>brms</strong> doesn’t have a convenient way to compute the posterior mode or HDIs. Base <strong>R</strong> is no help, either. But Matthew Kay’s <strong>tidybayes</strong> package makes it easy to compute posterior modes and HDIs with handy functions like <code>stat_halfeye()</code> and <code>stat_histinterval()</code>.</p>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="jags-brms.html#cb588-1"></a><span class="kw">library</span>(tidybayes)</span>
<span id="cb588-2"><a href="jags-brms.html#cb588-2"></a></span>
<span id="cb588-3"><a href="jags-brms.html#cb588-3"></a>post <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb588-4"><a href="jags-brms.html#cb588-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> b_Intercept, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></span>
<span id="cb588-5"><a href="jags-brms.html#cb588-5"></a><span class="st">  </span><span class="kw">stat_halfeye</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>)) <span class="op">+</span></span>
<span id="cb588-6"><a href="jags-brms.html#cb588-6"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb588-7"><a href="jags-brms.html#cb588-7"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Theta via tidybayes::stat_halfeye()&quot;</span>,</span>
<span id="cb588-8"><a href="jags-brms.html#cb588-8"></a>       <span class="dt">x =</span> <span class="kw">expression</span>(theta)) <span class="op">+</span></span>
<span id="cb588-9"><a href="jags-brms.html#cb588-9"></a><span class="st">  </span><span class="kw">theme_minimal_hgrid</span>()</span></code></pre></div>
<p><img src="08_files/figure-gfm/unnamed-chunk-24-1.png" width="384" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="jags-brms.html#cb589-1"></a>post <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb589-2"><a href="jags-brms.html#cb589-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> b_Intercept, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></span>
<span id="cb589-3"><a href="jags-brms.html#cb589-3"></a><span class="st">  </span><span class="kw">stat_histinterval</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>)) <span class="op">+</span></span>
<span id="cb589-4"><a href="jags-brms.html#cb589-4"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb589-5"><a href="jags-brms.html#cb589-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Theta via tidybayes::stat_histinterval()&quot;</span>,</span>
<span id="cb589-6"><a href="jags-brms.html#cb589-6"></a>       <span class="dt">x =</span> <span class="kw">expression</span>(theta)) <span class="op">+</span></span>
<span id="cb589-7"><a href="jags-brms.html#cb589-7"></a><span class="st">  </span><span class="kw">theme_minimal_hgrid</span>()</span></code></pre></div>
<p><img src="08_files/figure-gfm/unnamed-chunk-24-2.png" width="384" style="display: block; margin: auto;" /></p>
<p>The <code>tidybayes::stat_halfeye()</code> function returns a density with a measure of the posterior’s central tendency in a dot and one or multiple interval bands as horizontal lines at the base of the density. The <code>stat_histinterval()</code> function returns much the same, but replaces the density with a histogram. For both functions, the <code>point_interval = mode_hdi</code> argument allowed us to request the mode to be our measure of central tendency and the highest posterior density intervals to be our type intervals. With <code>.width = c(.95, .5)</code>, we requested our HDIs be at both the 95% and 50% levels.</p>
<p>If we wanted to be more congruent with Kruschke’s plotting sensibilities, we could further modify <code>tidybayes::stat_histinterval()</code>.</p>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="jags-brms.html#cb590-1"></a><span class="co"># this is unnecessary, but makes for nicer x-axis breaks</span></span>
<span id="cb590-2"><a href="jags-brms.html#cb590-2"></a>my_breaks &lt;-</span>
<span id="cb590-3"><a href="jags-brms.html#cb590-3"></a><span class="st">  </span><span class="kw">mode_hdi</span>(post<span class="op">$</span>b_Intercept)[, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>] <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb590-4"><a href="jags-brms.html#cb590-4"></a><span class="st">  </span><span class="kw">gather</span>(key, breaks) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb590-5"><a href="jags-brms.html#cb590-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">labels =</span> breaks <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">3</span>))</span>
<span id="cb590-6"><a href="jags-brms.html#cb590-6"></a></span>
<span id="cb590-7"><a href="jags-brms.html#cb590-7"></a><span class="co"># here&#39;s the main plot code</span></span>
<span id="cb590-8"><a href="jags-brms.html#cb590-8"></a>post <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb590-9"><a href="jags-brms.html#cb590-9"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> b_Intercept, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></span>
<span id="cb590-10"><a href="jags-brms.html#cb590-10"></a><span class="st">  </span><span class="kw">stat_histinterval</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>,</span>
<span id="cb590-11"><a href="jags-brms.html#cb590-11"></a>                    <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb590-12"><a href="jags-brms.html#cb590-12"></a>                    <span class="dt">breaks =</span> <span class="dv">40</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T) <span class="op">+</span></span>
<span id="cb590-13"><a href="jags-brms.html#cb590-13"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> my_breaks<span class="op">$</span>breaks,</span>
<span id="cb590-14"><a href="jags-brms.html#cb590-14"></a>                     <span class="dt">labels =</span> my_breaks<span class="op">$</span>labels) <span class="op">+</span></span>
<span id="cb590-15"><a href="jags-brms.html#cb590-15"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb590-16"><a href="jags-brms.html#cb590-16"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;tidybayes::stat_histinterval() all gussied up&quot;</span>,</span>
<span id="cb590-17"><a href="jags-brms.html#cb590-17"></a>       <span class="dt">x =</span> <span class="kw">expression</span>(theta)) <span class="op">+</span></span>
<span id="cb590-18"><a href="jags-brms.html#cb590-18"></a><span class="st">  </span><span class="kw">theme_minimal_hgrid</span>() <span class="op">+</span></span>
<span id="cb590-19"><a href="jags-brms.html#cb590-19"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="fl">10.5</span>))</span></code></pre></div>
<p><img src="08_files/figure-gfm/unnamed-chunk-25-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>With the <code>point_interval</code> argument within <code>stat_histinterval()</code> and related functions, we can request different combinations of measures of central tendency (i.e., mean, median, mode) and interval types (i.e., percentile-based and HDIs). Although all of these are legitimate ways to summarize a posterior, they can yield somewhat different results. For example, here we’ll contrast our mode + HDI summary with a median + percentile-based interval summary using <code>tidybayes::stat_pointinterval()</code>.</p>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="jags-brms.html#cb591-1"></a>post <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb591-2"><a href="jags-brms.html#cb591-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> b_Intercept)) <span class="op">+</span></span>
<span id="cb591-3"><a href="jags-brms.html#cb591-3"></a><span class="st">  </span><span class="kw">stat_pointinterval</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">1</span>), <span class="dt">point_interval =</span> median_qi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>)) <span class="op">+</span></span>
<span id="cb591-4"><a href="jags-brms.html#cb591-4"></a><span class="st">  </span><span class="kw">stat_pointinterval</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">2</span>), <span class="dt">point_interval =</span> mode_hdi,  <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>)) <span class="op">+</span></span>
<span id="cb591-5"><a href="jags-brms.html#cb591-5"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,</span>
<span id="cb591-6"><a href="jags-brms.html#cb591-6"></a>                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;median_qi&quot;</span>, <span class="st">&quot;mode_hdi&quot;</span>)) <span class="op">+</span></span>
<span id="cb591-7"><a href="jags-brms.html#cb591-7"></a><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">3</span>)) <span class="op">+</span></span>
<span id="cb591-8"><a href="jags-brms.html#cb591-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Theta via tidybayes::stat_pointinterval()&quot;</span>,</span>
<span id="cb591-9"><a href="jags-brms.html#cb591-9"></a>       <span class="dt">x =</span> <span class="kw">expression</span>(theta)) <span class="op">+</span></span>
<span id="cb591-10"><a href="jags-brms.html#cb591-10"></a><span class="st">  </span><span class="kw">theme_minimal_vgrid</span>() <span class="op">+</span></span>
<span id="cb591-11"><a href="jags-brms.html#cb591-11"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.line.y.left =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb591-12"><a href="jags-brms.html#cb591-12"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb591-13"><a href="jags-brms.html#cb591-13"></a>        <span class="dt">axis.ticks.y =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb591-14"><a href="jags-brms.html#cb591-14"></a>        <span class="dt">title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="fl">10.5</span>))</span></code></pre></div>
<p><img src="08_files/figure-gfm/unnamed-chunk-26-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Similar, yet distinct. To get a sense of the full variety of ways <strong>tidybayes</strong> allows users to summarize and plot the results of a Bayesian model, check out Kay’s <span class="citation">(<a href="#ref-kaySlabIntervalStats2020" role="doc-biblioref">2020</a><a href="#ref-kaySlabIntervalStats2020" role="doc-biblioref">c</a>)</span> vignette, <a href="https://mjskay.github.io/ggdist/articles/slabinterval.html"><em>Slab + interval stats and geoms</em></a>. Also, did you notice how we switched to <code>theme_minimal_vgrid()</code>? That’s how we added the vertical grid lines in the absence of horizontal grid lines.</p>
</div>
</div>
</div>
<div id="simplified-scripts-for-frequently-used-analyses" class="section level2">
<h2><span class="header-section-number">8.3</span> Simplified scripts for frequently used analyses</h2>
<p>A lot has happened in <strong>R</strong> for Bayesian analysis since Kruschke wrote his <span class="citation">(<a href="#ref-kruschkeDoingBayesianData2015" role="doc-biblioref">2015</a>)</span> text. In addition to our use of the <strong>tidyverse</strong>, the <strong>brms</strong>, <strong>bayesplot</strong>, and <strong>tidybayes</strong> packages offer an array of useful convenience functions. We can and occasionally will write our own. But really, the rich <strong>R</strong> ecosystem already has us pretty much covered.</p>
</div>
<div id="example-difference-of-biases" class="section level2">
<h2><span class="header-section-number">8.4</span> Example: Difference of biases</h2>
<p>Here are our new data.</p>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="jags-brms.html#cb592-1"></a>my_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data.R/z6N8z2N7.csv&quot;</span>)</span>
<span id="cb592-2"><a href="jags-brms.html#cb592-2"></a></span>
<span id="cb592-3"><a href="jags-brms.html#cb592-3"></a><span class="kw">glimpse</span>(my_data)</span></code></pre></div>
<pre><code>## Rows: 15
## Columns: 2
## $ y &lt;dbl&gt; 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0
## $ s &lt;chr&gt; &quot;Reginald&quot;, &quot;Reginald&quot;, &quot;Reginald&quot;, &quot;Reginald&quot;, &quot;Reginald&quot;, &quot;Reginald&quot;, &quot;Reginald&quot;, &quot;Re…</code></pre>
<p>They look like this.</p>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="jags-brms.html#cb594-1"></a><span class="kw">library</span>(ggthemes)</span>
<span id="cb594-2"><a href="jags-brms.html#cb594-2"></a></span>
<span id="cb594-3"><a href="jags-brms.html#cb594-3"></a>my_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb594-4"><a href="jags-brms.html#cb594-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y =</span> y <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb594-5"><a href="jags-brms.html#cb594-5"></a><span class="st">  </span></span>
<span id="cb594-6"><a href="jags-brms.html#cb594-6"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y, <span class="dt">fill =</span> s)) <span class="op">+</span></span>
<span id="cb594-7"><a href="jags-brms.html#cb594-7"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">show.legend =</span> F) <span class="op">+</span></span>
<span id="cb594-8"><a href="jags-brms.html#cb594-8"></a><span class="st">  </span><span class="kw">scale_fill_colorblind</span>() <span class="op">+</span></span>
<span id="cb594-9"><a href="jags-brms.html#cb594-9"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">expansion</span>(<span class="dt">mult =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>))) <span class="op">+</span></span>
<span id="cb594-10"><a href="jags-brms.html#cb594-10"></a><span class="st">  </span><span class="kw">theme_minimal_hgrid</span>() <span class="op">+</span></span>
<span id="cb594-11"><a href="jags-brms.html#cb594-11"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>s)</span></code></pre></div>
<p><img src="08_files/figure-gfm/unnamed-chunk-28-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Note our use of <code>ggthemes::scale_fill_colorblind()</code>. When you want to use color to emphasize different factor levels, such as <code>s</code>, it’s a good idea to make sure those colors can be distinguished by folks who are colorblind. The <code>scale_fill_colorblind()</code> function provides a discrete palette of eight colorblind safe colors. If you’d prefer to use a different palette, but wand to make sure its accessible to folks with colorblindness, check out the <a href="https://github.com/clauswilke/colorblindr"><strong>colorblindr</strong> package</a> <span class="citation">(McWhite &amp; Wilke, <a href="#ref-R-colorblindr" role="doc-biblioref">2020</a>)</span>.</p>
<p>Here’s our <strong>ggplot2</strong> version of the model diagram in Figure 8.5.</p>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb595-1"><a href="jags-brms.html#cb595-1"></a><span class="co"># plot of a beta density</span></span>
<span id="cb595-2"><a href="jags-brms.html#cb595-2"></a>p1 &lt;-</span>
<span id="cb595-3"><a href="jags-brms.html#cb595-3"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">.01</span>, <span class="dt">to =</span> <span class="fl">.99</span>, <span class="dt">by =</span> <span class="fl">.01</span>),</span>
<span id="cb595-4"><a href="jags-brms.html#cb595-4"></a>         <span class="dt">d =</span> (<span class="kw">dbeta</span>(x, <span class="dv">2</span>, <span class="dv">2</span>)) <span class="op">/</span><span class="st"> </span><span class="kw">max</span>(<span class="kw">dbeta</span>(x, <span class="dv">2</span>, <span class="dv">2</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb595-5"><a href="jags-brms.html#cb595-5"></a><span class="st">  </span></span>
<span id="cb595-6"><a href="jags-brms.html#cb595-6"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> d)) <span class="op">+</span></span>
<span id="cb595-7"><a href="jags-brms.html#cb595-7"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="dt">size =</span> <span class="dv">0</span>) <span class="op">+</span></span>
<span id="cb595-8"><a href="jags-brms.html#cb595-8"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb595-9"><a href="jags-brms.html#cb595-9"></a>           <span class="dt">x =</span> <span class="fl">.5</span>, <span class="dt">y =</span> <span class="fl">.2</span>,</span>
<span id="cb595-10"><a href="jags-brms.html#cb595-10"></a>           <span class="dt">label =</span> <span class="st">&quot;beta&quot;</span>,</span>
<span id="cb595-11"><a href="jags-brms.html#cb595-11"></a>           <span class="dt">size =</span> <span class="dv">7</span>) <span class="op">+</span></span>
<span id="cb595-12"><a href="jags-brms.html#cb595-12"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb595-13"><a href="jags-brms.html#cb595-13"></a>           <span class="dt">x =</span> <span class="fl">.5</span>, <span class="dt">y =</span> <span class="fl">.6</span>,</span>
<span id="cb595-14"><a href="jags-brms.html#cb595-14"></a>           <span class="dt">label =</span> <span class="st">&quot;italic(A)*&#39;, &#39;*italic(B)&quot;</span>, </span>
<span id="cb595-15"><a href="jags-brms.html#cb595-15"></a>           <span class="dt">size =</span> <span class="dv">7</span>, <span class="dt">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="dt">parse =</span> <span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb595-16"><a href="jags-brms.html#cb595-16"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span></span>
<span id="cb595-17"><a href="jags-brms.html#cb595-17"></a><span class="st">  </span><span class="kw">theme_void</span>() <span class="op">+</span></span>
<span id="cb595-18"><a href="jags-brms.html#cb595-18"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> <span class="fl">0.5</span>))</span>
<span id="cb595-19"><a href="jags-brms.html#cb595-19"></a></span>
<span id="cb595-20"><a href="jags-brms.html#cb595-20"></a><span class="co"># an annotated arrow</span></span>
<span id="cb595-21"><a href="jags-brms.html#cb595-21"></a>p2 &lt;-</span>
<span id="cb595-22"><a href="jags-brms.html#cb595-22"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x     =</span> <span class="kw">c</span>(.<span class="dv">35</span>, <span class="fl">.65</span>),</span>
<span id="cb595-23"><a href="jags-brms.html#cb595-23"></a>         <span class="dt">y     =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>,</span>
<span id="cb595-24"><a href="jags-brms.html#cb595-24"></a>         <span class="dt">label =</span> <span class="kw">c</span>(<span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;italic(s)&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb595-25"><a href="jags-brms.html#cb595-25"></a><span class="st">  </span></span>
<span id="cb595-26"><a href="jags-brms.html#cb595-26"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">label =</span> label)) <span class="op">+</span></span>
<span id="cb595-27"><a href="jags-brms.html#cb595-27"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">size =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">7</span>), <span class="dt">parse =</span> T, <span class="dt">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="op">+</span></span>
<span id="cb595-28"><a href="jags-brms.html#cb595-28"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">x =</span> <span class="fl">.5</span>, <span class="dt">xend =</span> <span class="fl">.5</span>,</span>
<span id="cb595-29"><a href="jags-brms.html#cb595-29"></a>               <span class="dt">y =</span> <span class="dv">1</span>, <span class="dt">yend =</span> <span class="dv">0</span>,</span>
<span id="cb595-30"><a href="jags-brms.html#cb595-30"></a>               <span class="dt">arrow =</span> my_arrow) <span class="op">+</span></span>
<span id="cb595-31"><a href="jags-brms.html#cb595-31"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb595-32"><a href="jags-brms.html#cb595-32"></a><span class="st">  </span><span class="kw">theme_void</span>()</span>
<span id="cb595-33"><a href="jags-brms.html#cb595-33"></a></span>
<span id="cb595-34"><a href="jags-brms.html#cb595-34"></a><span class="co"># bar plot of Bernoulli data</span></span>
<span id="cb595-35"><a href="jags-brms.html#cb595-35"></a>p3 &lt;-</span>
<span id="cb595-36"><a href="jags-brms.html#cb595-36"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>,</span>
<span id="cb595-37"><a href="jags-brms.html#cb595-37"></a>         <span class="dt">d =</span> (<span class="kw">dbinom</span>(x, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="fl">.6</span>)) <span class="op">/</span><span class="st"> </span><span class="kw">max</span>(<span class="kw">dbinom</span>(x, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="fl">.6</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb595-38"><a href="jags-brms.html#cb595-38"></a><span class="st">  </span></span>
<span id="cb595-39"><a href="jags-brms.html#cb595-39"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> d)) <span class="op">+</span></span>
<span id="cb595-40"><a href="jags-brms.html#cb595-40"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="dt">width =</span> <span class="fl">.4</span>) <span class="op">+</span></span>
<span id="cb595-41"><a href="jags-brms.html#cb595-41"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb595-42"><a href="jags-brms.html#cb595-42"></a>           <span class="dt">x =</span> <span class="fl">.5</span>, <span class="dt">y =</span> <span class="fl">.2</span>,</span>
<span id="cb595-43"><a href="jags-brms.html#cb595-43"></a>           <span class="dt">label =</span> <span class="st">&quot;Bernoulli&quot;</span>,</span>
<span id="cb595-44"><a href="jags-brms.html#cb595-44"></a>           <span class="dt">size =</span> <span class="dv">7</span>) <span class="op">+</span></span>
<span id="cb595-45"><a href="jags-brms.html#cb595-45"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb595-46"><a href="jags-brms.html#cb595-46"></a>           <span class="dt">x =</span> <span class="fl">.5</span>, <span class="dt">y =</span> <span class="fl">.92</span>,</span>
<span id="cb595-47"><a href="jags-brms.html#cb595-47"></a>           <span class="dt">label =</span> <span class="st">&quot;theta[italic(s)]&quot;</span>, </span>
<span id="cb595-48"><a href="jags-brms.html#cb595-48"></a>           <span class="dt">size =</span> <span class="dv">7</span>, <span class="dt">family =</span> <span class="st">&quot;Times&quot;</span>, <span class="dt">parse =</span> T) <span class="op">+</span></span>
<span id="cb595-49"><a href="jags-brms.html#cb595-49"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="op">-</span>.<span class="dv">75</span>, <span class="fl">1.75</span>) <span class="op">+</span></span>
<span id="cb595-50"><a href="jags-brms.html#cb595-50"></a><span class="st">  </span><span class="kw">theme_void</span>() <span class="op">+</span></span>
<span id="cb595-51"><a href="jags-brms.html#cb595-51"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.line.x =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> <span class="fl">0.5</span>))</span>
<span id="cb595-52"><a href="jags-brms.html#cb595-52"></a></span>
<span id="cb595-53"><a href="jags-brms.html#cb595-53"></a><span class="co"># another annotated arrow</span></span>
<span id="cb595-54"><a href="jags-brms.html#cb595-54"></a>p4 &lt;-</span>
<span id="cb595-55"><a href="jags-brms.html#cb595-55"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x     =</span> <span class="kw">c</span>(.<span class="dv">35</span>, <span class="fl">.65</span>),</span>
<span id="cb595-56"><a href="jags-brms.html#cb595-56"></a>         <span class="dt">y     =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>),</span>
<span id="cb595-57"><a href="jags-brms.html#cb595-57"></a>         <span class="dt">label =</span> <span class="kw">c</span>(<span class="st">&quot;&#39;~&#39;&quot;</span>, <span class="st">&quot;italic(i)*&#39;|&#39;*italic(s)&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb595-58"><a href="jags-brms.html#cb595-58"></a><span class="st">  </span></span>
<span id="cb595-59"><a href="jags-brms.html#cb595-59"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">label =</span> label)) <span class="op">+</span></span>
<span id="cb595-60"><a href="jags-brms.html#cb595-60"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">size =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">7</span>), <span class="dt">parse =</span> T, <span class="dt">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="op">+</span></span>
<span id="cb595-61"><a href="jags-brms.html#cb595-61"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">x =</span> <span class="fl">.5</span>, <span class="dt">xend =</span> <span class="fl">.5</span>,</span>
<span id="cb595-62"><a href="jags-brms.html#cb595-62"></a>               <span class="dt">y =</span> <span class="dv">1</span>, <span class="dt">yend =</span> <span class="dv">0</span>,</span>
<span id="cb595-63"><a href="jags-brms.html#cb595-63"></a>               <span class="dt">arrow =</span> my_arrow) <span class="op">+</span></span>
<span id="cb595-64"><a href="jags-brms.html#cb595-64"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb595-65"><a href="jags-brms.html#cb595-65"></a><span class="st">  </span><span class="kw">theme_void</span>()</span>
<span id="cb595-66"><a href="jags-brms.html#cb595-66"></a></span>
<span id="cb595-67"><a href="jags-brms.html#cb595-67"></a><span class="co"># some text</span></span>
<span id="cb595-68"><a href="jags-brms.html#cb595-68"></a>p5 &lt;-</span>
<span id="cb595-69"><a href="jags-brms.html#cb595-69"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x     =</span> <span class="dv">1</span>,</span>
<span id="cb595-70"><a href="jags-brms.html#cb595-70"></a>         <span class="dt">y     =</span> <span class="fl">.5</span>,</span>
<span id="cb595-71"><a href="jags-brms.html#cb595-71"></a>         <span class="dt">label =</span> <span class="st">&quot;italic(y)[italic(i)*&#39;|&#39;*italic(s)]&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb595-72"><a href="jags-brms.html#cb595-72"></a><span class="st">  </span></span>
<span id="cb595-73"><a href="jags-brms.html#cb595-73"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">label =</span> label)) <span class="op">+</span></span>
<span id="cb595-74"><a href="jags-brms.html#cb595-74"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">size =</span> <span class="dv">7</span>, <span class="dt">parse =</span> T, <span class="dt">family =</span> <span class="st">&quot;Times&quot;</span>) <span class="op">+</span></span>
<span id="cb595-75"><a href="jags-brms.html#cb595-75"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="dv">0</span>, <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb595-76"><a href="jags-brms.html#cb595-76"></a><span class="st">  </span><span class="kw">theme_void</span>()</span>
<span id="cb595-77"><a href="jags-brms.html#cb595-77"></a></span>
<span id="cb595-78"><a href="jags-brms.html#cb595-78"></a><span class="co"># define the layout</span></span>
<span id="cb595-79"><a href="jags-brms.html#cb595-79"></a>layout &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb595-80"><a href="jags-brms.html#cb595-80"></a>  <span class="kw">area</span>(<span class="dt">t =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">2</span>, <span class="dt">l =</span> <span class="dv">1</span>, <span class="dt">r =</span> <span class="dv">1</span>),</span>
<span id="cb595-81"><a href="jags-brms.html#cb595-81"></a>  <span class="kw">area</span>(<span class="dt">t =</span> <span class="dv">3</span>, <span class="dt">b =</span> <span class="dv">3</span>, <span class="dt">l =</span> <span class="dv">1</span>, <span class="dt">r =</span> <span class="dv">1</span>),</span>
<span id="cb595-82"><a href="jags-brms.html#cb595-82"></a>  <span class="kw">area</span>(<span class="dt">t =</span> <span class="dv">4</span>, <span class="dt">b =</span> <span class="dv">5</span>, <span class="dt">l =</span> <span class="dv">1</span>, <span class="dt">r =</span> <span class="dv">1</span>),</span>
<span id="cb595-83"><a href="jags-brms.html#cb595-83"></a>  <span class="kw">area</span>(<span class="dt">t =</span> <span class="dv">6</span>, <span class="dt">b =</span> <span class="dv">6</span>, <span class="dt">l =</span> <span class="dv">1</span>, <span class="dt">r =</span> <span class="dv">1</span>),</span>
<span id="cb595-84"><a href="jags-brms.html#cb595-84"></a>  <span class="kw">area</span>(<span class="dt">t =</span> <span class="dv">7</span>, <span class="dt">b =</span> <span class="dv">7</span>, <span class="dt">l =</span> <span class="dv">1</span>, <span class="dt">r =</span> <span class="dv">1</span>)</span>
<span id="cb595-85"><a href="jags-brms.html#cb595-85"></a>)</span>
<span id="cb595-86"><a href="jags-brms.html#cb595-86"></a></span>
<span id="cb595-87"><a href="jags-brms.html#cb595-87"></a><span class="co"># combine and plot!</span></span>
<span id="cb595-88"><a href="jags-brms.html#cb595-88"></a>(p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span>p4 <span class="op">+</span><span class="st"> </span>p5) <span class="op">+</span><span class="st"> </span></span>
<span id="cb595-89"><a href="jags-brms.html#cb595-89"></a><span class="st">  </span><span class="kw">plot_layout</span>(<span class="dt">design =</span> layout) <span class="op">&amp;</span></span>
<span id="cb595-90"><a href="jags-brms.html#cb595-90"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="op">&amp;</span></span>
<span id="cb595-91"><a href="jags-brms.html#cb595-91"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span> <span class="kw">margin</span>(<span class="dv">0</span>, <span class="fl">5.5</span>, <span class="dv">0</span>, <span class="fl">5.5</span>))</span></code></pre></div>
<p><img src="08_files/figure-gfm/unnamed-chunk-29-1.png" width="192" style="display: block; margin: auto;" /></p>
<p>Here is how we might fit the model with <code>brms::brm()</code>.</p>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="jags-brms.html#cb596-1"></a>fit8<span class="fl">.2</span> &lt;-</span>
<span id="cb596-2"><a href="jags-brms.html#cb596-2"></a><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data, </span>
<span id="cb596-3"><a href="jags-brms.html#cb596-3"></a>      <span class="dt">family =</span> <span class="kw">bernoulli</span>(identity),</span>
<span id="cb596-4"><a href="jags-brms.html#cb596-4"></a>      y <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>s,</span>
<span id="cb596-5"><a href="jags-brms.html#cb596-5"></a>      <span class="kw">prior</span>(<span class="kw">beta</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">class =</span> b, <span class="dt">lb =</span> <span class="dv">0</span>, <span class="dt">ub =</span> <span class="dv">1</span>),</span>
<span id="cb596-6"><a href="jags-brms.html#cb596-6"></a>      <span class="dt">iter =</span> <span class="dv">2000</span>, <span class="dt">warmup =</span> <span class="dv">500</span>, <span class="dt">cores =</span> <span class="dv">4</span>, <span class="dt">chains =</span> <span class="dv">4</span>,</span>
<span id="cb596-7"><a href="jags-brms.html#cb596-7"></a>      <span class="dt">seed =</span> <span class="dv">8</span>,</span>
<span id="cb596-8"><a href="jags-brms.html#cb596-8"></a>      <span class="dt">file =</span> <span class="st">&quot;fits/fit08.02&quot;</span>)</span></code></pre></div>
<p>More typically, we’d parameterize the model as <code>y ~ 1 + s</code>. This form would yield an intercept and a slope. Behind the scenes, <strong>brms</strong> would treat the nominal <code>s</code> variable as an 0-1 coded dummy variable. One of the nominal levels would become the reverence category, depicted by the <code>Intercept</code>, and the difference between that and the other category would be the <code>s</code> slope. However, with our <code>y ~ 0 + s</code> syntax, we’ve suppressed the typical model intercept. The consequence is that each level of the nominal variable <code>s</code> gets its own intercept or [i] index, if you will. This is analogous to Kruschke’s <code>y[i] ∼ dbern(theta[s[i]])</code> code.</p>
<p>Also, notice how we set <code>lb = 0</code> and <code>ub = 1</code> within the <code>prior()</code> function. These told <strong>brms</strong> that the lower and upper boundaries for our two intercept parameters are 0 and 1, respectively. The current version of <strong>brms</strong> will allow you to fit the model with out explicitly setting these. However, it will throw a warning. This is because there are no natural boundaries for the parameters of <code>class = b</code> on a model like this. Or at least, there aren’t any that <strong>brms</strong> has been made aware of. However, those beta priors presume the lower and upper boundaries of 0 and 1. As we’ll see later on in this ebook, we won’t usually fit models using the identity link and the Bernoulli likelihood for data like these. But that’s for another section…</p>
<p>All that aside, here are the chains.</p>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="jags-brms.html#cb597-1"></a><span class="kw">plot</span>(fit8<span class="fl">.2</span>)</span></code></pre></div>
<p><img src="08_files/figure-gfm/unnamed-chunk-30-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>The model <code>summary()</code> is as follows:</p>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="jags-brms.html#cb598-1"></a><span class="kw">summary</span>(fit8<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>##  Family: bernoulli 
##   Links: mu = identity 
## Formula: y ~ 0 + s 
##    Data: my_data (Number of observations: 15) 
## Samples: 4 chains, each with iter = 2000; warmup = 500; thin = 1;
##          total post-warmup samples = 6000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sReginald     0.67      0.13     0.38     0.89 1.00     5152     3519
## sTony         0.36      0.14     0.12     0.66 1.00     4627     4001
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>The <code>brms::pairs()</code> function gets us the bulk of Figure 8.6.</p>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb600-1"><a href="jags-brms.html#cb600-1"></a><span class="kw">pairs</span>(fit8<span class="fl">.2</span>,</span>
<span id="cb600-2"><a href="jags-brms.html#cb600-2"></a>      <span class="dt">off_diag_args =</span> <span class="kw">list</span>(<span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>))</span></code></pre></div>
<p><img src="08_files/figure-gfm/unnamed-chunk-32-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>But to get at that difference-score distribution, we’ll have extract the posterior iterations with <code>posterior_samples()</code>, make difference score with <code>mutate()</code>, and manually plot with <strong>ggplot2</strong>.</p>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="jags-brms.html#cb601-1"></a>post &lt;-<span class="st"> </span><span class="kw">posterior_samples</span>(fit8<span class="fl">.2</span>)</span>
<span id="cb601-2"><a href="jags-brms.html#cb601-2"></a></span>
<span id="cb601-3"><a href="jags-brms.html#cb601-3"></a>post &lt;-</span>
<span id="cb601-4"><a href="jags-brms.html#cb601-4"></a><span class="st">  </span>post <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb601-5"><a href="jags-brms.html#cb601-5"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">theta_Reginald =</span> b_sReginald,</span>
<span id="cb601-6"><a href="jags-brms.html#cb601-6"></a>         <span class="dt">theta_Tony     =</span> b_sTony) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb601-7"><a href="jags-brms.html#cb601-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">theta_Reginald - theta_Tony</span><span class="st">`</span> =<span class="st"> </span>theta_Reginald <span class="op">-</span><span class="st"> </span>theta_Tony)</span>
<span id="cb601-8"><a href="jags-brms.html#cb601-8"></a></span>
<span id="cb601-9"><a href="jags-brms.html#cb601-9"></a><span class="kw">glimpse</span>(post)</span></code></pre></div>
<pre><code>## Rows: 6,000
## Columns: 4
## $ theta_Reginald                &lt;dbl&gt; 0.7757244, 0.6615629, 0.6392801, 0.5430331, 0.5246347, 0.52…
## $ theta_Tony                    &lt;dbl&gt; 0.3163358, 0.4048103, 0.3239676, 0.2919574, 0.2351882, 0.20…
## $ lp__                          &lt;dbl&gt; -11.69349, -11.30482, -11.32344, -11.77508, -12.21795, -12.…
## $ `theta_Reginald - theta_Tony` &lt;dbl&gt; 0.45938855, 0.25675262, 0.31531244, 0.25107566, 0.28944655,…</code></pre>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="jags-brms.html#cb603-1"></a>gathered_post &lt;-</span>
<span id="cb603-2"><a href="jags-brms.html#cb603-2"></a><span class="st">  </span>post <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb603-3"><a href="jags-brms.html#cb603-3"></a><span class="st">  </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;theta&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb603-4"><a href="jags-brms.html#cb603-4"></a><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb603-5"><a href="jags-brms.html#cb603-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">key =</span> <span class="kw">factor</span>(key, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;theta_Reginald&quot;</span>, <span class="st">&quot;theta_Tony&quot;</span>, <span class="st">&quot;theta_Reginald - theta_Tony&quot;</span>))) </span>
<span id="cb603-6"><a href="jags-brms.html#cb603-6"></a>  </span>
<span id="cb603-7"><a href="jags-brms.html#cb603-7"></a>gathered_post <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb603-8"><a href="jags-brms.html#cb603-8"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">fill =</span> key)) <span class="op">+</span></span>
<span id="cb603-9"><a href="jags-brms.html#cb603-9"></a><span class="st">  </span><span class="kw">stat_histinterval</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>,</span>
<span id="cb603-10"><a href="jags-brms.html#cb603-10"></a>                    <span class="dt">slab_color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">outline_bars =</span> T,</span>
<span id="cb603-11"><a href="jags-brms.html#cb603-11"></a>                    <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></span>
<span id="cb603-12"><a href="jags-brms.html#cb603-12"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">colorblind_pal</span>()(<span class="dv">8</span>)[<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb603-13"><a href="jags-brms.html#cb603-13"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb603-14"><a href="jags-brms.html#cb603-14"></a><span class="st">  </span><span class="kw">theme_minimal_hgrid</span>() <span class="op">+</span></span>
<span id="cb603-15"><a href="jags-brms.html#cb603-15"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="08_files/figure-gfm/unnamed-chunk-34-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>Note how this time we used the <code>colorblind_pal()</code> function within <code>scale_fill_manual()</code> to manually select three of the of the <code>scale_fill_colorblind()</code> colors.</p>
<p>Anyway, here’s a way to get the numeric summaries out of <code>post</code>.</p>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="jags-brms.html#cb604-1"></a>gathered_post <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb604-2"><a href="jags-brms.html#cb604-2"></a><span class="st">  </span><span class="kw">group_by</span>(key) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb604-3"><a href="jags-brms.html#cb604-3"></a><span class="st">  </span><span class="kw">mode_hdi</span>()</span></code></pre></div>
<pre><code>## # A tibble: 3 x 7
##   key                         value  .lower .upper .width .point .interval
##   &lt;fct&gt;                       &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1 theta_Reginald              0.708  0.405   0.908   0.95 mode   hdi      
## 2 theta_Tony                  0.328  0.102   0.631   0.95 mode   hdi      
## 3 theta_Reginald - theta_Tony 0.332 -0.0720  0.670   0.95 mode   hdi</code></pre>
<p>In this context, the <code>mode_hdi()</code> summary yields:</p>
<ul>
<li><code>key</code> (i.e., the name we used to denote the parameters)</li>
<li><code>value</code> (i.e., the value of the measure of central tendency)</li>
<li><code>.lower</code> (i.e., the lower level of the 95% HDI)</li>
<li><code>.upper</code> (i.e., the upper level…)</li>
<li><code>.width</code> (i.e., what interval we used)</li>
<li><code>.point</code> (i.e., the type of measure of central tendency)</li>
<li><code>.interval</code> (i.e., the type of interval)</li>
</ul>
</div>
<div id="sampling-from-the-prior-distribution-in-jags-brms" class="section level2">
<h2><span class="header-section-number">8.5</span> Sampling from the prior distribution in <del>JAGS</del> brms</h2>
<p>There are a few ways to sample from the prior distribution with <strong>brms</strong>. Here we’ll do so by setting <code>sample_prior = "only"</code>. As a consequence, <code>brm()</code> will ignore the likelihood and return samples based solely on the model priors.</p>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="jags-brms.html#cb606-1"></a>fit8<span class="fl">.3</span> &lt;-</span>
<span id="cb606-2"><a href="jags-brms.html#cb606-2"></a><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data, </span>
<span id="cb606-3"><a href="jags-brms.html#cb606-3"></a>      <span class="dt">family =</span> <span class="kw">bernoulli</span>(identity),</span>
<span id="cb606-4"><a href="jags-brms.html#cb606-4"></a>      y <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>s,</span>
<span id="cb606-5"><a href="jags-brms.html#cb606-5"></a>      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">beta</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">class =</span> b, <span class="dt">coef =</span> sReginald),</span>
<span id="cb606-6"><a href="jags-brms.html#cb606-6"></a>                <span class="kw">prior</span>(<span class="kw">beta</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">class =</span> b, <span class="dt">coef =</span> sTony)),</span>
<span id="cb606-7"><a href="jags-brms.html#cb606-7"></a>      <span class="dt">iter =</span> <span class="dv">2000</span>, <span class="dt">warmup =</span> <span class="dv">500</span>, <span class="dt">cores =</span> <span class="dv">4</span>, <span class="dt">chains =</span> <span class="dv">4</span>,</span>
<span id="cb606-8"><a href="jags-brms.html#cb606-8"></a>      <span class="dt">sample_prior =</span> <span class="st">&quot;only&quot;</span>,</span>
<span id="cb606-9"><a href="jags-brms.html#cb606-9"></a>      <span class="dt">seed =</span> <span class="dv">8</span>,</span>
<span id="cb606-10"><a href="jags-brms.html#cb606-10"></a>      <span class="dt">file =</span> <span class="st">&quot;fits/fit08.03&quot;</span>)</span></code></pre></div>
<p>Because we set <code>sample_prior = "only"</code>, the <code>posterior_samples()</code> will now return samples from the priors.</p>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="jags-brms.html#cb607-1"></a>prior &lt;-<span class="st"> </span><span class="kw">posterior_samples</span>(fit8<span class="fl">.3</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>lp__)</span>
<span id="cb607-2"><a href="jags-brms.html#cb607-2"></a></span>
<span id="cb607-3"><a href="jags-brms.html#cb607-3"></a><span class="kw">head</span>(prior)</span></code></pre></div>
<pre><code>##   b_sReginald   b_sTony
## 1   0.4318585 0.6822865
## 2   0.6700181 0.8813427
## 3   0.4927418 0.7670926
## 4   0.5427397 0.6701206
## 5   0.2595087 0.4352793
## 6   0.2162240 0.6038407</code></pre>
<p>With <code>prior</code> in hand, we’re almost ready to make the prior histograms of Figure 8.7. But first we’ll want to determine the <span class="math inline">\(z/N\)</span> values in order to mark them off in the plots. [You’ll note Kruschke did so with gray plus marks in his.]</p>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="jags-brms.html#cb609-1"></a>my_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb609-2"><a href="jags-brms.html#cb609-2"></a><span class="st">  </span><span class="kw">group_by</span>(s) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb609-3"><a href="jags-brms.html#cb609-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">z =</span> <span class="kw">sum</span>(y),</span>
<span id="cb609-4"><a href="jags-brms.html#cb609-4"></a>            <span class="dt">N =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb609-5"><a href="jags-brms.html#cb609-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">z/N</span><span class="st">`</span> =<span class="st"> </span>z <span class="op">/</span><span class="st"> </span>N)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 4
##   s            z     N `z/N`
##   &lt;chr&gt;    &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
## 1 Reginald     6     8 0.75 
## 2 Tony         2     7 0.286</code></pre>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="jags-brms.html#cb611-1"></a>d_line &lt;-</span>
<span id="cb611-2"><a href="jags-brms.html#cb611-2"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">value =</span> <span class="kw">c</span>(.<span class="dv">75</span>, <span class="fl">.286</span>, <span class="fl">.75</span> <span class="op">-</span><span class="st"> </span><span class="fl">.286</span>),</span>
<span id="cb611-3"><a href="jags-brms.html#cb611-3"></a>         <span class="dt">key   =</span>  <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;theta_Reginald&quot;</span>, <span class="st">&quot;theta_Tony&quot;</span>, <span class="st">&quot;theta_Reginald - theta_Tony&quot;</span>), </span>
<span id="cb611-4"><a href="jags-brms.html#cb611-4"></a>                         <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;theta_Reginald&quot;</span>, <span class="st">&quot;theta_Tony&quot;</span>, <span class="st">&quot;theta_Reginald - theta_Tony&quot;</span>)))</span></code></pre></div>
<p>Behold the histograms of Figure 8.7.</p>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="jags-brms.html#cb612-1"></a>prior <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb612-2"><a href="jags-brms.html#cb612-2"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">theta_Reginald =</span> b_sReginald,</span>
<span id="cb612-3"><a href="jags-brms.html#cb612-3"></a>         <span class="dt">theta_Tony     =</span> b_sTony) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb612-4"><a href="jags-brms.html#cb612-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">theta_Reginald - theta_Tony</span><span class="st">`</span> =<span class="st"> </span>theta_Reginald <span class="op">-</span><span class="st"> </span>theta_Tony) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb612-5"><a href="jags-brms.html#cb612-5"></a><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb612-6"><a href="jags-brms.html#cb612-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">key =</span> <span class="kw">factor</span>(key, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;theta_Reginald&quot;</span>, <span class="st">&quot;theta_Tony&quot;</span>, <span class="st">&quot;theta_Reginald - theta_Tony&quot;</span>))) <span class="op">%&gt;%</span></span>
<span id="cb612-7"><a href="jags-brms.html#cb612-7"></a><span class="st">  </span></span>
<span id="cb612-8"><a href="jags-brms.html#cb612-8"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></span>
<span id="cb612-9"><a href="jags-brms.html#cb612-9"></a><span class="st">  </span><span class="kw">stat_histinterval</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>,</span>
<span id="cb612-10"><a href="jags-brms.html#cb612-10"></a>                    <span class="dt">fill =</span> <span class="kw">colorblind_pal</span>()(<span class="dv">8</span>)[<span class="dv">5</span>], <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></span>
<span id="cb612-11"><a href="jags-brms.html#cb612-11"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">data =</span> d_line, </span>
<span id="cb612-12"><a href="jags-brms.html#cb612-12"></a>             <span class="kw">aes</span>(<span class="dt">xintercept =</span> value), </span>
<span id="cb612-13"><a href="jags-brms.html#cb612-13"></a>             <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb612-14"><a href="jags-brms.html#cb612-14"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb612-15"><a href="jags-brms.html#cb612-15"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="kw">expression</span>(<span class="st">&quot;The dashed vertical lines mark off &quot;</span><span class="op">*</span><span class="kw">italic</span>(z[s])<span class="op">/</span><span class="kw">italic</span>(N[s]))) <span class="op">+</span></span>
<span id="cb612-16"><a href="jags-brms.html#cb612-16"></a><span class="st">  </span><span class="kw">theme_cowplot</span>() <span class="op">+</span></span>
<span id="cb612-17"><a href="jags-brms.html#cb612-17"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="08_files/figure-gfm/unnamed-chunk-38-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>Here’s how you might make the scatter plot.</p>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="jags-brms.html#cb613-1"></a>prior <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb613-2"><a href="jags-brms.html#cb613-2"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">theta_Reginald =</span> b_sReginald,</span>
<span id="cb613-3"><a href="jags-brms.html#cb613-3"></a>         <span class="dt">theta_Tony     =</span> b_sTony) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb613-4"><a href="jags-brms.html#cb613-4"></a><span class="st">  </span></span>
<span id="cb613-5"><a href="jags-brms.html#cb613-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta_Reginald, <span class="dt">y =</span> theta_Tony)) <span class="op">+</span></span>
<span id="cb613-6"><a href="jags-brms.html#cb613-6"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dt">color =</span> <span class="kw">colorblind_pal</span>()(<span class="dv">8</span>)[<span class="dv">6</span>]) <span class="op">+</span></span>
<span id="cb613-7"><a href="jags-brms.html#cb613-7"></a><span class="st">  </span><span class="kw">coord_equal</span>() <span class="op">+</span></span>
<span id="cb613-8"><a href="jags-brms.html#cb613-8"></a><span class="st">  </span><span class="kw">theme_minimal_grid</span>()</span></code></pre></div>
<p><img src="08_files/figure-gfm/unnamed-chunk-39-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>Or you could always use a two-dimensional density plot with <code>stat_density_2d()</code>.</p>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb614-1"><a href="jags-brms.html#cb614-1"></a>prior <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb614-2"><a href="jags-brms.html#cb614-2"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">theta_Reginald =</span> b_sReginald,</span>
<span id="cb614-3"><a href="jags-brms.html#cb614-3"></a>         <span class="dt">theta_Tony     =</span> b_sTony) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb614-4"><a href="jags-brms.html#cb614-4"></a><span class="st">  </span></span>
<span id="cb614-5"><a href="jags-brms.html#cb614-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta_Reginald, <span class="dt">y =</span> theta_Tony)) <span class="op">+</span></span>
<span id="cb614-6"><a href="jags-brms.html#cb614-6"></a><span class="st">  </span><span class="kw">stat_density_2d</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> <span class="kw">stat</span>(density)), </span>
<span id="cb614-7"><a href="jags-brms.html#cb614-7"></a>                  <span class="dt">geom =</span> <span class="st">&quot;raster&quot;</span>, <span class="dt">contour =</span> F) <span class="op">+</span></span>
<span id="cb614-8"><a href="jags-brms.html#cb614-8"></a><span class="st">  </span><span class="kw">scale_fill_viridis_c</span>(<span class="dt">option =</span> <span class="st">&quot;B&quot;</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb614-9"><a href="jags-brms.html#cb614-9"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="kw">expression</span>(theta[<span class="dv">1</span>]), </span>
<span id="cb614-10"><a href="jags-brms.html#cb614-10"></a>                     <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb614-11"><a href="jags-brms.html#cb614-11"></a>                     <span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">4</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;.25&quot;</span>, <span class="st">&quot;.5&quot;</span>, <span class="st">&quot;.75&quot;</span>, <span class="st">&quot;1&quot;</span>)) <span class="op">+</span></span>
<span id="cb614-12"><a href="jags-brms.html#cb614-12"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="kw">expression</span>(theta[<span class="dv">2</span>]), </span>
<span id="cb614-13"><a href="jags-brms.html#cb614-13"></a>                     <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb614-14"><a href="jags-brms.html#cb614-14"></a>                     <span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">4</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;.25&quot;</span>, <span class="st">&quot;.5&quot;</span>, <span class="st">&quot;.75&quot;</span>, <span class="st">&quot;1&quot;</span>)) <span class="op">+</span></span>
<span id="cb614-15"><a href="jags-brms.html#cb614-15"></a><span class="st">  </span><span class="kw">coord_equal</span>() <span class="op">+</span></span>
<span id="cb614-16"><a href="jags-brms.html#cb614-16"></a><span class="st">  </span><span class="kw">theme_minimal_grid</span>()</span></code></pre></div>
<p><img src="08_files/figure-gfm/unnamed-chunk-40-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>The viridis color palettes in functions like <code>scale_fill_viridis_c()</code> and <code>scale_fill_viridis_d()</code> are designed to be colorblind safe, too <span class="citation">(Garnier, <a href="#ref-R-viridis" role="doc-biblioref">2018</a>)</span>.</p>
</div>
<div id="probability-distributions-available-in-jags-brms" class="section level2">
<h2><span class="header-section-number">8.6</span> Probability distributions available in <del>JAGS</del> brms</h2>
<blockquote>
<p>[<strong>brms</strong>] has a large collection of frequently used probability distributions that are built-in. These distributions include the beta, gamma, normal, Bernoulli, and binomial along with many others. A complete list of distributions, and their [<strong>brms</strong>] names, can be found in [Bürkner’s <span class="citation">(<a href="#ref-Bürkner2020Parameterization" role="doc-biblioref">2020</a><a href="#ref-Bürkner2020Parameterization" role="doc-biblioref">c</a>)</span> vignette <a href="https://CRAN.R-project.org/package=brms/vignettes/brms_families.html"><em>Parameterization of response distributions in brms</em></a>]. <span class="citation">(Kruschke, <a href="#ref-kruschkeDoingBayesianData2015" role="doc-biblioref">2015</a>, pp. 213–214, <strong>emphasis</strong> added)</span></p>
</blockquote>
<div id="defining-new-likelihood-functions." class="section level3">
<h3><span class="header-section-number">8.6.1</span> Defining new likelihood functions.</h3>
<p>In addition to all the likelihood functions listed in above mentioned vignette, you can also make your own likelihood functions. Bürkner explained the method in his <span class="citation">(<a href="#ref-Bürkner2020Define" role="doc-biblioref">2020</a><a href="#ref-Bürkner2020Define" role="doc-biblioref">e</a>)</span> vignette, <a href="https://CRAN.R-project.org/package=brms/vignettes/brms_customfamilies.html"><em>Define custom response distributions with brms</em></a>.</p>
</div>
</div>
<div id="faster-sampling-with-parallel-processing-in-runjags-brmsbrm" class="section level2">
<h2><span class="header-section-number">8.7</span> Faster sampling with parallel processing in <del>runjags</del> <code>brms::brm()</code></h2>
<p>We don’t need to open another package to sample in parallel in <strong>brms</strong>. In fact, we’ve already been doing that. Take another look at the code use used for the last model, <code>fit8.2</code>.</p>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="jags-brms.html#cb615-1"></a>fit8<span class="fl">.2</span> &lt;-</span>
<span id="cb615-2"><a href="jags-brms.html#cb615-2"></a><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data, </span>
<span id="cb615-3"><a href="jags-brms.html#cb615-3"></a>      <span class="dt">family =</span> <span class="kw">bernoulli</span>(identity),</span>
<span id="cb615-4"><a href="jags-brms.html#cb615-4"></a>      y <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>s,</span>
<span id="cb615-5"><a href="jags-brms.html#cb615-5"></a>      <span class="kw">prior</span>(<span class="kw">beta</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">class =</span> b, <span class="dt">lb =</span> <span class="dv">0</span>, <span class="dt">ub =</span> <span class="dv">1</span>),</span>
<span id="cb615-6"><a href="jags-brms.html#cb615-6"></a>      <span class="dt">iter =</span> <span class="dv">2000</span>, <span class="dt">warmup =</span> <span class="dv">500</span>, <span class="dt">cores =</span> <span class="dv">4</span>, <span class="dt">chains =</span> <span class="dv">4</span>,</span>
<span id="cb615-7"><a href="jags-brms.html#cb615-7"></a>      <span class="dt">seed =</span> <span class="dv">8</span>,</span>
<span id="cb615-8"><a href="jags-brms.html#cb615-8"></a>      <span class="dt">file =</span> <span class="st">&quot;fits/fit08.02&quot;</span>)</span></code></pre></div>
<p>See the <code>cores = 4, chains = 4</code> arguments? With that bit of code, we told <code>brms::brm()</code> we wanted 4 chains, which we ran in parallel across 4 cores.</p>
</div>
<div id="tips-for-expanding-jags-brms-models" class="section level2">
<h2><span class="header-section-number">8.8</span> Tips for expanding <del>JAGS</del> brms models</h2>
<p>I’m in complete agreement with Kruschke, here:</p>
<blockquote>
<p>Often, the process of programming a model is done is stages, starting with a simple model and then incrementally incorporating complexifications. At each step, the model is checked for accuracy and efficiency. This procedure of incremental building is useful for creating a desired complex model from scratch, for expanding a previously created model for a new application, and for expanding a model that has been found to be inadequate in a posterior predictive check. (p. 218)</p>
</blockquote>
</div>
<div id="session-info-7" class="section level2 unnumbered">
<h2>Session info</h2>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb616-1"><a href="jags-brms.html#cb616-1"></a><span class="kw">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 3.6.3 (2020-02-29)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Catalina 10.15.3
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] ggthemes_4.2.0       tidybayes_2.1.1      bayesplot_1.7.1      brms_2.13.5         
##  [5] Rcpp_1.0.5           cowplot_1.0.0.9000   patchwork_1.0.1.9000 forcats_0.5.0       
##  [9] stringr_1.4.0        dplyr_1.0.1          purrr_0.3.4          readr_1.3.1         
## [13] tidyr_1.1.1          tibble_3.0.3         ggplot2_3.3.2        tidyverse_1.3.0     
## 
## loaded via a namespace (and not attached):
##   [1] TH.data_1.0-10       colorspace_1.4-1     ellipsis_0.3.1       ggridges_0.5.2      
##   [5] rsconnect_0.8.16     estimability_1.3     markdown_1.1         base64enc_0.1-3     
##   [9] fs_1.4.1             rstudioapi_0.11      farver_2.0.3         rstan_2.19.3        
##  [13] svUnit_1.0.3         DT_0.13              fansi_0.4.1          mvtnorm_1.1-0       
##  [17] lubridate_1.7.8      xml2_1.3.1           codetools_0.2-16     splines_3.6.3       
##  [21] bridgesampling_1.0-0 knitr_1.28           shinythemes_1.1.2    jsonlite_1.7.0      
##  [25] broom_0.5.5          dbplyr_1.4.2         ggdist_2.1.1         shiny_1.5.0         
##  [29] compiler_3.6.3       httr_1.4.1           emmeans_1.4.5        backports_1.1.9     
##  [33] assertthat_0.2.1     Matrix_1.2-18        fastmap_1.0.1        cli_2.0.2           
##  [37] later_1.1.0.1        htmltools_0.5.0      prettyunits_1.1.1    tools_3.6.3         
##  [41] igraph_1.2.5         coda_0.19-3          gtable_0.3.0         glue_1.4.2          
##  [45] reshape2_1.4.4       cellranger_1.1.0     vctrs_0.3.4          nlme_3.1-144        
##  [49] crosstalk_1.1.0.1    xfun_0.13            ps_1.3.4             rvest_0.3.5         
##  [53] mime_0.9             miniUI_0.1.1.1       lifecycle_0.2.0      gtools_3.8.2        
##  [57] MASS_7.3-51.5        zoo_1.8-7            scales_1.1.1         colourpicker_1.0    
##  [61] hms_0.5.3            promises_1.1.1       Brobdingnag_1.2-6    sandwich_2.5-1      
##  [65] parallel_3.6.3       inline_0.3.15        shinystan_2.5.0      yaml_2.2.1          
##  [69] gridExtra_2.3        StanHeaders_2.21.0-1 loo_2.3.1            stringi_1.4.6       
##  [73] dygraphs_1.1.1.6     pkgbuild_1.1.0       rlang_0.4.7          pkgconfig_2.0.3     
##  [77] matrixStats_0.56.0   HDInterval_0.2.0     evaluate_0.14        lattice_0.20-38     
##  [81] rstantools_2.1.1     htmlwidgets_1.5.1    labeling_0.3         tidyselect_1.1.0    
##  [85] processx_3.4.4       plyr_1.8.6           magrittr_1.5         bookdown_0.18       
##  [89] R6_2.4.1             generics_0.0.2       multcomp_1.4-13      DBI_1.1.0           
##  [93] pillar_1.4.6         haven_2.2.0          withr_2.2.0          xts_0.12-0          
##  [97] survival_3.1-12      abind_1.4-5          modelr_0.1.6         crayon_1.3.4        
## [101] arrayhelpers_1.1-0   utf8_1.1.4           rmarkdown_2.1        grid_3.6.3          
## [105] readxl_1.3.1         callr_3.4.4          threejs_0.3.3        reprex_0.3.0        
## [109] digest_0.6.25        xtable_1.8-4         httpuv_1.5.4         stats4_3.6.3        
## [113] munsell_0.5.0        viridisLite_0.3.0    shinyjs_1.1</code></pre>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-burknerBrmsPackageBayesian2017">
<p>Bürkner, P.-C. (2017). brms: An R package for Bayesian multilevel models using Stan. <em>Journal of Statistical Software</em>, <em>80</em>(1), 1–28. <a href="https://doi.org/10.18637/jss.v080.i01">https://doi.org/10.18637/jss.v080.i01</a></p>
</div>
<div id="ref-R-brms">
<p>Bürkner, P.-C. (2020a). <em>brms: Bayesian regression models using ’Stan’</em>. <a href="https://CRAN.R-project.org/package=brms">https://CRAN.R-project.org/package=brms</a></p>
</div>
<div id="ref-Bürkner2020Parameterization">
<p>Bürkner, P.-C. (2020c). <em>Parameterization of response distributions in brms</em>. <a href="https://CRAN.R-project.org/package=brms/vignettes/brms_families.html">https://CRAN.R-project.org/package=brms/vignettes/brms_families.html</a></p>
</div>
<div id="ref-Bürkner2020Define">
<p>Bürkner, P.-C. (2020e). <em>Define custom response distributions with brms</em>. <a href="https://CRAN.R-project.org/package=brms/vignettes/brms_customfamilies.html">https://CRAN.R-project.org/package=brms/vignettes/brms_customfamilies.html</a></p>
</div>
<div id="ref-R-viridis">
<p>Garnier, S. (2018). <em>viridis: Default color maps from ’matplotlib’</em> [Manual]. <a href="https://CRAN.R-project.org/package=viridis">https://CRAN.R-project.org/package=viridis</a></p>
</div>
<div id="ref-kaySlabIntervalStats2020">
<p>Kay, M. (2020c). <em>Slab + interval stats and geoms</em>. <a href="https://mjskay.github.io/ggdist/articles/slabinterval.html">https://mjskay.github.io/ggdist/articles/slabinterval.html</a></p>
</div>
<div id="ref-kruschkeDoingBayesianData2015">
<p>Kruschke, J. K. (2015). <em>Doing Bayesian data analysis: A tutorial with R, JAGS, and Stan</em>. Academic Press. <a href="https://sites.google.com/site/doingbayesiandataanalysis/">https://sites.google.com/site/doingbayesiandataanalysis/</a></p>
</div>
<div id="ref-R-colorblindr">
<p>McWhite, C. D., &amp; Wilke, C. O. (2020). <em>colorblindr: Simulate colorblindness in R figures</em> [Manual]. <a href="https://github.com/clauswilke/colorblindr">https://github.com/clauswilke/colorblindr</a></p>
</div>
<div id="ref-standevelopmentteamStanReferenceManual2020">
<p>Stan Development Team. (2020a). <em>Stan reference manual, Version 2.24</em>. <a href="https://mc-stan.org/docs/2_24/reference-manual/">https://mc-stan.org/docs/2_24/reference-manual/</a></p>
</div>
<div id="ref-standevelopmentteamStanUserGuide2020">
<p>Stan Development Team. (2020b). <em>Stan user’s guide, Version 2.24</em>. <a href="https://mc-stan.org/docs/2_24/stan-users-guide/index.html">https://mc-stan.org/docs/2_24/stan-users-guide/index.html</a></p>
</div>
<div id="ref-Wilke2019Themes">
<p>Wilke, C. O. (2019b). <em>Themes</em>. <a href="https://wilkelab.org/cowplot/articles/themes.html">https://wilkelab.org/cowplot/articles/themes.html</a></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="markov-chain-monte-carlo.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="hierarchical-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
