<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>18 Metric Predicted Variable with Multiple Metric Predictors | Doing Bayesian Data Analysis in brms and the tidyverse</title>
  <meta name="description" content="This project is an attempt to re-express the code in Kruschke’s (2014) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="18 Metric Predicted Variable with Multiple Metric Predictors | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This project is an attempt to re-express the code in Kruschke’s (2014) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="github-repo" content="ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="18 Metric Predicted Variable with Multiple Metric Predictors | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This project is an attempt to re-express the code in Kruschke’s (2014) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2019-11-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="metric-predicted-variable-with-one-metric-predictor.html">
<link rel="next" href="metric-predicted-variable-with-one-nominal-predictor.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What and why</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#caution-work-in-progress"><i class="fa fa-check"></i>Caution: Work in progress</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html"><i class="fa fa-check"></i><b>1</b> What’s in This Book (Read This First!)</a><ul>
<li class="chapter" data-level="1.1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#real-people-can-read-this-book"><i class="fa fa-check"></i><b>1.1</b> Real people can read this book</a></li>
<li class="chapter" data-level="1.2" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-in-this-book"><i class="fa fa-check"></i><b>1.2</b> What’s in this book</a></li>
<li class="chapter" data-level="1.3" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-new-in-the-second-edition"><i class="fa fa-check"></i><b>1.3</b> What’s new in the second edition</a></li>
<li class="chapter" data-level="1.4" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#gimme-feedback-be-polite"><i class="fa fa-check"></i><b>1.4</b> Gimme feedback (be polite)</a></li>
<li class="chapter" data-level="1.5" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#thank-you"><i class="fa fa-check"></i><b>1.5</b> Thank you!</a></li>
<li class="chapter" data-level="" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#reference"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>I THE BASICS: MODELS, PROBABILITY, BAYES’ RULE, AND R</b></span></li>
<li class="chapter" data-level="2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html"><i class="fa fa-check"></i><b>2</b> Introduction: Credibility, Models, and Parameters</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#bayesian-inference-is-reallocation-of-credibility-across-possibilities"><i class="fa fa-check"></i><b>2.1</b> Bayesian inference is reallocation of credibility across possibilities</a><ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#data-are-noisy-and-inferences-are-probabilistic."><i class="fa fa-check"></i><b>2.1.1</b> Data are noisy and inferences are probabilistic.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#possibilities-are-parameter-values-in-descriptive-models"><i class="fa fa-check"></i><b>2.2</b> Possibilities are parameter values in descriptive models</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#the-steps-of-bayesian-data-analysis"><i class="fa fa-check"></i><b>2.3</b> The steps of Bayesian data analysis</a></li>
<li class="chapter" data-level="" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#reference-1"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html"><i class="fa fa-check"></i><b>3</b> The R Programming Language</a><ul>
<li class="chapter" data-level="3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-software"><i class="fa fa-check"></i><b>3.1</b> Get the software</a><ul>
<li class="chapter" data-level="3.1.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-look-at-rstudio."><i class="fa fa-check"></i><b>3.1.1</b> A look at RStudio.</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-simple-example-of-r-in-action"><i class="fa fa-check"></i><b>3.2</b> A simple example of R in action</a><ul>
<li class="chapter" data-level="3.2.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-programs-used-with-this-book."><i class="fa fa-check"></i><b>3.2.1</b> Get the programs used with this book.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#basic-commands-and-operators-in-r"><i class="fa fa-check"></i><b>3.3</b> Basic commands and operators in R</a><ul>
<li class="chapter" data-level="3.3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#getting-help-in-r."><i class="fa fa-check"></i><b>3.3.1</b> Getting help in R.</a></li>
<li class="chapter" data-level="3.3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#arithmetic-and-logical-operators."><i class="fa fa-check"></i><b>3.3.2</b> Arithmetic and logical operators.</a></li>
<li class="chapter" data-level="3.3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#assignment-relational-operators-and-tests-of-equality."><i class="fa fa-check"></i><b>3.3.3</b> Assignment, relational operators, and tests of equality.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-types"><i class="fa fa-check"></i><b>3.4</b> Variable types</a><ul>
<li class="chapter" data-level="3.4.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#vector."><i class="fa fa-check"></i><b>3.4.1</b> Vector.</a></li>
<li class="chapter" data-level="3.4.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#factor."><i class="fa fa-check"></i><b>3.4.2</b> Factor.</a></li>
<li class="chapter" data-level="3.4.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#matrix-and-array."><i class="fa fa-check"></i><b>3.4.3</b> Matrix and array.</a></li>
<li class="chapter" data-level="3.4.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#list-and-data-frame."><i class="fa fa-check"></i><b>3.4.4</b> List and data frame.</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#loading-and-saving-data"><i class="fa fa-check"></i><b>3.5</b> Loading and saving data</a><ul>
<li class="chapter" data-level="3.5.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#the-read.csv-read_csv-and-read.table-read_table-functions."><i class="fa fa-check"></i><b>3.5.1</b> The <del>read.csv</del> <code>read_csv()</code> and <del>read.table</del> <code>read_table()</code> functions.</a></li>
<li class="chapter" data-level="3.5.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#saving-data-from-r."><i class="fa fa-check"></i><b>3.5.2</b> Saving data from R.</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#some-utility-functions"><i class="fa fa-check"></i><b>3.6</b> Some utility functions</a></li>
<li class="chapter" data-level="3.7" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-in-r"><i class="fa fa-check"></i><b>3.7</b> Programming in R</a><ul>
<li class="chapter" data-level="3.7.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-names-in-r."><i class="fa fa-check"></i><b>3.7.1</b> Variable names in R.</a></li>
<li class="chapter" data-level="3.7.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#running-a-program."><i class="fa fa-check"></i><b>3.7.2</b> Running a program.</a></li>
<li class="chapter" data-level="3.7.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-a-function."><i class="fa fa-check"></i><b>3.7.3</b> Programming a function.</a></li>
<li class="chapter" data-level="3.7.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#conditions-and-loops."><i class="fa fa-check"></i><b>3.7.4</b> Conditions and loops.</a></li>
<li class="chapter" data-level="3.7.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#measuring-processing-time."><i class="fa fa-check"></i><b>3.7.5</b> Measuring processing time.</a></li>
<li class="chapter" data-level="3.7.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#debugging."><i class="fa fa-check"></i><b>3.7.6</b> Debugging.</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#graphical-plots-opening-and-saving"><i class="fa fa-check"></i><b>3.8</b> Graphical plots: Opening and saving</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#reference-2"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html"><i class="fa fa-check"></i><b>4</b> What is This Stuff Called Probability?</a><ul>
<li class="chapter" data-level="4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#the-set-of-all-possible-events"><i class="fa fa-check"></i><b>4.1</b> The set of all possible events</a></li>
<li class="chapter" data-level="4.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-outside-or-inside-the-head"><i class="fa fa-check"></i><b>4.2</b> Probability: Outside or inside the head</a><ul>
<li class="chapter" data-level="4.2.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#outside-the-head-long-run-relative-frequency."><i class="fa fa-check"></i><b>4.2.1</b> Outside the head: Long-run relative frequency.</a></li>
<li class="chapter" data-level="4.2.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#inside-the-head-subjective-belief."><i class="fa fa-check"></i><b>4.2.2</b> Inside the head: Subjective belief.</a></li>
<li class="chapter" data-level="4.2.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probabilities-assign-numbers-to-possibilities."><i class="fa fa-check"></i><b>4.2.3</b> Probabilities assign numbers to possibilities.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-distributions"><i class="fa fa-check"></i><b>4.3</b> Probability distributions</a><ul>
<li class="chapter" data-level="4.3.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#discrete-distributions-probability-mass."><i class="fa fa-check"></i><b>4.3.1</b> Discrete distributions: Probability mass.</a></li>
<li class="chapter" data-level="4.3.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#continuous-distributions-rendezvous-with-density."><i class="fa fa-check"></i><b>4.3.2</b> Continuous distributions: Rendezvous with density.</a></li>
<li class="chapter" data-level="4.3.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#mean-and-variance-of-a-distribution."><i class="fa fa-check"></i><b>4.3.3</b> Mean and variance of a distribution.</a></li>
<li class="chapter" data-level="4.3.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#highest-density-interval-hdi."><i class="fa fa-check"></i><b>4.3.4</b> Highest density interval (HDI).</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#two-way-distributions"><i class="fa fa-check"></i><b>4.4</b> Two-way distributions</a></li>
<li class="chapter" data-level="" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#reference-3"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes-rule.html"><a href="bayes-rule.html"><i class="fa fa-check"></i><b>5</b> Bayes’ Rule</a><ul>
<li class="chapter" data-level="5.1" data-path="bayes-rule.html"><a href="bayes-rule.html#bayes-rule-1"><i class="fa fa-check"></i><b>5.1</b> Bayes’ rule</a><ul>
<li class="chapter" data-level="5.1.1" data-path="bayes-rule.html"><a href="bayes-rule.html#derived-from-definitions-of-conditional-probability."><i class="fa fa-check"></i><b>5.1.1</b> Derived from definitions of conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bayes-rule.html"><a href="bayes-rule.html#applied-to-parameters-and-data"><i class="fa fa-check"></i><b>5.2</b> Applied to parameters and data</a></li>
<li class="chapter" data-level="5.3" data-path="bayes-rule.html"><a href="bayes-rule.html#complete-examples-estimating-bias-in-a-coin"><i class="fa fa-check"></i><b>5.3</b> Complete examples: Estimating bias in a coin</a><ul>
<li class="chapter" data-level="5.3.1" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-sample-size-on-the-posterior."><i class="fa fa-check"></i><b>5.3.1</b> Influence of sample size on the posterior.</a></li>
<li class="chapter" data-level="5.3.2" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-prior-on-the-posterior."><i class="fa fa-check"></i><b>5.3.2</b> Influence of prior on the posterior.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="bayes-rule.html"><a href="bayes-rule.html#why-bayesian-inference-can-be-difficult"><i class="fa fa-check"></i><b>5.4</b> Why Bayesian inference can be difficult</a></li>
<li class="chapter" data-level="" data-path="bayes-rule.html"><a href="bayes-rule.html#reference-4"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="bayes-rule.html"><a href="bayes-rule.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>II ALL THE FUNDAMENTALS APPLIED TO INFERRING A BINOMIAL PROBABILITY</b></span></li>
<li class="chapter" data-level="6" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><i class="fa fa-check"></i><b>6</b> Inferring a Binomial Probability via Exact Mathematical Analysis</a><ul>
<li class="chapter" data-level="6.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-likelihood-function-the-bernoulli-distribution"><i class="fa fa-check"></i><b>6.1</b> The likelihood function: The Bernoulli distribution</a></li>
<li class="chapter" data-level="6.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#a-description-of-credibilities-the-beta-distribution"><i class="fa fa-check"></i><b>6.2</b> A description of credibilities: The beta distribution</a><ul>
<li class="chapter" data-level="6.2.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#specifying-a-beta-prior."><i class="fa fa-check"></i><b>6.2.1</b> Specifying a beta prior.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-posterior-beta"><i class="fa fa-check"></i><b>6.3</b> The posterior beta</a><ul>
<li class="chapter" data-level="6.3.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#posterior-is-compromise-of-prior-and-likelihood."><i class="fa fa-check"></i><b>6.3.1</b> Posterior is compromise of prior and likelihood.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#examples"><i class="fa fa-check"></i><b>6.4</b> Examples</a><ul>
<li class="chapter" data-level="6.4.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.1</b> Prior knowledge expressed as a beta distribution.</a></li>
<li class="chapter" data-level="6.4.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-that-cannot-be-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.2</b> Prior knowledge that cannot be expressed as a beta distribution.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#summary"><i class="fa fa-check"></i><b>6.5</b> Summary</a></li>
<li class="chapter" data-level="" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#reference-5"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>7</b> Markov Chain Monte Carlo</a><ul>
<li class="chapter" data-level="7.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#approximating-a-distribution-with-a-large-sample"><i class="fa fa-check"></i><b>7.1</b> Approximating a distribution with a large sample</a></li>
<li class="chapter" data-level="7.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-simple-case-of-the-metropolis-algorithm"><i class="fa fa-check"></i><b>7.2</b> A simple case of the Metropolis algorithm</a><ul>
<li class="chapter" data-level="7.2.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-politician-stumbles-upon-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.2.1</b> A politician stumbles upon the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.2.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-random-walk."><i class="fa fa-check"></i><b>7.2.2</b> A random walk.</a></li>
<li class="chapter" data-level="7.2.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#general-properties-of-a-random-walk."><i class="fa fa-check"></i><b>7.2.3</b> General properties of a random walk.</a></li>
<li class="chapter" data-level="7.2.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#why-we-care."><i class="fa fa-check"></i><b>7.2.4</b> Why we care.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-metropolis-algorithm-more-generally"><i class="fa fa-check"></i><b>7.3</b> The Metropolis algorithm more generally</a><ul>
<li class="chapter" data-level="7.3.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#metropolis-algorithm-applied-to-bernoulli-likelihood-and-beta-prior."><i class="fa fa-check"></i><b>7.3.1</b> Metropolis algorithm applied to Bernoulli likelihood and beta prior.</a></li>
<li class="chapter" data-level="7.3.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#summary-of-metropolis-algorithm."><i class="fa fa-check"></i><b>7.3.2</b> Summary of Metropolis algorithm.</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#toward-gibbs-sampling-estimating-two-coin-biases"><i class="fa fa-check"></i><b>7.4</b> Toward Gibbs sampling: Estimating two coin biases</a><ul>
<li class="chapter" data-level="7.4.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#prior-likelihood-and-posterior-for-two-biases."><i class="fa fa-check"></i><b>7.4.1</b> Prior, likelihood and posterior for two biases.</a></li>
<li class="chapter" data-level="7.4.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-exact-formal-analysis."><i class="fa fa-check"></i><b>7.4.2</b> The posterior via exact formal analysis.</a></li>
<li class="chapter" data-level="7.4.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.4.3</b> The posterior via the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.4.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#gibbs-hamiltonian-monte-carlo-sampling."><i class="fa fa-check"></i><b>7.4.4</b> <del>Gibbs</del> Hamiltonian Monte Carlo sampling.</a></li>
<li class="chapter" data-level="7.4.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#is-there-a-difference-between-biases"><i class="fa fa-check"></i><b>7.4.5</b> Is there a difference between biases?</a></li>
<li class="chapter" data-level="7.4.6" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#terminology-mcmc."><i class="fa fa-check"></i><b>7.4.6</b> Terminology: MCMC.</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness-accuracy-and-efficiency"><i class="fa fa-check"></i><b>7.5</b> MCMC representativeness, accuracy, and efficiency</a><ul>
<li class="chapter" data-level="7.5.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness."><i class="fa fa-check"></i><b>7.5.1</b> MCMC representativeness.</a></li>
<li class="chapter" data-level="7.5.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-accuracy."><i class="fa fa-check"></i><b>7.5.2</b> MCMC accuracy.</a></li>
<li class="chapter" data-level="7.5.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-efficiency."><i class="fa fa-check"></i><b>7.5.3</b> MCMC efficiency.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#reference-6"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="jags-brms.html"><a href="jags-brms.html"><i class="fa fa-check"></i><b>8</b> <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="8.1" data-path="jags-brms.html"><a href="jags-brms.html#jags-brms-and-its-relation-to-r"><i class="fa fa-check"></i><b>8.1</b> <del>JAGS</del> brms and its relation to R</a></li>
<li class="chapter" data-level="8.2" data-path="jags-brms.html"><a href="jags-brms.html#a-complete-example"><i class="fa fa-check"></i><b>8.2</b> A complete example</a><ul>
<li class="chapter" data-level="8.2.1" data-path="jags-brms.html"><a href="jags-brms.html#load-data."><i class="fa fa-check"></i><b>8.2.1</b> Load data.</a></li>
<li class="chapter" data-level="8.2.2" data-path="jags-brms.html"><a href="jags-brms.html#specify-model."><i class="fa fa-check"></i><b>8.2.2</b> Specify model.</a></li>
<li class="chapter" data-level="8.2.3" data-path="jags-brms.html"><a href="jags-brms.html#initialize-chains."><i class="fa fa-check"></i><b>8.2.3</b> Initialize chains.</a></li>
<li class="chapter" data-level="8.2.4" data-path="jags-brms.html"><a href="jags-brms.html#generate-chains."><i class="fa fa-check"></i><b>8.2.4</b> Generate chains.</a></li>
<li class="chapter" data-level="8.2.5" data-path="jags-brms.html"><a href="jags-brms.html#examine-chains."><i class="fa fa-check"></i><b>8.2.5</b> Examine chains.</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="jags-brms.html"><a href="jags-brms.html#simplified-scripts-for-frequently-used-analyses"><i class="fa fa-check"></i><b>8.3</b> Simplified scripts for frequently used analyses</a></li>
<li class="chapter" data-level="8.4" data-path="jags-brms.html"><a href="jags-brms.html#example-difference-of-biases"><i class="fa fa-check"></i><b>8.4</b> Example: Difference of biases</a></li>
<li class="chapter" data-level="8.5" data-path="jags-brms.html"><a href="jags-brms.html#sampling-from-the-prior-distribution-in-jags-brms"><i class="fa fa-check"></i><b>8.5</b> Sampling from the prior distribution in <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="8.6" data-path="jags-brms.html"><a href="jags-brms.html#probability-distributions-available-in-jags-brms"><i class="fa fa-check"></i><b>8.6</b> Probability distributions available in <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="8.6.1" data-path="jags-brms.html"><a href="jags-brms.html#defining-new-likelihood-functions."><i class="fa fa-check"></i><b>8.6.1</b> Defining new likelihood functions.</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="jags-brms.html"><a href="jags-brms.html#faster-sampling-with-parallel-processing-in-runjags-brmsbrm"><i class="fa fa-check"></i><b>8.7</b> Faster sampling with parallel processing in <del>runjags</del> <code>brms::brm()</code></a></li>
<li class="chapter" data-level="8.8" data-path="jags-brms.html"><a href="jags-brms.html#tips-for-expanding-jags-brms-models"><i class="fa fa-check"></i><b>8.8</b> Tips for expanding <del>JAGS</del> brms models</a></li>
<li class="chapter" data-level="" data-path="jags-brms.html"><a href="jags-brms.html#reference-7"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="jags-brms.html"><a href="jags-brms.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>9</b> Hierarchical Models</a><ul>
<li class="chapter" data-level="9.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-single-coin-from-a-single-mint"><i class="fa fa-check"></i><b>9.1</b> A single coin from a single mint</a><ul>
<li class="chapter" data-level="9.1.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation."><i class="fa fa-check"></i><b>9.1.1</b> Posterior via grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#multiple-coins-from-a-single-mint"><i class="fa fa-check"></i><b>9.2</b> Multiple coins from a single mint</a><ul>
<li class="chapter" data-level="9.2.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation.-1"><i class="fa fa-check"></i><b>9.2.1</b> Posterior via grid approximation.</a></li>
<li class="chapter" data-level="9.2.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-realistic-model-with-mcmc."><i class="fa fa-check"></i><b>9.2.2</b> A realistic model with MCMC.</a></li>
<li class="chapter" data-level="9.2.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#doing-it-with-jags-brms."><i class="fa fa-check"></i><b>9.2.3</b> Doing it with <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="9.2.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-therapeutic-touch."><i class="fa fa-check"></i><b>9.2.4</b> Example: Therapeutic touch.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#shrinkage-in-hierarchical-models"><i class="fa fa-check"></i><b>9.3</b> Shrinkage in hierarchical models</a></li>
<li class="chapter" data-level="9.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#speeding-up-jags-brms"><i class="fa fa-check"></i><b>9.4</b> Speeding up <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="9.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#extending-the-hierarchy-subjects-within-categories"><i class="fa fa-check"></i><b>9.5</b> Extending the hierarchy: Subjects within categories</a><ul>
<li class="chapter" data-level="9.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-baseball-batting-abilities-by-position."><i class="fa fa-check"></i><b>9.5.1</b> Example: Baseball batting abilities by position.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hierarchical-models.html"><a href="hierarchical-models.html#reference-8"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="hierarchical-models.html"><a href="hierarchical-models.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html"><i class="fa fa-check"></i><b>10</b> Model Comparison and Hierarchical Modeling</a><ul>
<li class="chapter" data-level="10.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#general-formula-and-the-bayes-factor"><i class="fa fa-check"></i><b>10.1</b> General formula and the Bayes factor</a></li>
<li class="chapter" data-level="10.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#example-two-factories-of-coins"><i class="fa fa-check"></i><b>10.2</b> Example: Two factories of coins</a><ul>
<li class="chapter" data-level="10.2.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-formal-analysis."><i class="fa fa-check"></i><b>10.2.1</b> Solution by formal analysis.</a></li>
<li class="chapter" data-level="10.2.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-grid-approximation."><i class="fa fa-check"></i><b>10.2.2</b> Solution by grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-mcmc"><i class="fa fa-check"></i><b>10.3</b> Solution by MCMC</a><ul>
<li class="chapter" data-level="10.3.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#nonhierarchical-mcmc-computation-of-each-models-marginal-likelihood."><i class="fa fa-check"></i><b>10.3.1</b> Nonhierarchical MCMC computation of each model’s marginal likelihood.</a></li>
<li class="chapter" data-level="10.3.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#hierarchical-mcmc-computation-of-relative-model-probability-is-not-available-in-brms-well-cover-information-criteria-instead."><i class="fa fa-check"></i><b>10.3.2</b> Hierarchical MCMC computation <del>of relative model probability</del> is not available in brms: We’ll cover information criteria instead.</a></li>
<li class="chapter" data-level="10.3.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#models-with-different-noise-distributions-in-jags-brms."><i class="fa fa-check"></i><b>10.3.3</b> Models with different “noise” distributions in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#prediction-model-averaging"><i class="fa fa-check"></i><b>10.4</b> Prediction: Model averaging</a></li>
<li class="chapter" data-level="10.5" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#model-complexity-naturally-accounted-for"><i class="fa fa-check"></i><b>10.5</b> Model complexity naturally accounted for</a><ul>
<li class="chapter" data-level="10.5.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#caveats-regarding-nested-model-comparison."><i class="fa fa-check"></i><b>10.5.1</b> Caveats regarding nested model comparison.</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#extreme-sensitivity-to-the-prior-distribution"><i class="fa fa-check"></i><b>10.6</b> Extreme sensitivity to the prior distribution</a><ul>
<li class="chapter" data-level="10.6.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#priors-of-different-models-should-be-equally-informed."><i class="fa fa-check"></i><b>10.6.1</b> Priors of different models should be equally informed.</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#bonus-theres-danger-ahead"><i class="fa fa-check"></i><b>10.7</b> Bonus: There’s danger ahead</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#reference-9"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html"><i class="fa fa-check"></i><b>11</b> Null Hypothesis Significance Testing</a><ul>
<li class="chapter" data-level="11.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#paved-with-good-intentions"><i class="fa fa-check"></i><b>11.1</b> Paved with good intentions</a><ul>
<li class="chapter" data-level="11.1.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#definition-of-p-value."><i class="fa fa-check"></i><b>11.1.1</b> Definition of <span class="math inline">\(p\)</span> value.</a></li>
<li class="chapter" data-level="11.1.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-n."><i class="fa fa-check"></i><b>11.1.2</b> With intention to fix <span class="math inline">\(N\)</span>.</a></li>
<li class="chapter" data-level="11.1.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-z."><i class="fa fa-check"></i><b>11.1.3</b> With intention to fix <span class="math inline">\(z\)</span>.</a></li>
<li class="chapter" data-level="11.1.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-duration."><i class="fa fa-check"></i><b>11.1.4</b> With intention to fix duration.</a></li>
<li class="chapter" data-level="11.1.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-make-multiple-tests."><i class="fa fa-check"></i><b>11.1.5</b> With intention to make multiple tests.</a></li>
<li class="chapter" data-level="11.1.6" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#soul-searching."><i class="fa fa-check"></i><b>11.1.6</b> Soul searching.</a></li>
<li class="chapter" data-level="11.1.7" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis."><i class="fa fa-check"></i><b>11.1.7</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#prior-knowledge"><i class="fa fa-check"></i><b>11.2</b> Prior knowledge</a><ul>
<li class="chapter" data-level="11.2.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-analysis."><i class="fa fa-check"></i><b>11.2.1</b> NHST analysis.</a></li>
<li class="chapter" data-level="11.2.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis.-1"><i class="fa fa-check"></i><b>11.2.2</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#confidence-interval-and-highest-density-interval"><i class="fa fa-check"></i><b>11.3</b> Confidence interval and highest density interval</a><ul>
<li class="chapter" data-level="11.3.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#ci-depends-on-intention."><i class="fa fa-check"></i><b>11.3.1</b> CI depends on intention.</a></li>
<li class="chapter" data-level="11.3.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-hdi."><i class="fa fa-check"></i><b>11.3.2</b> Bayesian HDI.</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#multiple-comparisons"><i class="fa fa-check"></i><b>11.4</b> Multiple comparisons</a><ul>
<li class="chapter" data-level="11.4.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-correction-for-experiment-wise-error."><i class="fa fa-check"></i><b>11.4.1</b> NHST correction for experiment wise error.</a></li>
<li class="chapter" data-level="11.4.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#just-one-bayesian-posterior-no-matter-how-you-look-at-it."><i class="fa fa-check"></i><b>11.4.2</b> Just one Bayesian posterior no matter how you look at it.</a></li>
<li class="chapter" data-level="11.4.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#how-bayesian-analysis-mitigates-false-alarms."><i class="fa fa-check"></i><b>11.4.3</b> How Bayesian analysis mitigates false alarms.</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#what-a-sampling-distribution-is-good-for"><i class="fa fa-check"></i><b>11.5</b> What a sampling distribution is good for</a><ul>
<li class="chapter" data-level="11.5.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#planning-an-experiment."><i class="fa fa-check"></i><b>11.5.1</b> Planning an experiment.</a></li>
<li class="chapter" data-level="11.5.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#exploring-model-predictions-posterior-predictive-check."><i class="fa fa-check"></i><b>11.5.2</b> Exploring model predictions (posterior predictive check).</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#reference-10"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#session-info-10"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><i class="fa fa-check"></i><b>12</b> Bayesian Approaches to Testing a Point (“Null”) Hypothesis</a><ul>
<li class="chapter" data-level="12.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-estimation-approach"><i class="fa fa-check"></i><b>12.1</b> The estimation approach</a><ul>
<li class="chapter" data-level="12.1.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#region-of-practical-equivalence."><i class="fa fa-check"></i><b>12.1.1</b> Region of practical equivalence.</a></li>
<li class="chapter" data-level="12.1.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#some-examples."><i class="fa fa-check"></i><b>12.1.2</b> Some examples.</a></li>
<li class="chapter" data-level="12.1.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#differences-of-correlated-parameters."><i class="fa fa-check"></i><b>12.1.3</b> Differences of correlated parameters.</a></li>
<li class="chapter" data-level="12.1.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#why-hdi-and-not-equal-tailed-interval"><i class="fa fa-check"></i><b>12.1.4</b> Why HDI and not equal-tailed interval?</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-model-comparison-approach"><i class="fa fa-check"></i><b>12.2</b> The model-comparison approach</a><ul>
<li class="chapter" data-level="12.2.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#is-a-coin-fair-or-not"><i class="fa fa-check"></i><b>12.2.1</b> Is a coin fair or not?</a></li>
<li class="chapter" data-level="12.2.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#bayes-factor-can-accept-null-with-poor-precision."><i class="fa fa-check"></i><b>12.2.2</b> Bayes’ factor can accept null with poor precision.</a></li>
<li class="chapter" data-level="12.2.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#are-different-groups-equal-or-not"><i class="fa fa-check"></i><b>12.2.3</b> Are different groups equal or not?</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#relations-of-parameter-estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.3</b> Relations of parameter estimation and model comparison</a></li>
<li class="chapter" data-level="12.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.4</b> Estimation and model comparison?</a></li>
<li class="chapter" data-level="" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#reference-11"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#session-info-11"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html"><i class="fa fa-check"></i><b>13</b> Goals, Power, and Sample Size</a><ul>
<li class="chapter" data-level="13.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-will-to-power"><i class="fa fa-check"></i><b>13.1</b> The will to power</a><ul>
<li class="chapter" data-level="13.1.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#goals-and-obstacles."><i class="fa fa-check"></i><b>13.1.1</b> Goals and obstacles.</a></li>
<li class="chapter" data-level="13.1.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power."><i class="fa fa-check"></i><b>13.1.2</b> Power.</a></li>
<li class="chapter" data-level="13.1.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sample-size."><i class="fa fa-check"></i><b>13.1.3</b> Sample size.</a></li>
<li class="chapter" data-level="13.1.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#other-expressions-of-goals."><i class="fa fa-check"></i><b>13.1.4</b> Other expressions of goals.</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#computing-power-and-sample-size"><i class="fa fa-check"></i><b>13.2</b> Computing power and sample size</a><ul>
<li class="chapter" data-level="13.2.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-to-exclude-a-null-value."><i class="fa fa-check"></i><b>13.2.1</b> When the goal is to exclude a null value.</a></li>
<li class="chapter" data-level="13.2.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#formal-solution-and-implementation-in-r."><i class="fa fa-check"></i><b>13.2.2</b> Formal solution and implementation in R.</a></li>
<li class="chapter" data-level="13.2.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-precision."><i class="fa fa-check"></i><b>13.2.3</b> When the goal is precision.</a></li>
<li class="chapter" data-level="13.2.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#monte-carlo-approximation-of-power."><i class="fa fa-check"></i><b>13.2.4</b> Monte Carlo approximation of power.</a></li>
<li class="chapter" data-level="13.2.5" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-from-idealized-or-actual-data."><i class="fa fa-check"></i><b>13.2.5</b> Power from idealized or actual data.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sequential-testing-and-the-goal-of-precision"><i class="fa fa-check"></i><b>13.3</b> Sequential testing and the goal of precision</a><ul>
<li class="chapter" data-level="13.3.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#examples-ofsequential-tests."><i class="fa fa-check"></i><b>13.3.1</b> Examples ofsequential tests.</a></li>
<li class="chapter" data-level="13.3.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#more-will-come-soon"><i class="fa fa-check"></i><b>13.3.2</b> More will come soon…</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#reference-12"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#session-info-12"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="stan.html"><a href="stan.html"><i class="fa fa-check"></i><b>14</b> Stan</a><ul>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#references"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#session-info-13"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>III THE GENERALIZED LINEAR MODEL</b></span></li>
<li class="chapter" data-level="15" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>15</b> Overview of the Generalized Linear Model</a><ul>
<li class="chapter" data-level="15.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#types-of-variables"><i class="fa fa-check"></i><b>15.1</b> Types of variables</a><ul>
<li class="chapter" data-level="15.1.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#predictor-and-predicted-variables."><i class="fa fa-check"></i><b>15.1.1</b> Predictor and predicted variables.</a></li>
<li class="chapter" data-level="15.1.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#scale-types-metric-ordinal-nominal-and-count."><i class="fa fa-check"></i><b>15.1.2</b> Scale types: metric, ordinal, nominal, and count.</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-combination-of-predictors"><i class="fa fa-check"></i><b>15.2</b> Linear combination of predictors</a><ul>
<li class="chapter" data-level="15.2.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-function-of-a-single-metric-predictor."><i class="fa fa-check"></i><b>15.2.1</b> Linear function of a single metric predictor.</a></li>
<li class="chapter" data-level="15.2.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#additive-combination-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.2</b> Additive combination of metric predictors.</a></li>
<li class="chapter" data-level="15.2.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nonadditive-interaction-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.3</b> Nonadditive interaction of metric predictors.</a></li>
<li class="chapter" data-level="15.2.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nominal-predictors."><i class="fa fa-check"></i><b>15.2.4</b> Nominal predictors.</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linking-from-combined-predictors-to-noisy-predicted-data"><i class="fa fa-check"></i><b>15.3</b> Linking from combined predictors to noisy predicted data</a><ul>
<li class="chapter" data-level="15.3.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predictors-to-predicted-central-tendency."><i class="fa fa-check"></i><b>15.3.1</b> From predictors to predicted central tendency.</a></li>
<li class="chapter" data-level="15.3.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predicted-central-tendency-to-noisy-data."><i class="fa fa-check"></i><b>15.3.2</b> From predicted central tendency to noisy data.</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#formal-expression-of-the-glm"><i class="fa fa-check"></i><b>15.4</b> Formal expression of the GLM</a><ul>
<li class="chapter" data-level="15.4.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#cases-of-the-glm."><i class="fa fa-check"></i><b>15.4.1</b> Cases of the GLM.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#reference-13"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#session-info-14"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html"><i class="fa fa-check"></i><b>16</b> Metric-Predicted Variable on One or Two Groups</a><ul>
<li class="chapter" data-level="16.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#estimating-the-mean-and-standard-deviation-of-a-normal-distribution"><i class="fa fa-check"></i><b>16.1</b> Estimating the mean and standard deviation of a normal distribution</a><ul>
<li class="chapter" data-level="16.1.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#solution-by-mathematical-analysis-heads-up-on-precision."><i class="fa fa-check"></i><b>16.1.1</b> <del>Solution by mathematical analysis</del> Heads up on precision.</a></li>
<li class="chapter" data-level="16.1.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#approximation-by-mcmc-in-jags-hmc-in-brms."><i class="fa fa-check"></i><b>16.1.2</b> Approximation by <del>MCMC in JAGS</del> HMC in brms.</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#outliers-and-robust-estimation-the-t-distribution"><i class="fa fa-check"></i><b>16.2</b> Outliers and robust estimation: The <span class="math inline">\(t\)</span> distribution</a><ul>
<li class="chapter" data-level="16.2.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-jags-brms."><i class="fa fa-check"></i><b>16.2.1</b> Using the <span class="math inline">\(t\)</span> distribution in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="16.2.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-stan."><i class="fa fa-check"></i><b>16.2.2</b> Using the <span class="math inline">\(t\)</span> distribution in Stan.</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#two-groups"><i class="fa fa-check"></i><b>16.3</b> Two groups</a><ul>
<li class="chapter" data-level="16.3.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#analysis-by-nhst."><i class="fa fa-check"></i><b>16.3.1</b> Analysis by NHST.</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#other-noise-distributions-and-transforming-data"><i class="fa fa-check"></i><b>16.4</b> Other noise distributions and transforming data</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#reference-14"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#session-info-15"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html"><i class="fa fa-check"></i><b>17</b> Metric Predicted Variable with One Metric Predictor</a><ul>
<li class="chapter" data-level="17.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#simple-linear-regression"><i class="fa fa-check"></i><b>17.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="17.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression"><i class="fa fa-check"></i><b>17.2</b> Robust linear regression</a><ul>
<li class="chapter" data-level="17.2.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-jags-brms."><i class="fa fa-check"></i><b>17.2.1</b> Robust linear regression in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.2.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-stan."><i class="fa fa-check"></i><b>17.2.2</b> Robust linear regression in Stan.</a></li>
<li class="chapter" data-level="17.2.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#stan-or-jags"><i class="fa fa-check"></i><b>17.2.3</b> Stan or JAGS?</a></li>
<li class="chapter" data-level="17.2.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#interpreting-the-posterior-distribution."><i class="fa fa-check"></i><b>17.2.4</b> Interpreting the posterior distribution.</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#hierarchical-regression-on-individuals-within-groups"><i class="fa fa-check"></i><b>17.3</b> Hierarchical regression on individuals within groups</a><ul>
<li class="chapter" data-level="17.3.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>17.3.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.3.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-posterior-distribution-shrinkage-and-prediction."><i class="fa fa-check"></i><b>17.3.2</b> The posterior distribution: Shrinkage and prediction.</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#quadratic-trend-and-weighted-data"><i class="fa fa-check"></i><b>17.4</b> Quadratic trend and weighted data</a><ul>
<li class="chapter" data-level="17.4.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#results-and-interpretation."><i class="fa fa-check"></i><b>17.4.1</b> Results and interpretation.</a></li>
<li class="chapter" data-level="17.4.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#further-extensions."><i class="fa fa-check"></i><b>17.4.2</b> Further extensions.</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#procedure-and-perils-for-expanding-a-model"><i class="fa fa-check"></i><b>17.5</b> Procedure and perils for expanding a model</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#reference-15"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#session-info-16"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html"><i class="fa fa-check"></i><b>18</b> Metric Predicted Variable with Multiple Metric Predictors</a><ul>
<li class="chapter" data-level="18.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiple-linear-regression"><i class="fa fa-check"></i><b>18.1</b> Multiple linear regression</a><ul>
<li class="chapter" data-level="18.1.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-perils-of-correlated-predictors."><i class="fa fa-check"></i><b>18.1.1</b> The perils of correlated predictors.</a></li>
<li class="chapter" data-level="18.1.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-model-and-implementation."><i class="fa fa-check"></i><b>18.1.2</b> The model and implementation.</a></li>
<li class="chapter" data-level="18.1.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-posterior-distribution."><i class="fa fa-check"></i><b>18.1.3</b> The posterior distribution.</a></li>
<li class="chapter" data-level="18.1.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#redundant-predictors."><i class="fa fa-check"></i><b>18.1.4</b> Redundant predictors.</a></li>
<li class="chapter" data-level="18.1.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#informative-priors-sparse-data-and-correlated-predictors."><i class="fa fa-check"></i><b>18.1.5</b> Informative priors, sparse data, and correlated predictors.</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiplicative-interaction-of-metric-predictors"><i class="fa fa-check"></i><b>18.2</b> Multiplicative interaction of metric predictors</a><ul>
<li class="chapter" data-level="18.2.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#an-example."><i class="fa fa-check"></i><b>18.2.1</b> An example.</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#shrinkage-of-regression-coefficients"><i class="fa fa-check"></i><b>18.3</b> Shrinkage of regression coefficients</a></li>
<li class="chapter" data-level="18.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection"><i class="fa fa-check"></i><b>18.4</b> Variable selection</a><ul>
<li class="chapter" data-level="18.4.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#inclusion-probability-is-strongly-affected-by-vagueness-of-prior."><i class="fa fa-check"></i><b>18.4.1</b> Inclusion probability is strongly affected by vagueness of prior.</a></li>
<li class="chapter" data-level="18.4.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection-with-hierarchical-shrinkage."><i class="fa fa-check"></i><b>18.4.2</b> Variable selection with hierarchical shrinkage.</a></li>
<li class="chapter" data-level="18.4.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#what-to-report-and-what-to-conclude."><i class="fa fa-check"></i><b>18.4.3</b> What to report and what to conclude.</a></li>
<li class="chapter" data-level="18.4.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-computational-methods."><i class="fa fa-check"></i><b>18.4.4</b> Caution: Computational methods.</a></li>
<li class="chapter" data-level="18.4.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-interaction-variables."><i class="fa fa-check"></i><b>18.4.5</b> Caution: Interaction variables.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#reference-16"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#session-info-17"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#footnote"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html"><i class="fa fa-check"></i><b>19</b> Metric Predicted Variable with One Nominal Predictor</a><ul>
<li class="chapter" data-level="19.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#describing-multiple-groups-of-metric-data"><i class="fa fa-check"></i><b>19.1</b> Describing multiple groups of metric data</a></li>
<li class="chapter" data-level="19.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#traditional-analysis-of-variance"><i class="fa fa-check"></i><b>19.2</b> Traditional analysis of variance</a></li>
<li class="chapter" data-level="19.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#hierarchical-bayesian-approach"><i class="fa fa-check"></i><b>19.3</b> Hierarchical Bayesian approach</a><ul>
<li class="chapter" data-level="19.3.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#implementation-in-jags-brms."><i class="fa fa-check"></i><b>19.3.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="19.3.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-and-death."><i class="fa fa-check"></i><b>19.3.2</b> Example: Sex and death.</a></li>
<li class="chapter" data-level="19.3.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#contrasts."><i class="fa fa-check"></i><b>19.3.3</b> Contrasts.</a></li>
<li class="chapter" data-level="19.3.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#multiple-comparisons-and-shrinkage."><i class="fa fa-check"></i><b>19.3.4</b> Multiple comparisons and shrinkage.</a></li>
<li class="chapter" data-level="19.3.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#the-two-group-case."><i class="fa fa-check"></i><b>19.3.5</b> The two-group case.</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#including-a-metric-predictor"><i class="fa fa-check"></i><b>19.4</b> Including a metric predictor</a><ul>
<li class="chapter" data-level="19.4.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-death-and-size."><i class="fa fa-check"></i><b>19.4.1</b> Example: Sex, death, and size.</a></li>
<li class="chapter" data-level="19.4.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#analogous-to-traditional-ancova."><i class="fa fa-check"></i><b>19.4.2</b> Analogous to traditional ANCOVA.</a></li>
<li class="chapter" data-level="19.4.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#relation-to-hierarchical-linear-regression."><i class="fa fa-check"></i><b>19.4.3</b> Relation to hierarchical linear regression.</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#heterogeneous-variances-and-robustness-against-outliers"><i class="fa fa-check"></i><b>19.5</b> Heterogeneous variances and robustness against outliers</a><ul>
<li class="chapter" data-level="19.5.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-contrast-of-means-with-different-variances."><i class="fa fa-check"></i><b>19.5.1</b> Example: Contrast of means with different variances.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#reference-17"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#session-info-18"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html"><i class="fa fa-check"></i><b>20</b> Metric Predicted Variable with Multiple Nominal Predictors</a><ul>
<li class="chapter" data-level="20.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#describing-groups-of-metric-data-with-multiple-nominal-predictors"><i class="fa fa-check"></i><b>20.1</b> Describing groups of metric data with multiple nominal predictors</a><ul>
<li class="chapter" data-level="20.1.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction."><i class="fa fa-check"></i><b>20.1.1</b> Interaction.</a></li>
<li class="chapter" data-level="20.1.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#traditional-anova."><i class="fa fa-check"></i><b>20.1.2</b> Traditional ANOVA.</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#hierarchical-bayesian-approach-1"><i class="fa fa-check"></i><b>20.2</b> Hierarchical Bayesian approach</a><ul>
<li class="chapter" data-level="20.2.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>20.2.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="20.2.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#example-its-only-money."><i class="fa fa-check"></i><b>20.2.2</b> Example: It’s only money.</a></li>
<li class="chapter" data-level="20.2.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#main-effect-contrasts."><i class="fa fa-check"></i><b>20.2.3</b> Main effect contrasts.</a></li>
<li class="chapter" data-level="20.2.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction-contrasts-and-simple-effects."><i class="fa fa-check"></i><b>20.2.4</b> Interaction contrasts and simple effects.</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#rescaling-can-change-interactions-homogeneity-and-normality"><i class="fa fa-check"></i><b>20.3</b> Rescaling can change interactions, homogeneity, and normality</a></li>
<li class="chapter" data-level="20.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#heterogeneous-variances-and-robustness-against-outliers-1"><i class="fa fa-check"></i><b>20.4</b> Heterogeneous variances and robustness against outliers</a></li>
<li class="chapter" data-level="20.5" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#within-subject-designs"><i class="fa fa-check"></i><b>20.5</b> Within-subject designs</a><ul>
<li class="chapter" data-level="20.5.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#why-use-a-within-subject-design-and-why-not"><i class="fa fa-check"></i><b>20.5.1</b> Why use a within-subject design? And why not?</a></li>
<li class="chapter" data-level="20.5.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#split-plot-design."><i class="fa fa-check"></i><b>20.5.2</b> Split-plot design.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#reference-18"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#session-info-19"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html"><i class="fa fa-check"></i><b>21</b> Dichotomous Predicted Variable</a><ul>
<li class="chapter" data-level="21.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-metric-predictors"><i class="fa fa-check"></i><b>21.1</b> Multiple metric predictors</a><ul>
<li class="chapter" data-level="21.1.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#the-model-and-implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>21.1.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="21.1.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#example-height-weight-and-gender."><i class="fa fa-check"></i><b>21.1.2</b> Example: Height, weight, and gender.</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interpreting-the-regression-coefficients"><i class="fa fa-check"></i><b>21.2</b> Interpreting the regression coefficients</a><ul>
<li class="chapter" data-level="21.2.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#log-odds."><i class="fa fa-check"></i><b>21.2.1</b> Log odds.</a></li>
<li class="chapter" data-level="21.2.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#when-there-are-few-1s-or-0s-in-the-data."><i class="fa fa-check"></i><b>21.2.2</b> When there are few 1’s or 0’s in the data.</a></li>
<li class="chapter" data-level="21.2.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#correlated-predictors."><i class="fa fa-check"></i><b>21.2.3</b> Correlated predictors.</a></li>
<li class="chapter" data-level="21.2.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interaction-of-metric-predictors."><i class="fa fa-check"></i><b>21.2.4</b> Interaction of metric predictors.</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#robust-logistic-regression"><i class="fa fa-check"></i><b>21.3</b> Robust logistic regression</a></li>
<li class="chapter" data-level="21.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#nominal-predictors"><i class="fa fa-check"></i><b>21.4</b> Nominal predictors</a><ul>
<li class="chapter" data-level="21.4.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#single-group."><i class="fa fa-check"></i><b>21.4.1</b> Single group.</a></li>
<li class="chapter" data-level="21.4.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-groups."><i class="fa fa-check"></i><b>21.4.2</b> Multiple groups.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#reference-19"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#session-info-20"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Doing Bayesian Data Analysis</em> in brms and the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="metric-predicted-variable-with-multiple-metric-predictors" class="section level1">
<h1><span class="header-section-number">18</span> Metric Predicted Variable with Multiple Metric Predictors</h1>
<blockquote>
<p>We will consider models in which the predicted variable is an additive combination of predictors, all of which have proportional influence on the prediction. This kind of model is called <em>multiple linear regression</em>. We will also consider nonadditive combinations of predictors, which are called <em>interactions</em>. (p. 509, <em>emphasis</em> in the original)</p>
</blockquote>
<div id="multiple-linear-regression" class="section level2">
<h2><span class="header-section-number">18.1</span> Multiple linear regression</h2>
<p>If <span class="math inline">\(y \sim \operatorname{Normal} (\mu, \sigma)\)</span> and <span class="math inline">\(\mu = \beta_0 + \beta_1 x_1 + \beta_2 x_2\)</span>, then it’s also the case that we can rewrite the formula for <span class="math inline">\(y\)</span> as</p>
<p><span class="math display">\[y \sim \operatorname{Normal} (\beta_0 + \beta_1 x_1 + \beta_2 x_2, \sigma).\]</span></p>
<p>As Kruschke pointed out, the basic model “assumes homogeneity of variance, which means that at all values of <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>, the variance <span class="math inline">\(\sigma^2\)</span> of <span class="math inline">\(y\)</span> is the same” (p. 510).</p>
<p>If we presume the data for the two <span class="math inline">\(x\)</span> variables are uniformly distributed within 0 and 10, we can make the data for Figure 18.1 like this.</p>
<div class="sourceCode" id="cb1417"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1417-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb1417-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1417-3" data-line-number="3">n &lt;-<span class="st"> </span><span class="dv">300</span></a>
<a class="sourceLine" id="cb1417-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1417-5" data-line-number="5"><span class="kw">set.seed</span>(<span class="dv">18</span>)</a>
<a class="sourceLine" id="cb1417-6" data-line-number="6">d &lt;-</a>
<a class="sourceLine" id="cb1417-7" data-line-number="7"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x_1 =</span> <span class="kw">runif</span>(<span class="dt">n =</span> n, <span class="dv">0</span>, <span class="dv">10</span>),</a>
<a class="sourceLine" id="cb1417-8" data-line-number="8">         <span class="dt">x_2 =</span> <span class="kw">runif</span>(<span class="dt">n =</span> n, <span class="dv">0</span>, <span class="dv">10</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1417-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y   =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> n, <span class="dt">mean =</span> <span class="dv">10</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>x_<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1417-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1417-11" data-line-number="11"><span class="kw">head</span>(d)  </a></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##     x_1   x_2     y
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 8.23   8.62  36.9
## 2 7.10   1.33  20.3
## 3 9.66   1.08  19.5
## 4 0.786  7.09  25.1
## 5 0.536  6.67  25.6
## 6 5.75   4.72  25.7</code></pre>
<p>Here are three of the scatter plots in Figure 18.1.</p>
<div class="sourceCode" id="cb1419"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1419-1" data-line-number="1"><span class="kw">theme_set</span>(<span class="kw">theme_grey</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb1419-2" data-line-number="2"><span class="st">            </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()))</a>
<a class="sourceLine" id="cb1419-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1419-4" data-line-number="4">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1419-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x_<span class="dv">1</span>, <span class="dt">y =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1419-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1419-7" data-line-number="7"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">50</span>)</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-2-1.png" /><!-- --></p>
<div class="sourceCode" id="cb1420"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1420-1" data-line-number="1">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1420-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x_<span class="dv">2</span>, <span class="dt">y =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1420-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1420-4" data-line-number="4"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">50</span>)</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-2-2.png" /><!-- --></p>
<div class="sourceCode" id="cb1421"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1421-1" data-line-number="1">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1421-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x_<span class="dv">1</span>, <span class="dt">y =</span> x_<span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1421-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="fl">.5</span>), <span class="dt">color =</span> <span class="st">&quot;grey98&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1421-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="fl">.5</span>), <span class="dt">color =</span> <span class="st">&quot;grey98&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1421-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>)</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-2-3.png" /><!-- --></p>
<p>As in previous chapters, I’m not aware that <strong>ggplot2</strong> allows for three-dimensional wireframe plots of the kind in the upper left panel. If you’d like to make one in base <strong>R</strong>, have at it. But with respect to the plots in the off-diagonal, I have no idea what Kruschke did with the compressed and diagonal grids. If you have that figured out, please <a href="https://github.com/ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse/issues">share your code</a>.</p>
<p>For Figure 18.2, the <span class="math inline">\(x\)</span> variables look to be multivariate normal with a correlation of about -.95. We can simulate such data with help from the <strong>MASS</strong> package.</p>
<p>Sven Hohenstein’s <a href="https://stats.stackexchange.com/questions/164471/generating-a-simulated-dataset-from-a-correlation-matrix-with-means-and-standard">answer to this stats.stackexchange.com question</a> provides the steps for simulating the data. First, we’ll need to specify the desired means and standard deviations for our variables. Then we’ll make a correlation matrix with 1s on the diagonal and the desired correlation coefficient, <span class="math inline">\(\rho\)</span> on the off-diagonal. Since the correlation matrix is symmetric, both off-diagonal positions are the same. Then we convert the correlation matrix to a covariance matrix.</p>
<div class="sourceCode" id="cb1422"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1422-1" data-line-number="1">mus &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb1422-2" data-line-number="2">sds &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1422-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1422-4" data-line-number="4">cors &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">-.95</span>,</a>
<a class="sourceLine" id="cb1422-5" data-line-number="5">                 <span class="fl">-.95</span>, <span class="dv">1</span>), </a>
<a class="sourceLine" id="cb1422-6" data-line-number="6">               <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1422-7" data-line-number="7">cors</a></code></pre></div>
<pre><code>##       [,1]  [,2]
## [1,]  1.00 -0.95
## [2,] -0.95  1.00</code></pre>
<div class="sourceCode" id="cb1424"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1424-1" data-line-number="1">covs &lt;-<span class="st"> </span>sds <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(sds) <span class="op">*</span><span class="st"> </span>cors</a>
<a class="sourceLine" id="cb1424-2" data-line-number="2">covs</a></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]  4.0 -3.8
## [2,] -3.8  4.0</code></pre>
<p>Now we’ve defined our means, standard deviations, and covariance matrix, we’re ready to simulate the data with the <code>MASS::mvrnorm()</code> function.</p>
<div class="sourceCode" id="cb1426"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1426-1" data-line-number="1"><span class="co"># how many data points would you like to simulate?</span></a>
<a class="sourceLine" id="cb1426-2" data-line-number="2">n &lt;-<span class="st"> </span><span class="dv">300</span></a>
<a class="sourceLine" id="cb1426-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1426-4" data-line-number="4"><span class="kw">set.seed</span>(<span class="fl">18.2</span>)</a>
<a class="sourceLine" id="cb1426-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1426-6" data-line-number="6">d &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1426-7" data-line-number="7"><span class="st">  </span>MASS<span class="op">::</span><span class="kw">mvrnorm</span>(<span class="dt">n         =</span> n, </a>
<a class="sourceLine" id="cb1426-8" data-line-number="8">                <span class="dt">mu        =</span> mus, </a>
<a class="sourceLine" id="cb1426-9" data-line-number="9">                <span class="dt">Sigma     =</span> covs, </a>
<a class="sourceLine" id="cb1426-10" data-line-number="10">                <span class="dt">empirical =</span> T) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1426-11" data-line-number="11"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1426-12" data-line-number="12"><span class="st">  </span><span class="kw">set_names</span>(<span class="st">&quot;x_1&quot;</span>, <span class="st">&quot;x_2&quot;</span>) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb1426-13" data-line-number="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> n, <span class="dt">mean =</span> <span class="dv">10</span> <span class="op">+</span><span class="st"> </span>x_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>x_<span class="dv">2</span>))</a></code></pre></div>
<p>Now we have our simulated data in hand, we’re ready for three of the four panels of Figure 18.2.</p>
<div class="sourceCode" id="cb1427"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1427-1" data-line-number="1">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1427-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x_<span class="dv">1</span>, <span class="dt">y =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1427-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1427-4" data-line-number="4"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb1427-5" data-line-number="5">                  <span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">50</span>)</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-5-1.png" /><!-- --></p>
<div class="sourceCode" id="cb1428"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1428-1" data-line-number="1">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1428-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x_<span class="dv">2</span>, <span class="dt">y =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1428-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1428-4" data-line-number="4"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb1428-5" data-line-number="5">                  <span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">50</span>)</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-5-2.png" /><!-- --></p>
<div class="sourceCode" id="cb1429"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1429-1" data-line-number="1">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1429-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x_<span class="dv">1</span>, <span class="dt">y =</span> x_<span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1429-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="fl">.5</span>), <span class="dt">color =</span> <span class="st">&quot;grey98&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1429-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="fl">.5</span>), <span class="dt">color =</span> <span class="st">&quot;grey98&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1429-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1429-6" data-line-number="6"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb1429-7" data-line-number="7">                  <span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">10</span>)</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-5-3.png" /><!-- --></p>
<p>Pretty close.</p>
<div id="the-perils-of-correlated-predictors." class="section level3">
<h3><span class="header-section-number">18.1.1</span> The perils of correlated predictors.</h3>
<blockquote>
<p>Figures 18.1 and 18.2 show data generated from the same model. In both figures, <span class="math inline">\(\sigma = 2, \beta_0 = 10, \beta_1 = 1, \text{ and } \beta_2 = 2\)</span>. All that differs between the two figures is the distribution of the <span class="math inline">\(\langle x_1, x_2 \rangle\)</span> values, which is not specified by the model. In Figure 18.1, the <span class="math inline">\(\langle x_1, x_2 \rangle\)</span> values are distributed independently. In Figure 18.2, the <span class="math inline">\(\langle x_1, x_2 \rangle\)</span> values are negatively correlated: When <span class="math inline">\(x_1\)</span> is small, <span class="math inline">\(x_2\)</span> tends to be large, and when <span class="math inline">\(x_1\)</span> is large, <span class="math inline">\(x_2\)</span> tends to be small. (p. 510)</p>
</blockquote>
<p>If you look closely at our simulation code from above, you’ll see we have done so, too.</p>
<blockquote>
<p>Real data often have correlated predictors. For example, consider trying to predict a state’s average high-school SAT score on the basis of the amount of money the state spends per pupil. If you plot only mean SAT against money spent, there is actually a <em>decreasing</em> trend… (p. 513, <em>emphasis</em> in the original)</p>
</blockquote>
<p>Before we remake Figure 18.3 to examine that decreasing trend, we’ll need to load the data.</p>
<div class="sourceCode" id="cb1430"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1430-1" data-line-number="1">my_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data.R/Guber1999data.csv&quot;</span>)</a>
<a class="sourceLine" id="cb1430-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1430-3" data-line-number="3"><span class="kw">glimpse</span>(my_data)</a></code></pre></div>
<pre><code>## Observations: 50
## Variables: 8
## $ State     &lt;chr&gt; &quot;Alabama&quot;, &quot;Alaska&quot;, &quot;Arizona&quot;, &quot;Arkansas&quot;, &quot;Californi…
## $ Spend     &lt;dbl&gt; 4.405, 8.963, 4.778, 4.459, 4.992, 5.443, 8.817, 7.030…
## $ StuTeaRat &lt;dbl&gt; 17.2, 17.6, 19.3, 17.1, 24.0, 18.4, 14.4, 16.6, 19.1, …
## $ Salary    &lt;dbl&gt; 31.144, 47.951, 32.175, 28.934, 41.078, 34.571, 50.045…
## $ PrcntTake &lt;dbl&gt; 8, 47, 27, 6, 45, 29, 81, 68, 48, 65, 57, 15, 13, 58, …
## $ SATV      &lt;dbl&gt; 491, 445, 448, 482, 417, 462, 431, 429, 420, 406, 407,…
## $ SATM      &lt;dbl&gt; 538, 489, 496, 523, 485, 518, 477, 468, 469, 448, 482,…
## $ SATT      &lt;dbl&gt; 1029, 934, 944, 1005, 902, 980, 908, 897, 889, 854, 88…</code></pre>
<p>Now we have the <a href="https://pdfs.semanticscholar.org/29c3/0e9dc77b56340faa5e6ad35e0741a5a83d49.pdf">Guber (1999)</a> data, here are three of the four plots.</p>
<div class="sourceCode" id="cb1432"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1432-1" data-line-number="1">my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1432-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Spend, <span class="dt">y =</span> SATT)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1432-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1432-4" data-line-number="4"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="dv">800</span><span class="op">:</span><span class="dv">1120</span>)</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-7-1.png" /><!-- --></p>
<div class="sourceCode" id="cb1433"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1433-1" data-line-number="1">my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1433-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PrcntTake, <span class="dt">y =</span> SATT)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1433-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1433-4" data-line-number="4"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;% Take&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1433-5" data-line-number="5"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="dv">800</span><span class="op">:</span><span class="dv">1120</span>)</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-7-2.png" /><!-- --></p>
<div class="sourceCode" id="cb1434"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1434-1" data-line-number="1">my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1434-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PrcntTake, <span class="dt">y =</span> Spend)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1434-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">5</span>,   <span class="dt">to =</span> <span class="dv">80</span>, <span class="dt">by =</span> <span class="dv">5</span>), <span class="dt">color =</span> <span class="st">&quot;grey98&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1434-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">3.5</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="fl">.5</span>), <span class="dt">color =</span> <span class="st">&quot;grey98&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1434-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1434-6" data-line-number="6"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;% Take&quot;</span>)</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-7-3.png" /><!-- --></p>
</div>
<div id="the-model-and-implementation." class="section level3">
<h3><span class="header-section-number">18.1.2</span> The model and implementation.</h3>
<p>We’ll make a custom function to standardize the criterion and predictor values.</p>
<div class="sourceCode" id="cb1435"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1435-1" data-line-number="1">standardize &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb1435-2" data-line-number="2">  (x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(x)</a>
<a class="sourceLine" id="cb1435-3" data-line-number="3">  }</a>
<a class="sourceLine" id="cb1435-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1435-5" data-line-number="5">my_data &lt;-</a>
<a class="sourceLine" id="cb1435-6" data-line-number="6"><span class="st">  </span>my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1435-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prcnt_take_z =</span> <span class="kw">standardize</span>(PrcntTake),</a>
<a class="sourceLine" id="cb1435-8" data-line-number="8">         <span class="dt">spend_z      =</span> <span class="kw">standardize</span>(Spend),</a>
<a class="sourceLine" id="cb1435-9" data-line-number="9">         <span class="dt">satt_z       =</span> <span class="kw">standardize</span>(SATT))</a></code></pre></div>
<p>Let’s open <strong>brms</strong>.</p>
<div class="sourceCode" id="cb1436"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1436-1" data-line-number="1"><span class="kw">library</span>(brms)</a></code></pre></div>
<p>Now we’re ready to fit the model. As Kruschke pointed out, the priors on the standardized predictors are set with</p>
<blockquote>
<p>an arbitrary standard deviation of 2.0. This value was chosen because standardized regression coefficients are algebraically constrained to fall between −1 and +1 in least-squares regression, [<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>] and therefore, the regression coefficients will not exceed those limits by much. A normal distribution with standard deviation of 2.0 is reasonably flat over the range from −1 to +1. (p. 516)</p>
</blockquote>
<p>With data like this, even a <code>prior(normal(0, 1), class = b)</code> would be only mildly regularizing.</p>
<p>This is a good place to emphasize how priors in <strong>brms</strong> are given classes. If you’d like all parameters within a given class to have the prior, you can just specify one prior argument within that class. For our <code>fit1</code>, both parameters of <code>class = b</code> have a <code>normal(0, 2)</code> prior. So we can just include one statement to handle both. Had we wanted different priors for the coefficients for <code>spend_z</code> and <code>prcnt_take_z</code>, we’d need to include two <code>prior()</code> arguments with at least one including a <code>coef</code> argument.</p>
<div class="sourceCode" id="cb1437"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1437-1" data-line-number="1">fit1 &lt;-</a>
<a class="sourceLine" id="cb1437-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1437-3" data-line-number="3">      <span class="dt">family =</span> student,</a>
<a class="sourceLine" id="cb1437-4" data-line-number="4">      satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>spend_z <span class="op">+</span><span class="st"> </span>prcnt_take_z,</a>
<a class="sourceLine" id="cb1437-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1437-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> b),</a>
<a class="sourceLine" id="cb1437-7" data-line-number="7">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">class =</span> sigma),</a>
<a class="sourceLine" id="cb1437-8" data-line-number="8">                <span class="kw">prior</span>(<span class="kw">exponential</span>(one_over_twentynine), <span class="dt">class =</span> nu)),</a>
<a class="sourceLine" id="cb1437-9" data-line-number="9">      <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1437-10" data-line-number="10">      <span class="dt">stanvars =</span> <span class="kw">stanvar</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">29</span>, <span class="dt">name =</span> <span class="st">&quot;one_over_twentynine&quot;</span>),</a>
<a class="sourceLine" id="cb1437-11" data-line-number="11">      <span class="dt">seed =</span> <span class="dv">18</span>)</a></code></pre></div>
<p>Check the model summary.</p>
<div class="sourceCode" id="cb1438"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1438-1" data-line-number="1"><span class="kw">print</span>(fit1)</a></code></pre></div>
<pre><code>##  Family: student 
##   Links: mu = identity; sigma = identity; nu = identity 
## Formula: satt_z ~ 1 + spend_z + prcnt_take_z 
##    Data: my_data (Number of observations: 50) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept        0.00      0.06    -0.12     0.13 1.00     4222     2585
## spend_z          0.23      0.08     0.08     0.38 1.00     3599     2990
## prcnt_take_z    -1.03      0.08    -1.18    -0.87 1.00     3490     3160
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     0.42      0.05     0.32     0.53 1.00     3523     2413
## nu       33.07     27.90     4.27   107.31 1.00     3398     2360
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>So when we use a multivariable model, increases in spending now appear associated with <em>increases</em> in SAT scores.</p>
</div>
<div id="the-posterior-distribution." class="section level3">
<h3><span class="header-section-number">18.1.3</span> The posterior distribution.</h3>
<p>Based on equation 18.1, we can convert the standardized coefficients from our multivariable model back to their original metric as follows:</p>
<p><span class="math display">\[\begin{align*}
\beta_0 &amp; = \operatorname{SD}_y \zeta_0 + M_y - \operatorname{SD}_y \sum_j \frac{\zeta_j M_{x_j}}{\operatorname{SD}_{x_j}} \;\;\; \text{and} \\
\beta_j &amp; = \frac{\operatorname{SD}_y \zeta_j}{\operatorname{SD}_{x_j}}.
\end{align*}\]</span></p>
<p>To use them, we’ll first extract the posterior samples.</p>
<div class="sourceCode" id="cb1440"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1440-1" data-line-number="1">post &lt;-<span class="st"> </span><span class="kw">posterior_samples</span>(fit1)</a>
<a class="sourceLine" id="cb1440-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1440-3" data-line-number="3"><span class="kw">head</span>(post)</a></code></pre></div>
<pre><code>##   b_Intercept b_spend_z b_prcnt_take_z     sigma        nu      lp__
## 1  0.03332938 0.2246157      -1.044109 0.4381914 58.891563 -35.40259
## 2 -0.05051637 0.2270969      -1.076683 0.3759888 13.331876 -35.92027
## 3 -0.04916057 0.2770627      -1.092591 0.3992656 18.839407 -35.58017
## 4  0.01043252 0.3638677      -1.141387 0.4167015  5.558774 -37.95336
## 5  0.02980380 0.3671874      -1.262402 0.4401791 29.336185 -39.44394
## 6  0.00317025 0.3080994      -1.259354 0.4584194 46.137031 -39.81174</code></pre>
<p>Like we did in Chapter 17, let’s wrap the consequences of Equation 18.1 into two functions.</p>
<div class="sourceCode" id="cb1442"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1442-1" data-line-number="1">make_beta_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="cf">function</span>(zeta_<span class="dv">0</span>, zeta_<span class="dv">1</span>, zeta_<span class="dv">2</span>, sd_x_<span class="dv">1</span>, sd_x_<span class="dv">2</span>, sd_y, m_x_<span class="dv">1</span>, m_x_<span class="dv">2</span>, m_y) {</a>
<a class="sourceLine" id="cb1442-2" data-line-number="2">  sd_y <span class="op">*</span><span class="st"> </span>zeta_<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>m_y <span class="op">-</span><span class="st"> </span>sd_y <span class="op">*</span><span class="st"> </span>((zeta_<span class="dv">1</span> <span class="op">*</span><span class="st"> </span>m_x_<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>sd_x_<span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>(zeta_<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>m_x_<span class="dv">2</span> <span class="op">/</span><span class="st"> </span>sd_x_<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1442-3" data-line-number="3">  }</a>
<a class="sourceLine" id="cb1442-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1442-5" data-line-number="5">make_beta_j &lt;-<span class="st"> </span><span class="cf">function</span>(zeta_j, sd_j, sd_y) {</a>
<a class="sourceLine" id="cb1442-6" data-line-number="6">  sd_y <span class="op">*</span><span class="st"> </span>zeta_j <span class="op">/</span><span class="st"> </span>sd_j</a>
<a class="sourceLine" id="cb1442-7" data-line-number="7">  }</a></code></pre></div>
<p>After saving a few values, we’re ready to use our custom functions.</p>
<div class="sourceCode" id="cb1443"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1443-1" data-line-number="1">sd_x_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>Spend)</a>
<a class="sourceLine" id="cb1443-2" data-line-number="2">sd_x_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>PrcntTake)</a>
<a class="sourceLine" id="cb1443-3" data-line-number="3">sd_y   &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>SATT)</a>
<a class="sourceLine" id="cb1443-4" data-line-number="4">m_x_<span class="dv">1</span>  &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>Spend)</a>
<a class="sourceLine" id="cb1443-5" data-line-number="5">m_x_<span class="dv">2</span>  &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>PrcntTake)</a>
<a class="sourceLine" id="cb1443-6" data-line-number="6">m_y    &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>SATT)</a>
<a class="sourceLine" id="cb1443-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1443-8" data-line-number="8">post &lt;-</a>
<a class="sourceLine" id="cb1443-9" data-line-number="9"><span class="st">  </span>post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1443-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">b_0 =</span> <span class="kw">make_beta_0</span>(<span class="dt">zeta_0 =</span> b_Intercept,</a>
<a class="sourceLine" id="cb1443-11" data-line-number="11">                           <span class="dt">zeta_1 =</span> b_spend_z,</a>
<a class="sourceLine" id="cb1443-12" data-line-number="12">                           <span class="dt">zeta_2 =</span> b_prcnt_take_z,</a>
<a class="sourceLine" id="cb1443-13" data-line-number="13">                           <span class="dt">sd_x_1 =</span> sd_x_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1443-14" data-line-number="14">                           <span class="dt">sd_x_2 =</span> sd_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1443-15" data-line-number="15">                           <span class="dt">sd_y   =</span> sd_y,</a>
<a class="sourceLine" id="cb1443-16" data-line-number="16">                           <span class="dt">m_x_1  =</span> m_x_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1443-17" data-line-number="17">                           <span class="dt">m_x_2  =</span> m_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1443-18" data-line-number="18">                           <span class="dt">m_y    =</span> m_y),</a>
<a class="sourceLine" id="cb1443-19" data-line-number="19">         <span class="dt">b_1 =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_spend_z,</a>
<a class="sourceLine" id="cb1443-20" data-line-number="20">                           <span class="dt">sd_j   =</span> sd_x_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1443-21" data-line-number="21">                           <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1443-22" data-line-number="22">         <span class="dt">b_2 =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_prcnt_take_z,</a>
<a class="sourceLine" id="cb1443-23" data-line-number="23">                           <span class="dt">sd_j   =</span> sd_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1443-24" data-line-number="24">                           <span class="dt">sd_y   =</span> sd_y))</a>
<a class="sourceLine" id="cb1443-25" data-line-number="25"></a>
<a class="sourceLine" id="cb1443-26" data-line-number="26"><span class="kw">glimpse</span>(post)</a></code></pre></div>
<pre><code>## Observations: 4,000
## Variables: 9
## $ b_Intercept    &lt;dbl&gt; 0.033329378, -0.050516372, -0.049160566, 0.010432…
## $ b_spend_z      &lt;dbl&gt; 0.22461570, 0.22709693, 0.27706273, 0.36386773, 0…
## $ b_prcnt_take_z &lt;dbl&gt; -1.0441089, -1.0766835, -1.0925912, -1.1413875, -…
## $ sigma          &lt;dbl&gt; 0.4381914, 0.3759888, 0.3992656, 0.4167015, 0.440…
## $ nu             &lt;dbl&gt; 58.891563, 13.331876, 18.839407, 5.558774, 29.336…
## $ lp__           &lt;dbl&gt; -35.40259, -35.92027, -35.58017, -37.95336, -39.4…
## $ b_0            &lt;dbl&gt; 998.4585, 994.5899, 980.0592, 961.1825, 973.4781,…
## $ b_1            &lt;dbl&gt; 12.331810, 12.468035, 15.211248, 19.977000, 20.15…
## $ b_2            &lt;dbl&gt; -2.919049, -3.010119, -3.054593, -3.191014, -3.52…</code></pre>
<p>Here’s the top panel of Figure 18.5.</p>
<div class="sourceCode" id="cb1445"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1445-1" data-line-number="1"><span class="kw">library</span>(tidybayes)</a>
<a class="sourceLine" id="cb1445-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1445-3" data-line-number="3"><span class="co"># here are the primary data</span></a>
<a class="sourceLine" id="cb1445-4" data-line-number="4">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1445-5" data-line-number="5"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">Intercept      =</span> b_<span class="dv">0</span>,</a>
<a class="sourceLine" id="cb1445-6" data-line-number="6">            <span class="dt">Spend          =</span> b_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1445-7" data-line-number="7">            <span class="st">`</span><span class="dt">Percent Take</span><span class="st">`</span> =<span class="st"> </span>b_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1445-8" data-line-number="8">            <span class="dt">Scale          =</span> sigma <span class="op">*</span><span class="st"> </span>sd_y,</a>
<a class="sourceLine" id="cb1445-9" data-line-number="9">            <span class="dt">Normality      =</span> nu <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">log10</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1445-10" data-line-number="10"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1445-11" data-line-number="11"><span class="st">  </span></a>
<a class="sourceLine" id="cb1445-12" data-line-number="12"><span class="st">  </span><span class="co"># the plot</span></a>
<a class="sourceLine" id="cb1445-13" data-line-number="13"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1445-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>,</a>
<a class="sourceLine" id="cb1445-15" data-line-number="15">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">bins =</span> <span class="dv">40</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1445-16" data-line-number="16"><span class="st">  </span><span class="kw">stat_pointintervalh</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb1445-17" data-line-number="17">                      <span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1445-18" data-line-number="18"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1445-19" data-line-number="19"><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1445-20" data-line-number="20"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-14-1.png" /><!-- --></p>
<blockquote>
<p>The slope on spending has a mode of about 13, which suggests that SAT scores rise by about 13 points for every extra $1000 spent per pupil. The slope on percentage taking the exam (PrcntTake) is also credibly non-zero, with a mode around −2.8, which suggests that SAT scores fall by about 2.8 points for every additional 1% of students who take the test. (p. 517)</p>
</blockquote>
<p>If you want those exact modes and, say, 50% intervals around them, you can just use <code>tidybayes::mode_hdi()</code>.</p>
<div class="sourceCode" id="cb1446"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1446-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1446-2" data-line-number="2"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">Spend          =</span> b_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1446-3" data-line-number="3">            <span class="st">`</span><span class="dt">Percent Take</span><span class="st">`</span> =<span class="st"> </span>b_<span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1446-4" data-line-number="4"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1446-5" data-line-number="5"><span class="st">  </span><span class="kw">group_by</span>(key) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1446-6" data-line-number="6"><span class="st">  </span><span class="kw">mode_hdi</span>(value, <span class="dt">.width =</span> <span class="fl">.5</span>)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 7
##   key          value .lower .upper .width .point .interval
##   &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1 Percent Take -2.86  -3.04  -2.74    0.5 mode   hdi      
## 2 Spend        12.9   10.3   15.9     0.5 mode   hdi</code></pre>
<p>The <code>brms::bayes_R2()</code> function makes it easy to compute a Bayesian <span class="math inline">\(R^2\)</span>. Simply feed a <code>brm()</code> fit object into <code>bayes_R2()</code> and you’ll bet back the posterior mean, <span class="math inline">\(SD\)</span>, and 95% intervals.</p>
<div class="sourceCode" id="cb1448"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1448-1" data-line-number="1"><span class="kw">bayes_R2</span>(fit1)</a></code></pre></div>
<pre><code>##     Estimate  Est.Error      Q2.5     Q97.5
## R2 0.8139321 0.02239821 0.7572305 0.8429055</code></pre>
<p>I’m not going to go into the technical details here, but you should be aware that the Bayeisan <span class="math inline">\(R^2\)</span> returned from the <code>bayes_R2()</code> function is not calculated the same as it is with OLS. If you want to dive in, check out the paper by <a href="https://stat.columbia.edu/~gelman/research/published/bayes_R2_v3.pdf">Gelman, Goodrich, Gabry, and Vehtari</a>. Anyway, if you’d like to view the Bayesian <span class="math inline">\(R^2\)</span> distribution rather than just get the summaries, specify <code>summary = F</code>, convert the output to a tibble, and plot as usual.</p>
<div class="sourceCode" id="cb1450"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1450-1" data-line-number="1"><span class="kw">bayes_R2</span>(fit1, <span class="dt">summary =</span> F) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1450-2" data-line-number="2"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1450-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb1450-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> R2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1450-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>,</a>
<a class="sourceLine" id="cb1450-6" data-line-number="6">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">bins =</span> <span class="dv">25</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1450-7" data-line-number="7"><span class="st">  </span><span class="kw">stat_pointintervalh</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb1450-8" data-line-number="8">                      <span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1450-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1450-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Bayesian &quot;</span>, <span class="kw">italic</span>(R)<span class="op">^</span><span class="dv">2</span>)),</a>
<a class="sourceLine" id="cb1450-11" data-line-number="11">       <span class="dt">x =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1450-12" data-line-number="12"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(.<span class="dv">6</span>, <span class="dv">1</span>))</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-17-1.png" /><!-- --></p>
<p>Since the <code>brms::bayes_R2()</code> function is not identical with Kruschke’s method in the text, the results might differ a bit.</p>
<p>We can get a sense of the scatter plots with <code>bayesplot::mcmc_pairs()</code>.</p>
<div class="sourceCode" id="cb1451"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1451-1" data-line-number="1"><span class="kw">library</span>(bayesplot)</a>
<a class="sourceLine" id="cb1451-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1451-3" data-line-number="3"><span class="kw">color_scheme_set</span>(<span class="st">&quot;gray&quot;</span>)</a>
<a class="sourceLine" id="cb1451-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1451-5" data-line-number="5">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1451-6" data-line-number="6"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">Intercept      =</span> b_<span class="dv">0</span>,</a>
<a class="sourceLine" id="cb1451-7" data-line-number="7">            <span class="dt">Spend          =</span> b_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1451-8" data-line-number="8">            <span class="st">`</span><span class="dt">Percent Take</span><span class="st">`</span> =<span class="st"> </span>b_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1451-9" data-line-number="9">            <span class="dt">Scale          =</span> sigma <span class="op">*</span><span class="st"> </span>sd_y,</a>
<a class="sourceLine" id="cb1451-10" data-line-number="10">            <span class="dt">Normality      =</span> nu <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">log10</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1451-11" data-line-number="11"><span class="st">  </span><span class="kw">mcmc_pairs</span>(<span class="dt">off_diag_args =</span> <span class="kw">list</span>(<span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">8</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">8</span>))</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-18-1.png" /><!-- --></p>
<p>To get the Pearson’s correlation coefficients among the parameters, we’ll use <code>psych::lowerCor()</code>.</p>
<div class="sourceCode" id="cb1452"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1452-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1452-2" data-line-number="2"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">Intercept      =</span> b_<span class="dv">0</span>,</a>
<a class="sourceLine" id="cb1452-3" data-line-number="3">            <span class="dt">Spend          =</span> b_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1452-4" data-line-number="4">            <span class="st">`</span><span class="dt">Percent Take</span><span class="st">`</span> =<span class="st"> </span>b_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1452-5" data-line-number="5">            <span class="dt">Scale          =</span> sigma <span class="op">*</span><span class="st"> </span>sd_y,</a>
<a class="sourceLine" id="cb1452-6" data-line-number="6">            <span class="dt">Normality      =</span> nu <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">log10</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1452-7" data-line-number="7"><span class="st">  </span>psych<span class="op">::</span><span class="kw">lowerCor</span>(<span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>##              Intrcp Spend  PrcntT Scale  Nrmlty
## Intercept     1.000                            
## Spend        -0.934  1.000                     
## Percent Take  0.349 -0.613  1.000              
## Scale         0.076 -0.083  0.080  1.000       
## Normality     0.099 -0.108  0.089  0.342  1.000</code></pre>
<p>Kruschke finished the subsection with the observation: “Sometimes we are interested in using the linear model to predict <span class="math inline">\(y\)</span> values for <span class="math inline">\(x\)</span> values of interest. It is straight forward to generate a large sample of credible <span class="math inline">\(y\)</span> values for specified <span class="math inline">\(x\)</span> values” (p. 519).</p>
<p>Like we practiced with in the last chapter, the simplest way to do so in <strong>brms</strong> is with the <code>fitted()</code> function. For a quick example, say we wanted to know what the model would predict if we were to have a standard-score increase in spending and a simultaneous standard-score decrease in the percent taking the exam. We’d just specify those values in a tibble and feed that tibble into <code>fitted()</code> along with the model.</p>
<div class="sourceCode" id="cb1454"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1454-1" data-line-number="1">nd &lt;-</a>
<a class="sourceLine" id="cb1454-2" data-line-number="2"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">spend_z      =</span>  <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1454-3" data-line-number="3">         <span class="dt">prcnt_take_z =</span> <span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb1454-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1454-5" data-line-number="5"><span class="kw">fitted</span>(fit1,</a>
<a class="sourceLine" id="cb1454-6" data-line-number="6">       <span class="dt">newdata =</span> nd)</a></code></pre></div>
<pre><code>##      Estimate Est.Error      Q2.5    Q97.5
## [1,] 1.262009 0.1547968 0.9596958 1.568147</code></pre>
</div>
<div id="redundant-predictors." class="section level3">
<h3><span class="header-section-number">18.1.4</span> Redundant predictors.</h3>
<blockquote>
<p>As a simplified example of correlated predictors, think of just two data points: Suppose <span class="math inline">\(y = 1 \text{ for } \langle x_1, x_2 \rangle = \langle 1, 1 \rangle \text{ and } y = 2 \text{ for } \langle x_1, x_2 \rangle = \langle 2, 2 \rangle\)</span>. The linear model, <span class="math inline">\(y = \beta_1 x_1 + \beta_2 x_2\)</span> is supposed to satisfy both data points, and in this case both are satisfied by <span class="math inline">\(1 = \beta_1 + \beta_2\)</span>. Therefore, many different combinations of <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span> satisfy the data. For example, it could be that <span class="math inline">\(\beta_1 = 2\)</span> and <span class="math inline">\(\beta_2 = -1\)</span>, or <span class="math inline">\(\beta_1 = 0.5\)</span> and <span class="math inline">\(\beta_2 = 0.5\)</span>, or <span class="math inline">\(\beta_1 = 0\)</span> and <span class="math inline">\(\beta_2 = 1\)</span>. In other words, the credible values of <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span> are anticorrelated and trade-off to fit the data. (p. 519)</p>
</blockquote>
<p>Here are what those data look like. You would not want to fit a regression model with these data.</p>
<div class="sourceCode" id="cb1456"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1456-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">x_1 =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1456-2" data-line-number="2">       <span class="dt">x_2 =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1456-3" data-line-number="3">       <span class="dt">y   =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##     x_1   x_2     y
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;
## 1     1     1     1
## 2     2     2     2</code></pre>
<p>We can take percentages and turn them into their inverse re-expressed as a proportion.</p>
<div class="sourceCode" id="cb1458"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1458-1" data-line-number="1">percent_take &lt;-<span class="st"> </span><span class="dv">37</span></a>
<a class="sourceLine" id="cb1458-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1458-3" data-line-number="3">(<span class="dv">100</span> <span class="op">-</span><span class="st"> </span>percent_take) <span class="op">/</span><span class="st"> </span><span class="dv">100</span></a></code></pre></div>
<pre><code>## [1] 0.63</code></pre>
<p>Let’s make a redundant predictor and then <code>standardize()</code> it.</p>
<div class="sourceCode" id="cb1460"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1460-1" data-line-number="1">my_data &lt;-</a>
<a class="sourceLine" id="cb1460-2" data-line-number="2"><span class="st">  </span>my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1460-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop_not_take   =</span> (<span class="dv">100</span> <span class="op">-</span><span class="st"> </span>PrcntTake) <span class="op">/</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1460-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop_not_take_z =</span> <span class="kw">standardize</span>(prop_not_take))</a>
<a class="sourceLine" id="cb1460-5" data-line-number="5">  </a>
<a class="sourceLine" id="cb1460-6" data-line-number="6"><span class="kw">glimpse</span>(my_data)</a></code></pre></div>
<pre><code>## Observations: 50
## Variables: 13
## $ State           &lt;chr&gt; &quot;Alabama&quot;, &quot;Alaska&quot;, &quot;Arizona&quot;, &quot;Arkansas&quot;, &quot;Cal…
## $ Spend           &lt;dbl&gt; 4.405, 8.963, 4.778, 4.459, 4.992, 5.443, 8.817,…
## $ StuTeaRat       &lt;dbl&gt; 17.2, 17.6, 19.3, 17.1, 24.0, 18.4, 14.4, 16.6, …
## $ Salary          &lt;dbl&gt; 31.144, 47.951, 32.175, 28.934, 41.078, 34.571, …
## $ PrcntTake       &lt;dbl&gt; 8, 47, 27, 6, 45, 29, 81, 68, 48, 65, 57, 15, 13…
## $ SATV            &lt;dbl&gt; 491, 445, 448, 482, 417, 462, 431, 429, 420, 406…
## $ SATM            &lt;dbl&gt; 538, 489, 496, 523, 485, 518, 477, 468, 469, 448…
## $ SATT            &lt;dbl&gt; 1029, 934, 944, 1005, 902, 980, 908, 897, 889, 8…
## $ prcnt_take_z    &lt;dbl&gt; -1.0178453, 0.4394222, -0.3078945, -1.0925770, 0…
## $ spend_z         &lt;dbl&gt; -1.10086058, 2.24370805, -0.82716069, -1.0612364…
## $ satt_z          &lt;dbl&gt; 0.8430838, -0.4266207, -0.2929676, 0.5223163, -0…
## $ prop_not_take   &lt;dbl&gt; 0.92, 0.53, 0.73, 0.94, 0.55, 0.71, 0.19, 0.32, …
## $ prop_not_take_z &lt;dbl&gt; 1.0178453, -0.4394222, 0.3078945, 1.0925770, -0.…</code></pre>
<p>We’re ready to fit the redundant-predictor model.</p>
<div class="sourceCode" id="cb1462"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1462-1" data-line-number="1">fit2 &lt;-</a>
<a class="sourceLine" id="cb1462-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1462-3" data-line-number="3">      <span class="dt">family =</span> student,</a>
<a class="sourceLine" id="cb1462-4" data-line-number="4">      satt_z <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Intercept <span class="op">+</span><span class="st"> </span>spend_z <span class="op">+</span><span class="st"> </span>prcnt_take_z <span class="op">+</span><span class="st"> </span>prop_not_take_z,</a>
<a class="sourceLine" id="cb1462-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> b, <span class="dt">coef =</span> <span class="st">&quot;Intercept&quot;</span>),</a>
<a class="sourceLine" id="cb1462-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> b, <span class="dt">coef =</span> <span class="st">&quot;spend_z&quot;</span>),</a>
<a class="sourceLine" id="cb1462-7" data-line-number="7">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> b, <span class="dt">coef =</span> <span class="st">&quot;prcnt_take_z&quot;</span>),</a>
<a class="sourceLine" id="cb1462-8" data-line-number="8">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> b, <span class="dt">coef =</span> <span class="st">&quot;prop_not_take_z&quot;</span>),</a>
<a class="sourceLine" id="cb1462-9" data-line-number="9">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">class =</span> sigma),</a>
<a class="sourceLine" id="cb1462-10" data-line-number="10">                <span class="kw">prior</span>(<span class="kw">exponential</span>(one_over_twentynine), <span class="dt">class =</span> nu)),</a>
<a class="sourceLine" id="cb1462-11" data-line-number="11">      <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1462-12" data-line-number="12">      <span class="dt">stanvars =</span> <span class="kw">stanvar</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">29</span>, <span class="dt">name =</span> <span class="st">&quot;one_over_twentynine&quot;</span>),</a>
<a class="sourceLine" id="cb1462-13" data-line-number="13">      <span class="dt">seed =</span> <span class="dv">18</span>,</a>
<a class="sourceLine" id="cb1462-14" data-line-number="14">      <span class="co"># this will let us use `prior_samples()` later on</span></a>
<a class="sourceLine" id="cb1462-15" data-line-number="15">      <span class="dt">sample_prior =</span> <span class="st">&quot;yes&quot;</span>)</a></code></pre></div>
<p>You might notice a few things about the <code>brm()</code> code. First, we have used the <code>~ 0 + Intercept + ...</code> syntax instead of the default syntax for intercepts. In normal situations, we would have been in good shape using the typical <code>~ 1 + ...</code> syntax for the intercept, especially given our use of standardized data. However, since <strong>brms</strong> version 2.5.0, using the <code>sample_prior</code> argument to draw samples from the prior distribution will no longer allow us to return samples from the typical <strong>brms</strong> intercept. Bürkner addressed the issue on the <a href="https://discourse.mc-stan.org/t/prior-intercept-samples-no-longer-saved-in-brms-2-5-0/6107">Stan forums</a>. As he pointed out, if you want to get prior samples from an intercept, you’ll have to use the alternative syntax. The other thing to point out is that even though we used the same prior on all the predictors, including the intercept, we still explicitly spelled each out with the <code>coef</code> argument. If we hadn’t been explicit like this, we would only get a single <code>b</code> vector from the <code>prior_samples()</code> function. But since we want separate vectors for each of our predictors, we used the verbose code. If you’re having a difficult time understanding these two points, experiment. Fit the model in a few different ways with either the typical or the alternative intercept syntax and with either the verbose prior code or the simplified <code>prior(normal(0, 2), class = b)</code> code. And after each, execute <code>prior_samples(fit2)</code>. You’ll see.</p>
<p>Let’s move on. Kruschke mentioned high autocorrelations in the prose. Here are the autocorrelation plots for our <span class="math inline">\(\beta\)</span>s.</p>
<div class="sourceCode" id="cb1463"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1463-1" data-line-number="1">post &lt;-<span class="st"> </span><span class="kw">posterior_samples</span>(fit2, <span class="dt">add_chain =</span> T)</a>
<a class="sourceLine" id="cb1463-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1463-3" data-line-number="3"><span class="kw">mcmc_acf</span>(post, </a>
<a class="sourceLine" id="cb1463-4" data-line-number="4">         <span class="dt">pars =</span> <span class="kw">c</span>(<span class="st">&quot;b_Intercept&quot;</span>, <span class="st">&quot;b_spend_z&quot;</span>, <span class="st">&quot;b_prcnt_take_z&quot;</span>, <span class="st">&quot;b_prop_not_take_z&quot;</span>), </a>
<a class="sourceLine" id="cb1463-5" data-line-number="5">         <span class="dt">lags =</span> <span class="dv">10</span>)</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-24-1.png" /><!-- --></p>
<p>Looks like HMC made a big difference. The <span class="math inline">\(N_{eff}/N\)</span> ratios weren’t terrible, either.</p>
<div class="sourceCode" id="cb1464"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1464-1" data-line-number="1"><span class="kw">neff_ratio</span>(fit2)[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1464-2" data-line-number="2"><span class="st">  </span><span class="kw">mcmc_neff</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb1464-3" data-line-number="3"><span class="st">  </span><span class="kw">yaxis_text</span>(<span class="dt">hjust =</span> <span class="dv">0</span>)</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-25-1.png" /><!-- --></p>
<p>The <code>brms::vcov()</code> function returns a variance/covariance matrix–or a correlation matrix when you set <code>correlation = T</code>–of the population-level parameters (i.e., the fixed effects). It returns the values to an unnecessary level of precision, so we’ll simplify the output with <code>round()</code>.</p>
<div class="sourceCode" id="cb1465"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1465-1" data-line-number="1"><span class="kw">vcov</span>(fit2, <span class="dt">correlation =</span> T) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1465-2" data-line-number="2"><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>##                 Intercept spend_z prcnt_take_z prop_not_take_z
## Intercept           1.000   0.026        0.028           0.029
## spend_z             0.026   1.000        0.013           0.048
## prcnt_take_z        0.028   0.013        1.000           0.998
## prop_not_take_z     0.029   0.048        0.998           1.000</code></pre>
<p>Notice how much lower our <code>Spend_z</code> correlations are than those Kruschke displayed on page 520 of the text. However, it turns out the correlations among the redundant predictors were still very high.</p>
<blockquote>
<p>If any of the nondiagonal correlations are high (i.e., close to +1 or close to −1), be careful when interpreting the posterior distribution. Here, we can see that the correlation of PrcntTake and PropNotTake is −1.0, which is an immediate sign of redundant predictors. (p. 520)</p>
</blockquote>
<p>You can really get a sense of the silliness of the parameters if you plot them. We’ll use <code>geom_halfeyeh()</code> to get a sense of densities and summaries of the <span class="math inline">\(\beta\)</span>s.</p>
<div class="sourceCode" id="cb1467"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1467-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1467-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(b_Intercept<span class="op">:</span>b_prop_not_take_z) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1467-3" data-line-number="3"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1467-4" data-line-number="4"><span class="st">  </span><span class="co"># this line isn&#39;t necessary, but it does allow us to arrange the parameters on the y-axis</span></a>
<a class="sourceLine" id="cb1467-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">key =</span> <span class="kw">factor</span>(key, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;b_prop_not_take_z&quot;</span>, <span class="st">&quot;b_prcnt_take_z&quot;</span>, <span class="st">&quot;b_spend_z&quot;</span>, <span class="st">&quot;b_Intercept&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1467-6" data-line-number="6"><span class="st">  </span></a>
<a class="sourceLine" id="cb1467-7" data-line-number="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> key)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1467-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1467-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_halfeyeh</span>(<span class="dt">point_interval =</span> mode_hdi,</a>
<a class="sourceLine" id="cb1467-10" data-line-number="10">                <span class="dt">.width =</span> <span class="fl">.95</span>,</a>
<a class="sourceLine" id="cb1467-11" data-line-number="11">                <span class="co"># the next two lines are purely aesthetic</span></a>
<a class="sourceLine" id="cb1467-12" data-line-number="12">                <span class="dt">scale =</span> <span class="st">&quot;width&quot;</span>,</a>
<a class="sourceLine" id="cb1467-13" data-line-number="13">                <span class="dt">relative_scale =</span> <span class="fl">.9</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1467-14" data-line-number="14"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, </a>
<a class="sourceLine" id="cb1467-15" data-line-number="15">       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1467-16" data-line-number="16"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">-5</span><span class="op">:</span><span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1467-17" data-line-number="17"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.y  =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1467-18" data-line-number="18">        <span class="dt">axis.ticks.y =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-27-1.png" /><!-- --></p>
<p>Yeah, on the standardized scale those are some ridiculous estimates. Let’s update our <code>make_beta_0()</code> function.</p>
<div class="sourceCode" id="cb1468"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1468-1" data-line-number="1">make_beta_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="cf">function</span>(zeta_<span class="dv">0</span>, zeta_<span class="dv">1</span>, zeta_<span class="dv">2</span>, zeta_<span class="dv">3</span>, sd_x_<span class="dv">1</span>, sd_x_<span class="dv">2</span>, sd_x_<span class="dv">3</span>, sd_y, m_x_<span class="dv">1</span>, m_x_<span class="dv">2</span>, m_x_<span class="dv">3</span>,  m_y) {</a>
<a class="sourceLine" id="cb1468-2" data-line-number="2">  sd_y <span class="op">*</span><span class="st"> </span>zeta_<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>m_y <span class="op">-</span><span class="st"> </span>sd_y <span class="op">*</span><span class="st"> </span>((zeta_<span class="dv">1</span> <span class="op">*</span><span class="st"> </span>m_x_<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>sd_x_<span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>(zeta_<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>m_x_<span class="dv">2</span> <span class="op">/</span><span class="st"> </span>sd_x_<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>(zeta_<span class="dv">3</span> <span class="op">*</span><span class="st"> </span>m_x_<span class="dv">3</span> <span class="op">/</span><span class="st"> </span>sd_x_<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb1468-3" data-line-number="3">  }</a></code></pre></div>
<div class="sourceCode" id="cb1469"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1469-1" data-line-number="1">sd_x_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>Spend)</a>
<a class="sourceLine" id="cb1469-2" data-line-number="2">sd_x_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>PrcntTake)</a>
<a class="sourceLine" id="cb1469-3" data-line-number="3">sd_x_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>prop_not_take)</a>
<a class="sourceLine" id="cb1469-4" data-line-number="4">sd_y   &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>SATT)</a>
<a class="sourceLine" id="cb1469-5" data-line-number="5">m_x_<span class="dv">1</span>  &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>Spend)</a>
<a class="sourceLine" id="cb1469-6" data-line-number="6">m_x_<span class="dv">2</span>  &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>PrcntTake)</a>
<a class="sourceLine" id="cb1469-7" data-line-number="7">m_x_<span class="dv">3</span>  &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>prop_not_take)</a>
<a class="sourceLine" id="cb1469-8" data-line-number="8">m_y    &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>SATT)</a>
<a class="sourceLine" id="cb1469-9" data-line-number="9"></a>
<a class="sourceLine" id="cb1469-10" data-line-number="10">post &lt;-</a>
<a class="sourceLine" id="cb1469-11" data-line-number="11"><span class="st">  </span>post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1469-12" data-line-number="12"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">Intercept =</span> <span class="kw">make_beta_0</span>(<span class="dt">zeta_0 =</span> b_Intercept,</a>
<a class="sourceLine" id="cb1469-13" data-line-number="13">                                    <span class="dt">zeta_1 =</span> b_spend_z,</a>
<a class="sourceLine" id="cb1469-14" data-line-number="14">                                    <span class="dt">zeta_2 =</span> b_prcnt_take_z,</a>
<a class="sourceLine" id="cb1469-15" data-line-number="15">                                    <span class="dt">zeta_3 =</span> b_prop_not_take_z,</a>
<a class="sourceLine" id="cb1469-16" data-line-number="16">                                    <span class="dt">sd_x_1 =</span> sd_x_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1469-17" data-line-number="17">                                    <span class="dt">sd_x_2 =</span> sd_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1469-18" data-line-number="18">                                    <span class="dt">sd_x_3 =</span> sd_x_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1469-19" data-line-number="19">                                    <span class="dt">sd_y   =</span> sd_y,</a>
<a class="sourceLine" id="cb1469-20" data-line-number="20">                                    <span class="dt">m_x_1  =</span> m_x_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1469-21" data-line-number="21">                                    <span class="dt">m_x_2  =</span> m_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1469-22" data-line-number="22">                                    <span class="dt">m_x_3  =</span> m_x_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1469-23" data-line-number="23">                                    <span class="dt">m_y    =</span> m_y),</a>
<a class="sourceLine" id="cb1469-24" data-line-number="24">            <span class="dt">Spend =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_spend_z,</a>
<a class="sourceLine" id="cb1469-25" data-line-number="25">                                <span class="dt">sd_j   =</span> sd_x_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1469-26" data-line-number="26">                                <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1469-27" data-line-number="27">            <span class="st">`</span><span class="dt">Percent Take</span><span class="st">`</span> =<span class="st"> </span><span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_prcnt_take_z,</a>
<a class="sourceLine" id="cb1469-28" data-line-number="28">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1469-29" data-line-number="29">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1469-30" data-line-number="30">            <span class="st">`</span><span class="dt">Proportion not Take</span><span class="st">`</span> =<span class="st"> </span><span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_prop_not_take_z,</a>
<a class="sourceLine" id="cb1469-31" data-line-number="31">                                                <span class="dt">sd_j   =</span> sd_x_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1469-32" data-line-number="32">                                                <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1469-33" data-line-number="33">            <span class="dt">Scale     =</span> sigma <span class="op">*</span><span class="st"> </span>sd_y,</a>
<a class="sourceLine" id="cb1469-34" data-line-number="34">            <span class="dt">Normality =</span> nu <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">log10</span>())</a>
<a class="sourceLine" id="cb1469-35" data-line-number="35"></a>
<a class="sourceLine" id="cb1469-36" data-line-number="36"><span class="kw">glimpse</span>(post)</a></code></pre></div>
<pre><code>## Observations: 4,000
## Variables: 6
## $ Intercept             &lt;dbl&gt; 1061.1824, 280.0482, 873.1032, 551.0707, 6…
## $ Spend                 &lt;dbl&gt; 5.454006, 17.469214, 15.816227, 12.931905,…
## $ `Percent Take`        &lt;dbl&gt; -3.1303938, 3.9409313, -1.8844443, 1.47699…
## $ `Proportion not Take` &lt;dbl&gt; -26.318716, 682.212440, 105.706334, 432.37…
## $ Scale                 &lt;dbl&gt; 30.16235, 32.49213, 26.98000, 36.66645, 28…
## $ Normality             &lt;dbl&gt; 1.1409028, 1.3884920, 1.8217587, 1.0168820…</code></pre>
<p>Now we’ve done the conversions, here are the histograms of Figure 18.6.</p>
<div class="sourceCode" id="cb1471"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1471-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1471-2" data-line-number="2"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1471-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb1471-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb1471-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value),</a>
<a class="sourceLine" id="cb1471-6" data-line-number="6">                 <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>,</a>
<a class="sourceLine" id="cb1471-7" data-line-number="7">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">bins =</span> <span class="dv">40</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1471-8" data-line-number="8"><span class="st">  </span><span class="kw">stat_pointintervalh</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb1471-9" data-line-number="9">                      <span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1471-10" data-line-number="10"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1471-11" data-line-number="11"><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1471-12" data-line-number="12"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-30-1.png" /><!-- --></p>
<p>Their scatter plots are as follows:</p>
<div class="sourceCode" id="cb1472"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1472-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1472-2" data-line-number="2"><span class="st">  </span><span class="kw">mcmc_pairs</span>(<span class="dt">off_diag_args =</span> <span class="kw">list</span>(<span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">8</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">8</span>))</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-31-1.png" /><!-- --></p>
<p>Here are the Pearson’s correlations.</p>
<div class="sourceCode" id="cb1473"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1473-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1473-2" data-line-number="2"><span class="st">  </span>psych<span class="op">::</span><span class="kw">lowerCor</span>(<span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>##                     Intrcp Spend  PrcntT PrprnT Scale  Nrmlty
## Intercept            1.000                                   
## Spend               -0.100  1.000                            
## Percent Take        -0.996  0.013  1.000                     
## Proportion not Take -0.998  0.048  0.998  1.000              
## Scale                0.002 -0.086  0.007  0.003  1.000       
## Normality            0.033 -0.082 -0.024 -0.030  0.373  1.000</code></pre>
<p>Figure 18.7 is all about the prior predictive distribution. Here we’ll extract the priors with <code>prior_samples()</code> and wrangle all in one step.</p>
<div class="sourceCode" id="cb1475"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1475-1" data-line-number="1">prior &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1475-2" data-line-number="2"><span class="st">  </span><span class="kw">prior_samples</span>(fit2) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1475-3" data-line-number="3"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">Intercept =</span> <span class="kw">make_beta_0</span>(<span class="dt">zeta_0 =</span> b_Intercept,</a>
<a class="sourceLine" id="cb1475-4" data-line-number="4">                                    <span class="dt">zeta_1 =</span> b_spend_z,</a>
<a class="sourceLine" id="cb1475-5" data-line-number="5">                                    <span class="dt">zeta_2 =</span> b_prcnt_take_z,</a>
<a class="sourceLine" id="cb1475-6" data-line-number="6">                                    <span class="dt">zeta_3 =</span> b_prop_not_take_z,</a>
<a class="sourceLine" id="cb1475-7" data-line-number="7">                                    <span class="dt">sd_x_1 =</span> sd_x_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1475-8" data-line-number="8">                                    <span class="dt">sd_x_2 =</span> sd_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1475-9" data-line-number="9">                                    <span class="dt">sd_x_3 =</span> sd_x_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1475-10" data-line-number="10">                                    <span class="dt">sd_y   =</span> sd_y,</a>
<a class="sourceLine" id="cb1475-11" data-line-number="11">                                    <span class="dt">m_x_1  =</span> m_x_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1475-12" data-line-number="12">                                    <span class="dt">m_x_2  =</span> m_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1475-13" data-line-number="13">                                    <span class="dt">m_x_3  =</span> m_x_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1475-14" data-line-number="14">                                    <span class="dt">m_y    =</span> m_y),</a>
<a class="sourceLine" id="cb1475-15" data-line-number="15">            <span class="dt">Spend =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_spend_z,</a>
<a class="sourceLine" id="cb1475-16" data-line-number="16">                                <span class="dt">sd_j   =</span> sd_x_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1475-17" data-line-number="17">                                <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1475-18" data-line-number="18">            <span class="st">`</span><span class="dt">Percent Take</span><span class="st">`</span> =<span class="st"> </span><span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_prcnt_take_z,</a>
<a class="sourceLine" id="cb1475-19" data-line-number="19">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1475-20" data-line-number="20">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1475-21" data-line-number="21">            <span class="st">`</span><span class="dt">Proportion not Take</span><span class="st">`</span> =<span class="st"> </span><span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_prop_not_take_z,</a>
<a class="sourceLine" id="cb1475-22" data-line-number="22">                                                <span class="dt">sd_j   =</span> sd_x_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1475-23" data-line-number="23">                                                <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1475-24" data-line-number="24">            <span class="dt">Scale     =</span> sigma <span class="op">*</span><span class="st"> </span>sd_y,</a>
<a class="sourceLine" id="cb1475-25" data-line-number="25">            <span class="dt">Normality =</span> nu <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">log10</span>()) </a>
<a class="sourceLine" id="cb1475-26" data-line-number="26"></a>
<a class="sourceLine" id="cb1475-27" data-line-number="27"><span class="kw">glimpse</span>(prior)</a></code></pre></div>
<pre><code>## Observations: 4,000
## Variables: 6
## $ Intercept             &lt;dbl&gt; 1462.43927, 664.21947, 1289.22313, 1476.56…
## $ Spend                 &lt;dbl&gt; -38.749588, 13.362327, -49.410718, -93.439…
## $ `Percent Take`        &lt;dbl&gt; 1.2899620, 6.4475454, 7.1217195, 1.7590988…
## $ `Proportion not Take` &lt;dbl&gt; -310.88980, 63.95417, -280.14134, 101.8131…
## $ Scale                 &lt;dbl&gt; 2.822765, 6.293331, 67.317724, 11.692913, …
## $ Normality             &lt;dbl&gt; 1.5678380, 1.5254245, 1.2846292, 0.6427115…</code></pre>
<p>Now we’ve wrangled the priors, we’re ready to make the histograms at the top of Figure 18.7.</p>
<div class="sourceCode" id="cb1477"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1477-1" data-line-number="1">prior <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1477-2" data-line-number="2"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1477-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb1477-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1477-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>,</a>
<a class="sourceLine" id="cb1477-6" data-line-number="6">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">bins =</span> <span class="dv">40</span>, <span class="dt">boundary =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1477-7" data-line-number="7"><span class="st">  </span><span class="kw">stat_pointintervalh</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb1477-8" data-line-number="8">                      <span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1477-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1477-10" data-line-number="10"><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1477-11" data-line-number="11"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-34-1.png" /><!-- --></p>
<p>Since we used the half-Gaussian prior for our <span class="math inline">\(\sigma\)</span>, our <code>Scale</code> histogram looks different from Kruschke’s. Otherwise, everything’s on the up and up. Here are the scatter plots at the bottom of Figure 18.7.</p>
<div class="sourceCode" id="cb1478"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1478-1" data-line-number="1">prior <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1478-2" data-line-number="2"><span class="st">  </span><span class="kw">mcmc_pairs</span>(<span class="dt">off_diag_args =</span> <span class="kw">list</span>(<span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">8</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">8</span>))</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-35-1.png" /><!-- --></p>
<p>And finally, here are those Pearson’s correlation coefficients for the priors.</p>
<div class="sourceCode" id="cb1479"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1479-1" data-line-number="1">prior <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1479-2" data-line-number="2"><span class="st">  </span>psych<span class="op">::</span><span class="kw">lowerCor</span>(<span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>##                     Intrcp Spend  PrcntT PrprnT Scale  Nrmlty
## Intercept            1.000                                   
## Spend               -0.826  1.000                            
## Percent Take        -0.256  0.003  1.000                     
## Proportion not Take -0.486  0.020  0.019  1.000              
## Scale               -0.007  0.005  0.024 -0.017  1.000       
## Normality            0.007 -0.006 -0.006 -0.001 -0.001  1.000</code></pre>
<p>At the top of page 523, Kruschke asked us to “notice that the posterior distribution in Figure 18.6 has ranges for the redundant parameters that are only a little smaller than their priors.” With a little wrangling, we can compare the prior/posterior distributions for our redundant parameters more directly.</p>
<div class="sourceCode" id="cb1481"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1481-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1481-2" data-line-number="2"><span class="st">  </span><span class="kw">gather</span>(parameter, posterior) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1481-3" data-line-number="3"><span class="st">  </span><span class="kw">bind_cols</span>(</a>
<a class="sourceLine" id="cb1481-4" data-line-number="4">    prior <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1481-5" data-line-number="5"><span class="st">      </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1481-6" data-line-number="6"><span class="st">      </span><span class="kw">transmute</span>(<span class="dt">prior =</span> value)</a>
<a class="sourceLine" id="cb1481-7" data-line-number="7">    ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1481-8" data-line-number="8"><span class="st">  </span><span class="kw">gather</span>(key, value, <span class="op">-</span>parameter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1481-9" data-line-number="9"><span class="st">  </span></a>
<a class="sourceLine" id="cb1481-10" data-line-number="10"><span class="st">  </span><span class="kw">filter</span>(parameter <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Percent Take&quot;</span>, <span class="st">&quot;Proportion not Take&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1481-11" data-line-number="11"><span class="st">  </span></a>
<a class="sourceLine" id="cb1481-12" data-line-number="12"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">fill =</span> key)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1481-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1481-14" data-line-number="14">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">bins =</span> <span class="dv">40</span>, <span class="dt">boundary =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1481-15" data-line-number="15"><span class="st">  </span><span class="kw">stat_pointintervalh</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb1481-16" data-line-number="16">                      <span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1481-17" data-line-number="17"><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;D&quot;</span>, <span class="dt">begin =</span> <span class="fl">.35</span>, <span class="dt">end =</span> <span class="fl">.65</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1481-18" data-line-number="18"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1481-19" data-line-number="19"><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1481-20" data-line-number="20"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1481-21" data-line-number="21"><span class="st">  </span><span class="kw">facet_grid</span>(key<span class="op">~</span>parameter, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-37-1.png" /><!-- --></p>
<p>Kruschke was right. The posterior distributions are only slightly narrower than the priors for those two. With our combination of data and model, we learned virtually nothing beyond the knowledge we encoded in those priors.</p>
<p>Kruschke mentioned SEM as a possible solution to multicollinearity. <strong>brms</strong> <a href="https://github.com/paul-buerkner/brms/issues/304">isn’t fully capable of SEM, at the moment</a>, but its <a href="https://cran.r-project.org/web/packages/brms/vignettes/brms_multivariate.html">multivariate syntax</a> does allow for <a href="http://www.imachordata.com/bayesian-sem-with-brms/">path analysis</a> and <a href="https://github.com/paul-buerkner/brms/issues/203">IRT models</a>. However, you can currently fit a variety of Bayesian SEMs with the <a href="https://cran.r-project.org/web/packages/blavaan/index.html"><strong>blavaan</strong> package</a>. I’m not aware of any textbooks highlighting <strong>blavaan</strong>. If you’ve seen any, <a href="https://github.com/ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse/issues">please share</a>.</p>
</div>
<div id="informative-priors-sparse-data-and-correlated-predictors." class="section level3">
<h3><span class="header-section-number">18.1.5</span> Informative priors, sparse data, and correlated predictors.</h3>
<p>It’s worth reproducing some of Kruschke’s prose from this subsection.</p>
<blockquote>
<p>The examples in this book tend to use mildly informed priors (e.g., using information about the rough magnitude and range of the data). But a benefit of Bayesian analysis is the potential for cumulative scientific progress by using priors that have been informed from previous research.</p>
<p>Informed priors can be especially useful when the amount of data is small compared to the parameter space. A strongly informed prior essentially reduces the scope of the credible parameter space, so that a small amount of new data implies a narrow zone of credible parameter values. (p. 523)</p>
</blockquote>
</div>
</div>
<div id="multiplicative-interaction-of-metric-predictors" class="section level2">
<h2><span class="header-section-number">18.2</span> Multiplicative interaction of metric predictors</h2>
<p>From page 526:</p>
<blockquote>
<p>Formally, interactions can have many different specific functional forms. We will consider multiplicative interaction. This means that the nonadditive interaction is expressed by multiplying the predictors. The predicted value is a weighted combination of the individual predictors and, additionally, the multiplicative product of the predictors. For two metric predictors, regression with multiplicative interaction has these algebraically equivalent expressions:</p>
</blockquote>
<p><span class="math display">\[\begin{align*}
\mu &amp; = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_{1 \times 2} x_1 x_2 \\
    &amp; = \beta_0 + \underbrace{(\beta_1 + \beta_{1 \times 2} x_2)}_{\text{slope of } x_1} x_1 + \beta_2 x_2 \\
    &amp; = \beta_0 + \beta_1 x_1 + \underbrace{(\beta_2 + \beta_{1 \times 2} x_1)}_{\text{slope of } x_2} x_2.
\end{align*}\]</span></p>
<p>Figure 18.8 is out of our <strong>ggplot2</strong> repertoire.</p>
<div id="an-example." class="section level3">
<h3><span class="header-section-number">18.2.1</span> An example.</h3>
<p>With <strong>brms</strong>, you can specify an interaction with either the <code>x_i*x_j</code> syntax or the <code>x_i:x_j</code> syntax. I typically use <code>x_i:x_j</code>. It’s often the case that you can just make the interaction term right in the model formula. But since we’re fitting the model with standardized predictors and then using Kruschke’s equations to convert the parameters back to the unstandardized metric, it seems easier to make the interaction term in the data, first.</p>
<div class="sourceCode" id="cb1482"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1482-1" data-line-number="1">my_data &lt;-</a>
<a class="sourceLine" id="cb1482-2" data-line-number="2"><span class="st">  </span>my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1482-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">interaction   =</span> Spend <span class="op">*</span><span class="st"> </span>PrcntTake) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1482-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">interaction_z =</span> <span class="kw">standardize</span>(interaction))</a></code></pre></div>
<p>Now we’ll fit the model.</p>
<div class="sourceCode" id="cb1483"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1483-1" data-line-number="1">fit3 &lt;-</a>
<a class="sourceLine" id="cb1483-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1483-3" data-line-number="3">      <span class="dt">family =</span> student,</a>
<a class="sourceLine" id="cb1483-4" data-line-number="4">      satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>spend_z <span class="op">+</span><span class="st"> </span>prcnt_take_z <span class="op">+</span><span class="st"> </span>interaction_z,</a>
<a class="sourceLine" id="cb1483-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1483-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> b),</a>
<a class="sourceLine" id="cb1483-7" data-line-number="7">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">class =</span> sigma),</a>
<a class="sourceLine" id="cb1483-8" data-line-number="8">                <span class="kw">prior</span>(<span class="kw">exponential</span>(one_over_twentynine), <span class="dt">class =</span> nu)),</a>
<a class="sourceLine" id="cb1483-9" data-line-number="9">      <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1483-10" data-line-number="10">      <span class="dt">stanvars =</span> <span class="kw">stanvar</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">29</span>, <span class="dt">name =</span> <span class="st">&quot;one_over_twentynine&quot;</span>),</a>
<a class="sourceLine" id="cb1483-11" data-line-number="11">      <span class="dt">seed =</span> <span class="dv">18</span>)</a></code></pre></div>
<p>Note that even though an interaction term might seem different kind from other regression terms, it’s just another coefficient of <code>class = b</code> as far as the <code>prior()</code> statements are concerned. Anyway, let’s inspect the <code>summary()</code>.</p>
<div class="sourceCode" id="cb1484"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1484-1" data-line-number="1"><span class="kw">summary</span>(fit3)</a></code></pre></div>
<pre><code>##  Family: student 
##   Links: mu = identity; sigma = identity; nu = identity 
## Formula: satt_z ~ 1 + spend_z + prcnt_take_z + interaction_z 
##    Data: my_data (Number of observations: 50) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept        -0.00      0.06    -0.12     0.11 1.00     2779     2427
## spend_z           0.04      0.14    -0.24     0.32 1.00     1484     2038
## prcnt_take_z     -1.48      0.29    -2.03    -0.90 1.00     1336     1985
## interaction_z     0.59      0.37    -0.12     1.30 1.00     1217     1696
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     0.41      0.05     0.33     0.52 1.00     2837     2503
## nu       34.38     28.67     4.52   110.70 1.00     2685     2567
## 
## Samples were drawn using sampling(NUTS). For each parameter, Eff.Sample 
## is a crude measure of effective sample size, and Rhat is the potential 
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>The correlations among our parameters are about as severe as those in the text.</p>
<div class="sourceCode" id="cb1486"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1486-1" data-line-number="1"><span class="kw">vcov</span>(fit3, <span class="dt">correlation =</span> T) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1486-2" data-line-number="2"><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>##               Intercept spend_z prcnt_take_z interaction_z
## Intercept         1.000  -0.009        0.003        -0.001
## spend_z          -0.009   1.000        0.713        -0.835
## prcnt_take_z      0.003   0.713        1.000        -0.962
## interaction_z    -0.001  -0.835       -0.962         1.000</code></pre>
<blockquote>
<p>We can see that the interaction variable is strongly correlated with both predictors. Therefore, we know that there will be strong trade-offs among the regression coefficients, and the marginal distributions of single regression coefficients might be much wider than when there was no interaction included. (p. 528)</p>
</blockquote>
<p>Let’s convert the posterior draws to the unstandardized metric.</p>
<div class="sourceCode" id="cb1488"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1488-1" data-line-number="1">sd_x_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>interaction)</a>
<a class="sourceLine" id="cb1488-2" data-line-number="2">m_x_<span class="dv">3</span>  &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>interaction)</a>
<a class="sourceLine" id="cb1488-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1488-4" data-line-number="4">post &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1488-5" data-line-number="5"><span class="st">  </span><span class="kw">posterior_samples</span>(fit3) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1488-6" data-line-number="6"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">Intercept =</span> <span class="kw">make_beta_0</span>(<span class="dt">zeta_0 =</span> b_Intercept,</a>
<a class="sourceLine" id="cb1488-7" data-line-number="7">                                    <span class="dt">zeta_1 =</span> b_spend_z,</a>
<a class="sourceLine" id="cb1488-8" data-line-number="8">                                    <span class="dt">zeta_2 =</span> b_prcnt_take_z,</a>
<a class="sourceLine" id="cb1488-9" data-line-number="9">                                    <span class="dt">zeta_3 =</span> b_interaction_z,</a>
<a class="sourceLine" id="cb1488-10" data-line-number="10">                                    <span class="dt">sd_x_1 =</span> sd_x_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1488-11" data-line-number="11">                                    <span class="dt">sd_x_2 =</span> sd_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1488-12" data-line-number="12">                                    <span class="dt">sd_x_3 =</span> sd_x_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1488-13" data-line-number="13">                                    <span class="dt">sd_y   =</span> sd_y,</a>
<a class="sourceLine" id="cb1488-14" data-line-number="14">                                    <span class="dt">m_x_1  =</span> m_x_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1488-15" data-line-number="15">                                    <span class="dt">m_x_2  =</span> m_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1488-16" data-line-number="16">                                    <span class="dt">m_x_3  =</span> m_x_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1488-17" data-line-number="17">                                    <span class="dt">m_y    =</span> m_y),</a>
<a class="sourceLine" id="cb1488-18" data-line-number="18">            <span class="dt">Spend =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_spend_z,</a>
<a class="sourceLine" id="cb1488-19" data-line-number="19">                                <span class="dt">sd_j   =</span> sd_x_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1488-20" data-line-number="20">                                <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1488-21" data-line-number="21">            <span class="st">`</span><span class="dt">Percent Take</span><span class="st">`</span> =<span class="st"> </span><span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_prcnt_take_z,</a>
<a class="sourceLine" id="cb1488-22" data-line-number="22">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1488-23" data-line-number="23">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1488-24" data-line-number="24">            <span class="st">`</span><span class="dt">Spend : Percent Take</span><span class="st">`</span> =<span class="st"> </span><span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_interaction_z,</a>
<a class="sourceLine" id="cb1488-25" data-line-number="25">                                                 <span class="dt">sd_j   =</span> sd_x_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1488-26" data-line-number="26">                                                 <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1488-27" data-line-number="27">            <span class="dt">Scale     =</span> sigma <span class="op">*</span><span class="st"> </span>sd_y,</a>
<a class="sourceLine" id="cb1488-28" data-line-number="28">            <span class="dt">Normality =</span> nu <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">log10</span>())</a>
<a class="sourceLine" id="cb1488-29" data-line-number="29"></a>
<a class="sourceLine" id="cb1488-30" data-line-number="30"><span class="kw">glimpse</span>(post)</a></code></pre></div>
<pre><code>## Observations: 4,000
## Variables: 6
## $ Intercept              &lt;dbl&gt; 1072.273, 1052.266, 1051.125, 1068.692, 1…
## $ Spend                  &lt;dbl&gt; -1.6619618, 4.1428271, 2.3548164, -1.6373…
## $ `Percent Take`         &lt;dbl&gt; -4.815437, -4.600243, -4.150411, -4.25895…
## $ `Spend : Percent Take` &lt;dbl&gt; 0.31441969, 0.22608990, 0.21413414, 0.255…
## $ Scale                  &lt;dbl&gt; 28.15976, 32.34262, 29.09982, 29.94091, 2…
## $ Normality              &lt;dbl&gt; 1.6180165, 1.1979350, 1.5089735, 1.569651…</code></pre>
<p>Now we’ve done the conversions, here are the histograms of Figure 18.9.</p>
<div class="sourceCode" id="cb1490"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1490-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1490-2" data-line-number="2"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1490-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb1490-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1490-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>,</a>
<a class="sourceLine" id="cb1490-6" data-line-number="6">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">bins =</span> <span class="dv">40</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1490-7" data-line-number="7"><span class="st">  </span><span class="kw">stat_pointintervalh</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb1490-8" data-line-number="8">                      <span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1490-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1490-10" data-line-number="10"><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1490-11" data-line-number="11"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-42-1.png" /><!-- --></p>
<p>“To properly understand the credible slopes on the two predictors, we must consider the credible slopes on each predictor as a function of the value of the other predictor” (p. 528). This is our motivation for the middle panel of Figure 18.9. To make it, we’ll need to <code>expand()</code> our <code>post</code>, wrangle a bit, and plot with <code>geom_pointrange()</code>.</p>
<div class="sourceCode" id="cb1491"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1491-1" data-line-number="1"><span class="co"># this will come in handy in `expand()`</span></a>
<a class="sourceLine" id="cb1491-2" data-line-number="2">bounds &lt;-<span class="st"> </span><span class="kw">range</span>(my_data<span class="op">$</span>PrcntTake)</a>
<a class="sourceLine" id="cb1491-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1491-4" data-line-number="4"><span class="co"># wrangle</span></a>
<a class="sourceLine" id="cb1491-5" data-line-number="5">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1491-6" data-line-number="6"><span class="st">  </span><span class="kw">expand</span>(<span class="kw">nesting</span>(Spend, <span class="st">`</span><span class="dt">Spend : Percent Take</span><span class="st">`</span>),</a>
<a class="sourceLine" id="cb1491-7" data-line-number="7">         <span class="dt">PrcntTake =</span> <span class="kw">seq</span>(<span class="dt">from =</span> bounds[<span class="dv">1</span>], <span class="dt">to =</span> bounds[<span class="dv">2</span>], <span class="dt">length.out =</span> <span class="dv">20</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1491-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">slope =</span> Spend <span class="op">+</span><span class="st"> `</span><span class="dt">Spend : Percent Take</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span>PrcntTake) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1491-9" data-line-number="9"><span class="st">  </span><span class="kw">group_by</span>(PrcntTake) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1491-10" data-line-number="10"><span class="st">  </span><span class="kw">median_hdi</span>(slope) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1491-11" data-line-number="11"><span class="st">  </span></a>
<a class="sourceLine" id="cb1491-12" data-line-number="12"><span class="st">  </span><span class="co"># plot</span></a>
<a class="sourceLine" id="cb1491-13" data-line-number="13"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PrcntTake, <span class="dt">y =</span> slope,</a>
<a class="sourceLine" id="cb1491-14" data-line-number="14">             <span class="dt">ymin =</span> .lower, <span class="dt">ymax =</span> .upper)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1491-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1491-16" data-line-number="16"><span class="st">  </span><span class="kw">geom_pointrange</span>(<span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1491-17" data-line-number="17"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x     =</span> <span class="st">&quot;Value of prcnt_take&quot;</span>,</a>
<a class="sourceLine" id="cb1491-18" data-line-number="18">       <span class="dt">y     =</span> <span class="st">&quot;Slope on spend&quot;</span>,</a>
<a class="sourceLine" id="cb1491-19" data-line-number="19">       <span class="dt">title =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Slope on spend is &quot;</span>, beta[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>beta[<span class="dv">3</span>] <span class="op">%.%</span><span class="st"> &quot;prcnt_take&quot;</span>)))</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-43-1.png" /><!-- --></p>
<p>That worked like a charm. We’ll follow the same basic order of operations for the final panel.</p>
<div class="sourceCode" id="cb1492"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1492-1" data-line-number="1"><span class="co"># this will come in handy in `expand()`</span></a>
<a class="sourceLine" id="cb1492-2" data-line-number="2">bounds &lt;-<span class="st"> </span><span class="kw">range</span>(my_data<span class="op">$</span>Spend)</a>
<a class="sourceLine" id="cb1492-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1492-4" data-line-number="4"><span class="co"># wrangle</span></a>
<a class="sourceLine" id="cb1492-5" data-line-number="5">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1492-6" data-line-number="6"><span class="st">  </span><span class="kw">expand</span>(<span class="kw">nesting</span>(<span class="st">`</span><span class="dt">Percent Take</span><span class="st">`</span>, <span class="st">`</span><span class="dt">Spend : Percent Take</span><span class="st">`</span>),</a>
<a class="sourceLine" id="cb1492-7" data-line-number="7">         <span class="dt">Spend =</span> <span class="kw">seq</span>(<span class="dt">from =</span> bounds[<span class="dv">1</span>], <span class="dt">to =</span> bounds[<span class="dv">2</span>], <span class="dt">length.out =</span> <span class="dv">20</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1492-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">slope =</span> <span class="st">`</span><span class="dt">Percent Take</span><span class="st">`</span> <span class="op">+</span><span class="st"> `</span><span class="dt">Spend : Percent Take</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span>Spend) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1492-9" data-line-number="9"><span class="st">  </span><span class="kw">group_by</span>(Spend) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1492-10" data-line-number="10"><span class="st">  </span><span class="kw">median_hdi</span>(slope) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1492-11" data-line-number="11"><span class="st">  </span></a>
<a class="sourceLine" id="cb1492-12" data-line-number="12"><span class="st">  </span><span class="co"># plot</span></a>
<a class="sourceLine" id="cb1492-13" data-line-number="13"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Spend, <span class="dt">y =</span> slope,</a>
<a class="sourceLine" id="cb1492-14" data-line-number="14">             <span class="dt">ymin =</span> .lower, <span class="dt">ymax =</span> .upper)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1492-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_pointrange</span>(<span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1492-16" data-line-number="16"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x     =</span> <span class="st">&quot;Value of spend&quot;</span>,</a>
<a class="sourceLine" id="cb1492-17" data-line-number="17">       <span class="dt">y     =</span> <span class="st">&quot;Slope on prcnt_take&quot;</span>,</a>
<a class="sourceLine" id="cb1492-18" data-line-number="18">       <span class="dt">title =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Slope on prcnt_take is &quot;</span>, beta[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span>beta[<span class="dv">3</span>] <span class="op">%.%</span><span class="st"> &quot;spend&quot;</span>)))</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-44-1.png" /><!-- --></p>
<p>Kruschke outlined all this in the opening paragraphs of page 530. His parting words of this subsection warrant repeating: “if you include an interaction term, you cannot ignore it even if its marginal posterior distribution includes zero” (p. 530).</p>
</div>
</div>
<div id="shrinkage-of-regression-coefficients" class="section level2">
<h2><span class="header-section-number">18.3</span> Shrinkage of regression coefficients</h2>
<blockquote>
<p>In some research, there are many candidate predictors which we suspect could possibly be informative about the predicted variable. For example, when predicting college GPA, we might include high-school GPA, high-school SAT score, income of student, income of parents, years of education of the parents, spending per pupil at the student’s high school, student IQ, student height, weight, shoe size, hours of sleep per night, distance from home to school, amount of caffeine consumed, hours spent studying, hours spent earning a wage, blood pressure, etc. We can include all the candidate predictors in the model, with a regression coefficient for every predictor. And this is not even considering interactions, which we will ignore for now.</p>
<p>With so many candidate predictors of noisy data, there may be some regression coefficients that are spuriously estimated to be non-zero. We would like some protection against accidentally nonzero regression coefficients. (p. 530)</p>
</blockquote>
<p>That’s what this section is all about. We’ll make our random noise predictors with <code>rnorm()</code>.</p>
<div class="sourceCode" id="cb1493"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1493-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">18</span>)</a>
<a class="sourceLine" id="cb1493-2" data-line-number="2">my_data &lt;-</a>
<a class="sourceLine" id="cb1493-3" data-line-number="3"><span class="st">  </span>my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1493-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x_rand_1  =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="kw">n</span>(), <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1493-5" data-line-number="5">         <span class="dt">x_rand_2  =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="kw">n</span>(), <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1493-6" data-line-number="6">         <span class="dt">x_rand_3  =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="kw">n</span>(), <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1493-7" data-line-number="7">         <span class="dt">x_rand_4  =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="kw">n</span>(), <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1493-8" data-line-number="8">         <span class="dt">x_rand_5  =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="kw">n</span>(), <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1493-9" data-line-number="9">         <span class="dt">x_rand_6  =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="kw">n</span>(), <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1493-10" data-line-number="10">         <span class="dt">x_rand_7  =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="kw">n</span>(), <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1493-11" data-line-number="11">         <span class="dt">x_rand_8  =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="kw">n</span>(), <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1493-12" data-line-number="12">         <span class="dt">x_rand_9  =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="kw">n</span>(), <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1493-13" data-line-number="13">         <span class="dt">x_rand_10 =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="kw">n</span>(), <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1493-14" data-line-number="14">         <span class="dt">x_rand_11 =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="kw">n</span>(), <span class="dv">0</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1493-15" data-line-number="15">         <span class="dt">x_rand_12 =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="kw">n</span>(), <span class="dv">0</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1493-16" data-line-number="16"></a>
<a class="sourceLine" id="cb1493-17" data-line-number="17"><span class="kw">glimpse</span>(my_data)</a></code></pre></div>
<pre><code>## Observations: 50
## Variables: 27
## $ State           &lt;chr&gt; &quot;Alabama&quot;, &quot;Alaska&quot;, &quot;Arizona&quot;, &quot;Arkansas&quot;, &quot;Cal…
## $ Spend           &lt;dbl&gt; 4.405, 8.963, 4.778, 4.459, 4.992, 5.443, 8.817,…
## $ StuTeaRat       &lt;dbl&gt; 17.2, 17.6, 19.3, 17.1, 24.0, 18.4, 14.4, 16.6, …
## $ Salary          &lt;dbl&gt; 31.144, 47.951, 32.175, 28.934, 41.078, 34.571, …
## $ PrcntTake       &lt;dbl&gt; 8, 47, 27, 6, 45, 29, 81, 68, 48, 65, 57, 15, 13…
## $ SATV            &lt;dbl&gt; 491, 445, 448, 482, 417, 462, 431, 429, 420, 406…
## $ SATM            &lt;dbl&gt; 538, 489, 496, 523, 485, 518, 477, 468, 469, 448…
## $ SATT            &lt;dbl&gt; 1029, 934, 944, 1005, 902, 980, 908, 897, 889, 8…
## $ prcnt_take_z    &lt;dbl&gt; -1.0178453, 0.4394222, -0.3078945, -1.0925770, 0…
## $ spend_z         &lt;dbl&gt; -1.10086058, 2.24370805, -0.82716069, -1.0612364…
## $ satt_z          &lt;dbl&gt; 0.8430838, -0.4266207, -0.2929676, 0.5223163, -0…
## $ prop_not_take   &lt;dbl&gt; 0.92, 0.53, 0.73, 0.94, 0.55, 0.71, 0.19, 0.32, …
## $ prop_not_take_z &lt;dbl&gt; 1.0178453, -0.4394222, 0.3078945, 1.0925770, -0.…
## $ interaction     &lt;dbl&gt; 35.240, 421.261, 129.006, 26.754, 224.640, 157.8…
## $ interaction_z   &lt;dbl&gt; -0.94113720, 0.93111798, -0.48635915, -0.9822954…
## $ x_rand_1        &lt;dbl&gt; 0.92645924, 1.82282117, -1.61056690, -0.28510975…
## $ x_rand_2        &lt;dbl&gt; -0.90258025, -1.13163679, 0.49708131, -0.5477187…
## $ x_rand_3        &lt;dbl&gt; 0.51576102, 0.30710965, 0.66199996, 2.21990655, …
## $ x_rand_4        &lt;dbl&gt; 1.08730491, -1.23909473, 0.43161390, 1.06733141,…
## $ x_rand_5        &lt;dbl&gt; -0.23846777, 0.15702031, -1.02132795, 0.75395217…
## $ x_rand_6        &lt;dbl&gt; 0.06014956, 1.00555800, 1.47981871, -0.82827890,…
## $ x_rand_7        &lt;dbl&gt; 1.46961709, 0.51790320, -2.33110353, 0.11339996,…
## $ x_rand_8        &lt;dbl&gt; 0.03463437, -1.48737599, -0.01528284, 0.48480309…
## $ x_rand_9        &lt;dbl&gt; -0.4556078, -0.7035475, -0.5001913, -0.6526022, …
## $ x_rand_10       &lt;dbl&gt; 1.2858586, -0.7474640, -0.3107255, -1.1037468, 0…
## $ x_rand_11       &lt;dbl&gt; 0.17236599, -0.37956084, 0.31982301, 0.29678108,…
## $ x_rand_12       &lt;dbl&gt; -0.53048519, 0.92465424, 0.66876661, 0.30935146,…</code></pre>
<p>Here’s the naïve model.</p>
<div class="sourceCode" id="cb1495"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1495-1" data-line-number="1">fit4 &lt;-</a>
<a class="sourceLine" id="cb1495-2" data-line-number="2"><span class="st">  </span><span class="kw">update</span>(fit1, </a>
<a class="sourceLine" id="cb1495-3" data-line-number="3">         <span class="dt">newdata =</span> my_data,</a>
<a class="sourceLine" id="cb1495-4" data-line-number="4">         <span class="dt">formula =</span> satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>prcnt_take_z <span class="op">+</span><span class="st"> </span>spend_z <span class="op">+</span><span class="st"> </span>x_rand_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x_rand_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>x_rand_<span class="dv">3</span> <span class="op">+</span><span class="st"> </span>x_rand_<span class="dv">4</span> <span class="op">+</span><span class="st"> </span>x_rand_<span class="dv">5</span> <span class="op">+</span><span class="st"> </span>x_rand_<span class="dv">6</span> <span class="op">+</span><span class="st"> </span>x_rand_<span class="dv">7</span> <span class="op">+</span><span class="st"> </span>x_rand_<span class="dv">8</span> <span class="op">+</span><span class="st"> </span>x_rand_<span class="dv">9</span> <span class="op">+</span><span class="st"> </span>x_rand_<span class="dv">10</span> <span class="op">+</span><span class="st"> </span>x_rand_<span class="dv">11</span> <span class="op">+</span><span class="st"> </span>x_rand_<span class="dv">12</span>,</a>
<a class="sourceLine" id="cb1495-5" data-line-number="5">         <span class="dt">seed =</span> <span class="dv">18</span>)</a></code></pre></div>
<p>Here we’ll examine the posterior with <code>posterior_summary()</code>.</p>
<div class="sourceCode" id="cb1496"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1496-1" data-line-number="1"><span class="kw">posterior_summary</span>(fit4) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1496-2" data-line-number="2"><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>##                Estimate Est.Error   Q2.5  Q97.5
## b_Intercept       -0.02      0.07  -0.16   0.10
## b_prcnt_take_z    -1.12      0.09  -1.28  -0.95
## b_spend_z          0.33      0.09   0.16   0.50
## b_x_rand_1         0.03      0.06  -0.08   0.15
## b_x_rand_2         0.02      0.09  -0.16   0.20
## b_x_rand_3         0.09      0.07  -0.06   0.22
## b_x_rand_4        -0.09      0.07  -0.22   0.05
## b_x_rand_5         0.01      0.06  -0.12   0.13
## b_x_rand_6        -0.02      0.08  -0.17   0.12
## b_x_rand_7        -0.03      0.07  -0.17   0.11
## b_x_rand_8        -0.18      0.07  -0.31  -0.04
## b_x_rand_9         0.13      0.06   0.02   0.25
## b_x_rand_10        0.00      0.05  -0.10   0.11
## b_x_rand_11        0.05      0.09  -0.13   0.22
## b_x_rand_12       -0.08      0.06  -0.21   0.04
## sigma              0.38      0.07   0.23   0.52
## nu                25.09     26.21   2.15  95.21
## lp__             -54.70      3.49 -62.56 -49.11</code></pre>
<p>Before we can make Figure 18.11, we’ll need to update our <code>make_beta_0()</code> function to accommodate this model.</p>
<div class="sourceCode" id="cb1498"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1498-1" data-line-number="1">make_beta_<span class="dv">0</span> &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1498-2" data-line-number="2"><span class="st">  </span><span class="cf">function</span>(zeta_<span class="dv">0</span>, zeta_<span class="dv">1</span>, zeta_<span class="dv">2</span>, zeta_<span class="dv">3</span>, zeta_<span class="dv">4</span>, zeta_<span class="dv">5</span>, zeta_<span class="dv">6</span>, zeta_<span class="dv">7</span>, zeta_<span class="dv">8</span>, zeta_<span class="dv">9</span>, zeta_<span class="dv">10</span>, zeta_<span class="dv">11</span>, zeta_<span class="dv">12</span>, zeta_<span class="dv">13</span>, zeta_<span class="dv">14</span>, </a>
<a class="sourceLine" id="cb1498-3" data-line-number="3">           sd_x_<span class="dv">1</span>, sd_x_<span class="dv">2</span>, sd_x_<span class="dv">3</span>, sd_x_<span class="dv">4</span>, sd_x_<span class="dv">5</span>, sd_x_<span class="dv">6</span>, sd_x_<span class="dv">7</span>, sd_x_<span class="dv">8</span>, sd_x_<span class="dv">9</span>, sd_x_<span class="dv">10</span>, sd_x_<span class="dv">11</span>, sd_x_<span class="dv">12</span>, sd_x_<span class="dv">13</span>, sd_x_<span class="dv">14</span>, sd_y, </a>
<a class="sourceLine" id="cb1498-4" data-line-number="4">           m_x_<span class="dv">1</span>, m_x_<span class="dv">2</span>, m_x_<span class="dv">3</span>, m_x_<span class="dv">4</span>, m_x_<span class="dv">5</span>, m_x_<span class="dv">6</span>, m_x_<span class="dv">7</span>, m_x_<span class="dv">8</span>, m_x_<span class="dv">9</span>, m_x_<span class="dv">10</span>, m_x_<span class="dv">11</span>, m_x_<span class="dv">12</span>, m_x_<span class="dv">13</span>, m_x_<span class="dv">14</span>, m_y) {</a>
<a class="sourceLine" id="cb1498-5" data-line-number="5">    sd_y <span class="op">*</span><span class="st"> </span>zeta_<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>m_y <span class="op">-</span><span class="st"> </span>sd_y <span class="op">*</span><span class="st"> </span>((zeta_<span class="dv">1</span> <span class="op">*</span><span class="st"> </span>m_x_<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>sd_x_<span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1498-6" data-line-number="6"><span class="st">                                    </span>(zeta_<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>m_x_<span class="dv">2</span> <span class="op">/</span><span class="st"> </span>sd_x_<span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1498-7" data-line-number="7"><span class="st">                                    </span>(zeta_<span class="dv">3</span> <span class="op">*</span><span class="st"> </span>m_x_<span class="dv">3</span> <span class="op">/</span><span class="st"> </span>sd_x_<span class="dv">3</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1498-8" data-line-number="8"><span class="st">                                    </span>(zeta_<span class="dv">4</span> <span class="op">*</span><span class="st"> </span>m_x_<span class="dv">4</span> <span class="op">/</span><span class="st"> </span>sd_x_<span class="dv">4</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1498-9" data-line-number="9"><span class="st">                                    </span>(zeta_<span class="dv">5</span> <span class="op">*</span><span class="st"> </span>m_x_<span class="dv">5</span> <span class="op">/</span><span class="st"> </span>sd_x_<span class="dv">5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1498-10" data-line-number="10"><span class="st">                                    </span>(zeta_<span class="dv">6</span> <span class="op">*</span><span class="st"> </span>m_x_<span class="dv">6</span> <span class="op">/</span><span class="st"> </span>sd_x_<span class="dv">6</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1498-11" data-line-number="11"><span class="st">                                    </span>(zeta_<span class="dv">7</span> <span class="op">*</span><span class="st"> </span>m_x_<span class="dv">7</span> <span class="op">/</span><span class="st"> </span>sd_x_<span class="dv">7</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1498-12" data-line-number="12"><span class="st">                                    </span>(zeta_<span class="dv">8</span> <span class="op">*</span><span class="st"> </span>m_x_<span class="dv">8</span> <span class="op">/</span><span class="st"> </span>sd_x_<span class="dv">8</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1498-13" data-line-number="13"><span class="st">                                    </span>(zeta_<span class="dv">9</span> <span class="op">*</span><span class="st"> </span>m_x_<span class="dv">9</span> <span class="op">/</span><span class="st"> </span>sd_x_<span class="dv">9</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1498-14" data-line-number="14"><span class="st">                                    </span>(zeta_<span class="dv">10</span> <span class="op">*</span><span class="st"> </span>m_x_<span class="dv">10</span> <span class="op">/</span><span class="st"> </span>sd_x_<span class="dv">10</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1498-15" data-line-number="15"><span class="st">                                    </span>(zeta_<span class="dv">11</span> <span class="op">*</span><span class="st"> </span>m_x_<span class="dv">11</span> <span class="op">/</span><span class="st"> </span>sd_x_<span class="dv">11</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1498-16" data-line-number="16"><span class="st">                                    </span>(zeta_<span class="dv">12</span> <span class="op">*</span><span class="st"> </span>m_x_<span class="dv">12</span> <span class="op">/</span><span class="st"> </span>sd_x_<span class="dv">12</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1498-17" data-line-number="17"><span class="st">                                    </span>(zeta_<span class="dv">13</span> <span class="op">*</span><span class="st"> </span>m_x_<span class="dv">13</span> <span class="op">/</span><span class="st"> </span>sd_x_<span class="dv">13</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1498-18" data-line-number="18"><span class="st">                                    </span>(zeta_<span class="dv">14</span> <span class="op">*</span><span class="st"> </span>m_x_<span class="dv">14</span> <span class="op">/</span><span class="st"> </span>sd_x_<span class="dv">14</span>))</a>
<a class="sourceLine" id="cb1498-19" data-line-number="19">  }</a></code></pre></div>
<p>Sigh, our poor <code>make_beta_0()</code> and <code>make_beta_1()</code> code is getting obscene. I don’t have the energy to think of how to wrap this into a simpler function. But someone probably should. If that ends up as you, <a href="https://github.com/ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse/issues">do share your code</a>.</p>
<div class="sourceCode" id="cb1499"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1499-1" data-line-number="1">sd_x_<span class="dv">1</span>  &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>Spend)</a>
<a class="sourceLine" id="cb1499-2" data-line-number="2">sd_x_<span class="dv">2</span>  &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>PrcntTake)</a>
<a class="sourceLine" id="cb1499-3" data-line-number="3">sd_x_<span class="dv">3</span>  &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>x_rand_<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1499-4" data-line-number="4">sd_x_<span class="dv">4</span>  &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>x_rand_<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1499-5" data-line-number="5">sd_x_<span class="dv">5</span>  &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>x_rand_<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1499-6" data-line-number="6">sd_x_<span class="dv">6</span>  &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>x_rand_<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb1499-7" data-line-number="7">sd_x_<span class="dv">7</span>  &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>x_rand_<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb1499-8" data-line-number="8">sd_x_<span class="dv">8</span>  &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>x_rand_<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb1499-9" data-line-number="9">sd_x_<span class="dv">9</span>  &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>x_rand_<span class="dv">7</span>)</a>
<a class="sourceLine" id="cb1499-10" data-line-number="10">sd_x_<span class="dv">10</span> &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>x_rand_<span class="dv">8</span>)</a>
<a class="sourceLine" id="cb1499-11" data-line-number="11">sd_x_<span class="dv">11</span> &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>x_rand_<span class="dv">9</span>)</a>
<a class="sourceLine" id="cb1499-12" data-line-number="12">sd_x_<span class="dv">12</span> &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>x_rand_<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb1499-13" data-line-number="13">sd_x_<span class="dv">13</span> &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>x_rand_<span class="dv">11</span>)</a>
<a class="sourceLine" id="cb1499-14" data-line-number="14">sd_x_<span class="dv">14</span> &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>x_rand_<span class="dv">12</span>)</a>
<a class="sourceLine" id="cb1499-15" data-line-number="15">sd_y    &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>SATT)</a>
<a class="sourceLine" id="cb1499-16" data-line-number="16"></a>
<a class="sourceLine" id="cb1499-17" data-line-number="17">m_x_<span class="dv">1</span>  &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>Spend)</a>
<a class="sourceLine" id="cb1499-18" data-line-number="18">m_x_<span class="dv">2</span>  &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>PrcntTake)</a>
<a class="sourceLine" id="cb1499-19" data-line-number="19">m_x_<span class="dv">3</span>  &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>x_rand_<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1499-20" data-line-number="20">m_x_<span class="dv">4</span>  &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>x_rand_<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1499-21" data-line-number="21">m_x_<span class="dv">5</span>  &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>x_rand_<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1499-22" data-line-number="22">m_x_<span class="dv">6</span>  &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>x_rand_<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb1499-23" data-line-number="23">m_x_<span class="dv">7</span>  &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>x_rand_<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb1499-24" data-line-number="24">m_x_<span class="dv">8</span>  &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>x_rand_<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb1499-25" data-line-number="25">m_x_<span class="dv">9</span>  &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>x_rand_<span class="dv">7</span>)</a>
<a class="sourceLine" id="cb1499-26" data-line-number="26">m_x_<span class="dv">10</span> &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>x_rand_<span class="dv">8</span>)</a>
<a class="sourceLine" id="cb1499-27" data-line-number="27">m_x_<span class="dv">11</span> &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>x_rand_<span class="dv">9</span>)</a>
<a class="sourceLine" id="cb1499-28" data-line-number="28">m_x_<span class="dv">12</span> &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>x_rand_<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb1499-29" data-line-number="29">m_x_<span class="dv">13</span> &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>x_rand_<span class="dv">11</span>)</a>
<a class="sourceLine" id="cb1499-30" data-line-number="30">m_x_<span class="dv">14</span> &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>x_rand_<span class="dv">12</span>)</a>
<a class="sourceLine" id="cb1499-31" data-line-number="31">m_y    &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>SATT)</a>
<a class="sourceLine" id="cb1499-32" data-line-number="32"></a>
<a class="sourceLine" id="cb1499-33" data-line-number="33">post &lt;-</a>
<a class="sourceLine" id="cb1499-34" data-line-number="34"><span class="st">  </span><span class="kw">posterior_samples</span>(fit4) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1499-35" data-line-number="35"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">Intercept      =</span> <span class="kw">make_beta_0</span>(<span class="dt">zeta_0 =</span> b_Intercept,</a>
<a class="sourceLine" id="cb1499-36" data-line-number="36">                                         <span class="dt">zeta_1  =</span> b_spend_z,</a>
<a class="sourceLine" id="cb1499-37" data-line-number="37">                                         <span class="dt">zeta_2  =</span> b_prcnt_take_z,</a>
<a class="sourceLine" id="cb1499-38" data-line-number="38">                                         <span class="dt">zeta_3  =</span> b_x_rand_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1499-39" data-line-number="39">                                         <span class="dt">zeta_4  =</span> b_x_rand_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1499-40" data-line-number="40">                                         <span class="dt">zeta_5  =</span> b_x_rand_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1499-41" data-line-number="41">                                         <span class="dt">zeta_6  =</span> b_x_rand_<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1499-42" data-line-number="42">                                         <span class="dt">zeta_7  =</span> b_x_rand_<span class="dv">5</span>,</a>
<a class="sourceLine" id="cb1499-43" data-line-number="43">                                         <span class="dt">zeta_8  =</span> b_x_rand_<span class="dv">6</span>,</a>
<a class="sourceLine" id="cb1499-44" data-line-number="44">                                         <span class="dt">zeta_9  =</span> b_x_rand_<span class="dv">7</span>,</a>
<a class="sourceLine" id="cb1499-45" data-line-number="45">                                         <span class="dt">zeta_10 =</span> b_x_rand_<span class="dv">8</span>,</a>
<a class="sourceLine" id="cb1499-46" data-line-number="46">                                         <span class="dt">zeta_11 =</span> b_x_rand_<span class="dv">9</span>,</a>
<a class="sourceLine" id="cb1499-47" data-line-number="47">                                         <span class="dt">zeta_12 =</span> b_x_rand_<span class="dv">10</span>,</a>
<a class="sourceLine" id="cb1499-48" data-line-number="48">                                         <span class="dt">zeta_13 =</span> b_x_rand_<span class="dv">11</span>,</a>
<a class="sourceLine" id="cb1499-49" data-line-number="49">                                         <span class="dt">zeta_14 =</span> b_x_rand_<span class="dv">12</span>,</a>
<a class="sourceLine" id="cb1499-50" data-line-number="50">                                         <span class="dt">sd_x_1  =</span> sd_x_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1499-51" data-line-number="51">                                         <span class="dt">sd_x_2  =</span> sd_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1499-52" data-line-number="52">                                         <span class="dt">sd_x_3  =</span> sd_x_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1499-53" data-line-number="53">                                         <span class="dt">sd_x_4  =</span> sd_x_<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1499-54" data-line-number="54">                                         <span class="dt">sd_x_5  =</span> sd_x_<span class="dv">5</span>,</a>
<a class="sourceLine" id="cb1499-55" data-line-number="55">                                         <span class="dt">sd_x_6  =</span> sd_x_<span class="dv">6</span>,</a>
<a class="sourceLine" id="cb1499-56" data-line-number="56">                                         <span class="dt">sd_x_7  =</span> sd_x_<span class="dv">7</span>,</a>
<a class="sourceLine" id="cb1499-57" data-line-number="57">                                         <span class="dt">sd_x_8  =</span> sd_x_<span class="dv">8</span>,</a>
<a class="sourceLine" id="cb1499-58" data-line-number="58">                                         <span class="dt">sd_x_9  =</span> sd_x_<span class="dv">9</span>,</a>
<a class="sourceLine" id="cb1499-59" data-line-number="59">                                         <span class="dt">sd_x_10 =</span> sd_x_<span class="dv">10</span>,</a>
<a class="sourceLine" id="cb1499-60" data-line-number="60">                                         <span class="dt">sd_x_11 =</span> sd_x_<span class="dv">11</span>,</a>
<a class="sourceLine" id="cb1499-61" data-line-number="61">                                         <span class="dt">sd_x_12 =</span> sd_x_<span class="dv">12</span>,</a>
<a class="sourceLine" id="cb1499-62" data-line-number="62">                                         <span class="dt">sd_x_13 =</span> sd_x_<span class="dv">13</span>,</a>
<a class="sourceLine" id="cb1499-63" data-line-number="63">                                         <span class="dt">sd_x_14 =</span> sd_x_<span class="dv">14</span>,</a>
<a class="sourceLine" id="cb1499-64" data-line-number="64">                                         <span class="dt">sd_y    =</span> sd_y,</a>
<a class="sourceLine" id="cb1499-65" data-line-number="65">                                         <span class="dt">m_x_1   =</span> m_x_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1499-66" data-line-number="66">                                         <span class="dt">m_x_2   =</span> m_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1499-67" data-line-number="67">                                         <span class="dt">m_x_3   =</span> m_x_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1499-68" data-line-number="68">                                         <span class="dt">m_x_4   =</span> m_x_<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1499-69" data-line-number="69">                                         <span class="dt">m_x_5   =</span> m_x_<span class="dv">5</span>,</a>
<a class="sourceLine" id="cb1499-70" data-line-number="70">                                         <span class="dt">m_x_6   =</span> m_x_<span class="dv">6</span>,</a>
<a class="sourceLine" id="cb1499-71" data-line-number="71">                                         <span class="dt">m_x_7   =</span> m_x_<span class="dv">7</span>,</a>
<a class="sourceLine" id="cb1499-72" data-line-number="72">                                         <span class="dt">m_x_8   =</span> m_x_<span class="dv">8</span>,</a>
<a class="sourceLine" id="cb1499-73" data-line-number="73">                                         <span class="dt">m_x_9   =</span> m_x_<span class="dv">9</span>,</a>
<a class="sourceLine" id="cb1499-74" data-line-number="74">                                         <span class="dt">m_x_10  =</span> m_x_<span class="dv">10</span>,</a>
<a class="sourceLine" id="cb1499-75" data-line-number="75">                                         <span class="dt">m_x_11  =</span> m_x_<span class="dv">11</span>,</a>
<a class="sourceLine" id="cb1499-76" data-line-number="76">                                         <span class="dt">m_x_12  =</span> m_x_<span class="dv">12</span>,</a>
<a class="sourceLine" id="cb1499-77" data-line-number="77">                                         <span class="dt">m_x_13  =</span> m_x_<span class="dv">13</span>,</a>
<a class="sourceLine" id="cb1499-78" data-line-number="78">                                         <span class="dt">m_x_14  =</span> m_x_<span class="dv">14</span>,</a>
<a class="sourceLine" id="cb1499-79" data-line-number="79">                                         <span class="dt">m_y     =</span> m_y),</a>
<a class="sourceLine" id="cb1499-80" data-line-number="80">            <span class="dt">Spend          =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_spend_z,</a>
<a class="sourceLine" id="cb1499-81" data-line-number="81">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1499-82" data-line-number="82">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1499-83" data-line-number="83">            <span class="st">`</span><span class="dt">Percent Take</span><span class="st">`</span> =<span class="st"> </span><span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_prcnt_take_z,</a>
<a class="sourceLine" id="cb1499-84" data-line-number="84">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1499-85" data-line-number="85">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1499-86" data-line-number="86">            <span class="dt">x_rand_1       =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_x_rand_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1499-87" data-line-number="87">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1499-88" data-line-number="88">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1499-89" data-line-number="89">            <span class="dt">x_rand_2       =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_x_rand_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1499-90" data-line-number="90">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1499-91" data-line-number="91">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1499-92" data-line-number="92">            <span class="dt">x_rand_3       =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_x_rand_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1499-93" data-line-number="93">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">5</span>,</a>
<a class="sourceLine" id="cb1499-94" data-line-number="94">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1499-95" data-line-number="95">            <span class="dt">x_rand_4       =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_x_rand_<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1499-96" data-line-number="96">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">6</span>,</a>
<a class="sourceLine" id="cb1499-97" data-line-number="97">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1499-98" data-line-number="98">            <span class="dt">x_rand_5       =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_x_rand_<span class="dv">5</span>,</a>
<a class="sourceLine" id="cb1499-99" data-line-number="99">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">7</span>,</a>
<a class="sourceLine" id="cb1499-100" data-line-number="100">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1499-101" data-line-number="101">            <span class="dt">x_rand_6       =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_x_rand_<span class="dv">6</span>,</a>
<a class="sourceLine" id="cb1499-102" data-line-number="102">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">8</span>,</a>
<a class="sourceLine" id="cb1499-103" data-line-number="103">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1499-104" data-line-number="104">            <span class="dt">x_rand_7       =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_x_rand_<span class="dv">7</span>,</a>
<a class="sourceLine" id="cb1499-105" data-line-number="105">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">9</span>,</a>
<a class="sourceLine" id="cb1499-106" data-line-number="106">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1499-107" data-line-number="107">            <span class="dt">x_rand_8       =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_x_rand_<span class="dv">8</span>,</a>
<a class="sourceLine" id="cb1499-108" data-line-number="108">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">10</span>,</a>
<a class="sourceLine" id="cb1499-109" data-line-number="109">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1499-110" data-line-number="110">            <span class="dt">x_rand_9       =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_x_rand_<span class="dv">9</span>,</a>
<a class="sourceLine" id="cb1499-111" data-line-number="111">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">11</span>,</a>
<a class="sourceLine" id="cb1499-112" data-line-number="112">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1499-113" data-line-number="113">            <span class="dt">x_rand_10      =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_x_rand_<span class="dv">10</span>,</a>
<a class="sourceLine" id="cb1499-114" data-line-number="114">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">12</span>,</a>
<a class="sourceLine" id="cb1499-115" data-line-number="115">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1499-116" data-line-number="116">            <span class="dt">x_rand_11      =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_x_rand_<span class="dv">11</span>,</a>
<a class="sourceLine" id="cb1499-117" data-line-number="117">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">13</span>,</a>
<a class="sourceLine" id="cb1499-118" data-line-number="118">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1499-119" data-line-number="119">            <span class="dt">x_rand_12      =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_x_rand_<span class="dv">12</span>,</a>
<a class="sourceLine" id="cb1499-120" data-line-number="120">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">14</span>,</a>
<a class="sourceLine" id="cb1499-121" data-line-number="121">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1499-122" data-line-number="122">            <span class="dt">Scale          =</span> sigma <span class="op">*</span><span class="st"> </span>sd_y,</a>
<a class="sourceLine" id="cb1499-123" data-line-number="123">            <span class="dt">Normality      =</span> nu <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">log10</span>())</a>
<a class="sourceLine" id="cb1499-124" data-line-number="124"></a>
<a class="sourceLine" id="cb1499-125" data-line-number="125"><span class="kw">glimpse</span>(post)</a></code></pre></div>
<pre><code>## Observations: 4,000
## Variables: 17
## $ Intercept      &lt;dbl&gt; 978.2629, 954.1022, 936.3345, 927.7583, 964.4377,…
## $ Spend          &lt;dbl&gt; 16.23816, 21.85959, 26.38032, 26.63065, 18.40972,…
## $ `Percent Take` &lt;dbl&gt; -3.123617, -3.470104, -3.496485, -3.622503, -3.31…
## $ x_rand_1       &lt;dbl&gt; 0.37557071, 0.47578746, 2.01992361, -2.49333200, …
## $ x_rand_2       &lt;dbl&gt; -2.747509054, -0.637063446, 3.112304494, -4.64025…
## $ x_rand_3       &lt;dbl&gt; 8.9258844, 1.5485414, 3.0112088, 0.4144604, 11.01…
## $ x_rand_4       &lt;dbl&gt; -8.1747088, -9.1809834, -13.4576786, -14.0589291,…
## $ x_rand_5       &lt;dbl&gt; -0.5797268, 0.1277984, 0.6989087, -2.2552537, -0.…
## $ x_rand_6       &lt;dbl&gt; -6.499016480, 2.006864887, 2.694773713, 0.7167073…
## $ x_rand_7       &lt;dbl&gt; -7.4236507, 2.4005544, 0.5063171, 0.9188742, 10.2…
## $ x_rand_8       &lt;dbl&gt; -11.9493748, -12.7780330, -12.2361496, -16.807961…
## $ x_rand_9       &lt;dbl&gt; 4.132977, 11.727639, 12.163225, 6.259811, 13.0476…
## $ x_rand_10      &lt;dbl&gt; 0.19896636, 4.15941187, 4.02509269, 1.58380409, -…
## $ x_rand_11      &lt;dbl&gt; 9.3111126, -4.5582639, -8.9587840, -9.6417867, -4…
## $ x_rand_12      &lt;dbl&gt; -8.3675915, -2.5825711, -3.9334521, -3.8179492, -…
## $ Scale          &lt;dbl&gt; 26.16620, 19.98710, 20.51592, 26.75018, 32.71402,…
## $ Normality      &lt;dbl&gt; 0.7053100, 0.7184234, 0.9159173, 0.4871434, 1.752…</code></pre>
<p>Okay, here are the histograms of Figure 18.11.</p>
<div class="sourceCode" id="cb1501"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1501-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1501-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(Intercept<span class="op">:</span>x_rand_<span class="dv">3</span>, x_rand_<span class="dv">10</span><span class="op">:</span>Normality) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1501-3" data-line-number="3"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1501-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">key =</span> <span class="kw">factor</span>(key, </a>
<a class="sourceLine" id="cb1501-5" data-line-number="5">                      <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;Spend&quot;</span>, <span class="st">&quot;Percent Take&quot;</span>,</a>
<a class="sourceLine" id="cb1501-6" data-line-number="6">                                 <span class="st">&quot;x_rand_1&quot;</span>, <span class="st">&quot;x_rand_2&quot;</span>, <span class="st">&quot;x_rand_3&quot;</span>,</a>
<a class="sourceLine" id="cb1501-7" data-line-number="7">                                 <span class="st">&quot;x_rand_10&quot;</span>, <span class="st">&quot;x_rand_11&quot;</span>, <span class="st">&quot;x_rand_12&quot;</span>,</a>
<a class="sourceLine" id="cb1501-8" data-line-number="8">                                 <span class="st">&quot;Scale&quot;</span>, <span class="st">&quot;Normality&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1501-9" data-line-number="9"><span class="st">  </span></a>
<a class="sourceLine" id="cb1501-10" data-line-number="10"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1501-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>,</a>
<a class="sourceLine" id="cb1501-12" data-line-number="12">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">bins =</span> <span class="dv">40</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1501-13" data-line-number="13"><span class="st">  </span><span class="kw">stat_pointintervalh</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb1501-14" data-line-number="14">                      <span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1501-15" data-line-number="15"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1501-16" data-line-number="16"><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1501-17" data-line-number="17"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-49-1.png" /><!-- --></p>
<p>And here’s the final histogram depicting the Bayesian <span class="math inline">\(R^2\)</span>.</p>
<div class="sourceCode" id="cb1502"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1502-1" data-line-number="1"><span class="kw">bayes_R2</span>(fit4, <span class="dt">summary =</span> F) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1502-2" data-line-number="2"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1502-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb1502-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> R2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1502-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>,</a>
<a class="sourceLine" id="cb1502-6" data-line-number="6">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">bins =</span> <span class="dv">25</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1502-7" data-line-number="7"><span class="st">  </span><span class="kw">stat_pointintervalh</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb1502-8" data-line-number="8">                      <span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1502-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1502-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Bayesian &quot;</span>, <span class="kw">italic</span>(R)<span class="op">^</span><span class="dv">2</span>)),</a>
<a class="sourceLine" id="cb1502-11" data-line-number="11">       <span class="dt">x =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1502-12" data-line-number="12"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(.<span class="dv">6</span>, <span class="dv">1</span>))</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-50-1.png" /><!-- --></p>
<p>Note that unlike the one Kruschke displayed in the text, our <code>brms::bayes_R2()</code>-based <span class="math inline">\(R^2\)</span> distribution did not exceed the logical right bound of 1.</p>
<p>Sometimes when you have this many parameters you’d like to compare, it’s better to display their summaries with an ordered coefficient plot.</p>
<div class="sourceCode" id="cb1503"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1503-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1503-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(Spend<span class="op">:</span>x_rand_<span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1503-3" data-line-number="3"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1503-4" data-line-number="4"><span class="st">  </span></a>
<a class="sourceLine" id="cb1503-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="kw">reorder</span>(key, value))) <span class="op">+</span></a>
<a class="sourceLine" id="cb1503-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1503-7" data-line-number="7"><span class="st">  </span><span class="kw">stat_pointintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>, <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1503-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb1503-9" data-line-number="9">       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1503-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.y  =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1503-11" data-line-number="11">        <span class="dt">axis.ticks.y =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb1503-12" data-line-number="12">        <span class="dt">panel.grid.major.y =</span> <span class="kw">element_line</span>(<span class="dt">color =</span> <span class="st">&quot;grey98&quot;</span>, <span class="dt">linetype =</span> <span class="dv">2</span>))</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-51-1.png" /><!-- --></p>
<p>Now we can see that by chance alone, the coefficients for <code>x_rand_8</code> and <code>x_rand_9</code> are clearly distinct from zero. The <code>geom_density_ridges()</code> function from the <a href="https://github.com/clauswilke/ggridges"><strong>ggridges</strong> package</a> can be informative, too.</p>
<div class="sourceCode" id="cb1504"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1504-1" data-line-number="1"><span class="kw">library</span>(ggridges)</a>
<a class="sourceLine" id="cb1504-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1504-3" data-line-number="3">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1504-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(Spend<span class="op">:</span>x_rand_<span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1504-5" data-line-number="5"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1504-6" data-line-number="6"><span class="st">  </span></a>
<a class="sourceLine" id="cb1504-7" data-line-number="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="kw">reorder</span>(key, value), <span class="dt">group =</span> <span class="kw">reorder</span>(key, value))) <span class="op">+</span></a>
<a class="sourceLine" id="cb1504-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1504-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_density_ridges</span>(<span class="dt">scale =</span> <span class="dv">4</span>, <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>, <span class="dt">alpha =</span> <span class="dv">3</span><span class="op">/</span><span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1504-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb1504-11" data-line-number="11">       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1504-12" data-line-number="12"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.y  =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1504-13" data-line-number="13">        <span class="dt">axis.ticks.y =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-52-1.png" /><!-- --></p>
<p>With <strong>brms</strong>, we can fit something like the model Kruschke displayed in Figure 18.12 with the <code>horseshoe()</code> prior. From the <code>horseshoe</code> section of the <a href="https://cran.r-project.org/web/packages/brms/brms.pdf"><strong>brms</strong> (version 2.10.3) reference manual</a>:</p>
<blockquote>
<p>The horseshoe prior is a special shrinkage prior initially proposed by <a href="http://proceedings.mlr.press/v5/carvalho09a/carvalho09a.pdf">Carvalho et al. (2009)</a>. It is symmetric around zero with fat tails and an infinitely large spike at zero. This makes it ideal for sparse models that have many regression coefficients, although only a minority of them is non-zero. The horseshoe prior can be applied on all population-level effects at once (excluding the intercept) by using <code>set_prior(&quot;horseshoe(1)&quot;)</code>. The <code>1</code> implies that the student-t prior of the local shrinkage parameters has 1 degrees of freedom.</p>
</blockquote>
<p>Based on the quote, here’s how to fit our horseshoe-prior model.</p>
<div class="sourceCode" id="cb1505"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1505-1" data-line-number="1">fit5 &lt;-</a>
<a class="sourceLine" id="cb1505-2" data-line-number="2"><span class="st">  </span><span class="kw">update</span>(fit4, </a>
<a class="sourceLine" id="cb1505-3" data-line-number="3">         <span class="dt">newdata =</span> my_data,</a>
<a class="sourceLine" id="cb1505-4" data-line-number="4">         <span class="dt">formula =</span> satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>prcnt_take_z <span class="op">+</span><span class="st"> </span>spend_z <span class="op">+</span><span class="st"> </span>x_rand_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x_rand_<span class="dv">2</span> <span class="op">+</span><span class="st"> </span>x_rand_<span class="dv">3</span> <span class="op">+</span><span class="st"> </span>x_rand_<span class="dv">4</span> <span class="op">+</span><span class="st"> </span>x_rand_<span class="dv">5</span> <span class="op">+</span><span class="st"> </span>x_rand_<span class="dv">6</span> <span class="op">+</span><span class="st"> </span>x_rand_<span class="dv">7</span> <span class="op">+</span><span class="st"> </span>x_rand_<span class="dv">8</span> <span class="op">+</span><span class="st"> </span>x_rand_<span class="dv">9</span> <span class="op">+</span><span class="st"> </span>x_rand_<span class="dv">10</span> <span class="op">+</span><span class="st"> </span>x_rand_<span class="dv">11</span> <span class="op">+</span><span class="st"> </span>x_rand_<span class="dv">12</span>,</a>
<a class="sourceLine" id="cb1505-5" data-line-number="5">         <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1505-6" data-line-number="6">                   <span class="kw">prior</span>(<span class="kw">horseshoe</span>(<span class="dv">1</span>), <span class="dt">class =</span> b),</a>
<a class="sourceLine" id="cb1505-7" data-line-number="7">                   <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">class =</span> sigma),</a>
<a class="sourceLine" id="cb1505-8" data-line-number="8">                   <span class="kw">prior</span>(<span class="kw">exponential</span>(one_over_twentynine), <span class="dt">class =</span> nu)),</a>
<a class="sourceLine" id="cb1505-9" data-line-number="9">         <span class="dt">seed =</span> <span class="dv">18</span>)</a></code></pre></div>
<p>Check the parameter summary.</p>
<div class="sourceCode" id="cb1506"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1506-1" data-line-number="1"><span class="kw">posterior_summary</span>(fit5) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1506-2" data-line-number="2"><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>##                Estimate Est.Error    Q2.5  Q97.5
## b_Intercept       -0.02      0.06   -0.14   0.11
## b_prcnt_take_z    -1.02      0.10   -1.20  -0.82
## b_spend_z          0.20      0.11    0.00   0.39
## b_x_rand_1         0.02      0.04   -0.05   0.10
## b_x_rand_2         0.01      0.04   -0.08   0.11
## b_x_rand_3         0.02      0.04   -0.06   0.12
## b_x_rand_4        -0.03      0.05   -0.14   0.04
## b_x_rand_5         0.00      0.04   -0.07   0.09
## b_x_rand_6        -0.02      0.04   -0.13   0.05
## b_x_rand_7        -0.01      0.04   -0.09   0.07
## b_x_rand_8        -0.09      0.07   -0.24   0.02
## b_x_rand_9         0.05      0.05   -0.02   0.17
## b_x_rand_10        0.00      0.03   -0.06   0.07
## b_x_rand_11        0.01      0.04   -0.07   0.12
## b_x_rand_12       -0.02      0.04   -0.12   0.05
## sigma              0.40      0.06    0.27   0.52
## nu                30.80     28.89    2.86 108.14
## lp__            -105.49      6.71 -119.76 -93.33
## hs_c2              1.89      3.56    0.35   7.79</code></pre>
<p>Our <code>make_beta_0()</code> and <code>make_beta_1()</code> code remains obscene.</p>
<div class="sourceCode" id="cb1508"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1508-1" data-line-number="1">post &lt;-</a>
<a class="sourceLine" id="cb1508-2" data-line-number="2"><span class="st">  </span><span class="kw">posterior_samples</span>(fit5) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1508-3" data-line-number="3"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">Intercept      =</span> <span class="kw">make_beta_0</span>(<span class="dt">zeta_0  =</span> b_Intercept,</a>
<a class="sourceLine" id="cb1508-4" data-line-number="4">                                         <span class="dt">zeta_1  =</span> b_spend_z,</a>
<a class="sourceLine" id="cb1508-5" data-line-number="5">                                         <span class="dt">zeta_2  =</span> b_prcnt_take_z,</a>
<a class="sourceLine" id="cb1508-6" data-line-number="6">                                         <span class="dt">zeta_3  =</span> b_x_rand_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1508-7" data-line-number="7">                                         <span class="dt">zeta_4  =</span> b_x_rand_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1508-8" data-line-number="8">                                         <span class="dt">zeta_5  =</span> b_x_rand_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1508-9" data-line-number="9">                                         <span class="dt">zeta_6  =</span> b_x_rand_<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1508-10" data-line-number="10">                                         <span class="dt">zeta_7  =</span> b_x_rand_<span class="dv">5</span>,</a>
<a class="sourceLine" id="cb1508-11" data-line-number="11">                                         <span class="dt">zeta_8  =</span> b_x_rand_<span class="dv">6</span>,</a>
<a class="sourceLine" id="cb1508-12" data-line-number="12">                                         <span class="dt">zeta_9  =</span> b_x_rand_<span class="dv">7</span>,</a>
<a class="sourceLine" id="cb1508-13" data-line-number="13">                                         <span class="dt">zeta_10 =</span> b_x_rand_<span class="dv">8</span>,</a>
<a class="sourceLine" id="cb1508-14" data-line-number="14">                                         <span class="dt">zeta_11 =</span> b_x_rand_<span class="dv">9</span>,</a>
<a class="sourceLine" id="cb1508-15" data-line-number="15">                                         <span class="dt">zeta_12 =</span> b_x_rand_<span class="dv">10</span>,</a>
<a class="sourceLine" id="cb1508-16" data-line-number="16">                                         <span class="dt">zeta_13 =</span> b_x_rand_<span class="dv">11</span>,</a>
<a class="sourceLine" id="cb1508-17" data-line-number="17">                                         <span class="dt">zeta_14 =</span> b_x_rand_<span class="dv">12</span>,</a>
<a class="sourceLine" id="cb1508-18" data-line-number="18">                                         <span class="dt">sd_x_1  =</span> sd_x_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1508-19" data-line-number="19">                                         <span class="dt">sd_x_2  =</span> sd_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1508-20" data-line-number="20">                                         <span class="dt">sd_x_3  =</span> sd_x_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1508-21" data-line-number="21">                                         <span class="dt">sd_x_4  =</span> sd_x_<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1508-22" data-line-number="22">                                         <span class="dt">sd_x_5  =</span> sd_x_<span class="dv">5</span>,</a>
<a class="sourceLine" id="cb1508-23" data-line-number="23">                                         <span class="dt">sd_x_6  =</span> sd_x_<span class="dv">6</span>,</a>
<a class="sourceLine" id="cb1508-24" data-line-number="24">                                         <span class="dt">sd_x_7  =</span> sd_x_<span class="dv">7</span>,</a>
<a class="sourceLine" id="cb1508-25" data-line-number="25">                                         <span class="dt">sd_x_8  =</span> sd_x_<span class="dv">8</span>,</a>
<a class="sourceLine" id="cb1508-26" data-line-number="26">                                         <span class="dt">sd_x_9  =</span> sd_x_<span class="dv">9</span>,</a>
<a class="sourceLine" id="cb1508-27" data-line-number="27">                                         <span class="dt">sd_x_10 =</span> sd_x_<span class="dv">10</span>,</a>
<a class="sourceLine" id="cb1508-28" data-line-number="28">                                         <span class="dt">sd_x_11 =</span> sd_x_<span class="dv">11</span>,</a>
<a class="sourceLine" id="cb1508-29" data-line-number="29">                                         <span class="dt">sd_x_12 =</span> sd_x_<span class="dv">12</span>,</a>
<a class="sourceLine" id="cb1508-30" data-line-number="30">                                         <span class="dt">sd_x_13 =</span> sd_x_<span class="dv">13</span>,</a>
<a class="sourceLine" id="cb1508-31" data-line-number="31">                                         <span class="dt">sd_x_14 =</span> sd_x_<span class="dv">14</span>,</a>
<a class="sourceLine" id="cb1508-32" data-line-number="32">                                         <span class="dt">sd_y    =</span> sd_y,</a>
<a class="sourceLine" id="cb1508-33" data-line-number="33">                                         <span class="dt">m_x_1   =</span> m_x_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1508-34" data-line-number="34">                                         <span class="dt">m_x_2   =</span> m_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1508-35" data-line-number="35">                                         <span class="dt">m_x_3   =</span> m_x_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1508-36" data-line-number="36">                                         <span class="dt">m_x_4   =</span> m_x_<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1508-37" data-line-number="37">                                         <span class="dt">m_x_5   =</span> m_x_<span class="dv">5</span>,</a>
<a class="sourceLine" id="cb1508-38" data-line-number="38">                                         <span class="dt">m_x_6   =</span> m_x_<span class="dv">6</span>,</a>
<a class="sourceLine" id="cb1508-39" data-line-number="39">                                         <span class="dt">m_x_7   =</span> m_x_<span class="dv">7</span>,</a>
<a class="sourceLine" id="cb1508-40" data-line-number="40">                                         <span class="dt">m_x_8   =</span> m_x_<span class="dv">8</span>,</a>
<a class="sourceLine" id="cb1508-41" data-line-number="41">                                         <span class="dt">m_x_9   =</span> m_x_<span class="dv">9</span>,</a>
<a class="sourceLine" id="cb1508-42" data-line-number="42">                                         <span class="dt">m_x_10  =</span> m_x_<span class="dv">10</span>,</a>
<a class="sourceLine" id="cb1508-43" data-line-number="43">                                         <span class="dt">m_x_11  =</span> m_x_<span class="dv">11</span>,</a>
<a class="sourceLine" id="cb1508-44" data-line-number="44">                                         <span class="dt">m_x_12  =</span> m_x_<span class="dv">12</span>,</a>
<a class="sourceLine" id="cb1508-45" data-line-number="45">                                         <span class="dt">m_x_13  =</span> m_x_<span class="dv">13</span>,</a>
<a class="sourceLine" id="cb1508-46" data-line-number="46">                                         <span class="dt">m_x_14  =</span> m_x_<span class="dv">14</span>,</a>
<a class="sourceLine" id="cb1508-47" data-line-number="47">                                         <span class="dt">m_y     =</span> m_y),</a>
<a class="sourceLine" id="cb1508-48" data-line-number="48">            <span class="dt">Spend          =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_spend_z,</a>
<a class="sourceLine" id="cb1508-49" data-line-number="49">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1508-50" data-line-number="50">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1508-51" data-line-number="51">            <span class="st">`</span><span class="dt">Percent Take</span><span class="st">`</span> =<span class="st"> </span><span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_prcnt_take_z,</a>
<a class="sourceLine" id="cb1508-52" data-line-number="52">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1508-53" data-line-number="53">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1508-54" data-line-number="54">            <span class="dt">x_rand_1       =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_x_rand_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1508-55" data-line-number="55">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1508-56" data-line-number="56">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1508-57" data-line-number="57">            <span class="dt">x_rand_2       =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_x_rand_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1508-58" data-line-number="58">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1508-59" data-line-number="59">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1508-60" data-line-number="60">            <span class="dt">x_rand_3       =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_x_rand_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1508-61" data-line-number="61">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">5</span>,</a>
<a class="sourceLine" id="cb1508-62" data-line-number="62">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1508-63" data-line-number="63">            <span class="dt">x_rand_4       =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_x_rand_<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1508-64" data-line-number="64">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">6</span>,</a>
<a class="sourceLine" id="cb1508-65" data-line-number="65">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1508-66" data-line-number="66">            <span class="dt">x_rand_5       =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_x_rand_<span class="dv">5</span>,</a>
<a class="sourceLine" id="cb1508-67" data-line-number="67">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">7</span>,</a>
<a class="sourceLine" id="cb1508-68" data-line-number="68">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1508-69" data-line-number="69">            <span class="dt">x_rand_6       =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_x_rand_<span class="dv">6</span>,</a>
<a class="sourceLine" id="cb1508-70" data-line-number="70">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">8</span>,</a>
<a class="sourceLine" id="cb1508-71" data-line-number="71">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1508-72" data-line-number="72">            <span class="dt">x_rand_7       =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_x_rand_<span class="dv">7</span>,</a>
<a class="sourceLine" id="cb1508-73" data-line-number="73">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">9</span>,</a>
<a class="sourceLine" id="cb1508-74" data-line-number="74">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1508-75" data-line-number="75">            <span class="dt">x_rand_8       =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_x_rand_<span class="dv">8</span>,</a>
<a class="sourceLine" id="cb1508-76" data-line-number="76">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">10</span>,</a>
<a class="sourceLine" id="cb1508-77" data-line-number="77">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1508-78" data-line-number="78">            <span class="dt">x_rand_9       =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_x_rand_<span class="dv">9</span>,</a>
<a class="sourceLine" id="cb1508-79" data-line-number="79">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">11</span>,</a>
<a class="sourceLine" id="cb1508-80" data-line-number="80">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1508-81" data-line-number="81">            <span class="dt">x_rand_10      =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_x_rand_<span class="dv">10</span>,</a>
<a class="sourceLine" id="cb1508-82" data-line-number="82">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">12</span>,</a>
<a class="sourceLine" id="cb1508-83" data-line-number="83">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1508-84" data-line-number="84">            <span class="dt">x_rand_11      =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_x_rand_<span class="dv">11</span>,</a>
<a class="sourceLine" id="cb1508-85" data-line-number="85">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">13</span>,</a>
<a class="sourceLine" id="cb1508-86" data-line-number="86">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1508-87" data-line-number="87">            <span class="dt">x_rand_12      =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_x_rand_<span class="dv">12</span>,</a>
<a class="sourceLine" id="cb1508-88" data-line-number="88">                                         <span class="dt">sd_j   =</span> sd_x_<span class="dv">14</span>,</a>
<a class="sourceLine" id="cb1508-89" data-line-number="89">                                         <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1508-90" data-line-number="90">            <span class="dt">Scale          =</span> sigma <span class="op">*</span><span class="st"> </span>sd_y,</a>
<a class="sourceLine" id="cb1508-91" data-line-number="91">            <span class="dt">Normality      =</span> nu <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">log10</span>())</a>
<a class="sourceLine" id="cb1508-92" data-line-number="92"></a>
<a class="sourceLine" id="cb1508-93" data-line-number="93"><span class="kw">glimpse</span>(post)</a></code></pre></div>
<pre><code>## Observations: 4,000
## Variables: 17
## $ Intercept      &lt;dbl&gt; 979.2471, 1023.5298, 1005.1208, 1019.9144, 987.87…
## $ Spend          &lt;dbl&gt; 10.433664, 6.800388, 8.659539, 6.694374, 13.33200…
## $ `Percent Take` &lt;dbl&gt; -2.647076, -2.530614, -2.792637, -2.863597, -2.82…
## $ x_rand_1       &lt;dbl&gt; -0.122140323, -1.158510122, 4.129300096, 2.557700…
## $ x_rand_2       &lt;dbl&gt; -0.08683436, -7.80656229, -0.29081925, -0.4379702…
## $ x_rand_3       &lt;dbl&gt; -0.52525371, 4.52651239, -1.31939726, -1.97089650…
## $ x_rand_4       &lt;dbl&gt; -0.14436314, 0.16171124, 1.24412546, 1.66430716, …
## $ x_rand_5       &lt;dbl&gt; -1.00575083, 7.17913473, -0.49749734, -0.80289945…
## $ x_rand_6       &lt;dbl&gt; -7.70462095, -2.23838325, -1.33121990, -2.0296176…
## $ x_rand_7       &lt;dbl&gt; -0.52338825, -0.97967618, -1.66890548, -3.6052574…
## $ x_rand_8       &lt;dbl&gt; -16.30586010, -4.60620698, 0.95248757, 1.40157515…
## $ x_rand_9       &lt;dbl&gt; -0.06430865, 14.47257381, 0.02975212, 0.24323983,…
## $ x_rand_10      &lt;dbl&gt; -0.693127222, 0.282968557, -0.575203802, 0.764815…
## $ x_rand_11      &lt;dbl&gt; 0.61800434, -0.14365478, 9.95488153, 13.63182415,…
## $ x_rand_12      &lt;dbl&gt; 0.004654011, -9.772196168, 0.691943833, 2.6793078…
## $ Scale          &lt;dbl&gt; 32.13506, 27.57153, 36.89317, 37.52294, 37.52031,…
## $ Normality      &lt;dbl&gt; 1.5010222, 1.2281283, 1.4576176, 1.5595392, 1.448…</code></pre>
<p>And here are the majority of the histograms of Figure 18.12.</p>
<div class="sourceCode" id="cb1510"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1510-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1510-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(Intercept<span class="op">:</span>x_rand_<span class="dv">3</span>, x_rand_<span class="dv">10</span><span class="op">:</span>Normality) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1510-3" data-line-number="3"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1510-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">key =</span> <span class="kw">factor</span>(key, </a>
<a class="sourceLine" id="cb1510-5" data-line-number="5">                      <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;Spend&quot;</span>, <span class="st">&quot;Percent Take&quot;</span>,</a>
<a class="sourceLine" id="cb1510-6" data-line-number="6">                                 <span class="st">&quot;x_rand_1&quot;</span>, <span class="st">&quot;x_rand_2&quot;</span>, <span class="st">&quot;x_rand_3&quot;</span>,</a>
<a class="sourceLine" id="cb1510-7" data-line-number="7">                                 <span class="st">&quot;x_rand_10&quot;</span>, <span class="st">&quot;x_rand_11&quot;</span>, <span class="st">&quot;x_rand_12&quot;</span>,</a>
<a class="sourceLine" id="cb1510-8" data-line-number="8">                                 <span class="st">&quot;Scale&quot;</span>, <span class="st">&quot;Normality&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1510-9" data-line-number="9"><span class="st">  </span></a>
<a class="sourceLine" id="cb1510-10" data-line-number="10"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1510-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>,</a>
<a class="sourceLine" id="cb1510-12" data-line-number="12">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">bins =</span> <span class="dv">40</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1510-13" data-line-number="13"><span class="st">  </span><span class="kw">stat_pointintervalh</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb1510-14" data-line-number="14">                      <span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1510-15" data-line-number="15"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1510-16" data-line-number="16"><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1510-17" data-line-number="17"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-55-1.png" /><!-- --></p>
<p>Based on the distributions for the random predictors, it looks like our <strong>brms</strong> horseshoe prior regularized more aggressively than Kruschke’s hierarchical prior in the text. And interestingly, look how our marginal posterior for <code>Spend</code> is bimodal.</p>
<p>For kicks and giggles, here’s the corresponding coefficient plot for <span class="math inline">\(\beta_1\)</span> through <span class="math inline">\(\beta_{14}\)</span>.</p>
<div class="sourceCode" id="cb1511"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1511-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1511-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(Spend<span class="op">:</span>x_rand_<span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1511-3" data-line-number="3"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1511-4" data-line-number="4"><span class="st">  </span></a>
<a class="sourceLine" id="cb1511-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="kw">reorder</span>(key, value))) <span class="op">+</span></a>
<a class="sourceLine" id="cb1511-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1511-7" data-line-number="7"><span class="st">  </span><span class="kw">stat_pointintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>, <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1511-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb1511-9" data-line-number="9">       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1511-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.y  =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1511-11" data-line-number="11">        <span class="dt">axis.ticks.y =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb1511-12" data-line-number="12">        <span class="dt">panel.grid.major.y =</span> <span class="kw">element_line</span>(<span class="dt">color =</span> <span class="st">&quot;grey98&quot;</span>, <span class="dt">linetype =</span> <span class="dv">2</span>))</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-56-1.png" /><!-- --></p>
<p>But anyways, here’s that final Bayesian <span class="math inline">\(R^2\)</span> histogram for Figure 18.12.</p>
<div class="sourceCode" id="cb1512"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1512-1" data-line-number="1"><span class="kw">bayes_R2</span>(fit5, <span class="dt">summary =</span> F) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1512-2" data-line-number="2"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1512-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb1512-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> R2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1512-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>,</a>
<a class="sourceLine" id="cb1512-6" data-line-number="6">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">bins =</span> <span class="dv">25</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1512-7" data-line-number="7"><span class="st">  </span><span class="kw">stat_pointintervalh</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb1512-8" data-line-number="8">                      <span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1512-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1512-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Bayesian &quot;</span>, <span class="kw">italic</span>(R)<span class="op">^</span><span class="dv">2</span>)),</a>
<a class="sourceLine" id="cb1512-11" data-line-number="11">       <span class="dt">x =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1512-12" data-line-number="12"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(.<span class="dv">6</span>, <span class="dv">1</span>))</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-57-1.png" /><!-- --></p>
<p>Just recall, though, that our <code>fit5</code> was not exactly like Kruschke’s model. Whereas we hard coded the scale of our Student-<span class="math inline">\(t\)</span> horseshoe prior to be 1, Kruschke estimated it with help from the gamma distribution. I’m not aware that’s currently possible in <strong>brms</strong>. If I’m at fault and you know how to do it, <a href="https://github.com/ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse/issues">please share your code</a>.</p>
</div>
<div id="variable-selection" class="section level2">
<h2><span class="header-section-number">18.4</span> Variable selection</h2>
<p>We can rewrite the linear regression model to accommodate whether it includes a predictor as</p>
<p><span class="math display">\[\mu_i = \beta_0 + \sum_j \delta_j \beta_j x_{j, i},\]</span></p>
<p>where <span class="math inline">\(\delta\)</span> is a dummy for which 0 = <em>not included</em> 1 = <em>included</em>. I’m not aware of a way to use <span class="math inline">\(\delta\)</span> as an inclusion indicator in <strong>brms</strong> the way Kruschke implemented it in JAGS. And in fact, it appears this might be <a href="https://discourse.mc-stan.org/t/include-extra-coefficient-multiplied-with-regression-weight-inclusion-weight-a-la-kruschke/5768">unfeasible within the Stan framework</a>. But if you know of a way, please <a href="https://github.com/ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse/issues">share your code</a>. However, this issue can lead to a similar approach: information criteria. To do so, let’s follow Kruschke’s basic flow and use the first model from way back in subsection 18.1.1 as a starting point. The model formula was as follows.</p>
<div class="sourceCode" id="cb1513"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1513-1" data-line-number="1">fit1<span class="op">$</span>formula</a></code></pre></div>
<pre><code>## satt_z ~ 1 + spend_z + prcnt_take_z</code></pre>
<p>Taking interactions off the table for a moment, we can specify four model types with various combinations of the two predictors, <code>prcnt_take_z</code> and <code>spend_z</code>. <code>fit1</code> was the first, which we might denote as <span class="math inline">\(\langle 1, 1 \rangle\)</span>. That leads to the remaining possibilities as</p>
<ul>
<li><span class="math inline">\(\langle 1, 0 \rangle:\)</span> <code>satt_z ~ 1 + spend_z</code></li>
<li><span class="math inline">\(\langle 0, 1 \rangle:\)</span> <code>satt_z ~ 1 + prcnt_take_z</code></li>
<li><span class="math inline">\(\langle 0, 0 \rangle:\)</span> <code>satt_z ~ 1</code></li>
</ul>
<p>Let’s fit those models.</p>
<div class="sourceCode" id="cb1515"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1515-1" data-line-number="1">fit6 &lt;-</a>
<a class="sourceLine" id="cb1515-2" data-line-number="2"><span class="st">  </span><span class="kw">update</span>(fit1,</a>
<a class="sourceLine" id="cb1515-3" data-line-number="3">         <span class="dt">formula =</span> satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>spend_z,</a>
<a class="sourceLine" id="cb1515-4" data-line-number="4">         <span class="dt">seed =</span> <span class="dv">18</span>)</a>
<a class="sourceLine" id="cb1515-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1515-6" data-line-number="6">fit7 &lt;-</a>
<a class="sourceLine" id="cb1515-7" data-line-number="7"><span class="st">  </span><span class="kw">update</span>(fit1,</a>
<a class="sourceLine" id="cb1515-8" data-line-number="8">         <span class="dt">formula =</span> satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>prcnt_take_z,</a>
<a class="sourceLine" id="cb1515-9" data-line-number="9">         <span class="dt">seed =</span> <span class="dv">18</span>)</a>
<a class="sourceLine" id="cb1515-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1515-11" data-line-number="11">fit8 &lt;-</a>
<a class="sourceLine" id="cb1515-12" data-line-number="12"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1515-13" data-line-number="13">      <span class="dt">family =</span> student,</a>
<a class="sourceLine" id="cb1515-14" data-line-number="14">      satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1515-15" data-line-number="15">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1515-16" data-line-number="16">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">class =</span> sigma),</a>
<a class="sourceLine" id="cb1515-17" data-line-number="17">                <span class="kw">prior</span>(<span class="kw">exponential</span>(one_over_twentynine), <span class="dt">class =</span> nu)),</a>
<a class="sourceLine" id="cb1515-18" data-line-number="18">      <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1515-19" data-line-number="19">      <span class="dt">stanvars =</span> <span class="kw">stanvar</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">29</span>, <span class="dt">name =</span> <span class="st">&quot;one_over_twentynine&quot;</span>),</a>
<a class="sourceLine" id="cb1515-20" data-line-number="20">      <span class="dt">seed =</span> <span class="dv">18</span>)</a></code></pre></div>
<p>We’ll compare our models with the LOO information criterion. Like other information criteria, the LOO values aren’t of interest in and of themselves. However, the values of one model’s LOO relative to that of another is of great interest. We generally prefer models with lower estimates.</p>
<div class="sourceCode" id="cb1516"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1516-1" data-line-number="1">fit1 &lt;-<span class="st"> </span><span class="kw">add_criterion</span>(fit1, <span class="st">&quot;loo&quot;</span>)</a>
<a class="sourceLine" id="cb1516-2" data-line-number="2">fit6 &lt;-<span class="st"> </span><span class="kw">add_criterion</span>(fit6, <span class="st">&quot;loo&quot;</span>)</a>
<a class="sourceLine" id="cb1516-3" data-line-number="3">fit7 &lt;-<span class="st"> </span><span class="kw">add_criterion</span>(fit7, <span class="st">&quot;loo&quot;</span>)</a>
<a class="sourceLine" id="cb1516-4" data-line-number="4">fit8 &lt;-<span class="st"> </span><span class="kw">add_criterion</span>(fit8, <span class="st">&quot;loo&quot;</span>)</a>
<a class="sourceLine" id="cb1516-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1516-6" data-line-number="6"><span class="kw">loo_compare</span>(fit1, fit6, fit7, fit8) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1516-7" data-line-number="7"><span class="st">  </span><span class="kw">print</span>(<span class="dt">simplify =</span> F)</a></code></pre></div>
<pre><code>##      elpd_diff se_diff elpd_loo se_elpd_loo p_loo se_p_loo looic se_looic
## fit1   0.0       0.0   -31.9      5.4         4.0   0.7     63.8  10.7   
## fit7  -3.3       2.8   -35.2      4.4         2.8   0.5     70.4   8.8   
## fit6 -37.7       6.3   -69.6      4.0         2.1   0.3    139.3   8.1   
## fit8 -40.9       5.7   -72.7      3.1         1.4   0.2    145.5   6.1</code></pre>
<p>In this case, <code>fit1</code> and <code>fit7</code> clearly have the lowest estimates, but the standard error of their difference score is about the same size as their difference. So the LOO difference score puts them on similar footing. Recall that you can do a similar analysis with the <code>waic()</code> function.</p>
<p>Let’s compare that with the insights from the <code>model_weights()</code> function.</p>
<div class="sourceCode" id="cb1518"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1518-1" data-line-number="1">(mw &lt;-<span class="st"> </span><span class="kw">model_weights</span>(fit1, fit6, fit7, fit8))</a></code></pre></div>
<pre><code>##         fit1         fit6         fit7         fit8 
## 8.985310e-01 8.464204e-08 1.014689e-01 1.081172e-08</code></pre>
<p>If you don’t like scientific notation, you can always wrangle and plot.</p>
<div class="sourceCode" id="cb1520"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1520-1" data-line-number="1">mw <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1520-2" data-line-number="2"><span class="st">  </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1520-3" data-line-number="3"><span class="st">  </span><span class="kw">rownames_to_column</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1520-4" data-line-number="4"><span class="st">  </span><span class="kw">set_names</span>(<span class="st">&quot;fit&quot;</span>, <span class="st">&quot;estimate&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1520-5" data-line-number="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb1520-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> estimate, <span class="dt">y =</span> <span class="kw">reorder</span>(fit, estimate))) <span class="op">+</span></a>
<a class="sourceLine" id="cb1520-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> estimate <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>())) <span class="op">+</span></a>
<a class="sourceLine" id="cb1520-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;stacking weight&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1520-9" data-line-number="9"><span class="st">  </span><span class="kw">ylab</span>(<span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1520-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.ticks.y =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-61-1.png" /><!-- --></p>
<p>Based on this weighting scheme, almost all the weight went to the full model, <code>fit1</code>. But note, in the intro of their <a href="https://cran.r-project.org/web/packages/loo/vignettes/loo2-weights.html">vignette on the topic</a>, Vehtari and Gabry opined:</p>
<blockquote>
<p>Ideally, we would avoid the Bayesian model combination problem by extending the model to include the separate models as special cases, and preferably as a continuous expansion of the model space. For example, instead of model averaging over different covariate combinations, all potentially relevant covariates should be included in a predictive model (for causal analysis more care is needed) and a prior assumption that only some of the covariates are relevant can be presented with regularized horseshoe prior (<a href="https://projecteuclid.org/euclid.ejs/1513306866">Piironen and Vehtari, 2017a</a>). For variable selection we recommend projective predictive variable selection (Piironen and Vehtari, 2017a; <a href="https://cran.r-project.org/web/packages/projpred/index.html">projpred package</a>).</p>
</blockquote>
<p>Perhaps unsurprisingly, their thoughts on the topic are similar with the Gelman et al quotation Kruschke provided on page 536:</p>
<blockquote>
<p>Some prominent authors eschew the variable-selection approach for typical applications in their fields. For example, <a href="http://www.stat.columbia.edu/~gelman/book/">Gelman et al. (2013, p. 369)</a> said, “For the regressions we typically see, we do not believe any coefficients to be truly zero and we do not generally consider it a conceptual (as opposed to computational) advantage to get point estimates of zero—but regularized estimates such as obtained by lasso can be much better than those resulting from simple least squares and flat prior distributions …we are not comfortable with an underlying model in which the coefficients can be exactly zero.”</p>
</blockquote>
<p>For more on some of these methods, check out Vehtari’s GitHub repository, <a href="https://github.com/avehtari/modelselection">Tutorial on model assessment, model selection and inference after model selection</a>.</p>
<p>But anyways, our model weighting methods cohered with Kruschke’s <span class="math inline">\(\delta\)</span>-inclusion-indicator method in that both suggested the full model, <code>fit1</code>, and the model with <code>prcnt_take</code> as the sole predictor, <code>fit7</code>, were given the greatest weight. I’m not aware that our information criteria weighting/model stacking methods provide probability distributions of the type Kruschke displayed in the left portions of Figure 18.13. But we can at least recreate the plots in the other panels.</p>
<div class="sourceCode" id="cb1521"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1521-1" data-line-number="1"><span class="co"># first we&#39;ll get the posterior draws from `fit1` and wrangle them</span></a>
<a class="sourceLine" id="cb1521-2" data-line-number="2"><span class="kw">posterior_samples</span>(fit1) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1521-3" data-line-number="3"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">Spend     =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_spend_z,</a>
<a class="sourceLine" id="cb1521-4" data-line-number="4">                                    <span class="dt">sd_j   =</span> sd_x_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1521-5" data-line-number="5">                                    <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1521-6" data-line-number="6">            <span class="dt">PrcntTake =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_prcnt_take_z,</a>
<a class="sourceLine" id="cb1521-7" data-line-number="7">                                    <span class="dt">sd_j   =</span> sd_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1521-8" data-line-number="8">                                    <span class="dt">sd_y   =</span> sd_y)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1521-9" data-line-number="9"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1521-10" data-line-number="10"><span class="st">  </span><span class="co"># within `bind_rows()`, we extract and wrangle the posterior draws from `fit7` and them insert them below those from `fit1`</span></a>
<a class="sourceLine" id="cb1521-11" data-line-number="11"><span class="st">  </span><span class="kw">bind_rows</span>(</a>
<a class="sourceLine" id="cb1521-12" data-line-number="12">    <span class="kw">posterior_samples</span>(fit7) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1521-13" data-line-number="13"><span class="st">      </span><span class="kw">transmute</span>(<span class="dt">value =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_prcnt_take_z,</a>
<a class="sourceLine" id="cb1521-14" data-line-number="14">                                    <span class="dt">sd_j   =</span> sd_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1521-15" data-line-number="15">                                    <span class="dt">sd_y   =</span> sd_y)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1521-16" data-line-number="16"><span class="st">      </span><span class="kw">mutate</span>(<span class="dt">key =</span> <span class="st">&quot;PrcntTake&quot;</span>)</a>
<a class="sourceLine" id="cb1521-17" data-line-number="17">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1521-18" data-line-number="18"><span class="st">  </span><span class="co"># now we just need a little indexing and factor ordering</span></a>
<a class="sourceLine" id="cb1521-19" data-line-number="19"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">model =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;fit1&quot;</span>, <span class="st">&quot;fit7&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">8000</span>, <span class="dv">4000</span>)), </a>
<a class="sourceLine" id="cb1521-20" data-line-number="20">         <span class="dt">key   =</span> <span class="kw">factor</span>(key, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Spend&quot;</span>, <span class="st">&quot;PrcntTake&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1521-21" data-line-number="21"><span class="st">  </span></a>
<a class="sourceLine" id="cb1521-22" data-line-number="22"><span class="st">  </span><span class="co"># we finally plot!</span></a>
<a class="sourceLine" id="cb1521-23" data-line-number="23"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">fill =</span> model)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1521-24" data-line-number="24"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1521-25" data-line-number="25">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">bins =</span> <span class="dv">40</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1521-26" data-line-number="26"><span class="st">  </span><span class="kw">stat_pointintervalh</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb1521-27" data-line-number="27">                      <span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1521-28" data-line-number="28"><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;D&quot;</span>, <span class="dt">begin =</span> <span class="fl">.35</span>, <span class="dt">end =</span> <span class="fl">.65</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1521-29" data-line-number="29"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1521-30" data-line-number="30"><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1521-31" data-line-number="31"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1521-32" data-line-number="32"><span class="st">  </span><span class="kw">facet_grid</span>(model<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-62-1.png" /><!-- --></p>
<div id="inclusion-probability-is-strongly-affected-by-vagueness-of-prior." class="section level3">
<h3><span class="header-section-number">18.4.1</span> Inclusion probability is strongly affected by vagueness of prior.</h3>
<p>To follow along, let’s fit the models with the updated <span class="math inline">\(SD = 1\)</span> on the <span class="math inline">\(\beta_{1+}\)</span> priors code.</p>
<div class="sourceCode" id="cb1522"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1522-1" data-line-number="1">fit9 &lt;-</a>
<a class="sourceLine" id="cb1522-2" data-line-number="2"><span class="st">  </span><span class="kw">update</span>(fit1,</a>
<a class="sourceLine" id="cb1522-3" data-line-number="3">         <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1522-4" data-line-number="4">                   <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">class =</span> b),</a>
<a class="sourceLine" id="cb1522-5" data-line-number="5">                   <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">class =</span> sigma),</a>
<a class="sourceLine" id="cb1522-6" data-line-number="6">                   <span class="kw">prior</span>(<span class="kw">exponential</span>(one_over_twentynine), <span class="dt">class =</span> nu)),</a>
<a class="sourceLine" id="cb1522-7" data-line-number="7">         <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1522-8" data-line-number="8">         <span class="dt">stanvars =</span> <span class="kw">stanvar</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">29</span>, <span class="dt">name =</span> <span class="st">&quot;one_over_twentynine&quot;</span>),</a>
<a class="sourceLine" id="cb1522-9" data-line-number="9">         <span class="dt">seed =</span> <span class="dv">18</span>)</a>
<a class="sourceLine" id="cb1522-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1522-11" data-line-number="11">fit10 &lt;-</a>
<a class="sourceLine" id="cb1522-12" data-line-number="12"><span class="st">  </span><span class="kw">update</span>(fit9,</a>
<a class="sourceLine" id="cb1522-13" data-line-number="13">         <span class="dt">formula =</span> satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>spend_z,</a>
<a class="sourceLine" id="cb1522-14" data-line-number="14">         <span class="dt">seed =</span> <span class="dv">18</span>)</a>
<a class="sourceLine" id="cb1522-15" data-line-number="15"></a>
<a class="sourceLine" id="cb1522-16" data-line-number="16">fit11 &lt;-</a>
<a class="sourceLine" id="cb1522-17" data-line-number="17"><span class="st">  </span><span class="kw">update</span>(fit9,</a>
<a class="sourceLine" id="cb1522-18" data-line-number="18">         <span class="dt">formula =</span> satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>prcnt_take_z,</a>
<a class="sourceLine" id="cb1522-19" data-line-number="19">         <span class="dt">seed =</span> <span class="dv">18</span>)</a>
<a class="sourceLine" id="cb1522-20" data-line-number="20"></a>
<a class="sourceLine" id="cb1522-21" data-line-number="21">fit12 &lt;-</a>
<a class="sourceLine" id="cb1522-22" data-line-number="22"><span class="st">  </span><span class="kw">update</span>(fit8,</a>
<a class="sourceLine" id="cb1522-23" data-line-number="23">         <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1522-24" data-line-number="24">                   <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">class =</span> sigma),</a>
<a class="sourceLine" id="cb1522-25" data-line-number="25">                   <span class="kw">prior</span>(<span class="kw">exponential</span>(one_over_twentynine), <span class="dt">class =</span> nu)),</a>
<a class="sourceLine" id="cb1522-26" data-line-number="26">         <span class="dt">seed =</span> <span class="dv">18</span>)</a></code></pre></div>
<p>And now we’ll fit the models with the updated <span class="math inline">\(SD = 10\)</span>.</p>
<div class="sourceCode" id="cb1523"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1523-1" data-line-number="1">fit13 &lt;-</a>
<a class="sourceLine" id="cb1523-2" data-line-number="2"><span class="st">  </span><span class="kw">update</span>(fit9,</a>
<a class="sourceLine" id="cb1523-3" data-line-number="3">         <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1523-4" data-line-number="4">                   <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="dt">class =</span> b),</a>
<a class="sourceLine" id="cb1523-5" data-line-number="5">                   <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="dt">class =</span> sigma),</a>
<a class="sourceLine" id="cb1523-6" data-line-number="6">                   <span class="kw">prior</span>(<span class="kw">exponential</span>(one_over_twentynine), <span class="dt">class =</span> nu)),</a>
<a class="sourceLine" id="cb1523-7" data-line-number="7">         <span class="dt">seed =</span> <span class="dv">18</span>)</a>
<a class="sourceLine" id="cb1523-8" data-line-number="8"></a>
<a class="sourceLine" id="cb1523-9" data-line-number="9">fit14 &lt;-</a>
<a class="sourceLine" id="cb1523-10" data-line-number="10"><span class="st">  </span><span class="kw">update</span>(fit13,</a>
<a class="sourceLine" id="cb1523-11" data-line-number="11">         <span class="dt">formula =</span> satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>spend_z,</a>
<a class="sourceLine" id="cb1523-12" data-line-number="12">         <span class="dt">seed =</span> <span class="dv">18</span>)</a>
<a class="sourceLine" id="cb1523-13" data-line-number="13"></a>
<a class="sourceLine" id="cb1523-14" data-line-number="14">fit15 &lt;-</a>
<a class="sourceLine" id="cb1523-15" data-line-number="15"><span class="st">  </span><span class="kw">update</span>(fit13,</a>
<a class="sourceLine" id="cb1523-16" data-line-number="16">         <span class="dt">formula =</span> satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>prcnt_take_z,</a>
<a class="sourceLine" id="cb1523-17" data-line-number="17">         <span class="dt">seed =</span> <span class="dv">18</span>)</a>
<a class="sourceLine" id="cb1523-18" data-line-number="18"></a>
<a class="sourceLine" id="cb1523-19" data-line-number="19">fit16 &lt;-</a>
<a class="sourceLine" id="cb1523-20" data-line-number="20"><span class="st">  </span><span class="kw">update</span>(fit12,</a>
<a class="sourceLine" id="cb1523-21" data-line-number="21">         <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1523-22" data-line-number="22">                   <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="dt">class =</span> sigma),</a>
<a class="sourceLine" id="cb1523-23" data-line-number="23">                   <span class="kw">prior</span>(<span class="kw">exponential</span>(one_over_twentynine), <span class="dt">class =</span> nu)),</a>
<a class="sourceLine" id="cb1523-24" data-line-number="24">         <span class="dt">seed =</span> <span class="dv">18</span>)</a></code></pre></div>
<p>Now we’ve fit the models, we’re ready to examine how altering the <span class="math inline">\(SD\)</span>s on the <span class="math inline">\(\beta_j\)</span> priors influenced the model comparisons via <code>model_weights()</code>. Here we’ll use the default stacking method.</p>
<div class="sourceCode" id="cb1524"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1524-1" data-line-number="1">mw <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1524-2" data-line-number="2"><span class="st">  </span><span class="kw">rbind</span>(<span class="kw">model_weights</span>(fit9, fit10, fit11, fit12),</a>
<a class="sourceLine" id="cb1524-3" data-line-number="3">        <span class="kw">model_weights</span>(fit13, fit14, fit15, fit16)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1524-4" data-line-number="4"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1524-5" data-line-number="5"><span class="st">  </span><span class="kw">set_names</span>(<span class="st">&quot;1, 1&quot;</span>, <span class="st">&quot;1, 0&quot;</span>, <span class="st">&quot;0, 1&quot;</span>, <span class="st">&quot;0, 0&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1524-6" data-line-number="6"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1524-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prior =</span> <span class="kw">rep</span>(<span class="kw">str_c</span>(<span class="st">&quot;SD = &quot;</span>, <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">2</span>, <span class="dv">1</span>)), <span class="dt">times =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1524-8" data-line-number="8"><span class="st">           </span><span class="kw">factor</span>(., <span class="dt">levels =</span> <span class="kw">str_c</span>(<span class="st">&quot;SD = &quot;</span>, <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">2</span>, <span class="dv">1</span>)))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1524-9" data-line-number="9"><span class="st">  </span></a>
<a class="sourceLine" id="cb1524-10" data-line-number="10"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="kw">reorder</span>(key, value))) <span class="op">+</span></a>
<a class="sourceLine" id="cb1524-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> value <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>())) <span class="op">+</span></a>
<a class="sourceLine" id="cb1524-12" data-line-number="12"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1524-13" data-line-number="13"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Stacking weight&quot;</span>,</a>
<a class="sourceLine" id="cb1524-14" data-line-number="14">       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Models defined by Kruschke&#39;s &quot;</span>, delta, <span class="st">&quot; notation&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb1524-15" data-line-number="15"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.ticks.y =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb1524-16" data-line-number="16"><span class="st">  </span><span class="kw">facet_grid</span>(prior<span class="op">~</span>.)</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-63-1.png" /><!-- --></p>
<p>So unlike in the depictions in Figure 18.14, the stacking method was <em>insensitive</em> to the <span class="math inline">\(SD\)</span>s on our <span class="math inline">\(\beta_j\)</span> priors. We might compare LOO difference scores, too.</p>
<div class="sourceCode" id="cb1525"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1525-1" data-line-number="1">fit9  &lt;-<span class="st"> </span><span class="kw">add_criterion</span>(fit9,  <span class="st">&quot;loo&quot;</span>)</a>
<a class="sourceLine" id="cb1525-2" data-line-number="2">fit10 &lt;-<span class="st"> </span><span class="kw">add_criterion</span>(fit10, <span class="st">&quot;loo&quot;</span>)</a>
<a class="sourceLine" id="cb1525-3" data-line-number="3">fit11 &lt;-<span class="st"> </span><span class="kw">add_criterion</span>(fit11, <span class="st">&quot;loo&quot;</span>)</a>
<a class="sourceLine" id="cb1525-4" data-line-number="4">fit12 &lt;-<span class="st"> </span><span class="kw">add_criterion</span>(fit12, <span class="st">&quot;loo&quot;</span>)</a>
<a class="sourceLine" id="cb1525-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1525-6" data-line-number="6">fit13 &lt;-<span class="st"> </span><span class="kw">add_criterion</span>(fit13, <span class="st">&quot;loo&quot;</span>)</a>
<a class="sourceLine" id="cb1525-7" data-line-number="7">fit14 &lt;-<span class="st"> </span><span class="kw">add_criterion</span>(fit14, <span class="st">&quot;loo&quot;</span>)</a>
<a class="sourceLine" id="cb1525-8" data-line-number="8">fit15 &lt;-<span class="st"> </span><span class="kw">add_criterion</span>(fit15, <span class="st">&quot;loo&quot;</span>)</a>
<a class="sourceLine" id="cb1525-9" data-line-number="9">fit16 &lt;-<span class="st"> </span><span class="kw">add_criterion</span>(fit16, <span class="st">&quot;loo&quot;</span>)</a>
<a class="sourceLine" id="cb1525-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1525-11" data-line-number="11"><span class="kw">loo_compare</span>(fit1, fit6, fit7, fit8) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1525-12" data-line-number="12"><span class="st">  </span><span class="kw">print</span>(<span class="dt">simplify =</span> F)</a></code></pre></div>
<pre><code>##      elpd_diff se_diff elpd_loo se_elpd_loo p_loo se_p_loo looic se_looic
## fit1   0.0       0.0   -31.9      5.4         4.0   0.7     63.8  10.7   
## fit7  -3.3       2.8   -35.2      4.4         2.8   0.5     70.4   8.8   
## fit6 -37.7       6.3   -69.6      4.0         2.1   0.3    139.3   8.1   
## fit8 -40.9       5.7   -72.7      3.1         1.4   0.2    145.5   6.1</code></pre>
<div class="sourceCode" id="cb1527"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1527-1" data-line-number="1"><span class="kw">loo_compare</span>(fit9, fit10, fit11, fit12) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1527-2" data-line-number="2"><span class="st">  </span><span class="kw">print</span>(<span class="dt">simplify =</span> F)</a></code></pre></div>
<pre><code>##       elpd_diff se_diff elpd_loo se_elpd_loo p_loo se_p_loo looic se_looic
## fit9    0.0       0.0   -32.0      5.4         4.0   0.7     63.9  10.7   
## fit11  -3.2       2.8   -35.1      4.4         2.7   0.4     70.2   8.8   
## fit10 -37.6       6.3   -69.5      4.0         2.1   0.3    139.0   8.1   
## fit12 -40.7       5.7   -72.7      3.1         1.3   0.2    145.3   6.1</code></pre>
<div class="sourceCode" id="cb1529"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1529-1" data-line-number="1"><span class="kw">loo_compare</span>(fit13, fit14, fit15, fit16) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1529-2" data-line-number="2"><span class="st">  </span><span class="kw">print</span>(<span class="dt">simplify =</span> F)</a></code></pre></div>
<pre><code>##       elpd_diff se_diff elpd_loo se_elpd_loo p_loo se_p_loo looic se_looic
## fit13   0.0       0.0   -31.9      5.4         3.9   0.7     63.8  10.7   
## fit15  -3.2       2.9   -35.1      4.4         2.7   0.5     70.3   8.8   
## fit14 -37.6       6.3   -69.5      4.0         2.0   0.3    139.1   8.0   
## fit16 -40.9       5.7   -72.8      3.0         1.4   0.2    145.7   6.0</code></pre>
<p>The LOO difference score patterns were also about the same across the <span class="math inline">\(SD\)</span>s on our <span class="math inline">\(\beta_j\)</span> priors. Let’s finish up with the histograms comparing the model predictors. Here’s the code for those in the top portion of Figure 18.14.</p>
<div class="sourceCode" id="cb1531"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1531-1" data-line-number="1"><span class="co"># first we&#39;ll get the posterior draws from `fit9` and wrangle them</span></a>
<a class="sourceLine" id="cb1531-2" data-line-number="2"><span class="kw">posterior_samples</span>(fit9) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1531-3" data-line-number="3"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">Spend     =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_spend_z,</a>
<a class="sourceLine" id="cb1531-4" data-line-number="4">                                    <span class="dt">sd_j   =</span> sd_x_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1531-5" data-line-number="5">                                    <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1531-6" data-line-number="6">            <span class="dt">PrcntTake =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_prcnt_take_z,</a>
<a class="sourceLine" id="cb1531-7" data-line-number="7">                                    <span class="dt">sd_j   =</span> sd_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1531-8" data-line-number="8">                                    <span class="dt">sd_y   =</span> sd_y)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1531-9" data-line-number="9"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1531-10" data-line-number="10"><span class="st">  </span><span class="co"># within `bind_rows()`, we extract and wrangle the posterior draws from `fit11` and </span></a>
<a class="sourceLine" id="cb1531-11" data-line-number="11"><span class="st">  </span><span class="co"># then insert them below those from `fit9`</span></a>
<a class="sourceLine" id="cb1531-12" data-line-number="12"><span class="st">  </span><span class="kw">bind_rows</span>(</a>
<a class="sourceLine" id="cb1531-13" data-line-number="13">    <span class="kw">posterior_samples</span>(fit11) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1531-14" data-line-number="14"><span class="st">      </span><span class="kw">transmute</span>(<span class="dt">value =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_prcnt_take_z,</a>
<a class="sourceLine" id="cb1531-15" data-line-number="15">                                    <span class="dt">sd_j   =</span> sd_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1531-16" data-line-number="16">                                    <span class="dt">sd_y   =</span> sd_y)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1531-17" data-line-number="17"><span class="st">      </span><span class="kw">mutate</span>(<span class="dt">key =</span> <span class="st">&quot;PrcntTake&quot;</span>)</a>
<a class="sourceLine" id="cb1531-18" data-line-number="18">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1531-19" data-line-number="19"><span class="st">  </span><span class="co"># now we just need a little indexing and factor ordering</span></a>
<a class="sourceLine" id="cb1531-20" data-line-number="20"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">model =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;fit9&quot;</span>, <span class="st">&quot;fit11&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">8000</span>, <span class="dv">4000</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1531-21" data-line-number="21"><span class="st">           </span><span class="kw">factor</span>(., <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;fit9&quot;</span>, <span class="st">&quot;fit11&quot;</span>)),</a>
<a class="sourceLine" id="cb1531-22" data-line-number="22">         <span class="dt">key   =</span> <span class="kw">factor</span>(key, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Spend&quot;</span>, <span class="st">&quot;PrcntTake&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1531-23" data-line-number="23"><span class="st">  </span></a>
<a class="sourceLine" id="cb1531-24" data-line-number="24"><span class="st">  </span><span class="co"># we finally plot!</span></a>
<a class="sourceLine" id="cb1531-25" data-line-number="25"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">fill =</span> model)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1531-26" data-line-number="26"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1531-27" data-line-number="27">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">bins =</span> <span class="dv">40</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1531-28" data-line-number="28"><span class="st">  </span><span class="kw">stat_pointintervalh</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb1531-29" data-line-number="29">                      <span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1531-30" data-line-number="30"><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;D&quot;</span>, <span class="dt">begin =</span> <span class="fl">.35</span>, <span class="dt">end =</span> <span class="fl">.65</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1531-31" data-line-number="31"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1531-32" data-line-number="32"><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1531-33" data-line-number="33"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1531-34" data-line-number="34"><span class="st">  </span><span class="kw">facet_grid</span>(model<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-65-1.png" /><!-- --></p>
<p>And now we’ll do the histograms for the bottom portion of Figure 18.14.</p>
<div class="sourceCode" id="cb1532"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1532-1" data-line-number="1"><span class="kw">posterior_samples</span>(fit13) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1532-2" data-line-number="2"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">Spend     =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_spend_z,</a>
<a class="sourceLine" id="cb1532-3" data-line-number="3">                                    <span class="dt">sd_j   =</span> sd_x_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1532-4" data-line-number="4">                                    <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1532-5" data-line-number="5">            <span class="dt">PrcntTake =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_prcnt_take_z,</a>
<a class="sourceLine" id="cb1532-6" data-line-number="6">                                    <span class="dt">sd_j   =</span> sd_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1532-7" data-line-number="7">                                    <span class="dt">sd_y   =</span> sd_y)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1532-8" data-line-number="8"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1532-9" data-line-number="9"><span class="st">  </span><span class="kw">bind_rows</span>(</a>
<a class="sourceLine" id="cb1532-10" data-line-number="10">    <span class="kw">posterior_samples</span>(fit15) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1532-11" data-line-number="11"><span class="st">      </span><span class="kw">transmute</span>(<span class="dt">value =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_prcnt_take_z,</a>
<a class="sourceLine" id="cb1532-12" data-line-number="12">                                    <span class="dt">sd_j   =</span> sd_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1532-13" data-line-number="13">                                    <span class="dt">sd_y   =</span> sd_y)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1532-14" data-line-number="14"><span class="st">      </span><span class="kw">mutate</span>(<span class="dt">key =</span> <span class="st">&quot;PrcntTake&quot;</span>)</a>
<a class="sourceLine" id="cb1532-15" data-line-number="15">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1532-16" data-line-number="16"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">model =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;fit13&quot;</span>, <span class="st">&quot;fit15&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">8000</span>, <span class="dv">4000</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1532-17" data-line-number="17"><span class="st">           </span><span class="kw">factor</span>(., <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;fit13&quot;</span>, <span class="st">&quot;fit15&quot;</span>)),</a>
<a class="sourceLine" id="cb1532-18" data-line-number="18">         <span class="dt">key   =</span> <span class="kw">factor</span>(key, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Spend&quot;</span>, <span class="st">&quot;PrcntTake&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1532-19" data-line-number="19"><span class="st">  </span></a>
<a class="sourceLine" id="cb1532-20" data-line-number="20"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">fill =</span> model)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1532-21" data-line-number="21"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1532-22" data-line-number="22">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">bins =</span> <span class="dv">40</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1532-23" data-line-number="23"><span class="st">  </span><span class="kw">stat_pointintervalh</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb1532-24" data-line-number="24">                      <span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1532-25" data-line-number="25"><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;D&quot;</span>, <span class="dt">begin =</span> <span class="fl">.35</span>, <span class="dt">end =</span> <span class="fl">.65</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1532-26" data-line-number="26"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1532-27" data-line-number="27"><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1532-28" data-line-number="28"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1532-29" data-line-number="29"><span class="st">  </span><span class="kw">facet_grid</span>(model<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-66-1.png" /><!-- --></p>
<p>Kurschke concluded this subsection with</p>
<blockquote>
<p>Bayesian model comparison can be strongly affected by the degree of vagueness in the priors, even though explicit estimates of the parameter values may be minimally affected. Therefore, be very cautious when interpreting the results of Bayesian variable selection. The next section discusses a way to inform the prior by using concurrent data instead of previous data. (p. 542)</p>
</blockquote>
<p>We should note that while the method in text was “strongly affected by the degree of vagueness in the priors”, the information-criteria and model weighting methods, above, were not. If you’re interested in comparing models within the Bayesian paradigm, choose your method with care.</p>
</div>
<div id="variable-selection-with-hierarchical-shrinkage." class="section level3">
<h3><span class="header-section-number">18.4.2</span> Variable selection with hierarchical shrinkage.</h3>
<p>Kruschke opened the subsection with a few good points:</p>
<blockquote>
<p>If you have strong previous research that can inform the prior, then it should be used. But if previous knowledge is weak, then the uncertainty should be expressed in the prior. This is an underlying mantra of the Bayesian approach: Any uncertainty should be expressed in the prior. (p. 543)</p>
</blockquote>
<p>Here we’ll standardize our new predictors, <code>StuTeaRat</code> and <code>Salary</code>.</p>
<div class="sourceCode" id="cb1533"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1533-1" data-line-number="1">my_data &lt;-</a>
<a class="sourceLine" id="cb1533-2" data-line-number="2"><span class="st">  </span>my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1533-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">stu_tea_rat_z =</span> <span class="kw">standardize</span>(StuTeaRat),</a>
<a class="sourceLine" id="cb1533-4" data-line-number="4">         <span class="dt">salary_z      =</span> <span class="kw">standardize</span>(Salary))</a></code></pre></div>
<p>We can use Kruschke’s <code>gamma_s_and_r_from_mode_sd()</code> function to return the exact shape and rate parameters to make a gamma with a mode of 1 and an <span class="math inline">\(SD\)</span> of 10.</p>
<div class="sourceCode" id="cb1534"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1534-1" data-line-number="1">gamma_s_and_r_from_mode_sd &lt;-<span class="st"> </span><span class="cf">function</span>(mode, sd) {</a>
<a class="sourceLine" id="cb1534-2" data-line-number="2">  <span class="cf">if</span> (mode <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="kw">stop</span>(<span class="st">&quot;mode must be &gt; 0&quot;</span>)</a>
<a class="sourceLine" id="cb1534-3" data-line-number="3">  <span class="cf">if</span> (sd   <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="kw">stop</span>(<span class="st">&quot;sd must be &gt; 0&quot;</span>)</a>
<a class="sourceLine" id="cb1534-4" data-line-number="4">  rate  &lt;-<span class="st"> </span>(mode <span class="op">+</span><span class="st"> </span><span class="kw">sqrt</span>(mode<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span>sd<span class="op">^</span><span class="dv">2</span>)) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>sd<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1534-5" data-line-number="5">  shape &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>mode <span class="op">*</span><span class="st"> </span>rate</a>
<a class="sourceLine" id="cb1534-6" data-line-number="6">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">shape =</span> shape, <span class="dt">rate =</span> rate))</a>
<a class="sourceLine" id="cb1534-7" data-line-number="7">}</a></code></pre></div>
<p>Here are the values.</p>
<div class="sourceCode" id="cb1535"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1535-1" data-line-number="1">(p &lt;-<span class="st"> </span><span class="kw">gamma_s_and_r_from_mode_sd</span>(<span class="dt">mode =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.numeric</span>())</a></code></pre></div>
<pre><code>## [1] 1.1051249 0.1051249</code></pre>
<p>That gamma distribution looks like this.</p>
<div class="sourceCode" id="cb1537"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1537-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">55</span>, <span class="dt">length.out =</span> <span class="fl">1e3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1537-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> <span class="kw">dgamma</span>(x, p[<span class="dv">1</span>], p[<span class="dv">2</span>]))) <span class="op">+</span></a>
<a class="sourceLine" id="cb1537-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">size =</span> <span class="dv">0</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1537-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1537-5" data-line-number="5"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Our gamma prior&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1537-6" data-line-number="6"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">50</span>)</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-70-1.png" /><!-- --></p>
<p>We can code those values in with arbitrary precision with the <code>stanvar()</code> function.</p>
<div class="sourceCode" id="cb1538"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1538-1" data-line-number="1">stanvars &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1538-2" data-line-number="2"><span class="st">  </span><span class="kw">stanvar</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">29</span>, <span class="dt">name =</span> <span class="st">&quot;one_over_twentynine&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1538-3" data-line-number="3"><span class="st">  </span><span class="kw">stanvar</span>(p[<span class="dv">1</span>], <span class="dt">name =</span> <span class="st">&quot;my_shape&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1538-4" data-line-number="4"><span class="st">  </span><span class="kw">stanvar</span>(p[<span class="dv">2</span>], <span class="dt">name =</span> <span class="st">&quot;my_rate&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1538-5" data-line-number="5"><span class="st">  </span><span class="kw">stanvar</span>(<span class="dt">scode =</span> <span class="st">&quot;  real&lt;lower=0&gt; tau;&quot;</span>, <span class="dt">block =</span> <span class="st">&quot;parameters&quot;</span>)</a></code></pre></div>
<p>Note that last <code>stanvar()</code> line. Bürkner recently posted an <a href="https://github.com/paul-buerkner/brms/issues/459">exemplar of how to set a hierarchical prior on a regression coefficient</a> in a <code>brm()</code> model:</p>
<div class="sourceCode" id="cb1539"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1539-1" data-line-number="1"><span class="co"># define a hierachical prior on the regression coefficients</span></a>
<a class="sourceLine" id="cb1539-2" data-line-number="2">bprior &lt;-<span class="st"> </span><span class="kw">set_prior</span>(<span class="st">&quot;normal(0, tau)&quot;</span>, <span class="dt">class =</span> <span class="st">&quot;b&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1539-3" data-line-number="3"><span class="st">  </span><span class="kw">set_prior</span>(<span class="st">&quot;target += normal_lpdf(tau | 0, 10)&quot;</span>, <span class="dt">check =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb1539-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1539-5" data-line-number="5">stanvars &lt;-<span class="st"> </span><span class="kw">stanvar</span>(<span class="dt">scode =</span> <span class="st">&quot;  real&lt;lower=0&gt; tau;&quot;</span>, <span class="dt">block =</span> <span class="st">&quot;parameters&quot;</span>)</a>
<a class="sourceLine" id="cb1539-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1539-7" data-line-number="7"><span class="kw">make_stancode</span>(count <span class="op">~</span><span class="st"> </span>Trt <span class="op">+</span><span class="st"> </span>log_Base4_c, epilepsy,</a>
<a class="sourceLine" id="cb1539-8" data-line-number="8">              <span class="dt">prior =</span> bprior, <span class="dt">stanvars =</span> stanvars)</a></code></pre></div>
<p>Following the method, we tell <code>brm()</code> we’d like to estimate the <span class="math inline">\(SD\)</span> of our <span class="math inline">\(\beta_{1+}\)</span> priors with <code>prior(normal(0, tau), class = b)</code>, where the <code>tau</code> is a stand-in for the <span class="math inline">\(SD\)</span>. In the next line, <code>set_prior(&quot;target += gamma_lpdf(tau | my_shape, my_rate)&quot;, check = FALSE)</code>, we tell <code>brm()</code> we’d like to estimate <code>tau</code> with a gamma(<code>my_shape</code>, <code>my_rate</code>), the values for which were saved in our <code>stanvars</code> object, above. And it’s that <code>stanvar()</code> line in that code wherein we told <code>brm()</code> we’d like that parameter to have a lower bound of 0. Let’s put it to use.</p>
<div class="sourceCode" id="cb1540"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1540-1" data-line-number="1">fit_<span class="dv">1111</span> &lt;-</a>
<a class="sourceLine" id="cb1540-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1540-3" data-line-number="3">      <span class="dt">family =</span> student,</a>
<a class="sourceLine" id="cb1540-4" data-line-number="4">      satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>spend_z <span class="op">+</span><span class="st"> </span>prcnt_take_z <span class="op">+</span><span class="st"> </span>stu_tea_rat_z <span class="op">+</span><span class="st"> </span>salary_z,</a>
<a class="sourceLine" id="cb1540-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1540-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, tau), <span class="dt">class =</span> b),</a>
<a class="sourceLine" id="cb1540-7" data-line-number="7">                <span class="kw">set_prior</span>(<span class="st">&quot;target += gamma_lpdf(tau | my_shape, my_rate)&quot;</span>, <span class="dt">check =</span> <span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb1540-8" data-line-number="8">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">class =</span> sigma),</a>
<a class="sourceLine" id="cb1540-9" data-line-number="9">                <span class="kw">prior</span>(<span class="kw">exponential</span>(one_over_twentynine), <span class="dt">class =</span> nu)),</a>
<a class="sourceLine" id="cb1540-10" data-line-number="10">      <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1540-11" data-line-number="11">      <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">.99</span>),</a>
<a class="sourceLine" id="cb1540-12" data-line-number="12">      <span class="dt">stanvars =</span> stanvars,</a>
<a class="sourceLine" id="cb1540-13" data-line-number="13">      <span class="dt">seed =</span> <span class="dv">18</span>)</a>
<a class="sourceLine" id="cb1540-14" data-line-number="14"></a>
<a class="sourceLine" id="cb1540-15" data-line-number="15">fit_<span class="dv">0111</span> &lt;-</a>
<a class="sourceLine" id="cb1540-16" data-line-number="16"><span class="st">  </span><span class="kw">update</span>(fit_<span class="dv">1111</span>,</a>
<a class="sourceLine" id="cb1540-17" data-line-number="17">         <span class="dt">formula =</span> satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span>           <span class="op">+</span><span class="st"> </span>prcnt_take_z <span class="op">+</span><span class="st"> </span>stu_tea_rat_z <span class="op">+</span><span class="st"> </span>salary_z)</a>
<a class="sourceLine" id="cb1540-18" data-line-number="18"></a>
<a class="sourceLine" id="cb1540-19" data-line-number="19">fit_<span class="dv">1011</span> &lt;-</a>
<a class="sourceLine" id="cb1540-20" data-line-number="20"><span class="st">  </span><span class="kw">update</span>(fit_<span class="dv">1111</span>,</a>
<a class="sourceLine" id="cb1540-21" data-line-number="21">         <span class="dt">formula =</span> satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>spend_z                <span class="op">+</span><span class="st"> </span>stu_tea_rat_z <span class="op">+</span><span class="st"> </span>salary_z)</a>
<a class="sourceLine" id="cb1540-22" data-line-number="22"> </a>
<a class="sourceLine" id="cb1540-23" data-line-number="23">fit_<span class="dv">1101</span> &lt;-</a>
<a class="sourceLine" id="cb1540-24" data-line-number="24"><span class="st">  </span><span class="kw">update</span>(fit_<span class="dv">1111</span>,</a>
<a class="sourceLine" id="cb1540-25" data-line-number="25">         <span class="dt">formula =</span> satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>spend_z <span class="op">+</span><span class="st"> </span>prcnt_take_z                 <span class="op">+</span><span class="st"> </span>salary_z)</a>
<a class="sourceLine" id="cb1540-26" data-line-number="26"></a>
<a class="sourceLine" id="cb1540-27" data-line-number="27">fit_<span class="dv">1110</span> &lt;-</a>
<a class="sourceLine" id="cb1540-28" data-line-number="28"><span class="st">  </span><span class="kw">update</span>(fit_<span class="dv">1111</span>,</a>
<a class="sourceLine" id="cb1540-29" data-line-number="29">         <span class="dt">formula =</span> satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>spend_z <span class="op">+</span><span class="st"> </span>prcnt_take_z <span class="op">+</span><span class="st"> </span>stu_tea_rat_z           )</a>
<a class="sourceLine" id="cb1540-30" data-line-number="30"></a>
<a class="sourceLine" id="cb1540-31" data-line-number="31">fit_<span class="dv">0011</span> &lt;-</a>
<a class="sourceLine" id="cb1540-32" data-line-number="32"><span class="st">  </span><span class="kw">update</span>(fit_<span class="dv">1111</span>,</a>
<a class="sourceLine" id="cb1540-33" data-line-number="33">         <span class="dt">formula =</span> satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span>                          <span class="op">+</span><span class="st"> </span>stu_tea_rat_z <span class="op">+</span><span class="st"> </span>salary_z)</a>
<a class="sourceLine" id="cb1540-34" data-line-number="34"></a>
<a class="sourceLine" id="cb1540-35" data-line-number="35">fit_<span class="dv">0101</span> &lt;-</a>
<a class="sourceLine" id="cb1540-36" data-line-number="36"><span class="st">  </span><span class="kw">update</span>(fit_<span class="dv">1111</span>,</a>
<a class="sourceLine" id="cb1540-37" data-line-number="37">         <span class="dt">formula =</span> satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span>           <span class="op">+</span><span class="st"> </span>prcnt_take_z                 <span class="op">+</span><span class="st"> </span>salary_z)</a>
<a class="sourceLine" id="cb1540-38" data-line-number="38"></a>
<a class="sourceLine" id="cb1540-39" data-line-number="39">fit_<span class="dv">0110</span> &lt;-</a>
<a class="sourceLine" id="cb1540-40" data-line-number="40"><span class="st">  </span><span class="kw">update</span>(fit_<span class="dv">1111</span>,</a>
<a class="sourceLine" id="cb1540-41" data-line-number="41">         <span class="dt">formula =</span> satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span>           <span class="op">+</span><span class="st"> </span>prcnt_take_z <span class="op">+</span><span class="st"> </span>stu_tea_rat_z           )</a>
<a class="sourceLine" id="cb1540-42" data-line-number="42"></a>
<a class="sourceLine" id="cb1540-43" data-line-number="43">fit_<span class="dv">1001</span> &lt;-</a>
<a class="sourceLine" id="cb1540-44" data-line-number="44"><span class="st">  </span><span class="kw">update</span>(fit_<span class="dv">1111</span>,</a>
<a class="sourceLine" id="cb1540-45" data-line-number="45">         <span class="dt">formula =</span> satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>spend_z                                <span class="op">+</span><span class="st"> </span>salary_z)</a>
<a class="sourceLine" id="cb1540-46" data-line-number="46"></a>
<a class="sourceLine" id="cb1540-47" data-line-number="47">fit_<span class="dv">1010</span> &lt;-</a>
<a class="sourceLine" id="cb1540-48" data-line-number="48"><span class="st">  </span><span class="kw">update</span>(fit_<span class="dv">1111</span>,</a>
<a class="sourceLine" id="cb1540-49" data-line-number="49">         <span class="dt">formula =</span> satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>spend_z                <span class="op">+</span><span class="st"> </span>stu_tea_rat_z           )</a>
<a class="sourceLine" id="cb1540-50" data-line-number="50"></a>
<a class="sourceLine" id="cb1540-51" data-line-number="51">fit_<span class="dv">1100</span> &lt;-</a>
<a class="sourceLine" id="cb1540-52" data-line-number="52"><span class="st">  </span><span class="kw">update</span>(fit_<span class="dv">1111</span>,</a>
<a class="sourceLine" id="cb1540-53" data-line-number="53">         <span class="dt">formula =</span> satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>spend_z <span class="op">+</span><span class="st"> </span>prcnt_take_z                           )</a>
<a class="sourceLine" id="cb1540-54" data-line-number="54"></a>
<a class="sourceLine" id="cb1540-55" data-line-number="55">fit_<span class="dv">0001</span> &lt;-</a>
<a class="sourceLine" id="cb1540-56" data-line-number="56"><span class="st">  </span><span class="kw">update</span>(fit_<span class="dv">1111</span>,</a>
<a class="sourceLine" id="cb1540-57" data-line-number="57">         <span class="dt">formula =</span> satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span>                                          <span class="op">+</span><span class="st"> </span>salary_z)</a>
<a class="sourceLine" id="cb1540-58" data-line-number="58"></a>
<a class="sourceLine" id="cb1540-59" data-line-number="59">fit_<span class="dv">0010</span> &lt;-</a>
<a class="sourceLine" id="cb1540-60" data-line-number="60"><span class="st">  </span><span class="kw">update</span>(fit_<span class="dv">1111</span>,</a>
<a class="sourceLine" id="cb1540-61" data-line-number="61">         <span class="dt">formula =</span> satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span>                          <span class="op">+</span><span class="st"> </span>stu_tea_rat_z           )</a>
<a class="sourceLine" id="cb1540-62" data-line-number="62"></a>
<a class="sourceLine" id="cb1540-63" data-line-number="63">fit_<span class="dv">0100</span> &lt;-</a>
<a class="sourceLine" id="cb1540-64" data-line-number="64"><span class="st">  </span><span class="kw">update</span>(fit_<span class="dv">1111</span>,</a>
<a class="sourceLine" id="cb1540-65" data-line-number="65">         <span class="dt">formula =</span> satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span>           <span class="op">+</span><span class="st"> </span>prcnt_take_z                           )</a>
<a class="sourceLine" id="cb1540-66" data-line-number="66"></a>
<a class="sourceLine" id="cb1540-67" data-line-number="67">fit_<span class="dv">1000</span> &lt;-</a>
<a class="sourceLine" id="cb1540-68" data-line-number="68"><span class="st">  </span><span class="kw">update</span>(fit_<span class="dv">1111</span>,</a>
<a class="sourceLine" id="cb1540-69" data-line-number="69">         <span class="dt">formula =</span> satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>spend_z                                          )</a>
<a class="sourceLine" id="cb1540-70" data-line-number="70"></a>
<a class="sourceLine" id="cb1540-71" data-line-number="71">fit_<span class="dv">0000</span> &lt;-</a>
<a class="sourceLine" id="cb1540-72" data-line-number="72"><span class="st">  </span><span class="kw">update</span>(fit_<span class="dv">1111</span>,</a>
<a class="sourceLine" id="cb1540-73" data-line-number="73">         <span class="dt">formula =</span> satt_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span>                                                    )</a></code></pre></div>
<p>In order to keep track of the next 16 models, we switched our usual naming convention. Instead of continuing on keeping on calling them <code>fit17</code> through <code>fit33</code>, we used Kruschke’s <span class="math inline">\(\delta\)</span> 0/1 convention. If we set the formula for the full model as <code>satt_z ~ 1 + spend_z + prcnt_take_z + stu_tea_rat_z + salary_z</code>, the name becomes <code>fit_1111</code>. Accordingly, we called the model omitting <code>spend_z</code>, the first predictor, <code>fit_0111</code>, and so on.</p>
<p>Before we go any further, here are the correlations among the <span class="math inline">\(\beta\)</span>s for the full model, <code>fit_1111</code>.</p>
<div class="sourceCode" id="cb1541"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1541-1" data-line-number="1"><span class="kw">vcov</span>(fit_<span class="dv">1111</span>, <span class="dt">correlation =</span> T) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1541-2" data-line-number="2"><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>##               Intercept spend_z prcnt_take_z stu_tea_rat_z salary_z
## Intercept         1.000   0.009       -0.007         0.019   -0.023
## spend_z           0.009   1.000        0.039         0.688   -0.883
## prcnt_take_z     -0.007   0.039        1.000         0.242   -0.344
## stu_tea_rat_z     0.019   0.688        0.242         1.000   -0.683
## salary_z         -0.023  -0.883       -0.344        -0.683    1.000</code></pre>
<p>Once again, the HMC correlations differ from Kruschke’s JAGS correlations. Moving on–behold the model weights.</p>
<div class="sourceCode" id="cb1543"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1543-1" data-line-number="1">(</a>
<a class="sourceLine" id="cb1543-2" data-line-number="2">  mw &lt;-</a>
<a class="sourceLine" id="cb1543-3" data-line-number="3"><span class="st">  </span><span class="kw">model_weights</span>(fit_<span class="dv">1111</span>, </a>
<a class="sourceLine" id="cb1543-4" data-line-number="4">                fit_<span class="dv">0111</span>, fit_<span class="dv">1011</span>, fit_<span class="dv">1101</span>, fit_<span class="dv">1110</span>,</a>
<a class="sourceLine" id="cb1543-5" data-line-number="5">                fit_<span class="dv">0011</span>, fit_<span class="dv">0101</span>, fit_<span class="dv">0110</span>, fit_<span class="dv">1001</span>, fit_<span class="dv">1010</span>, fit_<span class="dv">1100</span>, </a>
<a class="sourceLine" id="cb1543-6" data-line-number="6">                fit_<span class="dv">0001</span>, fit_<span class="dv">0010</span>, fit_<span class="dv">0100</span>, fit_<span class="dv">1000</span>,</a>
<a class="sourceLine" id="cb1543-7" data-line-number="7">                fit_<span class="dv">0000</span>)</a>
<a class="sourceLine" id="cb1543-8" data-line-number="8"> )</a></code></pre></div>
<pre><code>##     fit_1111     fit_0111     fit_1011     fit_1101     fit_1110 
## 6.863750e-06 2.487864e-01 1.805001e-05 3.950442e-06 2.701096e-03 
##     fit_0011     fit_0101     fit_0110     fit_1001     fit_1010 
## 1.533369e-05 8.946392e-03 1.508780e-05 1.320403e-05 1.184423e-05 
##     fit_1100     fit_0001     fit_0010     fit_0100     fit_1000 
## 1.985399e-01 1.387202e-01 3.212120e-06 3.161577e-01 8.606082e-02 
##     fit_0000 
## 1.024098e-08</code></pre>
<p>We’ll plot our model weights like before.</p>
<div class="sourceCode" id="cb1545"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1545-1" data-line-number="1">mw <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1545-2" data-line-number="2"><span class="st">  </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1545-3" data-line-number="3"><span class="st">  </span><span class="kw">rownames_to_column</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1545-4" data-line-number="4"><span class="st">  </span><span class="kw">set_names</span>(<span class="st">&quot;fit&quot;</span>, <span class="st">&quot;weight&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1545-5" data-line-number="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb1545-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> <span class="kw">reorder</span>(fit, weight))) <span class="op">+</span></a>
<a class="sourceLine" id="cb1545-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> weight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()),</a>
<a class="sourceLine" id="cb1545-8" data-line-number="8">            <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1545-9" data-line-number="9"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1545-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Stacking weight&quot;</span>,</a>
<a class="sourceLine" id="cb1545-11" data-line-number="11">       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1545-12" data-line-number="12"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.ticks.y =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-74-1.png" /><!-- --></p>
<p>As you might notice, pattern among model weights is similar with but not identical to the one among the model probabilities Kruschke displayed in Figure 18.15. Here we’ll plot the histograms for our top six.</p>
<div class="sourceCode" id="cb1546"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1546-1" data-line-number="1"><span class="co"># first, we need to redefine `sd_x_3` and `sd_x_4` in terms of our two new predictors</span></a>
<a class="sourceLine" id="cb1546-2" data-line-number="2">sd_x_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>StuTeaRat)</a>
<a class="sourceLine" id="cb1546-3" data-line-number="3">sd_x_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>Salary)</a>
<a class="sourceLine" id="cb1546-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1546-5" data-line-number="5"><span class="co">## Now we&#39;ll start extracting our posterior samples and wrangling them, by model</span></a>
<a class="sourceLine" id="cb1546-6" data-line-number="6"><span class="co"># fit_0100</span></a>
<a class="sourceLine" id="cb1546-7" data-line-number="7"><span class="kw">posterior_samples</span>(fit_<span class="dv">0100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1546-8" data-line-number="8"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">PrcntTake =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_prcnt_take_z,</a>
<a class="sourceLine" id="cb1546-9" data-line-number="9">                                    <span class="dt">sd_j   =</span> sd_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1546-10" data-line-number="10">                                    <span class="dt">sd_y   =</span> sd_y)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1546-11" data-line-number="11"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1546-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="st">&quot;fit_0100&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1546-13" data-line-number="13"><span class="st">  </span><span class="co"># fit_0111</span></a>
<a class="sourceLine" id="cb1546-14" data-line-number="14"><span class="st">  </span><span class="kw">bind_rows</span>(</a>
<a class="sourceLine" id="cb1546-15" data-line-number="15">    <span class="kw">posterior_samples</span>(fit_<span class="dv">0111</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1546-16" data-line-number="16"><span class="st">      </span><span class="kw">transmute</span>(<span class="dt">PrcntTake =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_prcnt_take_z,</a>
<a class="sourceLine" id="cb1546-17" data-line-number="17">                                        <span class="dt">sd_j   =</span> sd_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1546-18" data-line-number="18">                                        <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1546-19" data-line-number="19">                <span class="dt">StuTeaRat =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_stu_tea_rat_z,</a>
<a class="sourceLine" id="cb1546-20" data-line-number="20">                                        <span class="dt">sd_j   =</span> sd_x_<span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1546-21" data-line-number="21">                                        <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1546-22" data-line-number="22">                <span class="dt">Salary    =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_salary_z,</a>
<a class="sourceLine" id="cb1546-23" data-line-number="23">                                        <span class="dt">sd_j   =</span> sd_x_<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1546-24" data-line-number="24">                                        <span class="dt">sd_y   =</span> sd_y)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1546-25" data-line-number="25"><span class="st">      </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1546-26" data-line-number="26"><span class="st">      </span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="st">&quot;fit_0111&quot;</span>)</a>
<a class="sourceLine" id="cb1546-27" data-line-number="27">    )  <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1546-28" data-line-number="28"><span class="st">  </span><span class="co"># fit_1100</span></a>
<a class="sourceLine" id="cb1546-29" data-line-number="29"><span class="st">  </span><span class="kw">bind_rows</span>(</a>
<a class="sourceLine" id="cb1546-30" data-line-number="30">    <span class="kw">posterior_samples</span>(fit_<span class="dv">1100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1546-31" data-line-number="31"><span class="st">      </span><span class="kw">transmute</span>(<span class="dt">Spend     =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_spend_z,</a>
<a class="sourceLine" id="cb1546-32" data-line-number="32">                                        <span class="dt">sd_j   =</span> sd_x_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1546-33" data-line-number="33">                                        <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1546-34" data-line-number="34">                <span class="dt">PrcntTake =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_prcnt_take_z,</a>
<a class="sourceLine" id="cb1546-35" data-line-number="35">                                        <span class="dt">sd_j   =</span> sd_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1546-36" data-line-number="36">                                        <span class="dt">sd_y   =</span> sd_y)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1546-37" data-line-number="37"><span class="st">      </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1546-38" data-line-number="38"><span class="st">      </span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="st">&quot;fit_1100&quot;</span>)</a>
<a class="sourceLine" id="cb1546-39" data-line-number="39">    )  <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1546-40" data-line-number="40"><span class="st">  </span><span class="co"># fit_0001</span></a>
<a class="sourceLine" id="cb1546-41" data-line-number="41"><span class="st">  </span><span class="kw">bind_rows</span>(</a>
<a class="sourceLine" id="cb1546-42" data-line-number="42">    <span class="kw">posterior_samples</span>(fit_<span class="dv">0001</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1546-43" data-line-number="43"><span class="st">      </span><span class="kw">transmute</span>(<span class="dt">Salary    =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_salary_z,</a>
<a class="sourceLine" id="cb1546-44" data-line-number="44">                                        <span class="dt">sd_j   =</span> sd_x_<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1546-45" data-line-number="45">                                        <span class="dt">sd_y   =</span> sd_y)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1546-46" data-line-number="46"><span class="st">      </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1546-47" data-line-number="47"><span class="st">      </span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="st">&quot;fit_0001&quot;</span>)</a>
<a class="sourceLine" id="cb1546-48" data-line-number="48">    )  <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1546-49" data-line-number="49"><span class="st">  </span><span class="co"># fit_1000</span></a>
<a class="sourceLine" id="cb1546-50" data-line-number="50"><span class="st">  </span><span class="kw">bind_rows</span>(</a>
<a class="sourceLine" id="cb1546-51" data-line-number="51">    <span class="kw">posterior_samples</span>(fit_<span class="dv">1000</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1546-52" data-line-number="52"><span class="st">      </span><span class="kw">transmute</span>(<span class="dt">Spend     =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_spend_z,</a>
<a class="sourceLine" id="cb1546-53" data-line-number="53">                                        <span class="dt">sd_j   =</span> sd_x_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1546-54" data-line-number="54">                                        <span class="dt">sd_y   =</span> sd_y)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1546-55" data-line-number="55"><span class="st">      </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1546-56" data-line-number="56"><span class="st">      </span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="st">&quot;fit_1000&quot;</span>)</a>
<a class="sourceLine" id="cb1546-57" data-line-number="57">    )  <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1546-58" data-line-number="58"><span class="st">  </span><span class="co"># fit_0101       # spend_z + prcnt_take_z + stu_tea_rat_z</span></a>
<a class="sourceLine" id="cb1546-59" data-line-number="59"><span class="st">  </span><span class="kw">bind_rows</span>(</a>
<a class="sourceLine" id="cb1546-60" data-line-number="60">    <span class="kw">posterior_samples</span>(fit_<span class="dv">0101</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1546-61" data-line-number="61"><span class="st">      </span><span class="kw">transmute</span>(<span class="dt">PrcntTake =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_prcnt_take_z,</a>
<a class="sourceLine" id="cb1546-62" data-line-number="62">                                        <span class="dt">sd_j   =</span> sd_x_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb1546-63" data-line-number="63">                                        <span class="dt">sd_y   =</span> sd_y),</a>
<a class="sourceLine" id="cb1546-64" data-line-number="64">                <span class="dt">Salary    =</span> <span class="kw">make_beta_j</span>(<span class="dt">zeta_j =</span> b_salary_z,</a>
<a class="sourceLine" id="cb1546-65" data-line-number="65">                                        <span class="dt">sd_j   =</span> sd_x_<span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1546-66" data-line-number="66">                                        <span class="dt">sd_y   =</span> sd_y)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1546-67" data-line-number="67"><span class="st">      </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1546-68" data-line-number="68"><span class="st">      </span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="st">&quot;fit_0101&quot;</span>)</a>
<a class="sourceLine" id="cb1546-69" data-line-number="69">    ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1546-70" data-line-number="70"><span class="st">  </span><span class="co"># the next two lines just help order the grid the plots appear in</span></a>
<a class="sourceLine" id="cb1546-71" data-line-number="71"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">key =</span> <span class="kw">factor</span>(key, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Spend&quot;</span>, <span class="st">&quot;PrcntTake&quot;</span>, <span class="st">&quot;StuTeaRat&quot;</span>, <span class="st">&quot;Salary&quot;</span>)),</a>
<a class="sourceLine" id="cb1546-72" data-line-number="72">         <span class="dt">fit =</span> <span class="kw">factor</span>(fit, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;fit_0100&quot;</span>, <span class="st">&quot;fit_0111&quot;</span>, <span class="st">&quot;fit_1100&quot;</span>, <span class="st">&quot;fit_0001&quot;</span>, <span class="st">&quot;fit_1000&quot;</span>, <span class="st">&quot;fit_0101&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1546-73" data-line-number="73"><span class="st">  </span></a>
<a class="sourceLine" id="cb1546-74" data-line-number="74"><span class="st">  </span><span class="co"># finally, the plot!</span></a>
<a class="sourceLine" id="cb1546-75" data-line-number="75"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">fill =</span> fit)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1546-76" data-line-number="76"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1546-77" data-line-number="77">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">bins =</span> <span class="dv">40</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1546-78" data-line-number="78"><span class="st">  </span><span class="kw">stat_pointintervalh</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1546-79" data-line-number="79">                      <span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1546-80" data-line-number="80"><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;D&quot;</span>, <span class="dt">begin =</span> <span class="fl">.2</span>, <span class="dt">end =</span> <span class="fl">.8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1546-81" data-line-number="81"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1546-82" data-line-number="82"><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1546-83" data-line-number="83"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1546-84" data-line-number="84"><span class="st">  </span><span class="kw">facet_grid</span>(fit<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-75-1.png" /><!-- --></p>
<p>Like Kruschke’s results in the text, <code>PrcntTake</code> was the most prominant predictor.</p>
</div>
<div id="what-to-report-and-what-to-conclude." class="section level3">
<h3><span class="header-section-number">18.4.3</span> What to report and what to conclude.</h3>
<p>Kruschke made a great point in the opening paragraph of this subsection.</p>
<blockquote>
<p>It might make sense to use the single most credible model, especially if it is notably more credible than the runner up, and if the goal is to have a parsimonious explanatory description of the data. But it is important to recognize that using the single best model, when it excludes some predictors, is concluding that the regression coefficients on the excluded predictors are exactly zero. (p. 546)</p>
</blockquote>
<p>Later he added “A forthright report should state the posterior probabilities of the several top models. Additionally, it can be useful to report, for each model, the ratio of its posterior probability relative to that of the best model” (p. 546). With our information criteria and model weights approach, we don’t have posterior probabilities for the models themselves. But we can report on their information criteria comparisons and weights.</p>
<p>In the final paragraph of the subsection, Kruschke wrote:</p>
<blockquote>
<p>When the goal is prediction of <span class="math inline">\(y\)</span> for interesting values of the predictors, as opposed to parsimonious explanation, then it is usually not appropriate to use only the single most probable model. Instead, predictions should be based on as much information as possible, using all models to the extent that they are credible. This approach is called Bayesian model averaging (BMA). (p. 547)</p>
</blockquote>
<p>It’s worth it to walk this out a bit. With <strong>brms</strong>, one can use <code>brms::pp_average()</code> to get the weighted posterior distributions for the model parameters. This is a natural extension of our model weights comparisons.</p>
<div class="sourceCode" id="cb1547"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1547-1" data-line-number="1"><span class="co"># how many points on the x-axis?</span></a>
<a class="sourceLine" id="cb1547-2" data-line-number="2">n_points &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb1547-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1547-4" data-line-number="4"><span class="co"># what vales of the predictors would we like to evaluate the weighted posterior over?</span></a>
<a class="sourceLine" id="cb1547-5" data-line-number="5">nd &lt;-</a>
<a class="sourceLine" id="cb1547-6" data-line-number="6"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">spend_z       =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-3</span>, <span class="dt">to =</span> <span class="dv">3</span>, <span class="dt">length.out =</span> n_points),</a>
<a class="sourceLine" id="cb1547-7" data-line-number="7">         <span class="dt">prcnt_take_z  =</span> <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb1547-8" data-line-number="8">         <span class="dt">stu_tea_rat_z =</span> <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb1547-9" data-line-number="9">         <span class="dt">salary_z      =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1547-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1547-11" data-line-number="11">pp &lt;-</a>
<a class="sourceLine" id="cb1547-12" data-line-number="12"><span class="st">  </span><span class="co"># the first things we feed into `pp_average()` are the `brm()` fits we&#39;d like to average over</span></a>
<a class="sourceLine" id="cb1547-13" data-line-number="13"><span class="st">  </span><span class="kw">pp_average</span>(fit_<span class="dv">1111</span>, fit_<span class="dv">0111</span>, fit_<span class="dv">1011</span>, fit_<span class="dv">1101</span>, fit_<span class="dv">1110</span>, fit_<span class="dv">0011</span>, fit_<span class="dv">0101</span>, fit_<span class="dv">0110</span>, fit_<span class="dv">1001</span>, fit_<span class="dv">1010</span>, fit_<span class="dv">1100</span>, fit_<span class="dv">0001</span>, fit_<span class="dv">0010</span>, fit_<span class="dv">0100</span>, fit_<span class="dv">1000</span>, fit_<span class="dv">0000</span>,</a>
<a class="sourceLine" id="cb1547-14" data-line-number="14">             <span class="co"># here we tell it to evaluate the posterior over these predictor values</span></a>
<a class="sourceLine" id="cb1547-15" data-line-number="15">             <span class="dt">newdata =</span> nd, </a>
<a class="sourceLine" id="cb1547-16" data-line-number="16">             <span class="co"># we can get the mean trends using the &quot;fitted&quot; method</span></a>
<a class="sourceLine" id="cb1547-17" data-line-number="17">             <span class="dt">method =</span> <span class="st">&quot;fitted&quot;</span>,</a>
<a class="sourceLine" id="cb1547-18" data-line-number="18">             <span class="co"># by `robust`, we mean we&#39;d like the Estimate in terms of posterior medians, rather than means</span></a>
<a class="sourceLine" id="cb1547-19" data-line-number="19">             <span class="dt">robust =</span> T)</a>
<a class="sourceLine" id="cb1547-20" data-line-number="20"></a>
<a class="sourceLine" id="cb1547-21" data-line-number="21"><span class="kw">str</span>(pp)</a></code></pre></div>
<pre><code>##  num [1:30, 1:4] -0.0164 -0.0164 -0.0164 -0.0163 -0.0164 ...
##  - attr(*, &quot;dimnames&quot;)=List of 2
##   ..$ : NULL
##   ..$ : chr [1:4] &quot;Estimate&quot; &quot;Est.Error&quot; &quot;Q2.5&quot; &quot;Q97.5&quot;
##  - attr(*, &quot;weights&quot;)= Named num [1:16] 6.86e-06 2.49e-01 1.81e-05 3.95e-06 2.70e-03 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:16] &quot;fit_1111&quot; &quot;fit_0111&quot; &quot;fit_1011&quot; &quot;fit_1101&quot; ...
##  - attr(*, &quot;nsamples&quot;)= Named num [1:16] 0 995 0 0 11 0 36 0 0 0 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:16] &quot;fit_1111&quot; &quot;fit_0111&quot; &quot;fit_1011&quot; &quot;fit_1101&quot; ...</code></pre>
<p>The <code>pp</code> object will require a little wrangling before it’s of use for <strong>ggplot2</strong>.</p>
<div class="sourceCode" id="cb1549"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1549-1" data-line-number="1">pp <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1549-2" data-line-number="2"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1549-3" data-line-number="3"><span class="st">  </span><span class="kw">bind_cols</span>(nd) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1549-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1549-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> spend_z, <span class="dt">y =</span> Estimate,</a>
<a class="sourceLine" id="cb1549-6" data-line-number="6">             <span class="dt">ymin =</span> Q2<span class="fl">.5</span>, <span class="dt">ymax =</span> Q97<span class="fl">.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1549-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_pointrange</span>(<span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1549-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Value of Spend_z&quot;</span>,</a>
<a class="sourceLine" id="cb1549-9" data-line-number="9">       <span class="dt">y =</span> <span class="st">&quot;Standardized SATT&quot;</span>)</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-76-1.png" /><!-- --></p>
<p>We can build on this to make a plot considering each of the four predictors. But first that requires we make a new <code>nd</code> tibble to feed into <code>pp_average()</code>.</p>
<div class="sourceCode" id="cb1550"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1550-1" data-line-number="1"><span class="co"># how many points on the x-axis?</span></a>
<a class="sourceLine" id="cb1550-2" data-line-number="2">n_points &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb1550-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1550-4" data-line-number="4"><span class="co"># what vales of the predictors would we like to evaluate the weighted posterior over?</span></a>
<a class="sourceLine" id="cb1550-5" data-line-number="5">nd &lt;-</a>
<a class="sourceLine" id="cb1550-6" data-line-number="6"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">spend_z       =</span> <span class="kw">c</span>(<span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-3</span>, <span class="dt">to =</span> <span class="dv">3</span>, <span class="dt">length.out =</span> n_points),</a>
<a class="sourceLine" id="cb1550-7" data-line-number="7">                           <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dt">times =</span> n_points <span class="op">*</span><span class="st"> </span><span class="dv">3</span>)),</a>
<a class="sourceLine" id="cb1550-8" data-line-number="8">         </a>
<a class="sourceLine" id="cb1550-9" data-line-number="9">         <span class="dt">prcnt_take_z  =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dt">times =</span> n_points),</a>
<a class="sourceLine" id="cb1550-10" data-line-number="10">                           <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-3</span>, <span class="dt">to =</span> <span class="dv">3</span>, <span class="dt">length.out =</span> n_points),</a>
<a class="sourceLine" id="cb1550-11" data-line-number="11">                           <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dt">times =</span> n_points <span class="op">*</span><span class="st"> </span><span class="dv">2</span>)), </a>
<a class="sourceLine" id="cb1550-12" data-line-number="12">         </a>
<a class="sourceLine" id="cb1550-13" data-line-number="13">         <span class="dt">stu_tea_rat_z =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dt">times =</span> n_points <span class="op">*</span><span class="st"> </span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb1550-14" data-line-number="14">                           <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-3</span>, <span class="dt">to =</span> <span class="dv">3</span>, <span class="dt">length.out =</span> n_points),</a>
<a class="sourceLine" id="cb1550-15" data-line-number="15">                           <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dt">times =</span> n_points)), </a>
<a class="sourceLine" id="cb1550-16" data-line-number="16">         </a>
<a class="sourceLine" id="cb1550-17" data-line-number="17">         <span class="dt">salary_z      =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dt">times =</span> n_points <span class="op">*</span><span class="st"> </span><span class="dv">3</span>),</a>
<a class="sourceLine" id="cb1550-18" data-line-number="18">                           <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-3</span>, <span class="dt">to =</span> <span class="dv">3</span>, <span class="dt">length.out =</span> n_points)))</a>
<a class="sourceLine" id="cb1550-19" data-line-number="19"></a>
<a class="sourceLine" id="cb1550-20" data-line-number="20">pp &lt;-</a>
<a class="sourceLine" id="cb1550-21" data-line-number="21"><span class="st">  </span><span class="kw">pp_average</span>(fit_<span class="dv">1111</span>, fit_<span class="dv">0111</span>, fit_<span class="dv">1011</span>, fit_<span class="dv">1101</span>, fit_<span class="dv">1110</span>, fit_<span class="dv">0011</span>, fit_<span class="dv">0101</span>, fit_<span class="dv">0110</span>, fit_<span class="dv">1001</span>, fit_<span class="dv">1010</span>, fit_<span class="dv">1100</span>, fit_<span class="dv">0001</span>, fit_<span class="dv">0010</span>, fit_<span class="dv">0100</span>, fit_<span class="dv">1000</span>, fit_<span class="dv">0000</span>,</a>
<a class="sourceLine" id="cb1550-22" data-line-number="22">             <span class="dt">newdata =</span> nd, </a>
<a class="sourceLine" id="cb1550-23" data-line-number="23">             <span class="dt">method =</span> <span class="st">&quot;fitted&quot;</span>,</a>
<a class="sourceLine" id="cb1550-24" data-line-number="24">             <span class="dt">robust =</span> T,</a>
<a class="sourceLine" id="cb1550-25" data-line-number="25">             <span class="co"># Note the `probs` argument</span></a>
<a class="sourceLine" id="cb1550-26" data-line-number="26">             <span class="dt">probs =</span> <span class="kw">c</span>(.<span class="dv">025</span>, <span class="fl">.975</span>, <span class="fl">.1</span>, <span class="fl">.9</span>, <span class="fl">.25</span>, <span class="fl">.75</span>))</a>
<a class="sourceLine" id="cb1550-27" data-line-number="27"></a>
<a class="sourceLine" id="cb1550-28" data-line-number="28"><span class="kw">str</span>(pp)</a></code></pre></div>
<pre><code>##  num [1:120, 1:8] -0.0163 -0.0163 -0.0163 -0.0163 -0.0163 ...
##  - attr(*, &quot;dimnames&quot;)=List of 2
##   ..$ : NULL
##   ..$ : chr [1:8] &quot;Estimate&quot; &quot;Est.Error&quot; &quot;Q2.5&quot; &quot;Q97.5&quot; ...
##  - attr(*, &quot;weights&quot;)= Named num [1:16] 6.86e-06 2.49e-01 1.81e-05 3.95e-06 2.70e-03 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:16] &quot;fit_1111&quot; &quot;fit_0111&quot; &quot;fit_1011&quot; &quot;fit_1101&quot; ...
##  - attr(*, &quot;nsamples&quot;)= Named num [1:16] 0 995 0 0 11 0 36 0 0 0 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:16] &quot;fit_1111&quot; &quot;fit_0111&quot; &quot;fit_1011&quot; &quot;fit_1101&quot; ...</code></pre>
<p>In each panel of the plot, below, we focus on one predictor. For that predictor, we hold all other three at their mean, which, since they are all standardized, is zero. We consider the posterior predictions for standardized SAT scores across a range of values each focal predictor. The posterior predictions are depicted in terms of 95%, 80%, and 50% percentile-based interval bands and a line at the median.</p>
<div class="sourceCode" id="cb1552"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1552-1" data-line-number="1">pp <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1552-2" data-line-number="2"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1552-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-3</span>, <span class="dt">to =</span> <span class="dv">3</span>, <span class="dt">length.out =</span> n_points) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">4</span>),</a>
<a class="sourceLine" id="cb1552-4" data-line-number="4">         <span class="dt">predictor =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Spend_z&quot;</span>, <span class="st">&quot;PrcntTake_z&quot;</span>, <span class="st">&quot;StuTeaRat_z&quot;</span>, <span class="st">&quot;Salary_z&quot;</span>), <span class="dt">each =</span> n_points)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1552-5" data-line-number="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb1552-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1552-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> Q2<span class="fl">.5</span>, <span class="dt">ymax =</span> Q97<span class="fl">.5</span>, <span class="dt">fill =</span> predictor),</a>
<a class="sourceLine" id="cb1552-8" data-line-number="8">              <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1552-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> Q10, <span class="dt">ymax =</span> Q90, <span class="dt">fill =</span> predictor),</a>
<a class="sourceLine" id="cb1552-10" data-line-number="10">              <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1552-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> Q25, <span class="dt">ymax =</span> Q75, <span class="dt">fill =</span> predictor),</a>
<a class="sourceLine" id="cb1552-12" data-line-number="12">              <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1552-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Estimate, <span class="dt">color =</span> predictor),</a>
<a class="sourceLine" id="cb1552-14" data-line-number="14">            <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1552-15" data-line-number="15"><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;D&quot;</span>, <span class="dt">begin =</span> <span class="fl">.1</span>, <span class="dt">end =</span> <span class="fl">.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1552-16" data-line-number="16"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;D&quot;</span>, <span class="dt">begin =</span> <span class="fl">.1</span>, <span class="dt">end =</span> <span class="fl">.6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1552-17" data-line-number="17"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Standardized value of the focal predictor&quot;</span>,</a>
<a class="sourceLine" id="cb1552-18" data-line-number="18">       <span class="dt">y =</span> <span class="st">&quot;Standardized SATT&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1552-19" data-line-number="19"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1552-20" data-line-number="20"><span class="st">  </span><span class="kw">facet_grid</span>(predictor <span class="op">~</span><span class="st"> </span>., <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</a></code></pre></div>
<p><img src="18_files/figure-gfm/unnamed-chunk-77-1.png" /><!-- --></p>
<p>Based on the weighted average across the models, the <code>PrcntTake_z</code> predictor was the pmost potent.</p>
</div>
<div id="caution-computational-methods." class="section level3">
<h3><span class="header-section-number">18.4.4</span> Caution: Computational methods.</h3>
<blockquote>
<p>To conclude this section regarding variable selection, it is appropriate to recapitulate the considerations at the beginning of the section. Variable selection is a reasonable approach only if it is genuinely plausible and meaningful that candidate predictors have zero relation to the predicted variable. The results can be surprisingly sensitive to the seemingly innocuous choice of prior for the regression coefficients, and, of course, the prior for the inclusion probability. Because of these limitations, hierarchical shrinkage priors may be a more meaningful approach. (p. 548)</p>
</blockquote>
</div>
<div id="caution-interaction-variables." class="section level3">
<h3><span class="header-section-number">18.4.5</span> Caution: Interaction variables.</h3>
<blockquote>
<p>When interaction terms are included in a model that also has hierarchical shrinkage on regression coefficients, the interaction coefficients should not be put under the same higher-level prior distribution as the individual component coefficients, because interaction coefficients are conceptually from a different class of variables than individual components. (pp. 548–549)</p>
</blockquote>
</div>
</div>
<div id="reference-16" class="section level2 unnumbered">
<h2>Reference</h2>
<p><a href="https://sites.google.com/site/doingbayesiandataanalysis/">Kruschke, J. K. (2015). <em>Doing Bayesian data analysis, Second Edition: A tutorial with R, JAGS, and Stan.</em> Burlington, MA: Academic Press/Elsevier.</a></p>
</div>
<div id="session-info-17" class="section level2 unnumbered">
<h2>Session info</h2>
<div class="sourceCode" id="cb1553"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1553-1" data-line-number="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>## R version 3.6.0 (2019-04-26)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS High Sierra 10.13.6
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] ggridges_0.5.1  bayesplot_1.7.0 tidybayes_1.1.0 brms_2.10.3    
##  [5] Rcpp_1.0.2      forcats_0.4.0   stringr_1.4.0   dplyr_0.8.3    
##  [9] purrr_0.3.3     readr_1.3.1     tidyr_1.0.0     tibble_2.1.3   
## [13] ggplot2_3.2.1   tidyverse_1.2.1
## 
## loaded via a namespace (and not attached):
##   [1] colorspace_1.4-1          ellipsis_0.3.0           
##   [3] rsconnect_0.8.15          ggstance_0.3.2           
##   [5] markdown_1.1              base64enc_0.1-3          
##   [7] rstudioapi_0.10           rstan_2.19.2             
##   [9] svUnit_0.7-12             DT_0.9                   
##  [11] fansi_0.4.0               lubridate_1.7.4          
##  [13] xml2_1.2.0                bridgesampling_0.7-2     
##  [15] mnormt_1.5-5              knitr_1.23               
##  [17] shinythemes_1.1.2         zeallot_0.1.0            
##  [19] jsonlite_1.6              broom_0.5.2              
##  [21] shiny_1.3.2               compiler_3.6.0           
##  [23] httr_1.4.0                backports_1.1.5          
##  [25] assertthat_0.2.1          Matrix_1.2-17            
##  [27] lazyeval_0.2.2            cli_1.1.0                
##  [29] later_1.0.0               htmltools_0.4.0          
##  [31] prettyunits_1.0.2         tools_3.6.0              
##  [33] igraph_1.2.4.1            coda_0.19-3              
##  [35] gtable_0.3.0              glue_1.3.1.9000          
##  [37] reshape2_1.4.3            cellranger_1.1.0         
##  [39] vctrs_0.2.0               nlme_3.1-139             
##  [41] crosstalk_1.0.0           psych_1.8.12             
##  [43] xfun_0.10                 ps_1.3.0                 
##  [45] rvest_0.3.4               mime_0.7                 
##  [47] miniUI_0.1.1.1            lifecycle_0.1.0          
##  [49] gtools_3.8.1              MASS_7.3-51.4            
##  [51] zoo_1.8-6                 scales_1.0.0             
##  [53] colourpicker_1.0          hms_0.4.2                
##  [55] promises_1.1.0            Brobdingnag_1.2-6        
##  [57] parallel_3.6.0            inline_0.3.15            
##  [59] shinystan_2.5.0           yaml_2.2.0               
##  [61] gridExtra_2.3             loo_2.1.0                
##  [63] StanHeaders_2.19.0        stringi_1.4.3            
##  [65] dygraphs_1.1.1.6          pkgbuild_1.0.5           
##  [67] rlang_0.4.1               pkgconfig_2.0.3          
##  [69] matrixStats_0.55.0        HDInterval_0.2.0         
##  [71] evaluate_0.14             lattice_0.20-38          
##  [73] rstantools_2.0.0          htmlwidgets_1.5          
##  [75] labeling_0.3              tidyselect_0.2.5         
##  [77] processx_3.4.1            plyr_1.8.4               
##  [79] magrittr_1.5              R6_2.4.0                 
##  [81] generics_0.0.2            foreign_0.8-71           
##  [83] pillar_1.4.2              haven_2.1.0              
##  [85] withr_2.1.2               xts_0.11-2               
##  [87] abind_1.4-5               modelr_0.1.4             
##  [89] crayon_1.3.4              arrayhelpers_1.0-20160527
##  [91] utf8_1.1.4                rmarkdown_1.13           
##  [93] grid_3.6.0                readxl_1.3.1             
##  [95] callr_3.3.2               threejs_0.3.1            
##  [97] digest_0.6.21             xtable_1.8-4             
##  [99] httpuv_1.5.2              stats4_3.6.0             
## [101] munsell_0.5.0             viridisLite_0.3.0        
## [103] shinyjs_1.0</code></pre>
</div>
<div id="footnote" class="section level2 unnumbered">
<h2>Footnote</h2>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>In his <a href="https://sites.google.com/site/doingbayesiandataanalysis/corrigenda">Corrigenda</a>, Kruschke further clarified: “that is true only in case there is a single predictor, not for multiple predictors. The statement could have said that ‘R^2 is algebraically constrained to fall between −1 and +1 in least-squares regression’. More relevantly, replace the statement with the following: ‘In multiple linear regression, standardized regression coefficients tend to fall between -2 and +2 unless the predictors are very strongly correlated and have strongly opposing effects. If your data have strongly correlated predictors, consider widening the prior.’”<a href="metric-predicted-variable-with-multiple-metric-predictors.html#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="metric-predicted-variable-with-one-metric-predictor.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="metric-predicted-variable-with-one-nominal-predictor.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
