<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>25 Tools in the Trunk | Doing Bayesian Data Analysis in brms and the tidyverse</title>
  <meta name="description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="25 Tools in the Trunk | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="github-repo" content="ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="25 Tools in the Trunk | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2021-05-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="count-predicted-variable.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What and why</a>
<ul>
<li><a href="index.html#r-setup"><strong>R</strong> setup</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#we-have-updates"><i class="fa fa-check"></i>We have updates</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.1.0."><i class="fa fa-check"></i>Version 0.1.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.2.0."><i class="fa fa-check"></i>Version 0.2.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.3.0."><i class="fa fa-check"></i>Version 0.3.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.4.0."><i class="fa fa-check"></i>Version 0.4.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#were-not-done-yet-and-i-could-use-your-help."><i class="fa fa-check"></i>We’re not done yet and I could use your help.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#thank-yous-are-in-order"><i class="fa fa-check"></i>Thank-you’s are in order</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license-and-citation"><i class="fa fa-check"></i>License and citation</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html"><i class="fa fa-check"></i><b>1</b> What’s in This Book (Read This First!)</a>
<ul>
<li class="chapter" data-level="1.1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#real-people-can-read-this-book"><i class="fa fa-check"></i><b>1.1</b> Real people can read this book</a></li>
<li class="chapter" data-level="1.2" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-in-this-book"><i class="fa fa-check"></i><b>1.2</b> What’s in this book</a></li>
<li class="chapter" data-level="1.3" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-new-in-the-second-edition"><i class="fa fa-check"></i><b>1.3</b> What’s new in the second edition</a></li>
<li class="chapter" data-level="1.4" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#gimme-feedback-be-polite"><i class="fa fa-check"></i><b>1.4</b> Gimme feedback (be polite)</a></li>
<li class="chapter" data-level="1.5" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#thank-you"><i class="fa fa-check"></i><b>1.5</b> Thank you!</a></li>
<li class="chapter" data-level="" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html"><i class="fa fa-check"></i><b>2</b> Introduction: Credibility, Models, and Parameters</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#bayesian-inference-is-reallocation-of-credibility-across-possibilities"><i class="fa fa-check"></i><b>2.1</b> Bayesian inference is reallocation of credibility across possibilities</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#data-are-noisy-and-inferences-are-probabilistic."><i class="fa fa-check"></i><b>2.1.1</b> Data are noisy and inferences are probabilistic.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#possibilities-are-parameter-values-in-descriptive-models"><i class="fa fa-check"></i><b>2.2</b> Possibilities are parameter values in descriptive models</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#the-steps-of-bayesian-data-analysis"><i class="fa fa-check"></i><b>2.3</b> The steps of Bayesian data analysis</a></li>
<li class="chapter" data-level="" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html"><i class="fa fa-check"></i><b>3</b> The R Programming Language</a>
<ul>
<li class="chapter" data-level="3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-software"><i class="fa fa-check"></i><b>3.1</b> Get the software</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-look-at-rstudio."><i class="fa fa-check"></i><b>3.1.1</b> A look at RStudio.</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-simple-example-of-r-in-action"><i class="fa fa-check"></i><b>3.2</b> A simple example of R in action</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-programs-used-with-this-book."><i class="fa fa-check"></i><b>3.2.1</b> Get the programs used with this book.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#basic-commands-and-operators-in-r"><i class="fa fa-check"></i><b>3.3</b> Basic commands and operators in R</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#getting-help-in-r."><i class="fa fa-check"></i><b>3.3.1</b> Getting help in R.</a></li>
<li class="chapter" data-level="3.3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#arithmetic-and-logical-operators."><i class="fa fa-check"></i><b>3.3.2</b> Arithmetic and logical operators.</a></li>
<li class="chapter" data-level="3.3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#assignment-relational-operators-and-tests-of-equality."><i class="fa fa-check"></i><b>3.3.3</b> Assignment, relational operators, and tests of equality.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-types"><i class="fa fa-check"></i><b>3.4</b> Variable types</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#vector."><i class="fa fa-check"></i><b>3.4.1</b> Vector.</a></li>
<li class="chapter" data-level="3.4.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#factor."><i class="fa fa-check"></i><b>3.4.2</b> Factor.</a></li>
<li class="chapter" data-level="3.4.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#matrix-and-array."><i class="fa fa-check"></i><b>3.4.3</b> Matrix and array.</a></li>
<li class="chapter" data-level="3.4.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#list-and-data-frame."><i class="fa fa-check"></i><b>3.4.4</b> List and data frame.</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#loading-and-saving-data"><i class="fa fa-check"></i><b>3.5</b> Loading and saving data</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#the-read.csv-read_csv-and-read.table-read_table-functions."><i class="fa fa-check"></i><b>3.5.1</b> The <del>read.csv</del> <code>read_csv()</code> and <del>read.table</del> <code>read_table()</code> functions.</a></li>
<li class="chapter" data-level="3.5.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#saving-data-from-r."><i class="fa fa-check"></i><b>3.5.2</b> Saving data from R.</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#some-utility-functions"><i class="fa fa-check"></i><b>3.6</b> Some utility functions</a></li>
<li class="chapter" data-level="3.7" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-in-r"><i class="fa fa-check"></i><b>3.7</b> Programming in R</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-names-in-r."><i class="fa fa-check"></i><b>3.7.1</b> Variable names in R.</a></li>
<li class="chapter" data-level="3.7.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#running-a-program."><i class="fa fa-check"></i><b>3.7.2</b> Running a program.</a></li>
<li class="chapter" data-level="3.7.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-a-function."><i class="fa fa-check"></i><b>3.7.3</b> Programming a function.</a></li>
<li class="chapter" data-level="3.7.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#conditions-and-loops."><i class="fa fa-check"></i><b>3.7.4</b> Conditions and loops.</a></li>
<li class="chapter" data-level="3.7.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#measuring-processing-time."><i class="fa fa-check"></i><b>3.7.5</b> Measuring processing time.</a></li>
<li class="chapter" data-level="3.7.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#debugging."><i class="fa fa-check"></i><b>3.7.6</b> Debugging.</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#graphical-plots-opening-and-saving"><i class="fa fa-check"></i><b>3.8</b> Graphical plots: Opening and saving</a></li>
<li class="chapter" data-level="3.9" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#conclusion-brms-related-needs"><i class="fa fa-check"></i><b>3.9</b> <del>Conclusion</del> <strong>brms</strong>-related needs</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#footnote"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html"><i class="fa fa-check"></i><b>4</b> What is This Stuff Called Probability?</a>
<ul>
<li class="chapter" data-level="4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#the-set-of-all-possible-events"><i class="fa fa-check"></i><b>4.1</b> The set of all possible events</a></li>
<li class="chapter" data-level="4.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-outside-or-inside-the-head"><i class="fa fa-check"></i><b>4.2</b> Probability: Outside or inside the head</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#outside-the-head-long-run-relative-frequency."><i class="fa fa-check"></i><b>4.2.1</b> Outside the head: Long-run relative frequency.</a></li>
<li class="chapter" data-level="4.2.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#inside-the-head-subjective-belief."><i class="fa fa-check"></i><b>4.2.2</b> Inside the head: Subjective belief.</a></li>
<li class="chapter" data-level="4.2.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probabilities-assign-numbers-to-possibilities."><i class="fa fa-check"></i><b>4.2.3</b> Probabilities assign numbers to possibilities.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-distributions"><i class="fa fa-check"></i><b>4.3</b> Probability distributions</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#discrete-distributions-probability-mass."><i class="fa fa-check"></i><b>4.3.1</b> Discrete distributions: Probability mass.</a></li>
<li class="chapter" data-level="4.3.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#continuous-distributions-rendezvous-with-density."><i class="fa fa-check"></i><b>4.3.2</b> Continuous distributions: Rendezvous with density.</a></li>
<li class="chapter" data-level="4.3.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#mean-and-variance-of-a-distribution."><i class="fa fa-check"></i><b>4.3.3</b> Mean and variance of a distribution.</a></li>
<li class="chapter" data-level="4.3.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#highest-density-interval-hdi."><i class="fa fa-check"></i><b>4.3.4</b> Highest density interval (HDI).</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#two-way-distributions"><i class="fa fa-check"></i><b>4.4</b> Two-way distributions</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#conditional-probability."><i class="fa fa-check"></i><b>4.4.1</b> Conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes-rule.html"><a href="bayes-rule.html"><i class="fa fa-check"></i><b>5</b> Bayes’ Rule</a>
<ul>
<li class="chapter" data-level="5.1" data-path="bayes-rule.html"><a href="bayes-rule.html#bayes-rule-1"><i class="fa fa-check"></i><b>5.1</b> Bayes’ rule</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="bayes-rule.html"><a href="bayes-rule.html#derived-from-definitions-of-conditional-probability."><i class="fa fa-check"></i><b>5.1.1</b> Derived from definitions of conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bayes-rule.html"><a href="bayes-rule.html#applied-to-parameters-and-data"><i class="fa fa-check"></i><b>5.2</b> Applied to parameters and data</a></li>
<li class="chapter" data-level="5.3" data-path="bayes-rule.html"><a href="bayes-rule.html#complete-examples-estimating-bias-in-a-coin"><i class="fa fa-check"></i><b>5.3</b> Complete examples: Estimating bias in a coin</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-sample-size-on-the-posterior."><i class="fa fa-check"></i><b>5.3.1</b> Influence of sample size on the posterior.</a></li>
<li class="chapter" data-level="5.3.2" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-prior-on-the-posterior."><i class="fa fa-check"></i><b>5.3.2</b> Influence of prior on the posterior.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="bayes-rule.html"><a href="bayes-rule.html#why-bayesian-inference-can-be-difficult"><i class="fa fa-check"></i><b>5.4</b> Why Bayesian inference can be difficult</a></li>
<li class="chapter" data-level="" data-path="bayes-rule.html"><a href="bayes-rule.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><i class="fa fa-check"></i><b>6</b> Inferring a Binomial Probability via Exact Mathematical Analysis</a>
<ul>
<li class="chapter" data-level="6.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-likelihood-function-the-bernoulli-distribution"><i class="fa fa-check"></i><b>6.1</b> The likelihood function: The Bernoulli distribution</a></li>
<li class="chapter" data-level="6.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#a-description-of-credibilities-the-beta-distribution"><i class="fa fa-check"></i><b>6.2</b> A description of credibilities: The beta distribution</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#specifying-a-beta-prior."><i class="fa fa-check"></i><b>6.2.1</b> Specifying a beta prior.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-posterior-beta"><i class="fa fa-check"></i><b>6.3</b> The posterior beta</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#posterior-is-compromise-of-prior-and-likelihood."><i class="fa fa-check"></i><b>6.3.1</b> Posterior is compromise of prior and likelihood.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#examples"><i class="fa fa-check"></i><b>6.4</b> Examples</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.1</b> Prior knowledge expressed as a beta distribution.</a></li>
<li class="chapter" data-level="6.4.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-that-cannot-be-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.2</b> Prior knowledge that cannot be expressed as a beta distribution.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#summary"><i class="fa fa-check"></i><b>6.5</b> Summary</a></li>
<li class="chapter" data-level="" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>7</b> Markov Chain Monte Carlo</a>
<ul>
<li class="chapter" data-level="7.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#approximating-a-distribution-with-a-large-sample"><i class="fa fa-check"></i><b>7.1</b> Approximating a distribution with a large sample</a></li>
<li class="chapter" data-level="7.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-simple-case-of-the-metropolis-algorithm"><i class="fa fa-check"></i><b>7.2</b> A simple case of the Metropolis algorithm</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-politician-stumbles-upon-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.2.1</b> A politician stumbles upon the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.2.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-random-walk."><i class="fa fa-check"></i><b>7.2.2</b> A random walk.</a></li>
<li class="chapter" data-level="7.2.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#general-properties-of-a-random-walk."><i class="fa fa-check"></i><b>7.2.3</b> General properties of a random walk.</a></li>
<li class="chapter" data-level="7.2.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#why-we-care."><i class="fa fa-check"></i><b>7.2.4</b> Why we care.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-metropolis-algorithm-more-generally"><i class="fa fa-check"></i><b>7.3</b> The Metropolis algorithm more generally</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#metropolis-algorithm-applied-to-bernoulli-likelihood-and-beta-prior."><i class="fa fa-check"></i><b>7.3.1</b> Metropolis algorithm applied to Bernoulli likelihood and beta prior.</a></li>
<li class="chapter" data-level="7.3.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#summary-of-metropolis-algorithm."><i class="fa fa-check"></i><b>7.3.2</b> Summary of Metropolis algorithm.</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#toward-gibbs-sampling-estimating-two-coin-biases"><i class="fa fa-check"></i><b>7.4</b> Toward Gibbs sampling: Estimating two coin biases</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#prior-likelihood-and-posterior-for-two-biases."><i class="fa fa-check"></i><b>7.4.1</b> Prior, likelihood and posterior for two biases.</a></li>
<li class="chapter" data-level="7.4.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-exact-formal-analysis."><i class="fa fa-check"></i><b>7.4.2</b> The posterior via exact formal analysis.</a></li>
<li class="chapter" data-level="7.4.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.4.3</b> The posterior via the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.4.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#gibbs-hamiltonian-monte-carlo-sampling."><i class="fa fa-check"></i><b>7.4.4</b> <del>Gibbs</del> Hamiltonian Monte Carlo sampling.</a></li>
<li class="chapter" data-level="7.4.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#is-there-a-difference-between-biases"><i class="fa fa-check"></i><b>7.4.5</b> Is there a difference between biases?</a></li>
<li class="chapter" data-level="7.4.6" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#terminology-mcmc."><i class="fa fa-check"></i><b>7.4.6</b> Terminology: MCMC.</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness-accuracy-and-efficiency"><i class="fa fa-check"></i><b>7.5</b> MCMC representativeness, accuracy, and efficiency</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness."><i class="fa fa-check"></i><b>7.5.1</b> MCMC representativeness.</a></li>
<li class="chapter" data-level="7.5.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-accuracy."><i class="fa fa-check"></i><b>7.5.2</b> MCMC accuracy.</a></li>
<li class="chapter" data-level="7.5.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-efficiency."><i class="fa fa-check"></i><b>7.5.3</b> MCMC efficiency.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#footnote-1"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="jags-brms.html"><a href="jags-brms.html"><i class="fa fa-check"></i><b>8</b> <del>JAGS</del> brms</a>
<ul>
<li class="chapter" data-level="8.1" data-path="jags-brms.html"><a href="jags-brms.html#jags-brms-and-its-relation-to-r"><i class="fa fa-check"></i><b>8.1</b> <del>JAGS</del> brms and its relation to R</a></li>
<li class="chapter" data-level="8.2" data-path="jags-brms.html"><a href="jags-brms.html#a-complete-example"><i class="fa fa-check"></i><b>8.2</b> A complete example</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="jags-brms.html"><a href="jags-brms.html#load-data."><i class="fa fa-check"></i><b>8.2.1</b> Load data.</a></li>
<li class="chapter" data-level="8.2.2" data-path="jags-brms.html"><a href="jags-brms.html#specify-model."><i class="fa fa-check"></i><b>8.2.2</b> Specify model.</a></li>
<li class="chapter" data-level="8.2.3" data-path="jags-brms.html"><a href="jags-brms.html#initialize-chains."><i class="fa fa-check"></i><b>8.2.3</b> Initialize chains.</a></li>
<li class="chapter" data-level="8.2.4" data-path="jags-brms.html"><a href="jags-brms.html#generate-chains."><i class="fa fa-check"></i><b>8.2.4</b> Generate chains.</a></li>
<li class="chapter" data-level="8.2.5" data-path="jags-brms.html"><a href="jags-brms.html#examine-chains."><i class="fa fa-check"></i><b>8.2.5</b> Examine chains.</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="jags-brms.html"><a href="jags-brms.html#simplified-scripts-for-frequently-used-analyses"><i class="fa fa-check"></i><b>8.3</b> Simplified scripts for frequently used analyses</a></li>
<li class="chapter" data-level="8.4" data-path="jags-brms.html"><a href="jags-brms.html#example-difference-of-biases"><i class="fa fa-check"></i><b>8.4</b> Example: Difference of biases</a></li>
<li class="chapter" data-level="8.5" data-path="jags-brms.html"><a href="jags-brms.html#sampling-from-the-prior-distribution-in-jags-brms"><i class="fa fa-check"></i><b>8.5</b> Sampling from the prior distribution in <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="8.6" data-path="jags-brms.html"><a href="jags-brms.html#probability-distributions-available-in-jags-brms"><i class="fa fa-check"></i><b>8.6</b> Probability distributions available in <del>JAGS</del> brms</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="jags-brms.html"><a href="jags-brms.html#defining-new-likelihood-functions."><i class="fa fa-check"></i><b>8.6.1</b> Defining new likelihood functions.</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="jags-brms.html"><a href="jags-brms.html#faster-sampling-with-parallel-processing-in-runjags-brmsbrm"><i class="fa fa-check"></i><b>8.7</b> Faster sampling with parallel processing in <del>runjags</del> <code>brms::brm()</code></a></li>
<li class="chapter" data-level="8.8" data-path="jags-brms.html"><a href="jags-brms.html#tips-for-expanding-jags-brms-models"><i class="fa fa-check"></i><b>8.8</b> Tips for expanding <del>JAGS</del> brms models</a></li>
<li class="chapter" data-level="" data-path="jags-brms.html"><a href="jags-brms.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>9</b> Hierarchical Models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-single-coin-from-a-single-mint"><i class="fa fa-check"></i><b>9.1</b> A single coin from a single mint</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation."><i class="fa fa-check"></i><b>9.1.1</b> Posterior via grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#multiple-coins-from-a-single-mint"><i class="fa fa-check"></i><b>9.2</b> Multiple coins from a single mint</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation.-1"><i class="fa fa-check"></i><b>9.2.1</b> Posterior via grid approximation.</a></li>
<li class="chapter" data-level="9.2.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-realistic-model-with-mcmc."><i class="fa fa-check"></i><b>9.2.2</b> A realistic model with MCMC.</a></li>
<li class="chapter" data-level="9.2.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#doing-it-with-jags-brms."><i class="fa fa-check"></i><b>9.2.3</b> Doing it with <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="9.2.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-therapeutic-touch."><i class="fa fa-check"></i><b>9.2.4</b> Example: Therapeutic touch.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#shrinkage-in-hierarchical-models"><i class="fa fa-check"></i><b>9.3</b> Shrinkage in hierarchical models</a></li>
<li class="chapter" data-level="9.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#speeding-up-jags-brms"><i class="fa fa-check"></i><b>9.4</b> Speeding up <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="9.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#extending-the-hierarchy-subjects-within-categories"><i class="fa fa-check"></i><b>9.5</b> Extending the hierarchy: Subjects within categories</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-baseball-batting-abilities-by-position."><i class="fa fa-check"></i><b>9.5.1</b> Example: Baseball batting abilities by position.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hierarchical-models.html"><a href="hierarchical-models.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html"><i class="fa fa-check"></i><b>10</b> Model Comparison and Hierarchical Modeling</a>
<ul>
<li class="chapter" data-level="10.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#general-formula-and-the-bayes-factor"><i class="fa fa-check"></i><b>10.1</b> General formula and the Bayes factor</a></li>
<li class="chapter" data-level="10.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#example-two-factories-of-coins"><i class="fa fa-check"></i><b>10.2</b> Example: Two factories of coins</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-formal-analysis."><i class="fa fa-check"></i><b>10.2.1</b> Solution by formal analysis.</a></li>
<li class="chapter" data-level="10.2.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-grid-approximation."><i class="fa fa-check"></i><b>10.2.2</b> Solution by grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-mcmc"><i class="fa fa-check"></i><b>10.3</b> Solution by MCMC</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#nonhierarchical-mcmc-computation-of-each-models-marginal-likelihood."><i class="fa fa-check"></i><b>10.3.1</b> Nonhierarchical MCMC computation of each model’s marginal likelihood.</a></li>
<li class="chapter" data-level="10.3.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#hierarchical-mcmc-computation-of-relative-model-probability-is-not-available-in-brms-well-cover-information-criteria-instead."><i class="fa fa-check"></i><b>10.3.2</b> Hierarchical MCMC computation <del>of relative model probability</del> is not available in brms: We’ll cover information criteria instead.</a></li>
<li class="chapter" data-level="10.3.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#models-with-different-noise-distributions-in-jags-brms."><i class="fa fa-check"></i><b>10.3.3</b> Models with different “noise” distributions in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#prediction-model-averaging"><i class="fa fa-check"></i><b>10.4</b> Prediction: Model averaging</a></li>
<li class="chapter" data-level="10.5" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#model-complexity-naturally-accounted-for"><i class="fa fa-check"></i><b>10.5</b> Model complexity naturally accounted for</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#caveats-regarding-nested-model-comparison."><i class="fa fa-check"></i><b>10.5.1</b> Caveats regarding nested model comparison.</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#extreme-sensitivity-to-prior-distribution"><i class="fa fa-check"></i><b>10.6</b> Extreme sensitivity to prior distribution</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#priors-of-different-models-should-be-equally-informed."><i class="fa fa-check"></i><b>10.6.1</b> Priors of different models should be equally informed.</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#bonus-theres-danger-ahead"><i class="fa fa-check"></i><b>10.7</b> Bonus: There’s danger ahead</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#footnote-2"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html"><i class="fa fa-check"></i><b>11</b> Null Hypothesis Significance Testing</a>
<ul>
<li class="chapter" data-level="11.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#paved-with-good-intentions"><i class="fa fa-check"></i><b>11.1</b> Paved with good intentions</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#definition-of-p-value."><i class="fa fa-check"></i><b>11.1.1</b> Definition of <span class="math inline">\(p\)</span> value.</a></li>
<li class="chapter" data-level="11.1.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-n."><i class="fa fa-check"></i><b>11.1.2</b> With intention to fix <span class="math inline">\(N\)</span>.</a></li>
<li class="chapter" data-level="11.1.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-z."><i class="fa fa-check"></i><b>11.1.3</b> With intention to fix <span class="math inline">\(z\)</span>.</a></li>
<li class="chapter" data-level="11.1.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-duration."><i class="fa fa-check"></i><b>11.1.4</b> With intention to fix duration.</a></li>
<li class="chapter" data-level="11.1.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-make-multiple-tests."><i class="fa fa-check"></i><b>11.1.5</b> With intention to make multiple tests.</a></li>
<li class="chapter" data-level="11.1.6" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#soul-searching."><i class="fa fa-check"></i><b>11.1.6</b> Soul searching.</a></li>
<li class="chapter" data-level="11.1.7" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis."><i class="fa fa-check"></i><b>11.1.7</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#prior-knowledge"><i class="fa fa-check"></i><b>11.2</b> Prior knowledge</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-analysis."><i class="fa fa-check"></i><b>11.2.1</b> NHST analysis.</a></li>
<li class="chapter" data-level="11.2.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis.-1"><i class="fa fa-check"></i><b>11.2.2</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#confidence-interval-and-highest-density-interval"><i class="fa fa-check"></i><b>11.3</b> Confidence interval and highest density interval</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#ci-depends-on-intention."><i class="fa fa-check"></i><b>11.3.1</b> CI depends on intention.</a></li>
<li class="chapter" data-level="11.3.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-hdi."><i class="fa fa-check"></i><b>11.3.2</b> Bayesian HDI.</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#multiple-comparisons"><i class="fa fa-check"></i><b>11.4</b> Multiple comparisons</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-correction-for-experiment-wise-error."><i class="fa fa-check"></i><b>11.4.1</b> NHST correction for experiment wise error.</a></li>
<li class="chapter" data-level="11.4.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#just-one-bayesian-posterior-no-matter-how-you-look-at-it."><i class="fa fa-check"></i><b>11.4.2</b> Just one Bayesian posterior no matter how you look at it.</a></li>
<li class="chapter" data-level="11.4.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#how-bayesian-analysis-mitigates-false-alarms."><i class="fa fa-check"></i><b>11.4.3</b> How Bayesian analysis mitigates false alarms.</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#what-a-sampling-distribution-is-good-for"><i class="fa fa-check"></i><b>11.5</b> What a sampling distribution is good for</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#planning-an-experiment."><i class="fa fa-check"></i><b>11.5.1</b> Planning an experiment.</a></li>
<li class="chapter" data-level="11.5.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#exploring-model-predictions-posterior-predictive-check."><i class="fa fa-check"></i><b>11.5.2</b> Exploring model predictions (posterior predictive check).</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#session-info-10"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#footnote-3"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><i class="fa fa-check"></i><b>12</b> Bayesian Approaches to Testing a Point (“Null”) Hypothesis</a>
<ul>
<li class="chapter" data-level="12.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-estimation-approach"><i class="fa fa-check"></i><b>12.1</b> The estimation approach</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#region-of-practical-equivalence."><i class="fa fa-check"></i><b>12.1.1</b> Region of practical equivalence.</a></li>
<li class="chapter" data-level="12.1.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#some-examples."><i class="fa fa-check"></i><b>12.1.2</b> Some examples.</a></li>
<li class="chapter" data-level="12.1.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#differences-of-correlated-parameters."><i class="fa fa-check"></i><b>12.1.3</b> Differences of correlated parameters.</a></li>
<li class="chapter" data-level="12.1.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#why-hdi-and-not-equal-tailed-interval"><i class="fa fa-check"></i><b>12.1.4</b> Why HDI and not equal-tailed interval?</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-model-comparison-approach"><i class="fa fa-check"></i><b>12.2</b> The model-comparison approach</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#is-a-coin-fair-or-not"><i class="fa fa-check"></i><b>12.2.1</b> Is a coin fair or not?</a></li>
<li class="chapter" data-level="12.2.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#bayes-factor-can-accept-null-with-poor-precision."><i class="fa fa-check"></i><b>12.2.2</b> Bayes’ factor can accept null with poor precision.</a></li>
<li class="chapter" data-level="12.2.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#are-different-groups-equal-or-not"><i class="fa fa-check"></i><b>12.2.3</b> Are different groups equal or not?</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#relations-of-parameter-estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.3</b> Relations of parameter estimation and model comparison</a></li>
<li class="chapter" data-level="12.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.4</b> Estimation and model comparison?</a></li>
<li class="chapter" data-level="" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#session-info-11"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html"><i class="fa fa-check"></i><b>13</b> Goals, Power, and Sample Size</a>
<ul>
<li class="chapter" data-level="13.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-will-to-power"><i class="fa fa-check"></i><b>13.1</b> The will to power</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#goals-and-obstacles."><i class="fa fa-check"></i><b>13.1.1</b> Goals and obstacles.</a></li>
<li class="chapter" data-level="13.1.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power."><i class="fa fa-check"></i><b>13.1.2</b> Power.</a></li>
<li class="chapter" data-level="13.1.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sample-size."><i class="fa fa-check"></i><b>13.1.3</b> Sample size.</a></li>
<li class="chapter" data-level="13.1.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#other-expressions-of-goals."><i class="fa fa-check"></i><b>13.1.4</b> Other expressions of goals.</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#computing-power-and-sample-size"><i class="fa fa-check"></i><b>13.2</b> Computing power and sample size</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-to-exclude-a-null-value."><i class="fa fa-check"></i><b>13.2.1</b> When the goal is to exclude a null value.</a></li>
<li class="chapter" data-level="13.2.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#formal-solution-and-implementation-in-r."><i class="fa fa-check"></i><b>13.2.2</b> Formal solution and implementation in R.</a></li>
<li class="chapter" data-level="13.2.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-precision."><i class="fa fa-check"></i><b>13.2.3</b> When the goal is precision.</a></li>
<li class="chapter" data-level="13.2.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#monte-carlo-approximation-of-power."><i class="fa fa-check"></i><b>13.2.4</b> Monte Carlo approximation of power.</a></li>
<li class="chapter" data-level="13.2.5" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-from-idealized-or-actual-data."><i class="fa fa-check"></i><b>13.2.5</b> Power from idealized or actual data.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sequential-testing-and-the-goal-of-precision"><i class="fa fa-check"></i><b>13.3</b> Sequential testing and the goal of precision</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#examples-of-sequential-tests."><i class="fa fa-check"></i><b>13.3.1</b> Examples of sequential tests.</a></li>
<li class="chapter" data-level="13.3.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#average-behavior-of-sequential-tests."><i class="fa fa-check"></i><b>13.3.2</b> Average behavior of sequential tests.</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#discussion"><i class="fa fa-check"></i><b>13.4</b> Discussion</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-and-multiple-comparisons."><i class="fa fa-check"></i><b>13.4.1</b> Power and multiple comparisons.</a></li>
<li class="chapter" data-level="13.4.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-prospective-retrospective-and-replication."><i class="fa fa-check"></i><b>13.4.2</b> Power: prospective, retrospective, and replication.</a></li>
<li class="chapter" data-level="13.4.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-analysis-requires-verisimilitude-of-simulated-data."><i class="fa fa-check"></i><b>13.4.3</b> Power analysis requires verisimilitude of simulated data.</a></li>
<li class="chapter" data-level="13.4.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-importance-of-planning."><i class="fa fa-check"></i><b>13.4.4</b> The importance of planning.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#session-info-12"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="stan.html"><a href="stan.html"><i class="fa fa-check"></i><b>14</b> Stan</a>
<ul>
<li class="chapter" data-level="14.1" data-path="stan.html"><a href="stan.html#hmc-sampling"><i class="fa fa-check"></i><b>14.1</b> HMC sampling</a></li>
<li class="chapter" data-level="14.2" data-path="stan.html"><a href="stan.html#installing-stan"><i class="fa fa-check"></i><b>14.2</b> Installing Stan</a></li>
<li class="chapter" data-level="14.3" data-path="stan.html"><a href="stan.html#a-complete-example-1"><i class="fa fa-check"></i><b>14.3</b> A Complete example</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="stan.html"><a href="stan.html#reusing-the-compiled-model."><i class="fa fa-check"></i><b>14.3.1</b> Reusing the compiled model.</a></li>
<li class="chapter" data-level="14.3.2" data-path="stan.html"><a href="stan.html#general-structure-of-stan-model-specification."><i class="fa fa-check"></i><b>14.3.2</b> General structure of Stan model specification.</a></li>
<li class="chapter" data-level="14.3.3" data-path="stan.html"><a href="stan.html#think-log-probability-to-think-like-stan."><i class="fa fa-check"></i><b>14.3.3</b> Think log probability to think like Stan.</a></li>
<li class="chapter" data-level="14.3.4" data-path="stan.html"><a href="stan.html#sampling-the-prior-in-stan."><i class="fa fa-check"></i><b>14.3.4</b> Sampling the prior in Stan.</a></li>
<li class="chapter" data-level="14.3.5" data-path="stan.html"><a href="stan.html#simplified-scripts-for-frequently-used-analyses."><i class="fa fa-check"></i><b>14.3.5</b> Simplified scripts for frequently used analyses.</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="stan.html"><a href="stan.html#specify-models-top-down-in-stan"><i class="fa fa-check"></i><b>14.4</b> Specify models top-down in Stan</a></li>
<li class="chapter" data-level="14.5" data-path="stan.html"><a href="stan.html#limitations-and-extras"><i class="fa fa-check"></i><b>14.5</b> Limitations and extras</a></li>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#session-info-13"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>15</b> Overview of the Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="15.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#types-of-variables"><i class="fa fa-check"></i><b>15.1</b> Types of variables</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#predictor-and-predicted-variables."><i class="fa fa-check"></i><b>15.1.1</b> Predictor and predicted variables.</a></li>
<li class="chapter" data-level="15.1.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#scale-types-metric-ordinal-nominal-and-count."><i class="fa fa-check"></i><b>15.1.2</b> Scale types: metric, ordinal, nominal, and count.</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-combination-of-predictors"><i class="fa fa-check"></i><b>15.2</b> Linear combination of predictors</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-function-of-a-single-metric-predictor."><i class="fa fa-check"></i><b>15.2.1</b> Linear function of a single metric predictor.</a></li>
<li class="chapter" data-level="15.2.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#additive-combination-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.2</b> Additive combination of metric predictors.</a></li>
<li class="chapter" data-level="15.2.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nonadditive-interaction-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.3</b> Nonadditive interaction of metric predictors.</a></li>
<li class="chapter" data-level="15.2.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nominal-predictors."><i class="fa fa-check"></i><b>15.2.4</b> Nominal predictors.</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linking-from-combined-predictors-to-noisy-predicted-data"><i class="fa fa-check"></i><b>15.3</b> Linking from combined predictors to noisy predicted data</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predictors-to-predicted-central-tendency."><i class="fa fa-check"></i><b>15.3.1</b> From predictors to predicted central tendency.</a></li>
<li class="chapter" data-level="15.3.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predicted-central-tendency-to-noisy-data."><i class="fa fa-check"></i><b>15.3.2</b> From predicted central tendency to noisy data.</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#formal-expression-of-the-glm"><i class="fa fa-check"></i><b>15.4</b> Formal expression of the GLM</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#cases-of-the-glm."><i class="fa fa-check"></i><b>15.4.1</b> Cases of the GLM.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#session-info-14"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html"><i class="fa fa-check"></i><b>16</b> Metric-Predicted Variable on One or Two Groups</a>
<ul>
<li class="chapter" data-level="16.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#estimating-the-mean-and-standard-deviation-of-a-normal-distribution"><i class="fa fa-check"></i><b>16.1</b> Estimating the mean and standard deviation of a normal distribution</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#solution-by-mathematical-analysis-heads-up-on-precision."><i class="fa fa-check"></i><b>16.1.1</b> <del>Solution by mathematical analysis</del> Heads up on precision.</a></li>
<li class="chapter" data-level="16.1.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#approximation-by-mcmc-in-jags-hmc-in-brms."><i class="fa fa-check"></i><b>16.1.2</b> Approximation by <del>MCMC in JAGS</del> HMC in brms.</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#outliers-and-robust-estimation-the-t-distribution"><i class="fa fa-check"></i><b>16.2</b> Outliers and robust estimation: The <span class="math inline">\(t\)</span> distribution</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-jags-brms."><i class="fa fa-check"></i><b>16.2.1</b> Using the <span class="math inline">\(t\)</span> distribution in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="16.2.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-stan."><i class="fa fa-check"></i><b>16.2.2</b> Using the <span class="math inline">\(t\)</span> distribution in Stan.</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#two-groups"><i class="fa fa-check"></i><b>16.3</b> Two groups</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#analysis-by-nhst."><i class="fa fa-check"></i><b>16.3.1</b> Analysis by NHST.</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#other-noise-distributions-and-transforming-data"><i class="fa fa-check"></i><b>16.4</b> Other noise distributions and transforming data</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#session-info-15"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html"><i class="fa fa-check"></i><b>17</b> Metric Predicted Variable with One Metric Predictor</a>
<ul>
<li class="chapter" data-level="17.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#simple-linear-regression"><i class="fa fa-check"></i><b>17.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="17.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression"><i class="fa fa-check"></i><b>17.2</b> Robust linear regression</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-jags-brms."><i class="fa fa-check"></i><b>17.2.1</b> Robust linear regression in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.2.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-stan."><i class="fa fa-check"></i><b>17.2.2</b> Robust linear regression in Stan.</a></li>
<li class="chapter" data-level="17.2.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#stan-or-jags"><i class="fa fa-check"></i><b>17.2.3</b> Stan or JAGS?</a></li>
<li class="chapter" data-level="17.2.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#interpreting-the-posterior-distribution."><i class="fa fa-check"></i><b>17.2.4</b> Interpreting the posterior distribution.</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#hierarchical-regression-on-individuals-within-groups"><i class="fa fa-check"></i><b>17.3</b> Hierarchical regression on individuals within groups</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>17.3.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.3.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-posterior-distribution-shrinkage-and-prediction."><i class="fa fa-check"></i><b>17.3.2</b> The posterior distribution: Shrinkage and prediction.</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#quadratic-trend-and-weighted-data"><i class="fa fa-check"></i><b>17.4</b> Quadratic trend and weighted data</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#results-and-interpretation."><i class="fa fa-check"></i><b>17.4.1</b> Results and interpretation.</a></li>
<li class="chapter" data-level="17.4.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#further-extensions."><i class="fa fa-check"></i><b>17.4.2</b> Further extensions.</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#procedure-and-perils-for-expanding-a-model"><i class="fa fa-check"></i><b>17.5</b> Procedure and perils for expanding a model</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#session-info-16"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html"><i class="fa fa-check"></i><b>18</b> Metric Predicted Variable with Multiple Metric Predictors</a>
<ul>
<li class="chapter" data-level="18.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiple-linear-regression"><i class="fa fa-check"></i><b>18.1</b> Multiple linear regression</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-perils-of-correlated-predictors."><i class="fa fa-check"></i><b>18.1.1</b> The perils of correlated predictors.</a></li>
<li class="chapter" data-level="18.1.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-model-and-implementation."><i class="fa fa-check"></i><b>18.1.2</b> The model and implementation.</a></li>
<li class="chapter" data-level="18.1.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-posterior-distribution."><i class="fa fa-check"></i><b>18.1.3</b> The posterior distribution.</a></li>
<li class="chapter" data-level="18.1.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#redundant-predictors."><i class="fa fa-check"></i><b>18.1.4</b> Redundant predictors.</a></li>
<li class="chapter" data-level="18.1.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#informative-priors-sparse-data-and-correlated-predictors."><i class="fa fa-check"></i><b>18.1.5</b> Informative priors, sparse data, and correlated predictors.</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiplicative-interaction-of-metric-predictors"><i class="fa fa-check"></i><b>18.2</b> Multiplicative interaction of metric predictors</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#an-example."><i class="fa fa-check"></i><b>18.2.1</b> An example.</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#shrinkage-of-regression-coefficients"><i class="fa fa-check"></i><b>18.3</b> Shrinkage of regression coefficients</a></li>
<li class="chapter" data-level="18.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection"><i class="fa fa-check"></i><b>18.4</b> Variable selection</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#inclusion-probability-is-strongly-affected-by-vagueness-of-prior."><i class="fa fa-check"></i><b>18.4.1</b> Inclusion probability is strongly affected by vagueness of prior.</a></li>
<li class="chapter" data-level="18.4.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection-with-hierarchical-shrinkage."><i class="fa fa-check"></i><b>18.4.2</b> Variable selection with hierarchical shrinkage.</a></li>
<li class="chapter" data-level="18.4.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#what-to-report-and-what-to-conclude."><i class="fa fa-check"></i><b>18.4.3</b> What to report and what to conclude.</a></li>
<li class="chapter" data-level="18.4.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-computational-methods."><i class="fa fa-check"></i><b>18.4.4</b> Caution: Computational methods.</a></li>
<li class="chapter" data-level="18.4.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-interaction-variables."><i class="fa fa-check"></i><b>18.4.5</b> Caution: Interaction variables.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#session-info-17"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#footnote-4"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html"><i class="fa fa-check"></i><b>19</b> Metric Predicted Variable with One Nominal Predictor</a>
<ul>
<li class="chapter" data-level="19.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#describing-multiple-groups-of-metric-data"><i class="fa fa-check"></i><b>19.1</b> Describing multiple groups of metric data</a></li>
<li class="chapter" data-level="19.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#traditional-analysis-of-variance"><i class="fa fa-check"></i><b>19.2</b> Traditional analysis of variance</a></li>
<li class="chapter" data-level="19.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#hierarchical-bayesian-approach"><i class="fa fa-check"></i><b>19.3</b> Hierarchical Bayesian approach</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#implementation-in-jags-brms."><i class="fa fa-check"></i><b>19.3.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="19.3.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-and-death."><i class="fa fa-check"></i><b>19.3.2</b> Example: Sex and death.</a></li>
<li class="chapter" data-level="19.3.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#contrasts."><i class="fa fa-check"></i><b>19.3.3</b> Contrasts.</a></li>
<li class="chapter" data-level="19.3.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#multiple-comparisons-and-shrinkage."><i class="fa fa-check"></i><b>19.3.4</b> Multiple comparisons and shrinkage.</a></li>
<li class="chapter" data-level="19.3.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#the-two-group-case."><i class="fa fa-check"></i><b>19.3.5</b> The two-group case.</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#including-a-metric-predictor"><i class="fa fa-check"></i><b>19.4</b> Including a metric predictor</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-death-and-size."><i class="fa fa-check"></i><b>19.4.1</b> Example: Sex, death, and size.</a></li>
<li class="chapter" data-level="19.4.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#analogous-to-traditional-ancova."><i class="fa fa-check"></i><b>19.4.2</b> Analogous to traditional ANCOVA.</a></li>
<li class="chapter" data-level="19.4.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#relation-to-hierarchical-linear-regression."><i class="fa fa-check"></i><b>19.4.3</b> Relation to hierarchical linear regression.</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#heterogeneous-variances-and-robustness-against-outliers"><i class="fa fa-check"></i><b>19.5</b> Heterogeneous variances and robustness against outliers</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-contrast-of-means-with-different-variances."><i class="fa fa-check"></i><b>19.5.1</b> Example: Contrast of means with different variances.</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#exercises-walk-out-an-effect-size"><i class="fa fa-check"></i><b>19.6</b> <del>Exercises</del> Walk out an effect size</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#your-sample-sizes-may-differ."><i class="fa fa-check"></i><b>19.6.1</b> Your sample sizes may differ.</a></li>
<li class="chapter" data-level="19.6.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#populations-and-samples."><i class="fa fa-check"></i><b>19.6.2</b> Populations and samples.</a></li>
<li class="chapter" data-level="19.6.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#report-your-effect-sizes-effectively."><i class="fa fa-check"></i><b>19.6.3</b> Report your effect sizes effectively.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#session-info-18"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html"><i class="fa fa-check"></i><b>20</b> Metric Predicted Variable with Multiple Nominal Predictors</a>
<ul>
<li class="chapter" data-level="20.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#describing-groups-of-metric-data-with-multiple-nominal-predictors"><i class="fa fa-check"></i><b>20.1</b> Describing groups of metric data with multiple nominal predictors</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction."><i class="fa fa-check"></i><b>20.1.1</b> Interaction.</a></li>
<li class="chapter" data-level="20.1.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#traditional-anova."><i class="fa fa-check"></i><b>20.1.2</b> Traditional ANOVA.</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#hierarchical-bayesian-approach-1"><i class="fa fa-check"></i><b>20.2</b> Hierarchical Bayesian approach</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>20.2.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="20.2.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#example-its-only-money."><i class="fa fa-check"></i><b>20.2.2</b> Example: It’s only money.</a></li>
<li class="chapter" data-level="20.2.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#main-effect-contrasts."><i class="fa fa-check"></i><b>20.2.3</b> Main effect contrasts.</a></li>
<li class="chapter" data-level="20.2.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction-contrasts-and-simple-effects."><i class="fa fa-check"></i><b>20.2.4</b> Interaction contrasts and simple effects.</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#rescaling-can-change-interactions-homogeneity-and-normality"><i class="fa fa-check"></i><b>20.3</b> Rescaling can change interactions, homogeneity, and normality</a></li>
<li class="chapter" data-level="20.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#heterogeneous-variances-and-robustness-against-outliers-1"><i class="fa fa-check"></i><b>20.4</b> Heterogeneous variances and robustness against outliers</a></li>
<li class="chapter" data-level="20.5" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#within-subject-designs"><i class="fa fa-check"></i><b>20.5</b> Within-subject designs</a>
<ul>
<li class="chapter" data-level="20.5.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#why-use-a-within-subject-design-and-why-not"><i class="fa fa-check"></i><b>20.5.1</b> Why use a within-subject design? And why not?</a></li>
<li class="chapter" data-level="20.5.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#split-plot-design."><i class="fa fa-check"></i><b>20.5.2</b> Split-plot design.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#session-info-19"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#footnote-5"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html"><i class="fa fa-check"></i><b>21</b> Dichotomous Predicted Variable</a>
<ul>
<li class="chapter" data-level="21.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-metric-predictors"><i class="fa fa-check"></i><b>21.1</b> Multiple metric predictors</a>
<ul>
<li class="chapter" data-level="21.1.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#the-model-and-implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>21.1.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="21.1.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#example-height-weight-and-gender."><i class="fa fa-check"></i><b>21.1.2</b> Example: Height, weight, and gender.</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interpreting-the-regression-coefficients"><i class="fa fa-check"></i><b>21.2</b> Interpreting the regression coefficients</a>
<ul>
<li class="chapter" data-level="21.2.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#log-odds."><i class="fa fa-check"></i><b>21.2.1</b> Log odds.</a></li>
<li class="chapter" data-level="21.2.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#when-there-are-few-1s-or-0s-in-the-data."><i class="fa fa-check"></i><b>21.2.2</b> When there are few 1’s or 0’s in the data.</a></li>
<li class="chapter" data-level="21.2.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#correlated-predictors."><i class="fa fa-check"></i><b>21.2.3</b> Correlated predictors.</a></li>
<li class="chapter" data-level="21.2.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interaction-of-metric-predictors."><i class="fa fa-check"></i><b>21.2.4</b> Interaction of metric predictors.</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#robust-logistic-regression"><i class="fa fa-check"></i><b>21.3</b> Robust logistic regression</a></li>
<li class="chapter" data-level="21.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#nominal-predictors"><i class="fa fa-check"></i><b>21.4</b> Nominal predictors</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#single-group."><i class="fa fa-check"></i><b>21.4.1</b> Single group.</a></li>
<li class="chapter" data-level="21.4.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-groups."><i class="fa fa-check"></i><b>21.4.2</b> Multiple groups.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#session-info-20"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html"><i class="fa fa-check"></i><b>22</b> Nominal Predicted Variable</a>
<ul>
<li class="chapter" data-level="22.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-regression"><i class="fa fa-check"></i><b>22.1</b> Softmax regression</a>
<ul>
<li class="chapter" data-level="22.1.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-reduces-to-logistic-for-two-outcomes."><i class="fa fa-check"></i><b>22.1.1</b> Softmax reduces to logistic for two outcomes.</a></li>
<li class="chapter" data-level="22.1.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#independence-from-irrelevant-attributes."><i class="fa fa-check"></i><b>22.1.2</b> Independence from irrelevant attributes.</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#conditional-logistic-regression"><i class="fa fa-check"></i><b>22.2</b> Conditional logistic regression</a></li>
<li class="chapter" data-level="22.3" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#implementation-in-jags-brms"><i class="fa fa-check"></i><b>22.3</b> Implementation in <del>JAGS</del> brms</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-model."><i class="fa fa-check"></i><b>22.3.1</b> Softmax model.</a></li>
<li class="chapter" data-level="22.3.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#conditional-logistic-model."><i class="fa fa-check"></i><b>22.3.2</b> Conditional logistic model.</a></li>
<li class="chapter" data-level="22.3.3" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#results-interpreting-the-regression-coefficients."><i class="fa fa-check"></i><b>22.3.3</b> Results: Interpreting the regression coefficients.</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#generalizations-and-variations-of-the-models"><i class="fa fa-check"></i><b>22.4</b> Generalizations and variations of the models</a></li>
<li class="chapter" data-level="" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#session-info-21"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html"><i class="fa fa-check"></i><b>23</b> Ordinal Predicted Variable</a>
<ul>
<li class="chapter" data-level="23.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#modeling-ordinal-data-with-an-underlying-metric-variable"><i class="fa fa-check"></i><b>23.1</b> Modeling ordinal data with an underlying metric variable</a></li>
<li class="chapter" data-level="23.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-a-single-group"><i class="fa fa-check"></i><b>23.2</b> The case of a single group</a>
<ul>
<li class="chapter" data-level="23.2.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-3"><i class="fa fa-check"></i><b>23.2.1</b> Implementation in <del>JAGS</del> <strong>brms</strong>.</a></li>
<li class="chapter" data-level="23.2.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#examples-bayesian-estimation-recovers-true-parameter-values."><i class="fa fa-check"></i><b>23.2.2</b> Examples: Bayesian estimation recovers true parameter values.</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-two-groups"><i class="fa fa-check"></i><b>23.3</b> The case of two groups</a>
<ul>
<li class="chapter" data-level="23.3.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-4"><i class="fa fa-check"></i><b>23.3.1</b> Implementation in <del>JAGS</del> <strong>brms</strong>.</a></li>
<li class="chapter" data-level="23.3.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#examples-not-funny."><i class="fa fa-check"></i><b>23.3.2</b> Examples: Not funny.</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-metric-predictors"><i class="fa fa-check"></i><b>23.4</b> The Case of metric predictors</a>
<ul>
<li class="chapter" data-level="23.4.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-5"><i class="fa fa-check"></i><b>23.4.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="23.4.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#example-happiness-and-money."><i class="fa fa-check"></i><b>23.4.2</b> Example: Happiness and money.</a></li>
<li class="chapter" data-level="23.4.3" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#example-moviesthey-dont-make-em-like-they-used-to."><i class="fa fa-check"></i><b>23.4.3</b> Example: Movies–They don’t make ’em like they used to.</a></li>
<li class="chapter" data-level="23.4.4" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#why-are-some-thresholds-outside-the-data"><i class="fa fa-check"></i><b>23.4.4</b> Why are some thresholds outside the data?</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#posterior-prediction"><i class="fa fa-check"></i><b>23.5</b> Posterior prediction</a></li>
<li class="chapter" data-level="23.6" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#generalizations-and-extensions"><i class="fa fa-check"></i><b>23.6</b> Generalizations and extensions</a></li>
<li class="chapter" data-level="" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#session-info-22"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html"><i class="fa fa-check"></i><b>24</b> Count Predicted Variable</a>
<ul>
<li class="chapter" data-level="24.1" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#poisson-exponential-model"><i class="fa fa-check"></i><b>24.1</b> Poisson exponential model</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#data-structure."><i class="fa fa-check"></i><b>24.1.1</b> Data structure.</a></li>
<li class="chapter" data-level="24.1.2" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#exponential-link-function."><i class="fa fa-check"></i><b>24.1.2</b> Exponential link function.</a></li>
<li class="chapter" data-level="24.1.3" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#poisson-noise-distribution."><i class="fa fa-check"></i><b>24.1.3</b> Poisson noise distribution.</a></li>
<li class="chapter" data-level="24.1.4" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#the-complete-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>24.1.4</b> The complete model and implementation in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#example-hair-eye-go-again"><i class="fa fa-check"></i><b>24.2</b> Example: Hair eye go again</a></li>
<li class="chapter" data-level="24.3" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#example-interaction-contrasts-shrinkage-and-omnibus-test"><i class="fa fa-check"></i><b>24.3</b> Example: Interaction contrasts, shrinkage, and omnibus test</a></li>
<li class="chapter" data-level="24.4" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#log-linear-models-for-contingency-tables-bonus-alternative-parameterization"><i class="fa fa-check"></i><b>24.4</b> <del>Log-linear models for contingency tables</del> Bonus: Alternative parameterization</a></li>
<li class="chapter" data-level="" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#session-info-23"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html"><i class="fa fa-check"></i><b>25</b> Tools in the Trunk</a>
<ul>
<li class="chapter" data-level="25.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reporting-a-bayesian-analysis"><i class="fa fa-check"></i><b>25.1</b> Reporting a Bayesian analysis</a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#essential-points."><i class="fa fa-check"></i><b>25.1.1</b> Essential points.</a></li>
<li class="chapter" data-level="25.1.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#optional-points."><i class="fa fa-check"></i><b>25.1.2</b> Optional points.</a></li>
<li class="chapter" data-level="25.1.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#helpful-points."><i class="fa fa-check"></i><b>25.1.3</b> Helpful points.</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#functions-for-computing-highest-density-intervals"><i class="fa fa-check"></i><b>25.2</b> Functions for computing highest density intervals</a>
<ul>
<li class="chapter" data-level="25.2.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-grid-approximation."><i class="fa fa-check"></i><b>25.2.1</b> R code for computing HDI of a grid approximation.</a></li>
<li class="chapter" data-level="25.2.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#hdi-of-unimodal-distribution-is-shortest-interval."><i class="fa fa-check"></i><b>25.2.2</b> HDI of unimodal distribution is shortest interval.</a></li>
<li class="chapter" data-level="25.2.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-mcmc-sample."><i class="fa fa-check"></i><b>25.2.3</b> R code for computing HDI of a MCMC sample.</a></li>
<li class="chapter" data-level="25.2.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-function."><i class="fa fa-check"></i><b>25.2.4</b> R code for computing HDI of a function.</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reparameterization"><i class="fa fa-check"></i><b>25.3</b> Reparameterization</a></li>
<li class="chapter" data-level="25.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#censored-data-in-jags-brms"><i class="fa fa-check"></i><b>25.4</b> Censored data in <del>JAGS</del> brms</a>
<ul>
<li class="chapter" data-level="25.4.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#right-censoring-when-youre-uncertain-beyond-a-single-threshold."><i class="fa fa-check"></i><b>25.4.1</b> Right censoring: When you’re uncertain beyond a single threshold.</a></li>
<li class="chapter" data-level="25.4.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#interval-censoring-when-your-values-are-somewhere-in-the-middle."><i class="fa fa-check"></i><b>25.4.2</b> Interval censoring: When your values are somewhere in the middle.</a></li>
<li class="chapter" data-level="25.4.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#complex-censoring-when-the-going-gets-tough"><i class="fa fa-check"></i><b>25.4.3</b> Complex censoring: When the going gets tough…</a></li>
<li class="chapter" data-level="25.4.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#bonus-truncation."><i class="fa fa-check"></i><b>25.4.4</b> Bonus: Truncation.</a></li>
</ul></li>
<li class="chapter" data-level="25.5" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#what-next"><i class="fa fa-check"></i><b>25.5</b> What Next?</a></li>
<li class="chapter" data-level="" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#session-info-24"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Doing Bayesian Data Analysis</em> in brms and the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tools-in-the-trunk" class="section level1" number="25">
<h1><span class="header-section-number">25</span> Tools in the Trunk</h1>
<p>“This chapter includes some important topics that apply to many different models throughout the book… The sections can be read independently of each other and at any time” <span class="citation">(<a href="references.html#ref-kruschkeDoingBayesianData2015" role="doc-biblioref">Kruschke, 2015, p. 721</a>)</span>.</p>
<div id="reporting-a-bayesian-analysis" class="section level2" number="25.1">
<h2><span class="header-section-number">25.1</span> Reporting a Bayesian analysis</h2>
<blockquote>
<p>Bayesian data analyses are not yet standard procedure in many fields of research, and no conventional format for reporting them has been established. Therefore, the researcher who reports a Bayesian analysis must be sensitive to the background knowledge of his or her specific audience, and must frame the description accordingly. (p. 721)</p>
</blockquote>
<p>At the time of this writing (early 2020), this is still the case. See <span class="citation"><a href="references.html#ref-aczelDiscussionPointsBayesian2020" role="doc-biblioref">Aczel et al.</a> (<a href="references.html#ref-aczelDiscussionPointsBayesian2020" role="doc-biblioref">2020</a>)</span>, <a href="https://www.researchgate.net/publication/338849264_Discussion_points_for_Bayesian_inference"><em>Discussion points for Bayesian inference</em></a>, for a recent discussion from several Bayesian scholars.</p>
<div id="essential-points." class="section level3" number="25.1.1">
<h3><span class="header-section-number">25.1.1</span> Essential points.</h3>
<blockquote>
<p>Recall the basic steps of a Bayesian analysis from <a href="introduction-credibility-models-and-parameters.html#the-steps-of-bayesian-data-analysis">Section 2.3</a> (p. 25): Identify the data, define a descriptive model, specify a prior, compute the posterior distribution, interpret the posterior distribution, and, check that the model is a reasonable description of the data. Those steps are in logical order, with each step building on the previous step. That logical order should be preserved in the report of the analysis. (p. 722)</p>
</blockquote>
<p>Kruschke then gave recommendations for motivating Bayesian inference. His <span class="citation">(<a href="references.html#ref-kruschkeBayesianNewStatistics2018" role="doc-biblioref">2018</a>)</span> paper with Liddell, <a href="https://link.springer.com/content/pdf/10.3758/s13423-016-1221-4.pdf"><em>The Bayesian New Statistics: Hypothesis testing, estimation, meta-analysis, and power analysis from a Bayesian perspective</em></a>, might be helpful in this regard. Many of the other points Kruschke made in this section (e.g., adequately reporting the data structure, the priors, evidence for convergence) can be handled by adopting open science practices.</p>
<p>If your data and research questions are simple and straightforward, you might find it easy to detail these and other concerns in the primary manuscript. The harsh reality is many journals place tight constraints on word and/or page limits. If your projects are not of the simple and straightforward type, supplemental materials are your friend. Regardless of a journal’s policy on hosting supplemental materials on the official journal website, you can detail your data, priors, MCMC diagnostics, and all the other fine-grained details of your analysis in supplemental documents hosted in publicly-accessible repositories like the <a href="https://osf.io/">Open Science Framework (OSF)</a>. If possible, do consider making your data openly available. Regardless of the status of your data, please consider making all your <strong>R</strong> scripts available as supplementary material. To reiterate from Chapter 3, I strongly recommend checking out <a href="https://bookdown.org/yihui/rmarkdown/notebook.html">R Notebooks</a> for that purpose. They are a type of R Markdown document with augmentations that make them more useful for working scientists. You can learn more about them <a href="https://rstudio-pubs-static.s3.amazonaws.com/256225_63ebef4029dd40ef8e3679f6cf200a5a.html">here</a> and <a href="https://www.r-bloggers.com/why-i-love-r-notebooks-2/">here</a>. And for a more comprehensive overview, check out Xie, Allaire, and Grolemund’s <span class="citation">(<a href="references.html#ref-xieMarkdownDefinitiveGuide2020" role="doc-biblioref">2020</a>)</span> <a href="https://bookdown.org/yihui/rmarkdown/"><em>R markdown: The definitive guide</em></a>.</p>
</div>
<div id="optional-points." class="section level3" number="25.1.2">
<h3><span class="header-section-number">25.1.2</span> Optional points.</h3>
<p>For more thoughts on robustness checks, check out a couple Gelman’s blog posts, <a href="https://statmodeling.stat.columbia.edu/2017/11/29/whats-point-robustness-check/"><em>What’s the point of a robustness check?</em></a> and <a href="https://statmodeling.stat.columbia.edu/2018/11/14/robustness-checks-joke/"><em>Robustness checks are a joke</em></a>, along with the action in the comments section.</p>
<p>In addition to posterior predictive checks, which are great <span class="citation">(see <a href="references.html#ref-kruschkePosteriorPredictiveChecks2013" role="doc-biblioref">Kruschke, 2013</a>)</span>, consider prior predictive checks, too. For a great introduction to the topic, check out Gabry, Simpson, Vehtari, Betancourt, and Gelman’s <span class="citation">(<a href="references.html#ref-gabry2019visualization" role="doc-biblioref">2019</a>)</span> <a href="https://rss.onlinelibrary.wiley.com/doi/pdf/10.1111/rssa.12378"><em>Visualization in Bayesian workflow</em></a>.</p>
</div>
<div id="helpful-points." class="section level3" number="25.1.3">
<h3><span class="header-section-number">25.1.3</span> Helpful points.</h3>
<p>For more ideas on open data, check out Rouder’s <span class="citation">(<a href="references.html#ref-rouderWhatWhyHow2016" role="doc-biblioref">2016</a>)</span> <a href="https://link.springer.com/article/10.3758/s13428-015-0630-z"><em>The what, why, and how of born-open data</em></a>. You might also check out Klein and colleagues’ <span class="citation">(<a href="references.html#ref-kleinPracticalGuideTransparency2018" role="doc-biblioref">2018</a>)</span> <a href="https://lirias.kuleuven.be/1999530?limo=0"><em>A practical guide for transparency in psychological science</em></a> and Martone, Garcia-Castro, and VandenBos’s <span class="citation">(<a href="references.html#ref-martoneDataSharingPsychology2018" role="doc-biblioref">2018</a>)</span> <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5920518/pdf/nihms935471.pdf"><em>Data sharing in psychology</em></a>.</p>
<p>As to posting your model fits, this could be done in any number of ways, including as official supplemental materials hosted by the journal, on GitHub, or on the OSF. At a base level, this means saving your fits as external files. We’ve already been modeling this with our <code>brm()</code> code throughout this book. With the <code>save</code> argument, we saved the model fits within the <a href="https://github.com/ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse/tree/master/fits"><code>fits</code> folder on GitHub</a>. You might adopt a similar approach. But do be warned: <strong>brms</strong> fit objects contain a copy of the data used to create them. For example, here’s how we might reload <code>fit24.1</code> from last chapter.</p>
<div class="sourceCode" id="cb2446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2446-1"><a href="tools-in-the-trunk.html#cb2446-1" aria-hidden="true" tabindex="-1"></a>fit24<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;fits/fit24.01.rds&quot;</span>)</span></code></pre></div>
<p>By indexing the fit object with <code>$data</code>, you can see the data.</p>
<div class="sourceCode" id="cb2447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2447-1"><a href="tools-in-the-trunk.html#cb2447-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2447-2"><a href="tools-in-the-trunk.html#cb2447-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb2447-3"><a href="tools-in-the-trunk.html#cb2447-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2447-4"><a href="tools-in-the-trunk.html#cb2447-4" aria-hidden="true" tabindex="-1"></a>fit24<span class="fl">.1</span><span class="sc">$</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb2447-5"><a href="tools-in-the-trunk.html#cb2447-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 16
## Columns: 4
## $ Count      &lt;dbl&gt; 20, 68, 5, 15, 94, 7, 16, 10, 84, 119, 29, 54, 17, 26, 14, …
## $ Hair       &lt;fct&gt; Black, Black, Black, Black, Blond, Blond, Blond, Blond, Bru…
## $ Eye        &lt;chr&gt; &quot;Blue&quot;, &quot;Brown&quot;, &quot;Green&quot;, &quot;Hazel&quot;, &quot;Blue&quot;, &quot;Brown&quot;, &quot;Green&quot;…
## $ `Hair:Eye` &lt;chr&gt; &quot;Black_Blue&quot;, &quot;Black_Brown&quot;, &quot;Black_Green&quot;, &quot;Black_Hazel&quot;, …</code></pre>
<p>Here’s a quick way to remove the data from the fit object.</p>
<div class="sourceCode" id="cb2449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2449-1"><a href="tools-in-the-trunk.html#cb2449-1" aria-hidden="true" tabindex="-1"></a>fit24<span class="fl">.1</span><span class="sc">$</span>data <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p>Confirm it worked.</p>
<div class="sourceCode" id="cb2450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2450-1"><a href="tools-in-the-trunk.html#cb2450-1" aria-hidden="true" tabindex="-1"></a>fit24<span class="fl">.1</span><span class="sc">$</span>data</span></code></pre></div>
<pre><code>## NULL</code></pre>
<p>Happily, the rest of the information is still there for you. E.g., here’s the summary.</p>
<div class="sourceCode" id="cb2452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2452-1"><a href="tools-in-the-trunk.html#cb2452-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit24<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>##  Family: poisson 
##   Links: mu = log 
## Formula: Count ~ 1 + (1 | Hair) + (1 | Eye) + (1 | Hair:Eye) 
##    Data: NULL (Number of observations: ) 
## Samples: 4 chains, each with iter = 3000; warmup = 1000; thin = 1;
##          total post-warmup samples = 8000
## 
## Group-Level Effects: 
## ~Eye (Number of levels: 4) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)     1.29      1.47     0.13     5.16 1.00     2492     3672
## 
## ~Hair (Number of levels: 4) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)     1.36      1.37     0.20     5.04 1.00     2806     4091
## 
## ~Hair:Eye (Number of levels: 16) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)     0.89      0.25     0.52     1.49 1.00     3617     4791
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept     3.18      1.27     0.58     5.72 1.00     3800     3274
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
<div id="functions-for-computing-highest-density-intervals" class="section level2" number="25.2">
<h2><span class="header-section-number">25.2</span> Functions for computing highest density intervals</h2>
<p>You can find a copy of Kruschke’s scripts, including <code>DBDA2E-utilities.R</code>, at <a href="https://github.com/ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse/tree/master/data.R">https://github.com/ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse/tree/master/data.R</a>.</p>
<div id="r-code-for-computing-hdi-of-a-grid-approximation." class="section level3" number="25.2.1">
<h3><span class="header-section-number">25.2.1</span> R code for computing HDI of a grid approximation.</h3>
<blockquote>
<p>We can imagine the grid approximation of a distribution as a landscape of poles sticking up from each point on the parameter grid, with the height of each pole indicating the probability mass at that discrete point. We can imagine the highest density region by visualizing a rising tide: We gradually flood the landscape, monitoring the total mass of the poles that protrude above water, stopping the flood when 95% (say) of the mass remains protruding. The waterline at that moment defines the highest density region <span class="citation">(e.g., <a href="references.html#ref-hyndmanComputingGraphingHighest1996" role="doc-biblioref">Hyndman, 1996</a>)</span>. (p. 725)</p>
</blockquote>
<div class="sourceCode" id="cb2454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2454-1"><a href="tools-in-the-trunk.html#cb2454-1" aria-hidden="true" tabindex="-1"></a>HDIofGrid <span class="ot">&lt;-</span> <span class="cf">function</span>(probMassVec, <span class="at">credMass =</span> <span class="fl">0.95</span>) {</span>
<span id="cb2454-2"><a href="tools-in-the-trunk.html#cb2454-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2454-3"><a href="tools-in-the-trunk.html#cb2454-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arguments:</span></span>
<span id="cb2454-4"><a href="tools-in-the-trunk.html#cb2454-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   probMassVec is a vector of probability masses at each grid point.</span></span>
<span id="cb2454-5"><a href="tools-in-the-trunk.html#cb2454-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   credMass is the desired mass of the HDI region.</span></span>
<span id="cb2454-6"><a href="tools-in-the-trunk.html#cb2454-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return value:</span></span>
<span id="cb2454-7"><a href="tools-in-the-trunk.html#cb2454-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   A list with components:</span></span>
<span id="cb2454-8"><a href="tools-in-the-trunk.html#cb2454-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   indices is a vector of indices that are in the HDI</span></span>
<span id="cb2454-9"><a href="tools-in-the-trunk.html#cb2454-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   mass is the total mass of the included indices</span></span>
<span id="cb2454-10"><a href="tools-in-the-trunk.html#cb2454-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   height is the smallest component probability mass in the HDI</span></span>
<span id="cb2454-11"><a href="tools-in-the-trunk.html#cb2454-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Example of use: For determining HDI of a beta(30,12) distribution</span></span>
<span id="cb2454-12"><a href="tools-in-the-trunk.html#cb2454-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   approximated on a grid:</span></span>
<span id="cb2454-13"><a href="tools-in-the-trunk.html#cb2454-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   &gt; probDensityVec = dbeta( seq(0,1,length=201) , 30 , 12 )</span></span>
<span id="cb2454-14"><a href="tools-in-the-trunk.html#cb2454-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   &gt; probMassVec = probDensityVec / sum( probDensityVec )</span></span>
<span id="cb2454-15"><a href="tools-in-the-trunk.html#cb2454-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   &gt; HDIinfo = HDIofGrid( probMassVec )</span></span>
<span id="cb2454-16"><a href="tools-in-the-trunk.html#cb2454-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   &gt; show( HDIinfo )</span></span>
<span id="cb2454-17"><a href="tools-in-the-trunk.html#cb2454-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2454-18"><a href="tools-in-the-trunk.html#cb2454-18" aria-hidden="true" tabindex="-1"></a>  sortedProbMass <span class="ot">&lt;-</span> <span class="fu">sort</span>(probMassVec, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2454-19"><a href="tools-in-the-trunk.html#cb2454-19" aria-hidden="true" tabindex="-1"></a>  HDIheightIdx <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">which</span>(<span class="fu">cumsum</span>(sortedProbMass) <span class="sc">&gt;=</span> credMass))</span>
<span id="cb2454-20"><a href="tools-in-the-trunk.html#cb2454-20" aria-hidden="true" tabindex="-1"></a>  HDIheight <span class="ot">&lt;-</span> sortedProbMass[HDIheightIdx]</span>
<span id="cb2454-21"><a href="tools-in-the-trunk.html#cb2454-21" aria-hidden="true" tabindex="-1"></a>  HDImass <span class="ot">&lt;-</span> <span class="fu">sum</span>(probMassVec[probMassVec <span class="sc">&gt;=</span> HDIheight])</span>
<span id="cb2454-22"><a href="tools-in-the-trunk.html#cb2454-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2454-23"><a href="tools-in-the-trunk.html#cb2454-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">indices =</span> <span class="fu">which</span>(probMassVec <span class="sc">&gt;=</span> HDIheight),</span>
<span id="cb2454-24"><a href="tools-in-the-trunk.html#cb2454-24" aria-hidden="true" tabindex="-1"></a>              <span class="at">mass    =</span> HDImass, <span class="at">height =</span> HDIheight))</span>
<span id="cb2454-25"><a href="tools-in-the-trunk.html#cb2454-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2454-26"><a href="tools-in-the-trunk.html#cb2454-26" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>I found Kruschke’s description of his <code>HDIofGrid()</code> a bit opaque. Happily, we can understand this function with a little help from an example posted at <a href="https://rdrr.io/github/kyusque/DBDA2E-utilities/man/HDIofGrid.html">https://rdrr.io/github/kyusque/DBDA2E-utilities/man/HDIofGrid.html</a>.</p>
<div class="sourceCode" id="cb2455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2455-1"><a href="tools-in-the-trunk.html#cb2455-1" aria-hidden="true" tabindex="-1"></a>prob_density_vec <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="dv">201</span>), <span class="dv">30</span>, <span class="dv">12</span>)</span>
<span id="cb2455-2"><a href="tools-in-the-trunk.html#cb2455-2" aria-hidden="true" tabindex="-1"></a>prob_mass_vec    <span class="ot">&lt;-</span> prob_density_vec <span class="sc">/</span> <span class="fu">sum</span>(prob_density_vec)</span>
<span id="cb2455-3"><a href="tools-in-the-trunk.html#cb2455-3" aria-hidden="true" tabindex="-1"></a>HDI_info         <span class="ot">&lt;-</span> <span class="fu">HDIofGrid</span>(prob_mass_vec)</span>
<span id="cb2455-4"><a href="tools-in-the-trunk.html#cb2455-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2455-5"><a href="tools-in-the-trunk.html#cb2455-5" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>(HDI_info)</span></code></pre></div>
<pre><code>## $indices
##  [1] 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135
## [20] 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154
## [39] 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170
## 
## $mass
## [1] 0.9528232
## 
## $height
## [1] 0.004448336</code></pre>
<p>To walk that through a bit, <code>prob_density_vec</code> is a vector of density values for <span class="math inline">\(\operatorname{beta} (30, 12)\)</span> based on 201 evenly-spaced values spanning the parameter space for <span class="math inline">\(\theta\)</span> (i.e., from 0 to 1). In the second line, we converted those density values to the probability metric by dividing each by their sum, which we then saved as <code>prob_mass_vec</code>. In the third line we shoved those probability values into Kruschke’s <code>HDIofGrid()</code> and saved the results as <code>HDI_info</code>. The output of the fourth line, <code>show(HDI_info)</code>, showed us the results (i.e., the contents of <code>HDI_info</code>).</p>
<p>As to those results, the values in saved as <code>$indices</code> are the row numbers for all cases in <code>prob_mass_vec</code> that were within the HDI. The value in <code>$mass</code> showed the actual width of the HDI. Because we’re only working with finite samples (i.e., <code>length = 201</code>), we won’t likely get a perfect 95% HDI. The value in <code>$height</code> is the density value for <em>the waterline that defines the highest density region</em>. A plot might make that less abstract.</p>
<div class="sourceCode" id="cb2457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2457-1"><a href="tools-in-the-trunk.html#cb2457-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb2457-2"><a href="tools-in-the-trunk.html#cb2457-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2457-3"><a href="tools-in-the-trunk.html#cb2457-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(</span>
<span id="cb2457-4"><a href="tools-in-the-trunk.html#cb2457-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_base</span>() <span class="sc">+</span></span>
<span id="cb2457-5"><a href="tools-in-the-trunk.html#cb2457-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">&quot;transparent&quot;</span>))</span>
<span id="cb2457-6"><a href="tools-in-the-trunk.html#cb2457-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2457-7"><a href="tools-in-the-trunk.html#cb2457-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2457-8"><a href="tools-in-the-trunk.html#cb2457-8" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb2457-9"><a href="tools-in-the-trunk.html#cb2457-9" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">row     =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(prob_density_vec),</span>
<span id="cb2457-10"><a href="tools-in-the-trunk.html#cb2457-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">theta   =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length =</span> <span class="fu">length</span>(prob_density_vec)),</span>
<span id="cb2457-11"><a href="tools-in-the-trunk.html#cb2457-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">density =</span> prob_mass_vec,</span>
<span id="cb2457-12"><a href="tools-in-the-trunk.html#cb2457-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">cred    =</span> <span class="fu">if_else</span>(row <span class="sc">%in%</span> HDI_info<span class="sc">$</span>indices, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2457-13"><a href="tools-in-the-trunk.html#cb2457-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2457-14"><a href="tools-in-the-trunk.html#cb2457-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb2457-15"><a href="tools-in-the-trunk.html#cb2457-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> theta, <span class="at">y =</span> density)) <span class="sc">+</span></span>
<span id="cb2457-16"><a href="tools-in-the-trunk.html#cb2457-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># HDI</span></span>
<span id="cb2457-17"><a href="tools-in-the-trunk.html#cb2457-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">fill =</span> cred <span class="sc">==</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb2457-18"><a href="tools-in-the-trunk.html#cb2457-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># density line</span></span>
<span id="cb2457-19"><a href="tools-in-the-trunk.html#cb2457-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;skyblue&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2457-20"><a href="tools-in-the-trunk.html#cb2457-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># waterline</span></span>
<span id="cb2457-21"><a href="tools-in-the-trunk.html#cb2457-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> HDI_info<span class="sc">$</span>height, <span class="at">linetype =</span> <span class="dv">3</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb2457-22"><a href="tools-in-the-trunk.html#cb2457-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fluff</span></span>
<span id="cb2457-23"><a href="tools-in-the-trunk.html#cb2457-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> .<span class="dv">2</span>, <span class="at">y =</span> <span class="fl">0.0046</span>,</span>
<span id="cb2457-24"><a href="tools-in-the-trunk.html#cb2457-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&#39;&quot;waterline&quot; that defines all points</span><span class="sc">\n</span><span class="st">inside the highest density region&#39;</span>) <span class="sc">+</span></span>
<span id="cb2457-25"><a href="tools-in-the-trunk.html#cb2457-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> .<span class="dv">715</span>, <span class="at">y =</span> <span class="fl">0.01</span>,</span>
<span id="cb2457-26"><a href="tools-in-the-trunk.html#cb2457-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;95.28% HDI&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb2457-27"><a href="tools-in-the-trunk.html#cb2457-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;transparent&quot;</span>, <span class="st">&quot;grey67&quot;</span>)) <span class="sc">+</span></span>
<span id="cb2457-28"><a href="tools-in-the-trunk.html#cb2457-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(theta))</span></code></pre></div>
<p><img src="25_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>You might have noticed our <code>theme_set()</code> lines at the top of that code block. For the plots in this chapter, we’ll give a nod to the source material and make them with a similar aesthetic to Kruschke’s plots.</p>
</div>
<div id="hdi-of-unimodal-distribution-is-shortest-interval." class="section level3" number="25.2.2">
<h3><span class="header-section-number">25.2.2</span> HDI of unimodal distribution is shortest interval.</h3>
<blockquote>
<p>The algorithms [in the next sections] find the HDI by searching among candidate intervals of mass <span class="math inline">\(M\)</span>. The shortest one found is declared to be the HDI. It is an approximation, of course. See <span class="citation"><a href="references.html#ref-chenMonteCarloEstimation1999" role="doc-biblioref">Chen &amp; Shao</a> (<a href="references.html#ref-chenMonteCarloEstimation1999" role="doc-biblioref">1999</a>)</span> for more details, and Chen, He, Shao, and Xu <span class="citation">(<a href="references.html#ref-chenMonteCarloGap2003" role="doc-biblioref">2003</a>)</span> for dealing with the unusual situation of multimodal distributions. (p. 727)</p>
</blockquote>
</div>
<div id="r-code-for-computing-hdi-of-a-mcmc-sample." class="section level3" number="25.2.3">
<h3><span class="header-section-number">25.2.3</span> R code for computing HDI of a MCMC sample.</h3>
<p>In this section, Kruschke provided the code for his <code>HDIofMCMC()</code> function. We recreate it, below, with a few mild formatting changes. The <code>ggthemes::theme_base()</code> theme gets us most of the way there.</p>
<div class="sourceCode" id="cb2458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2458-1"><a href="tools-in-the-trunk.html#cb2458-1" aria-hidden="true" tabindex="-1"></a>HDIofMCMC <span class="ot">&lt;-</span> <span class="cf">function</span>(sampleVec, <span class="at">credMass =</span> .<span class="dv">95</span>) {</span>
<span id="cb2458-2"><a href="tools-in-the-trunk.html#cb2458-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2458-3"><a href="tools-in-the-trunk.html#cb2458-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Computes highest density interval from a sample of representative values,</span></span>
<span id="cb2458-4"><a href="tools-in-the-trunk.html#cb2458-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   estimated as shortest credible interval.</span></span>
<span id="cb2458-5"><a href="tools-in-the-trunk.html#cb2458-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arguments:</span></span>
<span id="cb2458-6"><a href="tools-in-the-trunk.html#cb2458-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   sampleVec</span></span>
<span id="cb2458-7"><a href="tools-in-the-trunk.html#cb2458-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     is a vector of representative values from a probability distribution.</span></span>
<span id="cb2458-8"><a href="tools-in-the-trunk.html#cb2458-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   credMass</span></span>
<span id="cb2458-9"><a href="tools-in-the-trunk.html#cb2458-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     is a scalar between 0 and 1, indicating the mass within the credible</span></span>
<span id="cb2458-10"><a href="tools-in-the-trunk.html#cb2458-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     interval that is to be estimated.</span></span>
<span id="cb2458-11"><a href="tools-in-the-trunk.html#cb2458-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Value:</span></span>
<span id="cb2458-12"><a href="tools-in-the-trunk.html#cb2458-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   HDIlim is a vector containing the limits of the HDI</span></span>
<span id="cb2458-13"><a href="tools-in-the-trunk.html#cb2458-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2458-14"><a href="tools-in-the-trunk.html#cb2458-14" aria-hidden="true" tabindex="-1"></a>  sortedPts <span class="ot">&lt;-</span> <span class="fu">sort</span>(sampleVec)</span>
<span id="cb2458-15"><a href="tools-in-the-trunk.html#cb2458-15" aria-hidden="true" tabindex="-1"></a>  ciIdxInc <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(credMass <span class="sc">*</span> <span class="fu">length</span>(sortedPts))</span>
<span id="cb2458-16"><a href="tools-in-the-trunk.html#cb2458-16" aria-hidden="true" tabindex="-1"></a>  nCIs <span class="ot">&lt;-</span> <span class="fu">length</span>(sortedPts) <span class="sc">-</span> ciIdxInc</span>
<span id="cb2458-17"><a href="tools-in-the-trunk.html#cb2458-17" aria-hidden="true" tabindex="-1"></a>  ciWidth <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, nCIs)</span>
<span id="cb2458-18"><a href="tools-in-the-trunk.html#cb2458-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nCIs) {</span>
<span id="cb2458-19"><a href="tools-in-the-trunk.html#cb2458-19" aria-hidden="true" tabindex="-1"></a>    ciWidth[i] <span class="ot">&lt;-</span> sortedPts[i <span class="sc">+</span> ciIdxInc] <span class="sc">-</span> sortedPts[i]</span>
<span id="cb2458-20"><a href="tools-in-the-trunk.html#cb2458-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2458-21"><a href="tools-in-the-trunk.html#cb2458-21" aria-hidden="true" tabindex="-1"></a>  HDImin <span class="ot">&lt;-</span> sortedPts[<span class="fu">which.min</span>(ciWidth)]</span>
<span id="cb2458-22"><a href="tools-in-the-trunk.html#cb2458-22" aria-hidden="true" tabindex="-1"></a>  HDImax <span class="ot">&lt;-</span> sortedPts[<span class="fu">which.min</span>(ciWidth) <span class="sc">+</span> ciIdxInc]</span>
<span id="cb2458-23"><a href="tools-in-the-trunk.html#cb2458-23" aria-hidden="true" tabindex="-1"></a>  HDIlim <span class="ot">&lt;-</span> <span class="fu">c</span>(HDImin, HDImax)</span>
<span id="cb2458-24"><a href="tools-in-the-trunk.html#cb2458-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2458-25"><a href="tools-in-the-trunk.html#cb2458-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(HDIlim)</span>
<span id="cb2458-26"><a href="tools-in-the-trunk.html#cb2458-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2458-27"><a href="tools-in-the-trunk.html#cb2458-27" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Let’s continue working with <code>fit24.1</code> to see how Kruschke’s <code>HDIofMCMC()</code> works. First we need to extract the posterior draws.</p>
<div class="sourceCode" id="cb2459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2459-1"><a href="tools-in-the-trunk.html#cb2459-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">posterior_samples</span>(fit24<span class="fl">.1</span>)</span></code></pre></div>
<p>Here’s how you might use the function to get the HDIs for the first hierarchical variance parameter.</p>
<div class="sourceCode" id="cb2460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2460-1"><a href="tools-in-the-trunk.html#cb2460-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HDIofMCMC</span>(post<span class="sc">$</span>sd_Eye__Intercept)</span></code></pre></div>
<pre><code>## [1] 0.007038013 3.773912594</code></pre>
<p>Kruschke’s <code>HDIofMCMC()</code> works very much the same as the summary functions from <strong>tidybayes</strong>. For example, here’s good old <code>tidybayes::mode_hdi()</code>.</p>
<div class="sourceCode" id="cb2462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2462-1"><a href="tools-in-the-trunk.html#cb2462-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb2462-2"><a href="tools-in-the-trunk.html#cb2462-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2462-3"><a href="tools-in-the-trunk.html#cb2462-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mode_hdi</span>(post<span class="sc">$</span>sd_Eye__Intercept)</span></code></pre></div>
<pre><code>##           y        ymin     ymax .width .point .interval
## 1 0.5572236 0.007038013 3.628502   0.95   mode       hdi
## 2 0.5572236 3.940696738 4.003136   0.95   mode       hdi</code></pre>
<p>If you’d like to use <strong>tidybayes</strong> to just pull the HDIs without the extra information, just use the <code>hdi()</code> function.</p>
<div class="sourceCode" id="cb2464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2464-1"><a href="tools-in-the-trunk.html#cb2464-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hdi</span>(post<span class="sc">$</span>sd_Eye__Intercept)</span></code></pre></div>
<pre><code>##             [,1]     [,2]
## [1,] 0.007038013 3.628502
## [2,] 3.940696738 4.003136</code></pre>
<p>Just in case you’re curious, Kruschke’s <code>HDIofMCMC()</code> function returns the same information as <code>tidybayes::hdi()</code>. Let’s confirm.</p>
<div class="sourceCode" id="cb2466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2466-1"><a href="tools-in-the-trunk.html#cb2466-1" aria-hidden="true" tabindex="-1"></a><span class="fu">HDIofMCMC</span>(post<span class="sc">$</span>sd_Eye__Intercept) <span class="sc">==</span> <span class="fu">hdi</span>(post<span class="sc">$</span>sd_Eye__Intercept)</span></code></pre></div>
<pre><code>##       [,1]  [,2]
## [1,]  TRUE FALSE
## [2,] FALSE FALSE</code></pre>
<p>Identical.</p>
</div>
<div id="r-code-for-computing-hdi-of-a-function." class="section level3" number="25.2.4">
<h3><span class="header-section-number">25.2.4</span> R code for computing HDI of a function.</h3>
<blockquote>
<p>The function described in this section finds the HDI of a unimodal probability density function that is specified mathematically in R. For example, the function can find HDI’s of normal densities or of beta densities or of gamma densities, because those densities are specified as functions in R. (p. 728)</p>
</blockquote>
<p>If you recall, we’ve been using this funciton off and on since Chapter 4. Here is it, again, with mildly reformated code and parameter names.</p>
<div class="sourceCode" id="cb2468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2468-1"><a href="tools-in-the-trunk.html#cb2468-1" aria-hidden="true" tabindex="-1"></a>hdi_of_icdf <span class="ot">&lt;-</span> <span class="cf">function</span>(name, <span class="at">width =</span> .<span class="dv">95</span>, <span class="at">tol =</span> <span class="fl">1e-8</span>, ... ) {</span>
<span id="cb2468-2"><a href="tools-in-the-trunk.html#cb2468-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2468-3"><a href="tools-in-the-trunk.html#cb2468-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arguments:</span></span>
<span id="cb2468-4"><a href="tools-in-the-trunk.html#cb2468-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   `name` is R&#39;s name for the inverse cumulative density function</span></span>
<span id="cb2468-5"><a href="tools-in-the-trunk.html#cb2468-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   of the distribution.</span></span>
<span id="cb2468-6"><a href="tools-in-the-trunk.html#cb2468-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   `width` is the desired mass of the HDI region.</span></span>
<span id="cb2468-7"><a href="tools-in-the-trunk.html#cb2468-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   `tol` is passed to R&#39;s optimize function.</span></span>
<span id="cb2468-8"><a href="tools-in-the-trunk.html#cb2468-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return value:</span></span>
<span id="cb2468-9"><a href="tools-in-the-trunk.html#cb2468-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   Highest density iterval (HDI) limits in a vector.</span></span>
<span id="cb2468-10"><a href="tools-in-the-trunk.html#cb2468-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Example of use: For determining HDI of a beta(30, 12) distribution, type</span></span>
<span id="cb2468-11"><a href="tools-in-the-trunk.html#cb2468-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   `hdi_of_icdf(qbeta, shape1 = 30, shape2 = 12)`</span></span>
<span id="cb2468-12"><a href="tools-in-the-trunk.html#cb2468-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   Notice that the parameters of the `name` must be explicitly stated;</span></span>
<span id="cb2468-13"><a href="tools-in-the-trunk.html#cb2468-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   e.g., `hdi_of_icdf(qbeta, 30, 12)` does not work.</span></span>
<span id="cb2468-14"><a href="tools-in-the-trunk.html#cb2468-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adapted and corrected from Greg Snow&#39;s TeachingDemos package.</span></span>
<span id="cb2468-15"><a href="tools-in-the-trunk.html#cb2468-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2468-16"><a href="tools-in-the-trunk.html#cb2468-16" aria-hidden="true" tabindex="-1"></a>  incredible_mass <span class="ot">&lt;-</span>  <span class="fl">1.0</span> <span class="sc">-</span> width</span>
<span id="cb2468-17"><a href="tools-in-the-trunk.html#cb2468-17" aria-hidden="true" tabindex="-1"></a>  interval_width <span class="ot">&lt;-</span> <span class="cf">function</span>(low_tail_prob, name, width, ...) {</span>
<span id="cb2468-18"><a href="tools-in-the-trunk.html#cb2468-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">name</span>(width <span class="sc">+</span> low_tail_prob, ...) <span class="sc">-</span> <span class="fu">name</span>(low_tail_prob, ...)</span>
<span id="cb2468-19"><a href="tools-in-the-trunk.html#cb2468-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2468-20"><a href="tools-in-the-trunk.html#cb2468-20" aria-hidden="true" tabindex="-1"></a>  opt_info <span class="ot">&lt;-</span> <span class="fu">optimize</span>(interval_width, <span class="fu">c</span>(<span class="dv">0</span>, incredible_mass), </span>
<span id="cb2468-21"><a href="tools-in-the-trunk.html#cb2468-21" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> name, <span class="at">width =</span> width, </span>
<span id="cb2468-22"><a href="tools-in-the-trunk.html#cb2468-22" aria-hidden="true" tabindex="-1"></a>                       <span class="at">tol =</span> tol, ...)</span>
<span id="cb2468-23"><a href="tools-in-the-trunk.html#cb2468-23" aria-hidden="true" tabindex="-1"></a>  hdi_lower_tail_prob <span class="ot">&lt;-</span> opt_info<span class="sc">$</span>minimum</span>
<span id="cb2468-24"><a href="tools-in-the-trunk.html#cb2468-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2468-25"><a href="tools-in-the-trunk.html#cb2468-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">name</span>(hdi_lower_tail_prob, ...),</span>
<span id="cb2468-26"><a href="tools-in-the-trunk.html#cb2468-26" aria-hidden="true" tabindex="-1"></a>           <span class="fu">name</span>(width <span class="sc">+</span> hdi_lower_tail_prob, ...)))</span>
<span id="cb2468-27"><a href="tools-in-the-trunk.html#cb2468-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2468-28"><a href="tools-in-the-trunk.html#cb2468-28" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Here’s how it works for the standard normal distribution.</p>
<div class="sourceCode" id="cb2469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2469-1"><a href="tools-in-the-trunk.html#cb2469-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hdi_of_icdf</span>(qnorm, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] -1.959964  1.959964</code></pre>
<p>By default, it returns 95% HDIs. Here’s how it’d work if you wanted the 80% intervals for <span class="math inline">\(\operatorname{Beta}(2, 2)\)</span>.</p>
<div class="sourceCode" id="cb2471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2471-1"><a href="tools-in-the-trunk.html#cb2471-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hdi_of_icdf</span>(qbeta, <span class="at">shape1 =</span> <span class="dv">2</span>, <span class="at">shape2 =</span> <span class="dv">2</span>, <span class="at">width =</span> .<span class="dv">8</span>)</span></code></pre></div>
<pre><code>## [1] 0.1958001 0.8041999</code></pre>
</div>
</div>
<div id="reparameterization" class="section level2" number="25.3">
<h2><span class="header-section-number">25.3</span> Reparameterization</h2>
<blockquote>
<p>There are situations in which one parameterization is intuitive to express a distribution, but a different parameterization is required for mathematical convenience. For example, we may think intuitively of the standard deviation of a normal distribution, but have to parameterize the distribution in terms of the precision (i.e., reciprocal of the variance). (p. 729)</p>
</blockquote>
<p>The details in the rest of this section are beyond the scope of this project.</p>
</div>
<div id="censored-data-in-jags-brms" class="section level2" number="25.4">
<h2><span class="header-section-number">25.4</span> Censored data in <del>JAGS</del> brms</h2>
<p>“In many situations some data are censored, which means that their values are known only within a certain range” (p. 732) Happily, <strong>brms</strong> is capable of handling censored variables. The setup is a little different from how Kruschke described for JAGS. From the <code>brmsformula</code> section of the <a href="https://CRAN.R-project.org/package=brms/brms.pdf"><strong>brms</strong> reference manual</a> <span class="citation">(<a href="references.html#ref-brms2021RM" role="doc-biblioref">Bürkner, 2021f</a>)</span>, we read:</p>
<blockquote>
<p>With the exception of categorical, ordinal, and mixture families, left, right, and interval censoring can be modeled through <code>y | cens(censored) ~ predictors</code>. The censoring variable (named <code>censored</code> in this example) should contain the values <code>'left'</code>, <code>'none'</code>, <code>'right'</code>, and <code>'interval'</code> (or equivalently <code>-1</code>, <code>0</code>, <code>1</code>, and <code>2</code>) to indicate that the corresponding observation is left censored, not censored, right censored, or interval censored. For interval censored data, a second variable (let’s call it <code>y2</code>) has to be passed to <code>cens</code>. In this case, the formula has the structure <code>y | cens(censored,y2) ~ predictors</code>. While the lower bounds are given in <code>y</code>, the upper bounds are given in <code>y2</code> for interval censored data. Intervals are assumed to be open on the left and closed on the right: <code>(y,y2]</code>.</p>
</blockquote>
<p>We’ll make sense of all this in just a moment. First, let’s see how Kruschke described the example in the text.</p>
<blockquote>
<p>To illustrate why it is important to include censored data in the analysis, consider a case in which <span class="math inline">\(N = 500\)</span> values are generated randomly from a normal distribution with <span class="math inline">\(\mu = 100\)</span> and <span class="math inline">\(\sigma = 15\)</span>. Suppose that values above 106 are censored, as are values in the interval between 94 and 100. For the censored values, all we know is the interval in which they occurred, but not their exact value. (p. 732)</p>
</blockquote>
<p>I’m not aware that we have access to Kruschke’s censored data, so we’ll just make our own based on his description. We’ll start off by simulating the idealized uncensored data, <code>y</code>, based on <span class="math inline">\(\operatorname{Normal}(100, 15)\)</span>.</p>
<div class="sourceCode" id="cb2473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2473-1"><a href="tools-in-the-trunk.html#cb2473-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb2473-2"><a href="tools-in-the-trunk.html#cb2473-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2473-3"><a href="tools-in-the-trunk.html#cb2473-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">25</span>)</span>
<span id="cb2473-4"><a href="tools-in-the-trunk.html#cb2473-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2473-5"><a href="tools-in-the-trunk.html#cb2473-5" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">y =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">15</span>))</span></code></pre></div>
<p>To repeat, Kruschke described two kinds of censoring:</p>
<ul>
<li>“values above 106 are censored,”</li>
<li>“as are values in the interval between 94 and 100.”</li>
</ul>
<p>⚠️ Rather than examine both kinds of censoring at once, as in the text, I’m going to slow down and break this section up. First, we’ll explore right censoring. Second, we’ll explore interval censoring. For our grand finale, we’ll combine the two, as in the text.</p>
<div id="right-censoring-when-youre-uncertain-beyond-a-single-threshold." class="section level3" number="25.4.1">
<h3><span class="header-section-number">25.4.1</span> Right censoring: When you’re uncertain beyond a single threshold.</h3>
<p>In the case where the “values above 106 are censored,” we need to save a single threshold value. We’ll call it <code>t1</code>.</p>
<div class="sourceCode" id="cb2474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2474-1"><a href="tools-in-the-trunk.html#cb2474-1" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="dv">106</span></span></code></pre></div>
<p>Now we can use our <code>t1</code> threshold value to make a right censored version of the <code>y</code> column called <code>y1</code>. We’ll also make a character value listing out a row’s censoring status in nominal terms.</p>
<div class="sourceCode" id="cb2475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2475-1"><a href="tools-in-the-trunk.html#cb2475-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb2475-2"><a href="tools-in-the-trunk.html#cb2475-2" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb2475-3"><a href="tools-in-the-trunk.html#cb2475-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y1   =</span> <span class="fu">if_else</span>(y <span class="sc">&gt;</span> t1, t1, y),</span>
<span id="cb2475-4"><a href="tools-in-the-trunk.html#cb2475-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">cen1 =</span> <span class="fu">if_else</span>(y <span class="sc">&gt;</span> t1, <span class="st">&quot;right&quot;</span>, <span class="st">&quot;none&quot;</span>))</span>
<span id="cb2475-5"><a href="tools-in-the-trunk.html#cb2475-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2475-6"><a href="tools-in-the-trunk.html#cb2475-6" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<pre><code>## # A tibble: 500 x 3
##        y    y1 cen1 
##    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
##  1  96.8  96.8 none 
##  2  84.4  84.4 none 
##  3  82.7  82.7 none 
##  4 105.  105.  none 
##  5  77.5  77.5 none 
##  6  93.3  93.3 none 
##  7 126.  106   right
##  8 108.  106   right
##  9 101.  101.  none 
## 10  99.1  99.1 none 
## # … with 490 more rows</code></pre>
<p>When the values in <code>y1</code> are not censored, we see <code>cen1 == "none"</code>. For all cases where the original <code>y</code> value exceeded the <code>t1</code> threshold (i.e., 106), <code>y1 == 106</code> and <code>cen1 == "right"</code>. We are using the terms <code>"none"</code> and <code>"right"</code> because they are based on the block quote from the <strong>brms</strong> reference manual. For plotting purposes, we’ll make a new variable, <code>y_na</code>, that only has values for which <code>cen1 == "none"</code>.</p>
<div class="sourceCode" id="cb2477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2477-1"><a href="tools-in-the-trunk.html#cb2477-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb2477-2"><a href="tools-in-the-trunk.html#cb2477-2" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb2477-3"><a href="tools-in-the-trunk.html#cb2477-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y_na =</span> <span class="fu">ifelse</span>(cen1 <span class="sc">==</span> <span class="st">&quot;none&quot;</span>, y, <span class="cn">NA</span>))</span>
<span id="cb2477-4"><a href="tools-in-the-trunk.html#cb2477-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2477-5"><a href="tools-in-the-trunk.html#cb2477-5" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<pre><code>## # A tibble: 500 x 4
##        y    y1 cen1   y_na
##    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
##  1  96.8  96.8 none   96.8
##  2  84.4  84.4 none   84.4
##  3  82.7  82.7 none   82.7
##  4 105.  105.  none  105. 
##  5  77.5  77.5 none   77.5
##  6  93.3  93.3 none   93.3
##  7 126.  106   right  NA  
##  8 108.  106   right  NA  
##  9 101.  101.  none  101. 
## 10  99.1  99.1 none   99.1
## # … with 490 more rows</code></pre>
<p>Now let’s get a better sense of the data with a few histograms.</p>
<div class="sourceCode" id="cb2479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2479-1"><a href="tools-in-the-trunk.html#cb2479-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb2479-2"><a href="tools-in-the-trunk.html#cb2479-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>cen1) <span class="sc">%&gt;%</span> </span>
<span id="cb2479-3"><a href="tools-in-the-trunk.html#cb2479-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;y&quot;</span>, <span class="st">&quot;y1&quot;</span>, <span class="st">&quot;y_na&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb2479-4"><a href="tools-in-the-trunk.html#cb2479-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2479-5"><a href="tools-in-the-trunk.html#cb2479-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb2479-6"><a href="tools-in-the-trunk.html#cb2479-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">size =</span> .<span class="dv">25</span>, <span class="at">binwidth =</span> <span class="dv">2</span>, <span class="at">boundary =</span> <span class="dv">106</span>,</span>
<span id="cb2479-7"><a href="tools-in-the-trunk.html#cb2479-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;skyblue4&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb2479-8"><a href="tools-in-the-trunk.html#cb2479-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2479-9"><a href="tools-in-the-trunk.html#cb2479-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2479-10"><a href="tools-in-the-trunk.html#cb2479-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="25_files/figure-html/unnamed-chunk-23-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The original un-censored data are in <code>y</code>. The censored data, for which all values above 106 were simply recoded 106, is <code>y1</code>. The <code>y_na</code> column shows what the distribution would look like if the censored values were omitted.</p>
<p>Here’s how we might fit a model which only uses the uncensored values, those in <code>y_na</code>.</p>
<div class="sourceCode" id="cb2480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2480-1"><a href="tools-in-the-trunk.html#cb2480-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define the stanvars</span></span>
<span id="cb2480-2"><a href="tools-in-the-trunk.html#cb2480-2" aria-hidden="true" tabindex="-1"></a>mean_y <span class="ot">&lt;-</span> <span class="fu">mean</span>(d<span class="sc">$</span>y_na, <span class="at">na.rm =</span> T)</span>
<span id="cb2480-3"><a href="tools-in-the-trunk.html#cb2480-3" aria-hidden="true" tabindex="-1"></a>sd_y   <span class="ot">&lt;-</span> <span class="fu">sd</span>(d<span class="sc">$</span>y_na, <span class="at">na.rm =</span> T)</span>
<span id="cb2480-4"><a href="tools-in-the-trunk.html#cb2480-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2480-5"><a href="tools-in-the-trunk.html#cb2480-5" aria-hidden="true" tabindex="-1"></a>stanvars <span class="ot">&lt;-</span> </span>
<span id="cb2480-6"><a href="tools-in-the-trunk.html#cb2480-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(mean_y, <span class="at">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="sc">+</span> </span>
<span id="cb2480-7"><a href="tools-in-the-trunk.html#cb2480-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stanvar</span>(sd_y,   <span class="at">name =</span> <span class="st">&quot;sd_y&quot;</span>)</span>
<span id="cb2480-8"><a href="tools-in-the-trunk.html#cb2480-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2480-9"><a href="tools-in-the-trunk.html#cb2480-9" aria-hidden="true" tabindex="-1"></a><span class="co"># fit the model</span></span>
<span id="cb2480-10"><a href="tools-in-the-trunk.html#cb2480-10" aria-hidden="true" tabindex="-1"></a>fit25<span class="fl">.1</span>a <span class="ot">&lt;-</span></span>
<span id="cb2480-11"><a href="tools-in-the-trunk.html#cb2480-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d,</span>
<span id="cb2480-12"><a href="tools-in-the-trunk.html#cb2480-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb2480-13"><a href="tools-in-the-trunk.html#cb2480-13" aria-hidden="true" tabindex="-1"></a>      y_na <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb2480-14"><a href="tools-in-the-trunk.html#cb2480-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(mean_y, sd_y <span class="sc">*</span> <span class="dv">100</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb2480-15"><a href="tools-in-the-trunk.html#cb2480-15" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, sd_y), <span class="at">class =</span> sigma)),</span>
<span id="cb2480-16"><a href="tools-in-the-trunk.html#cb2480-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb2480-17"><a href="tools-in-the-trunk.html#cb2480-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> stanvars, </span>
<span id="cb2480-18"><a href="tools-in-the-trunk.html#cb2480-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit25.01a&quot;</span>)</span></code></pre></div>
<p>Check the summary for the naïve model.</p>
<div class="sourceCode" id="cb2481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2481-1"><a href="tools-in-the-trunk.html#cb2481-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit25<span class="fl">.1</span>a)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: y_na ~ 1 
##    Data: d (Number of observations: 333) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    91.43      0.51    90.39    92.43 1.00     4065     2600
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     9.39      0.36     8.72    10.15 1.00     4059     2773
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Relative to the true data-generating process for the original variable <code>y</code>, <span class="math inline">\(\operatorname{Normal}(100, 15)\)</span>, those parameters look pretty biased. Now let’s practice fitting our first censored model. Here we use the <code>y1 | cens(cen1)</code> syntax in the left side of the model <code>formula</code> to indicate that the criterion variable, <code>y1</code>, has been censored according to the process as defined in the <code>cens()</code> function. Within <code>cens()</code> we inserted our nominal variable, <code>cens1</code>, which indicates which cases are censored (<code>"right"</code>) or not (<code>"none"</code>).</p>
<p>This model is one of the rare occasions where we’ll set our initial values for the model intercept. In my first few attempts, <code>brm()</code> had great difficulty initializing the chains using the default initial values. We’ll help it out by setting them at <code>mean_y</code>. Recall that when you set custom initial values in <strong>brms</strong>, you save them in a list with the number of lists equaling the number of HMC chains. Because we’re using the default <code>chains = 4</code>, well need four lists of intercept start values, <code>mean_y</code>. You can set them to different values, if you’d like.</p>
<div class="sourceCode" id="cb2483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2483-1"><a href="tools-in-the-trunk.html#cb2483-1" aria-hidden="true" tabindex="-1"></a>inits <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Intercept =</span> mean_y)</span>
<span id="cb2483-2"><a href="tools-in-the-trunk.html#cb2483-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2483-3"><a href="tools-in-the-trunk.html#cb2483-3" aria-hidden="true" tabindex="-1"></a>inits_list <span class="ot">&lt;-</span> <span class="fu">list</span>(inits, inits, inits, inits)</span>
<span id="cb2483-4"><a href="tools-in-the-trunk.html#cb2483-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2483-5"><a href="tools-in-the-trunk.html#cb2483-5" aria-hidden="true" tabindex="-1"></a>fit25<span class="fl">.2</span>a <span class="ot">&lt;-</span></span>
<span id="cb2483-6"><a href="tools-in-the-trunk.html#cb2483-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d,</span>
<span id="cb2483-7"><a href="tools-in-the-trunk.html#cb2483-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb2483-8"><a href="tools-in-the-trunk.html#cb2483-8" aria-hidden="true" tabindex="-1"></a>      y1 <span class="sc">|</span> <span class="fu">cens</span>(cen1) <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb2483-9"><a href="tools-in-the-trunk.html#cb2483-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(mean_y, sd_y <span class="sc">*</span> <span class="dv">100</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb2483-10"><a href="tools-in-the-trunk.html#cb2483-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, sd_y), <span class="at">class =</span> sigma)),</span>
<span id="cb2483-11"><a href="tools-in-the-trunk.html#cb2483-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb2483-12"><a href="tools-in-the-trunk.html#cb2483-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> stanvars, </span>
<span id="cb2483-13"><a href="tools-in-the-trunk.html#cb2483-13" aria-hidden="true" tabindex="-1"></a>      <span class="co"># here we insert our start values for the intercept</span></span>
<span id="cb2483-14"><a href="tools-in-the-trunk.html#cb2483-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">inits =</span> inits_list, </span>
<span id="cb2483-15"><a href="tools-in-the-trunk.html#cb2483-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit25.02a&quot;</span>)</span></code></pre></div>
<p>Now check the summary for the model accounting for the censoring.</p>
<div class="sourceCode" id="cb2484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2484-1"><a href="tools-in-the-trunk.html#cb2484-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit25<span class="fl">.2</span>a)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: y1 | cens(cen1) ~ 1 
##    Data: d (Number of observations: 500) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    99.41      0.69    98.09   100.74 1.00     2429     2252
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma    14.31      0.61    13.16    15.53 1.00     2528     2588
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>To get a better sense of what these models are doing, we might do a posterior predictive check with <code>predict()</code>.</p>
<div class="sourceCode" id="cb2486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2486-1"><a href="tools-in-the-trunk.html#cb2486-1" aria-hidden="true" tabindex="-1"></a><span class="co"># original</span></span>
<span id="cb2486-2"><a href="tools-in-the-trunk.html#cb2486-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb2486-3"><a href="tools-in-the-trunk.html#cb2486-3" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb2486-4"><a href="tools-in-the-trunk.html#cb2486-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(y, y_na)) <span class="sc">%&gt;%</span> </span>
<span id="cb2486-5"><a href="tools-in-the-trunk.html#cb2486-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2486-6"><a href="tools-in-the-trunk.html#cb2486-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb2486-7"><a href="tools-in-the-trunk.html#cb2486-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">size =</span> .<span class="dv">25</span>, <span class="at">binwidth =</span> <span class="dv">2</span>, <span class="at">boundary =</span> <span class="dv">106</span>,</span>
<span id="cb2486-8"><a href="tools-in-the-trunk.html#cb2486-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;skyblue4&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb2486-9"><a href="tools-in-the-trunk.html#cb2486-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Data&quot;</span>,</span>
<span id="cb2486-10"><a href="tools-in-the-trunk.html#cb2486-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2486-11"><a href="tools-in-the-trunk.html#cb2486-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">*</span> <span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb2486-12"><a href="tools-in-the-trunk.html#cb2486-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2486-13"><a href="tools-in-the-trunk.html#cb2486-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb2486-14"><a href="tools-in-the-trunk.html#cb2486-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2486-15"><a href="tools-in-the-trunk.html#cb2486-15" aria-hidden="true" tabindex="-1"></a><span class="co"># posterior simulations</span></span>
<span id="cb2486-16"><a href="tools-in-the-trunk.html#cb2486-16" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">25</span>)</span>
<span id="cb2486-17"><a href="tools-in-the-trunk.html#cb2486-17" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb2486-18"><a href="tools-in-the-trunk.html#cb2486-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(fit25<span class="fl">.1</span>a,</span>
<span id="cb2486-19"><a href="tools-in-the-trunk.html#cb2486-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">summary =</span> F,</span>
<span id="cb2486-20"><a href="tools-in-the-trunk.html#cb2486-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">nsamples =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2486-21"><a href="tools-in-the-trunk.html#cb2486-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2486-22"><a href="tools-in-the-trunk.html#cb2486-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sim =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb2486-23"><a href="tools-in-the-trunk.html#cb2486-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>sim)  <span class="sc">%&gt;%</span> </span>
<span id="cb2486-24"><a href="tools-in-the-trunk.html#cb2486-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2486-25"><a href="tools-in-the-trunk.html#cb2486-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb2486-26"><a href="tools-in-the-trunk.html#cb2486-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">size =</span> .<span class="dv">25</span>, <span class="at">binwidth =</span> <span class="dv">2</span>, <span class="at">boundary =</span> <span class="dv">106</span>,</span>
<span id="cb2486-27"><a href="tools-in-the-trunk.html#cb2486-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;skyblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb2486-28"><a href="tools-in-the-trunk.html#cb2486-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> t1, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb2486-29"><a href="tools-in-the-trunk.html#cb2486-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Simulations&quot;</span>,</span>
<span id="cb2486-30"><a href="tools-in-the-trunk.html#cb2486-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2486-31"><a href="tools-in-the-trunk.html#cb2486-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">*</span> <span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb2486-32"><a href="tools-in-the-trunk.html#cb2486-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2486-33"><a href="tools-in-the-trunk.html#cb2486-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(d<span class="sc">$</span>y)) <span class="sc">+</span></span>
<span id="cb2486-34"><a href="tools-in-the-trunk.html#cb2486-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> sim, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">labeller =</span> label_both)</span>
<span id="cb2486-35"><a href="tools-in-the-trunk.html#cb2486-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2486-36"><a href="tools-in-the-trunk.html#cb2486-36" aria-hidden="true" tabindex="-1"></a><span class="co"># combine</span></span>
<span id="cb2486-37"><a href="tools-in-the-trunk.html#cb2486-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb2486-38"><a href="tools-in-the-trunk.html#cb2486-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2486-39"><a href="tools-in-the-trunk.html#cb2486-39" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> </span>
<span id="cb2486-40"><a href="tools-in-the-trunk.html#cb2486-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb2486-41"><a href="tools-in-the-trunk.html#cb2486-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">&quot;PP check for the naïve model, fit25.1a&quot;</span>)</span></code></pre></div>
<p><img src="25_files/figure-html/unnamed-chunk-26-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>On the left column, the have the original uncensored data <code>y</code> and the <code>y_na</code> data where the censored values were removed. The four lighter histograms on the right are individual simulations based on our naïve model, <code>fit25.1a</code>, which only used the <code>y_na</code> data. In all cases, the simulated data are biased to be too small compared with the original data, <code>y</code>. They also have the undesirable quality that they don’t even match up with the <code>y_na</code> data, which drops sharply off at the 106 threshold, whereas the simulated data all contain values exceeding that point (depicted by the dashed vertical lines). Now let’s see what happens when we execute a few posterior predictive checks with our first censored model, <code>fit25.2a</code>.</p>
<div class="sourceCode" id="cb2487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2487-1"><a href="tools-in-the-trunk.html#cb2487-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb2487-2"><a href="tools-in-the-trunk.html#cb2487-2" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb2487-3"><a href="tools-in-the-trunk.html#cb2487-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(y, y1)) <span class="sc">%&gt;%</span> </span>
<span id="cb2487-4"><a href="tools-in-the-trunk.html#cb2487-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2487-5"><a href="tools-in-the-trunk.html#cb2487-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb2487-6"><a href="tools-in-the-trunk.html#cb2487-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">size =</span> .<span class="dv">25</span>, <span class="at">binwidth =</span> <span class="dv">2</span>, <span class="at">boundary =</span> <span class="dv">106</span>,</span>
<span id="cb2487-7"><a href="tools-in-the-trunk.html#cb2487-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;skyblue4&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb2487-8"><a href="tools-in-the-trunk.html#cb2487-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Data&quot;</span>,</span>
<span id="cb2487-9"><a href="tools-in-the-trunk.html#cb2487-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2487-10"><a href="tools-in-the-trunk.html#cb2487-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">*</span> <span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb2487-11"><a href="tools-in-the-trunk.html#cb2487-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2487-12"><a href="tools-in-the-trunk.html#cb2487-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span>
<span id="cb2487-13"><a href="tools-in-the-trunk.html#cb2487-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2487-14"><a href="tools-in-the-trunk.html#cb2487-14" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">25</span>)</span>
<span id="cb2487-15"><a href="tools-in-the-trunk.html#cb2487-15" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb2487-16"><a href="tools-in-the-trunk.html#cb2487-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(fit25<span class="fl">.2</span>a,</span>
<span id="cb2487-17"><a href="tools-in-the-trunk.html#cb2487-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">summary =</span> F,</span>
<span id="cb2487-18"><a href="tools-in-the-trunk.html#cb2487-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">nsamples =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2487-19"><a href="tools-in-the-trunk.html#cb2487-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2487-20"><a href="tools-in-the-trunk.html#cb2487-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sim =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb2487-21"><a href="tools-in-the-trunk.html#cb2487-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>sim)  <span class="sc">%&gt;%</span> </span>
<span id="cb2487-22"><a href="tools-in-the-trunk.html#cb2487-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2487-23"><a href="tools-in-the-trunk.html#cb2487-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb2487-24"><a href="tools-in-the-trunk.html#cb2487-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">size =</span> .<span class="dv">25</span>, <span class="at">binwidth =</span> <span class="dv">2</span>, <span class="at">boundary =</span> <span class="dv">106</span>,</span>
<span id="cb2487-25"><a href="tools-in-the-trunk.html#cb2487-25" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;skyblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb2487-26"><a href="tools-in-the-trunk.html#cb2487-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Simulations&quot;</span>,</span>
<span id="cb2487-27"><a href="tools-in-the-trunk.html#cb2487-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2487-28"><a href="tools-in-the-trunk.html#cb2487-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">*</span> <span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb2487-29"><a href="tools-in-the-trunk.html#cb2487-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2487-30"><a href="tools-in-the-trunk.html#cb2487-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(d<span class="sc">$</span>y)) <span class="sc">+</span></span>
<span id="cb2487-31"><a href="tools-in-the-trunk.html#cb2487-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> sim, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">labeller =</span> label_both)</span>
<span id="cb2487-32"><a href="tools-in-the-trunk.html#cb2487-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2487-33"><a href="tools-in-the-trunk.html#cb2487-33" aria-hidden="true" tabindex="-1"></a><span class="co"># combine</span></span>
<span id="cb2487-34"><a href="tools-in-the-trunk.html#cb2487-34" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> </span>
<span id="cb2487-35"><a href="tools-in-the-trunk.html#cb2487-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb2487-36"><a href="tools-in-the-trunk.html#cb2487-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">&quot;PP check for the censored model, fit25.2a&quot;</span>)</span></code></pre></div>
<p><img src="25_files/figure-html/unnamed-chunk-27-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Now the posterior predictive samples match up nicely from the original uncensored data <code>y</code> in terms of central tendency, dispersion, and their overall shapes. This is the magic of a model that accounts for right (or left) censoring. It can take all those stacked-up 106 values and approximate the underlying distribution, had they been more accurately recorded.</p>
</div>
<div id="interval-censoring-when-your-values-are-somewhere-in-the-middle." class="section level3" number="25.4.2">
<h3><span class="header-section-number">25.4.2</span> Interval censoring: When your values are somewhere in the middle.</h3>
<p>Time to move onto interval censoring. Kruschke’s example in the text included values censored in the interval between 94 and 100. This will require two more thresholds, which we’ll call <code>t2</code> and <code>t3</code>.</p>
<div class="sourceCode" id="cb2488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2488-1"><a href="tools-in-the-trunk.html#cb2488-1" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="dv">94</span></span>
<span id="cb2488-2"><a href="tools-in-the-trunk.html#cb2488-2" aria-hidden="true" tabindex="-1"></a>t3 <span class="ot">&lt;-</span> <span class="dv">100</span></span></code></pre></div>
<p>We should revisit part of the block quote from the <strong>brms</strong> reference manual, above:</p>
<blockquote>
<p>For interval censored data, a second variable (let’s call it <code>y2</code>) has to be passed to <code>cens</code>. In this case, the formula has the structure <code>y | cens(censored,y2) ~ predictors</code>. While the lower bounds are given in <code>y</code>, the upper bounds are given in <code>y2</code> for interval censored data. Intervals are assumed to be open on the left and closed on the right: <code>(y,y2]</code></p>
</blockquote>
<p>It’s a little unclear, to me, if this is how Kruschke defined his intervals, but since we’re working with <strong>brms</strong> we’ll just use this convention. Thus, we will define “values in the interval between 94 and 100” as <code>y &gt;= t2 &amp; y &lt; t3</code>. Here we’ll follow the <strong>brms</strong> convention and define a new variable <code>y2</code> for our lower bound and <code>y3</code> for our upper bound. Additionally, the new <code>cen2</code> variable will tell us whether a case is interval censored (<code>"interval"</code>) or not (<code>"none"</code>). We have also redefined <code>y_na</code> in terms of our <code>cen2</code> variable.</p>
<div class="sourceCode" id="cb2489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2489-1"><a href="tools-in-the-trunk.html#cb2489-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb2489-2"><a href="tools-in-the-trunk.html#cb2489-2" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb2489-3"><a href="tools-in-the-trunk.html#cb2489-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y2   =</span> <span class="fu">if_else</span>(y <span class="sc">&gt;=</span> t2 <span class="sc">&amp;</span> y <span class="sc">&lt;</span> t3, t2, y),</span>
<span id="cb2489-4"><a href="tools-in-the-trunk.html#cb2489-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y3   =</span> <span class="fu">if_else</span>(y <span class="sc">&gt;=</span> t2 <span class="sc">&amp;</span> y <span class="sc">&lt;</span> t3, t3, y),</span>
<span id="cb2489-5"><a href="tools-in-the-trunk.html#cb2489-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">cen2 =</span> <span class="fu">if_else</span>(y <span class="sc">&gt;=</span> t2 <span class="sc">&amp;</span> y <span class="sc">&lt;</span> t3, <span class="st">&quot;interval&quot;</span>, <span class="st">&quot;none&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2489-6"><a href="tools-in-the-trunk.html#cb2489-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y_na =</span> <span class="fu">ifelse</span>(cen2 <span class="sc">==</span> <span class="st">&quot;none&quot;</span>, y, <span class="cn">NA</span>))</span>
<span id="cb2489-7"><a href="tools-in-the-trunk.html#cb2489-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2489-8"><a href="tools-in-the-trunk.html#cb2489-8" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<pre><code>## # A tibble: 500 x 7
##        y    y1 cen1   y_na    y2    y3 cen2    
##    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   
##  1  96.8  96.8 none   NA    94   100   interval
##  2  84.4  84.4 none   84.4  84.4  84.4 none    
##  3  82.7  82.7 none   82.7  82.7  82.7 none    
##  4 105.  105.  none  105.  105.  105.  none    
##  5  77.5  77.5 none   77.5  77.5  77.5 none    
##  6  93.3  93.3 none   93.3  93.3  93.3 none    
##  7 126.  106   right 126.  126.  126.  none    
##  8 108.  106   right 108.  108.  108.  none    
##  9 101.  101.  none  101.  101.  101.  none    
## 10  99.1  99.1 none   NA    94   100   interval
## # … with 490 more rows</code></pre>
<p>Now let’s get a better sense of the new data with a few histograms.</p>
<div class="sourceCode" id="cb2491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2491-1"><a href="tools-in-the-trunk.html#cb2491-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb2491-2"><a href="tools-in-the-trunk.html#cb2491-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(y, y2, y3, y_na)) <span class="sc">%&gt;%</span> </span>
<span id="cb2491-3"><a href="tools-in-the-trunk.html#cb2491-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;y&quot;</span>, <span class="st">&quot;y2&quot;</span>, <span class="st">&quot;y3&quot;</span>, <span class="st">&quot;y_na&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb2491-4"><a href="tools-in-the-trunk.html#cb2491-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2491-5"><a href="tools-in-the-trunk.html#cb2491-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb2491-6"><a href="tools-in-the-trunk.html#cb2491-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">size =</span> .<span class="dv">25</span>, <span class="at">binwidth =</span> <span class="dv">2</span>, <span class="at">boundary =</span> <span class="dv">106</span>,</span>
<span id="cb2491-7"><a href="tools-in-the-trunk.html#cb2491-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;skyblue4&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb2491-8"><a href="tools-in-the-trunk.html#cb2491-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Our data have been updated&quot;</span>,</span>
<span id="cb2491-9"><a href="tools-in-the-trunk.html#cb2491-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2491-10"><a href="tools-in-the-trunk.html#cb2491-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2491-11"><a href="tools-in-the-trunk.html#cb2491-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="25_files/figure-html/unnamed-chunk-30-1.png" width="408" style="display: block; margin: auto;" /></p>
<p>Now we fit two models. The first, <code>fit25.1b</code>, will only used the values not interval censored, <code>y_na</code>. The second model, <code>fit25.2b</code>, will use the <code>cens()</code> function to fit account for the interval censored data with the <code>y2</code>, <code>y3</code>, and <code>cen2</code> columns. As before, we’ll want to use <code>inits</code> to help the censored model run smoothly.</p>
<div class="sourceCode" id="cb2492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2492-1"><a href="tools-in-the-trunk.html#cb2492-1" aria-hidden="true" tabindex="-1"></a><span class="co"># naïve</span></span>
<span id="cb2492-2"><a href="tools-in-the-trunk.html#cb2492-2" aria-hidden="true" tabindex="-1"></a>fit25<span class="fl">.1</span>b <span class="ot">&lt;-</span></span>
<span id="cb2492-3"><a href="tools-in-the-trunk.html#cb2492-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d,</span>
<span id="cb2492-4"><a href="tools-in-the-trunk.html#cb2492-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb2492-5"><a href="tools-in-the-trunk.html#cb2492-5" aria-hidden="true" tabindex="-1"></a>      y_na <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb2492-6"><a href="tools-in-the-trunk.html#cb2492-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(mean_y, sd_y <span class="sc">*</span> <span class="dv">100</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb2492-7"><a href="tools-in-the-trunk.html#cb2492-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, sd_y), <span class="at">class =</span> sigma)),</span>
<span id="cb2492-8"><a href="tools-in-the-trunk.html#cb2492-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb2492-9"><a href="tools-in-the-trunk.html#cb2492-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> stanvars, </span>
<span id="cb2492-10"><a href="tools-in-the-trunk.html#cb2492-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit25.01b&quot;</span>)</span>
<span id="cb2492-11"><a href="tools-in-the-trunk.html#cb2492-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2492-12"><a href="tools-in-the-trunk.html#cb2492-12" aria-hidden="true" tabindex="-1"></a><span class="co"># censored</span></span>
<span id="cb2492-13"><a href="tools-in-the-trunk.html#cb2492-13" aria-hidden="true" tabindex="-1"></a>fit25<span class="fl">.2</span>b <span class="ot">&lt;-</span></span>
<span id="cb2492-14"><a href="tools-in-the-trunk.html#cb2492-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d,</span>
<span id="cb2492-15"><a href="tools-in-the-trunk.html#cb2492-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb2492-16"><a href="tools-in-the-trunk.html#cb2492-16" aria-hidden="true" tabindex="-1"></a>      y2 <span class="sc">|</span> <span class="fu">cens</span>(cen2, y3) <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb2492-17"><a href="tools-in-the-trunk.html#cb2492-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(mean_y, sd_y <span class="sc">*</span> <span class="dv">100</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb2492-18"><a href="tools-in-the-trunk.html#cb2492-18" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, sd_y), <span class="at">class =</span> sigma)),</span>
<span id="cb2492-19"><a href="tools-in-the-trunk.html#cb2492-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb2492-20"><a href="tools-in-the-trunk.html#cb2492-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> stanvars, </span>
<span id="cb2492-21"><a href="tools-in-the-trunk.html#cb2492-21" aria-hidden="true" tabindex="-1"></a>      <span class="co"># here we insert our start values for the intercept</span></span>
<span id="cb2492-22"><a href="tools-in-the-trunk.html#cb2492-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">inits =</span> inits_list, </span>
<span id="cb2492-23"><a href="tools-in-the-trunk.html#cb2492-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit25.02b&quot;</span>)</span></code></pre></div>
<p>Review the model summaries.</p>
<div class="sourceCode" id="cb2493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2493-1"><a href="tools-in-the-trunk.html#cb2493-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit25<span class="fl">.1</span>b)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: y_na ~ 1 
##    Data: d (Number of observations: 424) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept   100.26      0.76    98.73   101.74 1.00     3624     2806
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma    15.78      0.55    14.78    16.93 1.00     3201     2513
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb2495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2495-1"><a href="tools-in-the-trunk.html#cb2495-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit25<span class="fl">.2</span>b)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: y2 | cens(cen2, y3) ~ 1 
##    Data: d (Number of observations: 500) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    99.75      0.64    98.46   100.99 1.00     3270     2574
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma    14.60      0.46    13.70    15.50 1.00     3544     2677
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>In this case, both models did a reasonable job approximating the original data-generating parameters, <span class="math inline">\(\operatorname{Normal}(100, 15)\)</span>. However, the naïve model <code>fit25.1b</code> did so at a considerable loss of precision, as indicated by the posterior standard deviations. To give a better sense, here are the model parameters in an interval plot.</p>
<div class="sourceCode" id="cb2497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2497-1"><a href="tools-in-the-trunk.html#cb2497-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb2497-2"><a href="tools-in-the-trunk.html#cb2497-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(<span class="fu">posterior_samples</span>(fit25<span class="fl">.1</span>b),</span>
<span id="cb2497-3"><a href="tools-in-the-trunk.html#cb2497-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">posterior_samples</span>(fit25<span class="fl">.2</span>b)) <span class="sc">%&gt;%</span> </span>
<span id="cb2497-4"><a href="tools-in-the-trunk.html#cb2497-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;fit25.1b&quot;</span>, <span class="st">&quot;fit25.2b&quot;</span>), <span class="at">each =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2497-5"><a href="tools-in-the-trunk.html#cb2497-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(b_Intercept<span class="sc">:</span>sigma) <span class="sc">%&gt;%</span> </span>
<span id="cb2497-6"><a href="tools-in-the-trunk.html#cb2497-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">parameter =</span> <span class="fu">if_else</span>(name <span class="sc">==</span> <span class="st">&quot;b_Intercept&quot;</span>, <span class="st">&quot;mu&quot;</span>, <span class="st">&quot;sigma&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2497-7"><a href="tools-in-the-trunk.html#cb2497-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2497-8"><a href="tools-in-the-trunk.html#cb2497-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot</span></span>
<span id="cb2497-9"><a href="tools-in-the-trunk.html#cb2497-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> fit)) <span class="sc">+</span></span>
<span id="cb2497-10"><a href="tools-in-the-trunk.html#cb2497-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_interval</span>(<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">95</span>)) <span class="sc">+</span></span>
<span id="cb2497-11"><a href="tools-in-the-trunk.html#cb2497-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">&quot;ETI&quot;</span>, </span>
<span id="cb2497-12"><a href="tools-in-the-trunk.html#cb2497-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;skyblue2&quot;</span>, <span class="st">&quot;skyblue4&quot;</span>),</span>
<span id="cb2497-13"><a href="tools-in-the-trunk.html#cb2497-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;95%&quot;</span>, <span class="st">&quot;50%&quot;</span>)) <span class="sc">+</span></span>
<span id="cb2497-14"><a href="tools-in-the-trunk.html#cb2497-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;marginal posterior&quot;</span>,</span>
<span id="cb2497-15"><a href="tools-in-the-trunk.html#cb2497-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2497-16"><a href="tools-in-the-trunk.html#cb2497-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb2497-17"><a href="tools-in-the-trunk.html#cb2497-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> parameter, <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>, <span class="at">labeller =</span> label_parsed)</span></code></pre></div>
<p><img src="25_files/figure-html/unnamed-chunk-32-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>One could also argue the parameters for the censored model <code>fit25.2b</code> were a little less biased. However, I’d be leery of making that as a general claim based on this example, alone.</p>
</div>
<div id="complex-censoring-when-the-going-gets-tough" class="section level3" number="25.4.3">
<h3><span class="header-section-number">25.4.3</span> Complex censoring: When the going gets tough…</h3>
<p>Okay, let’s put what we’ve learned together and practice with data that are both right AND interval censored. This is going to require some tricky coding on our part. Since interval censoring is in play, we’ll need two <code>y</code> variables, again. When the data are indeed interval censored, their lower and upper bounds will be depicted by <code>y4</code> and <code>y5</code>, respectively. When the data are right censored, <code>y4</code> will contain the threshold 106 and <code>y5</code> will contain the original value from <code>y</code>. All this tricky information will be indexed in our nominal variable <code>cen3</code>. Once again, we update our <code>y_na</code> variable, too.</p>
<div class="sourceCode" id="cb2498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2498-1"><a href="tools-in-the-trunk.html#cb2498-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb2498-2"><a href="tools-in-the-trunk.html#cb2498-2" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb2498-3"><a href="tools-in-the-trunk.html#cb2498-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y4   =</span> <span class="fu">if_else</span>(y <span class="sc">&gt;=</span> t2 <span class="sc">&amp;</span> y <span class="sc">&lt;</span> t3, t2, </span>
<span id="cb2498-4"><a href="tools-in-the-trunk.html#cb2498-4" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">if_else</span>(y <span class="sc">&gt;</span> t1, t1, y)),</span>
<span id="cb2498-5"><a href="tools-in-the-trunk.html#cb2498-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">y5   =</span> <span class="fu">if_else</span>(y <span class="sc">&gt;=</span> t2 <span class="sc">&amp;</span> y <span class="sc">&lt;</span> t3, t3, y),</span>
<span id="cb2498-6"><a href="tools-in-the-trunk.html#cb2498-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">cen3 =</span> <span class="fu">if_else</span>(y <span class="sc">&gt;=</span> t2 <span class="sc">&amp;</span> y <span class="sc">&lt;</span> t3, <span class="st">&quot;interval&quot;</span>,</span>
<span id="cb2498-7"><a href="tools-in-the-trunk.html#cb2498-7" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">if_else</span>(y <span class="sc">&gt;</span> t1, <span class="st">&quot;right&quot;</span>, <span class="st">&quot;none&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb2498-8"><a href="tools-in-the-trunk.html#cb2498-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y_na =</span> <span class="fu">ifelse</span>(cen3 <span class="sc">==</span> <span class="st">&quot;none&quot;</span>, y, <span class="cn">NA</span>))</span>
<span id="cb2498-9"><a href="tools-in-the-trunk.html#cb2498-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2498-10"><a href="tools-in-the-trunk.html#cb2498-10" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<pre><code>## # A tibble: 500 x 10
##        y    y1 cen1   y_na    y2    y3 cen2        y4    y5 cen3    
##    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   
##  1  96.8  96.8 none   NA    94   100   interval  94   100   interval
##  2  84.4  84.4 none   84.4  84.4  84.4 none      84.4  84.4 none    
##  3  82.7  82.7 none   82.7  82.7  82.7 none      82.7  82.7 none    
##  4 105.  105.  none  105.  105.  105.  none     105.  105.  none    
##  5  77.5  77.5 none   77.5  77.5  77.5 none      77.5  77.5 none    
##  6  93.3  93.3 none   93.3  93.3  93.3 none      93.3  93.3 none    
##  7 126.  106   right  NA   126.  126.  none     106   126.  right   
##  8 108.  106   right  NA   108.  108.  none     106   108.  right   
##  9 101.  101.  none  101.  101.  101.  none     101.  101.  none    
## 10  99.1  99.1 none   NA    94   100   interval  94   100   interval
## # … with 490 more rows</code></pre>
<p>Explore the new data with histograms.</p>
<div class="sourceCode" id="cb2500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2500-1"><a href="tools-in-the-trunk.html#cb2500-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb2500-2"><a href="tools-in-the-trunk.html#cb2500-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(y, y4, y5, y_na)) <span class="sc">%&gt;%</span> </span>
<span id="cb2500-3"><a href="tools-in-the-trunk.html#cb2500-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;y&quot;</span>, <span class="st">&quot;y4&quot;</span>, <span class="st">&quot;y5&quot;</span>, <span class="st">&quot;y_na&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb2500-4"><a href="tools-in-the-trunk.html#cb2500-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2500-5"><a href="tools-in-the-trunk.html#cb2500-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb2500-6"><a href="tools-in-the-trunk.html#cb2500-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">size =</span> .<span class="dv">25</span>, <span class="at">binwidth =</span> <span class="dv">2</span>, <span class="at">boundary =</span> <span class="dv">106</span>,</span>
<span id="cb2500-7"><a href="tools-in-the-trunk.html#cb2500-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;skyblue4&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb2500-8"><a href="tools-in-the-trunk.html#cb2500-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Our data have been updated, again&quot;</span>,</span>
<span id="cb2500-9"><a href="tools-in-the-trunk.html#cb2500-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2500-10"><a href="tools-in-the-trunk.html#cb2500-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2500-11"><a href="tools-in-the-trunk.html#cb2500-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="25_files/figure-html/unnamed-chunk-34-1.png" width="408" style="display: block; margin: auto;" /></p>
<p>In the text, Kruschke reported he had 255 uncensored values (p. 732). Here’s the breakdown of our data.</p>
<div class="sourceCode" id="cb2501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2501-1"><a href="tools-in-the-trunk.html#cb2501-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb2501-2"><a href="tools-in-the-trunk.html#cb2501-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(cen3)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##   cen3         n
##   &lt;chr&gt;    &lt;int&gt;
## 1 interval    76
## 2 none       257
## 3 right      167</code></pre>
<p>We got really close! Now we fit our two models: <code>fit25.1c</code>, which ignores the censoring problem and just drops those cases, and <code>fit25.2c</code>, which makes slick use of the <code>cens()</code> function.</p>
<div class="sourceCode" id="cb2503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2503-1"><a href="tools-in-the-trunk.html#cb2503-1" aria-hidden="true" tabindex="-1"></a><span class="co"># naïve</span></span>
<span id="cb2503-2"><a href="tools-in-the-trunk.html#cb2503-2" aria-hidden="true" tabindex="-1"></a>fit25<span class="fl">.1</span>c <span class="ot">&lt;-</span></span>
<span id="cb2503-3"><a href="tools-in-the-trunk.html#cb2503-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d,</span>
<span id="cb2503-4"><a href="tools-in-the-trunk.html#cb2503-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb2503-5"><a href="tools-in-the-trunk.html#cb2503-5" aria-hidden="true" tabindex="-1"></a>      y_na <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb2503-6"><a href="tools-in-the-trunk.html#cb2503-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(mean_y, sd_y <span class="sc">*</span> <span class="dv">100</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb2503-7"><a href="tools-in-the-trunk.html#cb2503-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, sd_y), <span class="at">class =</span> sigma)),</span>
<span id="cb2503-8"><a href="tools-in-the-trunk.html#cb2503-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb2503-9"><a href="tools-in-the-trunk.html#cb2503-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> stanvars, </span>
<span id="cb2503-10"><a href="tools-in-the-trunk.html#cb2503-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit25.01c&quot;</span>)</span>
<span id="cb2503-11"><a href="tools-in-the-trunk.html#cb2503-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2503-12"><a href="tools-in-the-trunk.html#cb2503-12" aria-hidden="true" tabindex="-1"></a><span class="co"># censored</span></span>
<span id="cb2503-13"><a href="tools-in-the-trunk.html#cb2503-13" aria-hidden="true" tabindex="-1"></a>fit25<span class="fl">.2</span>c <span class="ot">&lt;-</span></span>
<span id="cb2503-14"><a href="tools-in-the-trunk.html#cb2503-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d,</span>
<span id="cb2503-15"><a href="tools-in-the-trunk.html#cb2503-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb2503-16"><a href="tools-in-the-trunk.html#cb2503-16" aria-hidden="true" tabindex="-1"></a>      y4 <span class="sc">|</span> <span class="fu">cens</span>(cen3, y5) <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb2503-17"><a href="tools-in-the-trunk.html#cb2503-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(mean_y, sd_y <span class="sc">*</span> <span class="dv">100</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb2503-18"><a href="tools-in-the-trunk.html#cb2503-18" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, sd_y), <span class="at">class =</span> sigma)),</span>
<span id="cb2503-19"><a href="tools-in-the-trunk.html#cb2503-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb2503-20"><a href="tools-in-the-trunk.html#cb2503-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">stanvars =</span> stanvars, </span>
<span id="cb2503-21"><a href="tools-in-the-trunk.html#cb2503-21" aria-hidden="true" tabindex="-1"></a>      <span class="co"># here we insert our start values for the intercept</span></span>
<span id="cb2503-22"><a href="tools-in-the-trunk.html#cb2503-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">inits =</span> inits_list, </span>
<span id="cb2503-23"><a href="tools-in-the-trunk.html#cb2503-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/fit25.02c&quot;</span>)</span></code></pre></div>
<p>Compare the model summaries.</p>
<div class="sourceCode" id="cb2504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2504-1"><a href="tools-in-the-trunk.html#cb2504-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit25<span class="fl">.1</span>c)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: y_na ~ 1 
##    Data: d (Number of observations: 257) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    89.90      0.64    88.66    91.17 1.00     3204     2942
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma    10.13      0.46     9.28    11.11 1.00     3360     2598
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb2506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2506-1"><a href="tools-in-the-trunk.html#cb2506-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit25<span class="fl">.2</span>c)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: y4 | cens(cen3, y5) ~ 1 
##    Data: d (Number of observations: 500) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    99.46      0.68    98.17   100.87 1.00     3130     2506
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma    14.28      0.61    13.15    15.52 1.00     2647     2284
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>The results for the naïve model are a mess and those from the censored model look great! Also note how the latter used all avaliable cases, whereas the former dropped nearly half of them.</p>
<p>Before we can make our version of Figure 25.4, we’ll need to extract the posterior draws. We’ll start with <code>fit25.1c</code>.</p>
<div class="sourceCode" id="cb2508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2508-1"><a href="tools-in-the-trunk.html#cb2508-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> </span>
<span id="cb2508-2"><a href="tools-in-the-trunk.html#cb2508-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">posterior_samples</span>(fit25<span class="fl">.1</span>c) <span class="sc">%&gt;%</span> </span>
<span id="cb2508-3"><a href="tools-in-the-trunk.html#cb2508-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mu =</span> b_Intercept,</span>
<span id="cb2508-4"><a href="tools-in-the-trunk.html#cb2508-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">(mu-100)/sigma</span><span class="st">`</span> <span class="ot">=</span> (b_Intercept <span class="sc">-</span> <span class="dv">100</span>) <span class="sc">/</span> sigma)</span>
<span id="cb2508-5"><a href="tools-in-the-trunk.html#cb2508-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2508-6"><a href="tools-in-the-trunk.html#cb2508-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(post)</span></code></pre></div>
<pre><code>##   b_Intercept     sigma      lp__       mu (mu-100)/sigma
## 1    90.05188 10.199345 -967.0199 90.05188     -0.9753683
## 2    90.09738  9.515594 -967.8906 90.09738     -1.0406726
## 3    89.66705 10.056845 -967.0060 89.66705     -1.0274541
## 4    90.34445  9.916196 -967.2923 90.34445     -0.9737150
## 5    89.85105 10.157868 -966.9644 89.85105     -0.9991220
## 6    90.59965 10.632351 -968.2521 90.59965     -0.8841270</code></pre>
<p>These subplots look a lot like those from back in <a href="metric-predicted-variable-on-one-or-two-groups.html#outliers-and-robust-estimation-the-t-distribution">Section 16.2</a>. Since this is the last plot from the book, it seems like we should go all out. To reduce some of the code redundancy with the six subplots of the marginal posteriors, we’ll make a custom geom, <code>geom_hist()</code>.</p>
<div class="sourceCode" id="cb2510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2510-1"><a href="tools-in-the-trunk.html#cb2510-1" aria-hidden="true" tabindex="-1"></a>geom_hist <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">xintercept =</span> xintercept, <span class="at">binwidth =</span> binwidth, ...) {</span>
<span id="cb2510-2"><a href="tools-in-the-trunk.html#cb2510-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2510-3"><a href="tools-in-the-trunk.html#cb2510-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb2510-4"><a href="tools-in-the-trunk.html#cb2510-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">&quot;skyblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">size =</span> .<span class="dv">2</span>, <span class="at">binwidth =</span> binwidth, <span class="at">boundary =</span> <span class="dv">106</span>),</span>
<span id="cb2510-5"><a href="tools-in-the-trunk.html#cb2510-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> xintercept, <span class="at">color =</span> <span class="st">&quot;skyblue3&quot;</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">linetype =</span> <span class="dv">3</span>),</span>
<span id="cb2510-6"><a href="tools-in-the-trunk.html#cb2510-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_pointinterval</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">0</span>), <span class="at">point_interval =</span> mode_hdi, <span class="at">.width =</span> .<span class="dv">95</span>),</span>
<span id="cb2510-7"><a href="tools-in-the-trunk.html#cb2510-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>)</span>
<span id="cb2510-8"><a href="tools-in-the-trunk.html#cb2510-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2510-9"><a href="tools-in-the-trunk.html#cb2510-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2510-10"><a href="tools-in-the-trunk.html#cb2510-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we have our <code>geom_hist()</code>, here are the first three histograms for the marginal posteriors from <code>fit25.1c</code>.</p>
<div class="sourceCode" id="cb2511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2511-1"><a href="tools-in-the-trunk.html#cb2511-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb2511-2"><a href="tools-in-the-trunk.html#cb2511-2" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">%&gt;%</span> </span>
<span id="cb2511-3"><a href="tools-in-the-trunk.html#cb2511-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mu)) <span class="sc">+</span></span>
<span id="cb2511-4"><a href="tools-in-the-trunk.html#cb2511-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hist</span>(<span class="at">xintercept =</span> <span class="dv">100</span>, <span class="at">binwidth =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb2511-5"><a href="tools-in-the-trunk.html#cb2511-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(mu))</span>
<span id="cb2511-6"><a href="tools-in-the-trunk.html#cb2511-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2511-7"><a href="tools-in-the-trunk.html#cb2511-7" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb2511-8"><a href="tools-in-the-trunk.html#cb2511-8" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">%&gt;%</span> </span>
<span id="cb2511-9"><a href="tools-in-the-trunk.html#cb2511-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sigma)) <span class="sc">+</span></span>
<span id="cb2511-10"><a href="tools-in-the-trunk.html#cb2511-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hist</span>(<span class="at">xintercept =</span> <span class="dv">15</span>, <span class="at">binwidth =</span> <span class="fl">0.08</span>) <span class="sc">+</span></span>
<span id="cb2511-11"><a href="tools-in-the-trunk.html#cb2511-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(sigma))</span>
<span id="cb2511-12"><a href="tools-in-the-trunk.html#cb2511-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2511-13"><a href="tools-in-the-trunk.html#cb2511-13" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span></span>
<span id="cb2511-14"><a href="tools-in-the-trunk.html#cb2511-14" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">%&gt;%</span> </span>
<span id="cb2511-15"><a href="tools-in-the-trunk.html#cb2511-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">(mu-100)/sigma</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb2511-16"><a href="tools-in-the-trunk.html#cb2511-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hist</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">binwidth =</span> <span class="fl">0.015</span>) <span class="sc">+</span></span>
<span id="cb2511-17"><a href="tools-in-the-trunk.html#cb2511-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>((mu<span class="dv">-100</span>)<span class="sc">/</span>sigma))</span></code></pre></div>
<p>The histogram of the censored data with the posterior predictive density curves superimposed will take a little more work.</p>
<div class="sourceCode" id="cb2512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2512-1"><a href="tools-in-the-trunk.html#cb2512-1" aria-hidden="true" tabindex="-1"></a>n_lines <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb2512-2"><a href="tools-in-the-trunk.html#cb2512-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2512-3"><a href="tools-in-the-trunk.html#cb2512-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb2512-4"><a href="tools-in-the-trunk.html#cb2512-4" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">%&gt;%</span> </span>
<span id="cb2512-5"><a href="tools-in-the-trunk.html#cb2512-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">iter =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb2512-6"><a href="tools-in-the-trunk.html#cb2512-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span>n_lines) <span class="sc">%&gt;%</span> </span>
<span id="cb2512-7"><a href="tools-in-the-trunk.html#cb2512-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(mu, sigma, iter),</span>
<span id="cb2512-8"><a href="tools-in-the-trunk.html#cb2512-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">y_na =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">40</span>, <span class="at">to =</span> <span class="dv">120</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2512-9"><a href="tools-in-the-trunk.html#cb2512-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> <span class="fu">dnorm</span>(<span class="at">x =</span> y_na, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb2512-10"><a href="tools-in-the-trunk.html#cb2512-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2512-11"><a href="tools-in-the-trunk.html#cb2512-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> y_na)) <span class="sc">+</span> </span>
<span id="cb2512-12"><a href="tools-in-the-trunk.html#cb2512-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">data =</span> d, </span>
<span id="cb2512-13"><a href="tools-in-the-trunk.html#cb2512-13" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">stat</span>(density)),</span>
<span id="cb2512-14"><a href="tools-in-the-trunk.html#cb2512-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> .<span class="dv">25</span>, <span class="at">binwidth =</span> <span class="dv">2</span>, <span class="at">boundary =</span> <span class="dv">106</span>,</span>
<span id="cb2512-15"><a href="tools-in-the-trunk.html#cb2512-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;skyblue4&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb2512-16"><a href="tools-in-the-trunk.html#cb2512-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> density, <span class="at">group =</span> iter),</span>
<span id="cb2512-17"><a href="tools-in-the-trunk.html#cb2512-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">size  =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb2512-18"><a href="tools-in-the-trunk.html#cb2512-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;data with posterior predictive lines&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">110</span>)) <span class="sc">+</span></span>
<span id="cb2512-19"><a href="tools-in-the-trunk.html#cb2512-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p>Now extract the posterior draws from our censored model, <code>fit25.2</code>, and repeat the process.</p>
<div class="sourceCode" id="cb2513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2513-1"><a href="tools-in-the-trunk.html#cb2513-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> </span>
<span id="cb2513-2"><a href="tools-in-the-trunk.html#cb2513-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">posterior_samples</span>(fit25<span class="fl">.2</span>c) <span class="sc">%&gt;%</span> </span>
<span id="cb2513-3"><a href="tools-in-the-trunk.html#cb2513-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mu =</span> b_Intercept,</span>
<span id="cb2513-4"><a href="tools-in-the-trunk.html#cb2513-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">(mu-100)/sigma</span><span class="st">`</span> <span class="ot">=</span> (b_Intercept <span class="sc">-</span> <span class="dv">100</span>) <span class="sc">/</span> sigma)</span>
<span id="cb2513-5"><a href="tools-in-the-trunk.html#cb2513-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2513-6"><a href="tools-in-the-trunk.html#cb2513-6" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span></span>
<span id="cb2513-7"><a href="tools-in-the-trunk.html#cb2513-7" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">%&gt;%</span> </span>
<span id="cb2513-8"><a href="tools-in-the-trunk.html#cb2513-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mu)) <span class="sc">+</span></span>
<span id="cb2513-9"><a href="tools-in-the-trunk.html#cb2513-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hist</span>(<span class="at">xintercept =</span> <span class="dv">100</span>, <span class="at">binwidth =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb2513-10"><a href="tools-in-the-trunk.html#cb2513-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(mu))</span>
<span id="cb2513-11"><a href="tools-in-the-trunk.html#cb2513-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2513-12"><a href="tools-in-the-trunk.html#cb2513-12" aria-hidden="true" tabindex="-1"></a>p7 <span class="ot">&lt;-</span></span>
<span id="cb2513-13"><a href="tools-in-the-trunk.html#cb2513-13" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">%&gt;%</span> </span>
<span id="cb2513-14"><a href="tools-in-the-trunk.html#cb2513-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sigma)) <span class="sc">+</span></span>
<span id="cb2513-15"><a href="tools-in-the-trunk.html#cb2513-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hist</span>(<span class="at">xintercept =</span> <span class="dv">15</span>, <span class="at">binwidth =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb2513-16"><a href="tools-in-the-trunk.html#cb2513-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(sigma))</span>
<span id="cb2513-17"><a href="tools-in-the-trunk.html#cb2513-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2513-18"><a href="tools-in-the-trunk.html#cb2513-18" aria-hidden="true" tabindex="-1"></a>p8 <span class="ot">&lt;-</span></span>
<span id="cb2513-19"><a href="tools-in-the-trunk.html#cb2513-19" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">%&gt;%</span> </span>
<span id="cb2513-20"><a href="tools-in-the-trunk.html#cb2513-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">(mu-100)/sigma</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb2513-21"><a href="tools-in-the-trunk.html#cb2513-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hist</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">binwidth =</span> <span class="fl">0.01</span>) <span class="sc">+</span></span>
<span id="cb2513-22"><a href="tools-in-the-trunk.html#cb2513-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>((mu<span class="dv">-100</span>)<span class="sc">/</span>sigma))</span>
<span id="cb2513-23"><a href="tools-in-the-trunk.html#cb2513-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2513-24"><a href="tools-in-the-trunk.html#cb2513-24" aria-hidden="true" tabindex="-1"></a>p6 <span class="ot">&lt;-</span></span>
<span id="cb2513-25"><a href="tools-in-the-trunk.html#cb2513-25" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">%&gt;%</span> </span>
<span id="cb2513-26"><a href="tools-in-the-trunk.html#cb2513-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">iter =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb2513-27"><a href="tools-in-the-trunk.html#cb2513-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span>n_lines) <span class="sc">%&gt;%</span> </span>
<span id="cb2513-28"><a href="tools-in-the-trunk.html#cb2513-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(mu, sigma, iter),</span>
<span id="cb2513-29"><a href="tools-in-the-trunk.html#cb2513-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">y_na =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">40</span>, <span class="at">to =</span> <span class="dv">120</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2513-30"><a href="tools-in-the-trunk.html#cb2513-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> <span class="fu">dnorm</span>(<span class="at">x =</span> y_na, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)) <span class="sc">%&gt;%</span> </span>
<span id="cb2513-31"><a href="tools-in-the-trunk.html#cb2513-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2513-32"><a href="tools-in-the-trunk.html#cb2513-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> y_na)) <span class="sc">+</span> </span>
<span id="cb2513-33"><a href="tools-in-the-trunk.html#cb2513-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">data =</span> d, </span>
<span id="cb2513-34"><a href="tools-in-the-trunk.html#cb2513-34" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">stat</span>(density)),</span>
<span id="cb2513-35"><a href="tools-in-the-trunk.html#cb2513-35" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> .<span class="dv">25</span>, <span class="at">binwidth =</span> <span class="dv">2</span>, <span class="at">boundary =</span> <span class="dv">106</span>, </span>
<span id="cb2513-36"><a href="tools-in-the-trunk.html#cb2513-36" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;skyblue4&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb2513-37"><a href="tools-in-the-trunk.html#cb2513-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> density, <span class="at">group =</span> iter),</span>
<span id="cb2513-38"><a href="tools-in-the-trunk.html#cb2513-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">size  =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb2513-39"><a href="tools-in-the-trunk.html#cb2513-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;data with posterior predictive lines&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">110</span>)) <span class="sc">+</span></span>
<span id="cb2513-40"><a href="tools-in-the-trunk.html#cb2513-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p>Finally, combine the subplots, and annotate a bit.</p>
<div class="sourceCode" id="cb2514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2514-1"><a href="tools-in-the-trunk.html#cb2514-1" aria-hidden="true" tabindex="-1"></a>((p1 <span class="sc">|</span> p2) <span class="sc">/</span> (p3 <span class="sc">|</span> p4) <span class="sc">/</span> (p5 <span class="sc">|</span> p6) <span class="sc">/</span> (p7 <span class="sc">|</span> p8)) <span class="sc">+</span></span>
<span id="cb2514-2"><a href="tools-in-the-trunk.html#cb2514-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">&quot;This is our final plot, together.&quot;</span>,</span>
<span id="cb2514-3"><a href="tools-in-the-trunk.html#cb2514-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">caption =</span> <span class="fu">expression</span>(<span class="fu">atop</span>(<span class="fu">italic</span>(<span class="st">&quot;Upper quartet&quot;</span>)<span class="sc">*</span><span class="st">&quot;: Censored data omitted from analysis; parameter estimates are too small.  &quot;</span>, <span class="fu">italic</span>(<span class="st">&quot;Lower quartet&quot;</span>)<span class="sc">*</span><span class="st">&quot;: Censored data imputed in known bins; parameter estimates are accurate.&quot;</span>))) <span class="sc">&amp;</span></span>
<span id="cb2514-4"><a href="tools-in-the-trunk.html#cb2514-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>))</span></code></pre></div>
<p><img src="25_files/figure-html/unnamed-chunk-42-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>To learn more about censored data, check out the nice lecture by Gordon Fox, <a href="https://www.youtube.com/watch?v=aPN10YYrC1M"><em>Introduction to analysis of censored and truncated data</em></a>.</p>
</div>
<div id="bonus-truncation." class="section level3" number="25.4.4">
<h3><span class="header-section-number">25.4.4</span> Bonus: Truncation.</h3>
<p>Though Kruschke didn’t cover it, truncation is often confused with censoring. When you have actually collected all your values, but some are just less certain than you’d like, you have a censoring issue. That is, you can think of censoring as an issue with <em>measurement precision</em>. Truncation has to do with <em>data collection</em>. When there’s some level in your criterion variable that you haven’t collected data on, that’s a truncation issue. For example, imagine you wanted to predict scores on an IQ test with socioeconomic status (SES). There might be a relation, there. But now imagine you only collected data on people with an IQ above 110. Those IQ data are severely left truncated. If you only care about the relation of SES and IQ for those with high IQ scores, your data are fine. But if you want to make general statements across the full range of IQ values, standard regression methods will likely produce biased results. Happily, <strong>brms</strong> allows users to accommodate truncated criterion variables with the <code>trunc()</code> function, which works in a similar way to the <code>cens()</code> function. For details on fitting truncated regression models with <code>trunc()</code>, check out the <em>Additional response information</em> subsection of the <code>brmsformula</code> section of the <a href="https://CRAN.R-project.org/package=brms/brms.pdf"><strong>brms</strong> reference manual</a>. The <a href="https://youtu.be/aPN10YYrC1M?t=6153">end of the Fox lecture</a>, above, briefly covers truncated regression. You can also find a <a href="https://stats.idre.ucla.edu/r/dae/truncated-regression/">brief vignette on truncation</a> by the good folks at the UCLA Institute for Digital Research and Education.</p>
</div>
</div>
<div id="what-next" class="section level2" number="25.5">
<h2><span class="header-section-number">25.5</span> What Next?</h2>
<p>“If you have made it this far and you are looking for more, you might peruse posts at [Kruschke’s] blog, <a href="https://doingbayesiandataanalysis.blogspot.com/">https://doingbayesiandataanalysis.blogspot.com/</a>, and search there for topics that interest you.” In addition to the other references Kruschke mentioned, you might also check out McElreath’s <a href="https://xcelab.net/rm/statistical-rethinking/"><em>Statistical rethinking</em></a>, both first <span class="citation">(<a href="references.html#ref-mcelreathStatisticalRethinkingBayesian2015" role="doc-biblioref">2015</a>)</span> and second <span class="citation">(<a href="references.html#ref-mcelreathStatisticalRethinkingBayesian2020" role="doc-biblioref">2020</a>)</span> editions. Much like this project, I have recoded both editions of <em>Statistical rethinking</em> in a <strong>bookdown</strong> form <span class="citation">(<a href="references.html#ref-kurzStatisticalRethinkingSecondEd2021" role="doc-biblioref">Kurz, 2021</a>, <a href="references.html#ref-kurzStatisticalRethinkingBrms2020" role="doc-biblioref">2020</a>)</span>. Click <a href="https://bookdown.org/content/3890/">here</a> for the first and <a href="https://bookdown.org/content/4857/">here</a> for the second. You can find other pedagogical material at my academic blog, <a href="https://solomonkurz.netlify.com/post/">https://solomonkurz.netlify.com/post/</a>. For assistance on <strong>brms</strong>-related issues, check out the <strong>brms</strong> section on the Stan forums at <a href="https://discourse.mc-stan.org/c/interfaces/brms/36">https://discourse.mc-stan.org/c/interfaces/brms/36</a>. Happy modeling, friends!</p>
</div>
<div id="session-info-24" class="section level2 unnumbered">
<h2>Session info</h2>
<div class="sourceCode" id="cb2515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2515-1"><a href="tools-in-the-trunk.html#cb2515-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.0.4 (2021-02-15)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Catalina 10.15.7
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] patchwork_1.1.1 tidybayes_2.3.1 ggthemes_4.2.4  brms_2.15.0    
##  [5] Rcpp_1.0.6      forcats_0.5.1   stringr_1.4.0   dplyr_1.0.5    
##  [9] purrr_0.3.4     readr_1.4.0     tidyr_1.1.3     tibble_3.1.1   
## [13] ggplot2_3.3.3   tidyverse_1.3.0
## 
## loaded via a namespace (and not attached):
##   [1] readxl_1.3.1         backports_1.2.1      plyr_1.8.6          
##   [4] igraph_1.2.6         svUnit_1.0.3         sp_1.4-4            
##   [7] splines_4.0.4        crosstalk_1.1.0.1    TH.data_1.0-10      
##  [10] rstantools_2.1.1     inline_0.3.17        digest_0.6.27       
##  [13] htmltools_0.5.1.1    rsconnect_0.8.16     fansi_0.4.2         
##  [16] magrittr_2.0.1       modelr_0.1.8         RcppParallel_5.0.2  
##  [19] matrixStats_0.57.0   xts_0.12.1           sandwich_3.0-0      
##  [22] prettyunits_1.1.1    colorspace_2.0-0     rvest_0.3.6         
##  [25] ggdist_2.4.0.9000    haven_2.3.1          xfun_0.22           
##  [28] callr_3.7.0          crayon_1.4.1         jsonlite_1.7.2      
##  [31] lme4_1.1-25          survival_3.2-10      zoo_1.8-8           
##  [34] glue_1.4.2           gtable_0.3.0         emmeans_1.5.2-1     
##  [37] V8_3.4.0             distributional_0.2.2 pkgbuild_1.2.0      
##  [40] rstan_2.21.2         abind_1.4-5          scales_1.1.1        
##  [43] mvtnorm_1.1-1        emo_0.0.0.9000       DBI_1.1.0           
##  [46] miniUI_0.1.1.1       xtable_1.8-4         HDInterval_0.2.2    
##  [49] stats4_4.0.4         StanHeaders_2.21.0-7 DT_0.16             
##  [52] htmlwidgets_1.5.2    httr_1.4.2           threejs_0.3.3       
##  [55] arrayhelpers_1.1-0   ellipsis_0.3.2       farver_2.1.0        
##  [58] pkgconfig_2.0.3      loo_2.4.1            sass_0.3.1          
##  [61] dbplyr_2.0.0         utf8_1.2.1           labeling_0.4.2      
##  [64] tidyselect_1.1.0     rlang_0.4.11         reshape2_1.4.4      
##  [67] later_1.2.0          munsell_0.5.0        cellranger_1.1.0    
##  [70] tools_4.0.4          cli_2.5.0            generics_0.1.0      
##  [73] broom_0.7.5          ggridges_0.5.3       evaluate_0.14       
##  [76] fastmap_1.1.0        processx_3.5.2       knitr_1.31          
##  [79] fs_1.5.0             nlme_3.1-152         mime_0.10           
##  [82] projpred_2.0.2       xml2_1.3.2           rstudioapi_0.13     
##  [85] compiler_4.0.4       bayesplot_1.8.0      shinythemes_1.1.2   
##  [88] curl_4.3             gamm4_0.2-6          reprex_0.3.0        
##  [91] statmod_1.4.35       bslib_0.2.4          stringi_1.5.3       
##  [94] highr_0.8            ps_1.6.0             Brobdingnag_1.2-6   
##  [97] lattice_0.20-41      Matrix_1.3-2         nloptr_1.2.2.2      
## [100] markdown_1.1         shinyjs_2.0.0        vctrs_0.3.8         
## [103] pillar_1.6.0         lifecycle_1.0.0      jquerylib_0.1.4     
## [106] bridgesampling_1.0-0 estimability_1.3     raster_3.4-5        
## [109] httpuv_1.6.0         R6_2.5.0             bookdown_0.21       
## [112] promises_1.2.0.1     gridExtra_2.3        codetools_0.2-18    
## [115] boot_1.3-26          colourpicker_1.1.0   MASS_7.3-53         
## [118] gtools_3.8.2         assertthat_0.2.1     withr_2.4.2         
## [121] shinystan_2.5.0      multcomp_1.4-16      mgcv_1.8-33         
## [124] parallel_4.0.4       hms_0.5.3            grid_4.0.4          
## [127] coda_0.19-4          minqa_1.2.4          rmarkdown_2.7       
## [130] shiny_1.6.0          lubridate_1.7.9.2    base64enc_0.1-3     
## [133] dygraphs_1.1.1.6</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="count-predicted-variable.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
