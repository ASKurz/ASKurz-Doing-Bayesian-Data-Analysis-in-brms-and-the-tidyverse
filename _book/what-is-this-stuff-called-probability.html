<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 What is This Stuff Called Probability? | Doing Bayesian Data Analysis in brms and the tidyverse</title>
  <meta name="description" content="This project is an attempt to re-express the code in Kruschke’s (2014) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="4 What is This Stuff Called Probability? | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This project is an attempt to re-express the code in Kruschke’s (2014) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="github-repo" content="ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 What is This Stuff Called Probability? | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This project is an attempt to re-express the code in Kruschke’s (2014) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2019-10-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-r-programming-language.html">
<link rel="next" href="bayes-rule.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What and why</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#caution-work-in-progress"><i class="fa fa-check"></i>Caution: Work in progress</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html"><i class="fa fa-check"></i><b>1</b> What’s in This Book (Read This First!)</a><ul>
<li class="chapter" data-level="1.1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#real-people-can-read-this-book"><i class="fa fa-check"></i><b>1.1</b> Real people can read this book</a></li>
<li class="chapter" data-level="1.2" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-in-this-book"><i class="fa fa-check"></i><b>1.2</b> What’s in this book</a></li>
<li class="chapter" data-level="1.3" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-new-in-the-second-edition"><i class="fa fa-check"></i><b>1.3</b> What’s new in the second edition</a></li>
<li class="chapter" data-level="1.4" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#gimme-feedback-be-polite"><i class="fa fa-check"></i><b>1.4</b> Gimme feedback (be polite)</a></li>
<li class="chapter" data-level="1.5" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#thank-you"><i class="fa fa-check"></i><b>1.5</b> Thank you!</a></li>
<li class="chapter" data-level="" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#reference"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>I THE BASICS: MODELS, PROBABILITY, BAYES’ RULE, AND R</b></span></li>
<li class="chapter" data-level="2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html"><i class="fa fa-check"></i><b>2</b> Introduction: Credibility, Models, and Parameters</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#bayesian-inference-is-reallocation-of-credibility-across-possibilities"><i class="fa fa-check"></i><b>2.1</b> Bayesian inference is reallocation of credibility across possibilities</a><ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#data-are-noisy-and-inferences-are-probabilistic."><i class="fa fa-check"></i><b>2.1.1</b> Data are noisy and inferences are probabilistic.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#possibilities-are-parameter-values-in-descriptive-models"><i class="fa fa-check"></i><b>2.2</b> Possibilities are parameter values in descriptive models</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#the-steps-of-bayesian-data-analysis"><i class="fa fa-check"></i><b>2.3</b> The steps of Bayesian data analysis</a></li>
<li class="chapter" data-level="" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#reference-1"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html"><i class="fa fa-check"></i><b>3</b> The R Programming Language</a><ul>
<li class="chapter" data-level="3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-software"><i class="fa fa-check"></i><b>3.1</b> Get the software</a><ul>
<li class="chapter" data-level="3.1.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-look-at-rstudio."><i class="fa fa-check"></i><b>3.1.1</b> A look at RStudio.</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-simple-example-of-r-in-action"><i class="fa fa-check"></i><b>3.2</b> A simple example of R in action</a><ul>
<li class="chapter" data-level="3.2.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-programs-used-with-this-book."><i class="fa fa-check"></i><b>3.2.1</b> Get the programs used with this book.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#basic-commands-and-operators-in-r"><i class="fa fa-check"></i><b>3.3</b> Basic commands and operators in R</a><ul>
<li class="chapter" data-level="3.3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#getting-help-in-r."><i class="fa fa-check"></i><b>3.3.1</b> Getting help in R.</a></li>
<li class="chapter" data-level="3.3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#arithmetic-and-logical-operators."><i class="fa fa-check"></i><b>3.3.2</b> Arithmetic and logical operators.</a></li>
<li class="chapter" data-level="3.3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#assignment-relational-operators-and-tests-of-equality."><i class="fa fa-check"></i><b>3.3.3</b> Assignment, relational operators, and tests of equality.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-types"><i class="fa fa-check"></i><b>3.4</b> Variable types</a><ul>
<li class="chapter" data-level="3.4.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#vector."><i class="fa fa-check"></i><b>3.4.1</b> Vector.</a></li>
<li class="chapter" data-level="3.4.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#factor."><i class="fa fa-check"></i><b>3.4.2</b> Factor.</a></li>
<li class="chapter" data-level="3.4.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#matrix-and-array."><i class="fa fa-check"></i><b>3.4.3</b> Matrix and array.</a></li>
<li class="chapter" data-level="3.4.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#list-and-data-frame."><i class="fa fa-check"></i><b>3.4.4</b> List and data frame.</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#loading-and-saving-data"><i class="fa fa-check"></i><b>3.5</b> Loading and saving data</a><ul>
<li class="chapter" data-level="3.5.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#the-read.csv-read_csv-and-read.table-read_table-functions."><i class="fa fa-check"></i><b>3.5.1</b> The <del>read.csv</del> <code>read_csv()</code> and <del>read.table</del> <code>read_table()</code> functions.</a></li>
<li class="chapter" data-level="3.5.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#saving-data-from-r."><i class="fa fa-check"></i><b>3.5.2</b> Saving data from R.</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#some-utility-functions"><i class="fa fa-check"></i><b>3.6</b> Some utility functions</a></li>
<li class="chapter" data-level="3.7" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-in-r"><i class="fa fa-check"></i><b>3.7</b> Programming in R</a><ul>
<li class="chapter" data-level="3.7.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-names-in-r."><i class="fa fa-check"></i><b>3.7.1</b> Variable names in R.</a></li>
<li class="chapter" data-level="3.7.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#running-a-program."><i class="fa fa-check"></i><b>3.7.2</b> Running a program.</a></li>
<li class="chapter" data-level="3.7.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-a-function."><i class="fa fa-check"></i><b>3.7.3</b> Programming a function.</a></li>
<li class="chapter" data-level="3.7.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#conditions-and-loops."><i class="fa fa-check"></i><b>3.7.4</b> Conditions and loops.</a></li>
<li class="chapter" data-level="3.7.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#measuring-processing-time."><i class="fa fa-check"></i><b>3.7.5</b> Measuring processing time.</a></li>
<li class="chapter" data-level="3.7.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#debugging."><i class="fa fa-check"></i><b>3.7.6</b> Debugging.</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#graphical-plots-opening-and-saving"><i class="fa fa-check"></i><b>3.8</b> Graphical plots: Opening and saving</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#reference-2"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html"><i class="fa fa-check"></i><b>4</b> What is This Stuff Called Probability?</a><ul>
<li class="chapter" data-level="4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#the-set-of-all-possible-events"><i class="fa fa-check"></i><b>4.1</b> The set of all possible events</a></li>
<li class="chapter" data-level="4.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-outside-or-inside-the-head"><i class="fa fa-check"></i><b>4.2</b> Probability: Outside or inside the head</a><ul>
<li class="chapter" data-level="4.2.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#outside-the-head-long-run-relative-frequency."><i class="fa fa-check"></i><b>4.2.1</b> Outside the head: Long-run relative frequency.</a></li>
<li class="chapter" data-level="4.2.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#inside-the-head-subjective-belief."><i class="fa fa-check"></i><b>4.2.2</b> Inside the head: Subjective belief.</a></li>
<li class="chapter" data-level="4.2.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probabilities-assign-numbers-to-possibilities."><i class="fa fa-check"></i><b>4.2.3</b> Probabilities assign numbers to possibilities.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-distributions"><i class="fa fa-check"></i><b>4.3</b> Probability distributions</a><ul>
<li class="chapter" data-level="4.3.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#discrete-distributions-probability-mass."><i class="fa fa-check"></i><b>4.3.1</b> Discrete distributions: Probability mass.</a></li>
<li class="chapter" data-level="4.3.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#continuous-distributions-rendezvous-with-density."><i class="fa fa-check"></i><b>4.3.2</b> Continuous distributions: Rendezvous with density.</a></li>
<li class="chapter" data-level="4.3.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#mean-and-variance-of-a-distribution."><i class="fa fa-check"></i><b>4.3.3</b> Mean and variance of a distribution.</a></li>
<li class="chapter" data-level="4.3.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#highest-density-interval-hdi."><i class="fa fa-check"></i><b>4.3.4</b> Highest density interval (HDI).</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#two-way-distributions"><i class="fa fa-check"></i><b>4.4</b> Two-way distributions</a></li>
<li class="chapter" data-level="" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#reference-3"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes-rule.html"><a href="bayes-rule.html"><i class="fa fa-check"></i><b>5</b> Bayes’ Rule</a><ul>
<li class="chapter" data-level="5.1" data-path="bayes-rule.html"><a href="bayes-rule.html#bayes-rule-1"><i class="fa fa-check"></i><b>5.1</b> Bayes’ rule</a><ul>
<li class="chapter" data-level="5.1.1" data-path="bayes-rule.html"><a href="bayes-rule.html#derived-from-definitions-of-conditional-probability."><i class="fa fa-check"></i><b>5.1.1</b> Derived from definitions of conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bayes-rule.html"><a href="bayes-rule.html#applied-to-parameters-and-data"><i class="fa fa-check"></i><b>5.2</b> Applied to parameters and data</a></li>
<li class="chapter" data-level="5.3" data-path="bayes-rule.html"><a href="bayes-rule.html#complete-examples-estimating-bias-in-a-coin"><i class="fa fa-check"></i><b>5.3</b> Complete examples: Estimating bias in a coin</a><ul>
<li class="chapter" data-level="5.3.1" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-sample-size-on-the-posterior."><i class="fa fa-check"></i><b>5.3.1</b> Influence of sample size on the posterior.</a></li>
<li class="chapter" data-level="5.3.2" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-prior-on-the-posterior."><i class="fa fa-check"></i><b>5.3.2</b> Influence of prior on the posterior.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="bayes-rule.html"><a href="bayes-rule.html#why-bayesian-inference-can-be-difficult"><i class="fa fa-check"></i><b>5.4</b> 5.4. Why Bayesian inference can be difficult</a></li>
<li class="chapter" data-level="" data-path="bayes-rule.html"><a href="bayes-rule.html#reference-4"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="bayes-rule.html"><a href="bayes-rule.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Doing Bayesian Data Analysis</em> in brms and the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="what-is-this-stuff-called-probability" class="section level1">
<h1><span class="header-section-number">4</span> What is This Stuff Called Probability?</h1>
<blockquote>
<p>Inferential statistical techniques assign precise measures to our uncertainty about possibilities. Uncertainty is measured in terms of <em>probability</em>, and therefore we must establish the properties of probability before we can make inferences about it. This chapter introduces the basic ideas of probability. (p. 71, <em>emphasis</em> in the original)</p>
</blockquote>
<div id="the-set-of-all-possible-events" class="section level2">
<h2><span class="header-section-number">4.1</span> The set of all possible events</h2>
<p>This snip from page 72 is important (<em>emphasis</em> in the original):</p>
<blockquote>
<p>Whenever we ask about how likely an outcome is, we always ask with a set of possible outcomes in mind. This set exhausts all possible outcomes, and the outcomes are all mutually exclusive. This set is called the <em>sample space</em>.</p>
</blockquote>
</div>
<div id="probability-outside-or-inside-the-head" class="section level2">
<h2><span class="header-section-number">4.2</span> Probability: Outside or inside the head</h2>
<p>It’s worthwhile to quote this section in full.</p>
<blockquote>
<p>Sometimes we talk about probabilities of outcomes that are “out there” in the world. The face of a flipped coin is such an outcome: We can observe the flip, and the probability of coming up heads can be estimated by observing several flips.</p>
<p>But sometimes we talk about probabilities of things that are not so clearly “out there,” and instead are just possible beliefs “inside the head.” Our belief about the fairness of a coin is an example of something inside the head. The coin may have an intrinsic physical bias, but now I am referring to our <em>belief</em> about the bias. Our beliefs refer to a space of mutually exclusive and exhaustive possibilities. It might be strange to say that we randomly sample from our beliefs, like we randomly sample from a sack of coins. Nevertheless, the mathematical properties of probabilities outside the head and beliefs inside the head are the same in their essentials, as we will see. (pp. 73–74, <em>emphasis</em> in the original)</p>
</blockquote>
<div id="outside-the-head-long-run-relative-frequency." class="section level3">
<h3><span class="header-section-number">4.2.1</span> Outside the head: Long-run relative frequency.</h3>
<blockquote>
<p>For events outside the head, it’s intuitive to think of probability as being the long-run relative frequency of each possible outcome…</p>
<p>We can determine the long-run relative frequency by two different ways. One way is to approximate it by actually sampling from the space many times and tallying the number of times each event happens. A second way is by deriving it mathematically. These two methods are now explored in turn. (p. 74)</p>
</blockquote>
<div id="simulating-a-long-run-relative-frequency." class="section level4">
<h4><span class="header-section-number">4.2.1.1</span> Simulating a long-run relative frequency.</h4>
<p>Before we try coding the simulation, we’ll first load the <strong>tidyverse</strong>.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb321-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<p>Now run the simulation.</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb322-1" data-line-number="1">n       &lt;-<span class="st"> </span><span class="dv">500</span>  <span class="co"># specify the total number of flips</span></a>
<a class="sourceLine" id="cb322-2" data-line-number="2">p_heads &lt;-<span class="st"> </span><span class="fl">0.5</span>  <span class="co"># specify underlying probability of heads</span></a>
<a class="sourceLine" id="cb322-3" data-line-number="3"></a>
<a class="sourceLine" id="cb322-4" data-line-number="4"><span class="co"># Kruschke reported this was the seed he used at the top of page 94</span></a>
<a class="sourceLine" id="cb322-5" data-line-number="5"><span class="kw">set.seed</span>(<span class="dv">47405</span>)</a>
<a class="sourceLine" id="cb322-6" data-line-number="6"></a>
<a class="sourceLine" id="cb322-7" data-line-number="7"><span class="co"># here we use that seed to flip a coin n times and compute the running proportion of heads at each flip. </span></a>
<a class="sourceLine" id="cb322-8" data-line-number="8"><span class="co"># we generate a random sample of n flips (heads = 1, tails = 0)</span></a>
<a class="sourceLine" id="cb322-9" data-line-number="9">d &lt;-</a>
<a class="sourceLine" id="cb322-10" data-line-number="10"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">flip_sequence =</span> <span class="kw">sample</span>(<span class="dt">x       =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </a>
<a class="sourceLine" id="cb322-11" data-line-number="11">                                <span class="dt">prob    =</span> <span class="kw">c</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p_heads, p_heads), </a>
<a class="sourceLine" id="cb322-12" data-line-number="12">                                <span class="dt">size    =</span> n, </a>
<a class="sourceLine" id="cb322-13" data-line-number="13">                                <span class="dt">replace =</span> T),</a>
<a class="sourceLine" id="cb322-14" data-line-number="14">         <span class="dt">r =</span> <span class="kw">cumsum</span>(flip_sequence),</a>
<a class="sourceLine" id="cb322-15" data-line-number="15">         <span class="dt">n =</span> <span class="dv">1</span><span class="op">:</span>n) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb322-16" data-line-number="16"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">run_prop =</span> r <span class="op">/</span><span class="st"> </span>n)</a>
<a class="sourceLine" id="cb322-17" data-line-number="17"></a>
<a class="sourceLine" id="cb322-18" data-line-number="18">end_prop &lt;-</a>
<a class="sourceLine" id="cb322-19" data-line-number="19"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb322-20" data-line-number="20"><span class="st">  </span><span class="kw">select</span>(run_prop) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb322-21" data-line-number="21"><span class="st">  </span><span class="kw">slice</span>(<span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb322-22" data-line-number="22"><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb322-23" data-line-number="23"><span class="st">  </span><span class="kw">pull</span>()</a></code></pre></div>
<p>Now we’re ready to make Figure 4.1.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb323-1" data-line-number="1">d <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb323-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(n <span class="op">&lt;</span><span class="st"> </span><span class="dv">1000</span>) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># this step cuts down on the time it takes to make the plot</span></a>
<a class="sourceLine" id="cb323-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> run_prop)) <span class="op">+</span></a>
<a class="sourceLine" id="cb323-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">.5</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb323-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb323-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb323-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_x_log10</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">200</span>, <span class="dv">500</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb323-8" data-line-number="8"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">500</span>,</a>
<a class="sourceLine" id="cb323-9" data-line-number="9">                  <span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb323-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Running proportion of heads&quot;</span>,</a>
<a class="sourceLine" id="cb323-11" data-line-number="11">       <span class="dt">subtitle =</span> <span class="kw">paste</span>(<span class="st">&quot;Our end proportion =&quot;</span>, end_prop),</a>
<a class="sourceLine" id="cb323-12" data-line-number="12">       <span class="dt">x =</span> <span class="st">&quot;Flip number&quot;</span>, </a>
<a class="sourceLine" id="cb323-13" data-line-number="13">       <span class="dt">y =</span> <span class="st">&quot;Proportion of heads&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb323-14" data-line-number="14"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-174-1.png" width="432" /></p>
</div>
<div id="deriving-a-long-run-relative-frequency." class="section level4">
<h4><span class="header-section-number">4.2.1.2</span> Deriving a long-run relative frequency.</h4>
<blockquote>
<p>Sometimes, when the situation is simple enough mathematically, we can derive the exact long-run relative frequency. The case of the fair coin is one such simple situation. The sample space of the coin consists of two possible outcomes, head and tail. By the assumption of fairness, we know that each outcome is equally likely. Therefore, the long-run relative frequency of heads should be exactly one out of two, i.e., 1/2, and the long-run relative frequency of tails should also be exactly 1/2. (p. 76)</p>
</blockquote>
</div>
</div>
<div id="inside-the-head-subjective-belief." class="section level3">
<h3><span class="header-section-number">4.2.2</span> Inside the head: Subjective belief.</h3>
<blockquote>
<p>To specify our subjective beliefs, we have to specify how likely we think each possible outcome is. It can be hard to pin down mushy intuitive beliefs. In the next section, we explore one way to “calibrate” subjective beliefs, and in the subsequent section we discuss ways to mathematically describe degrees of belief. (p. 76)</p>
</blockquote>
</div>
<div id="probabilities-assign-numbers-to-possibilities." class="section level3">
<h3><span class="header-section-number">4.2.3</span> Probabilities assign numbers to possibilities.</h3>
<blockquote>
<p>In general, a probability, whether it’s outside the head or inside the head, is just a way of assigning numbers to a set of mutually exclusive possibilities. The numbers, called “probabilities,” merely need to satisfy three properties (<a href="https://www.york.ac.uk/depts/maths/histstat/kolmogorov_foundations.pdf">Kolmogorov, 1956</a>):</p>
<ol style="list-style-type: decimal">
<li>A probability value must be nonnegative (i.e., zero or positive).</li>
<li>The sum of the probabilities across all events in the entire sample space must be 1.0 (i.e., one of the events in the space must happen, otherwise the space does not exhaust all possibilities).</li>
<li>For any two mutually exclusive events, the probability that one <em>or</em> the other occurs is the <em>sum</em> of their individual probabilities. For example, the probability that a fair six-sided die comes up 3-dots <em>or</em> 4-dots is 1/6 + 1/6 = 2/6.</li>
</ol>
<p>Any assignment of numbers to events that respects those three properties will also have all the properties of probabilities that we will discuss below. (pp. 77–78, <em>emphasis</em> in the original)</p>
</blockquote>
</div>
</div>
<div id="probability-distributions" class="section level2">
<h2><span class="header-section-number">4.3</span> Probability distributions</h2>
<p>“A probability <em>distribution</em> is simply a list of all possible outcomes and their corresponding probabilities” (p. 78, <em>emphasis</em> in the original)</p>
<div id="discrete-distributions-probability-mass." class="section level3">
<h3><span class="header-section-number">4.3.1</span> Discrete distributions: Probability mass.</h3>
<blockquote>
<p>When the sample space consists of discrete outcomes, then we can talk about the probability of each distinct outcome. For example, the sample space of a flipped coin has two discrete outcomes, and we talk about the probability of head or tail…</p>
<p>For continuous outcome spaces, we can <em>discretize</em> the space into a finite set of mutually exclusive and exhaustive “bins.” (p. 78, <em>emphasis</em> in the original)</p>
</blockquote>
<p>In order to recreate Figure 4.2, we need to generate the heights data. In his <code>HtWtDataDenerator.R</code> script, Kruschke provided the code for a function that will generate height data of the kind in his text. Here is the code:</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb324-1" data-line-number="1">HtWtDataGenerator &lt;-<span class="st"> </span><span class="cf">function</span>(n_subj, <span class="dt">rndsd =</span> <span class="ot">NULL</span>, <span class="dt">male_prob =</span> <span class="fl">0.50</span>) {</a>
<a class="sourceLine" id="cb324-2" data-line-number="2">  <span class="co"># Random height, weight generator for males and females. Uses parameters from</span></a>
<a class="sourceLine" id="cb324-3" data-line-number="3">  <span class="co"># Brainard, J. &amp; Burmaster, D. E. (1992). Bivariate distributions for height and</span></a>
<a class="sourceLine" id="cb324-4" data-line-number="4">  <span class="co"># weight of men and women in the United States. Risk Analysis, 12(2), 267-275.</span></a>
<a class="sourceLine" id="cb324-5" data-line-number="5">  <span class="co"># Kruschke, J. K. (2011). Doing Bayesian data analysis:</span></a>
<a class="sourceLine" id="cb324-6" data-line-number="6">  <span class="co"># A Tutorial with R and BUGS. Academic Press / Elsevier.</span></a>
<a class="sourceLine" id="cb324-7" data-line-number="7">  <span class="co"># Kruschke, J. K. (2014). Doing Bayesian data analysis, 2nd Edition:</span></a>
<a class="sourceLine" id="cb324-8" data-line-number="8">  <span class="co"># A Tutorial with R, JAGS and Stan. Academic Press / Elsevier.</span></a>
<a class="sourceLine" id="cb324-9" data-line-number="9">  </a>
<a class="sourceLine" id="cb324-10" data-line-number="10">  <span class="co"># require(MASS)</span></a>
<a class="sourceLine" id="cb324-11" data-line-number="11">  </a>
<a class="sourceLine" id="cb324-12" data-line-number="12">  <span class="co"># Specify parameters of multivariate normal (MVN) distributions.</span></a>
<a class="sourceLine" id="cb324-13" data-line-number="13">  <span class="co"># Men:</span></a>
<a class="sourceLine" id="cb324-14" data-line-number="14">  HtMmu   &lt;-<span class="st"> </span><span class="fl">69.18</span></a>
<a class="sourceLine" id="cb324-15" data-line-number="15">  HtMsd   &lt;-<span class="st"> </span><span class="fl">2.87</span></a>
<a class="sourceLine" id="cb324-16" data-line-number="16">  lnWtMmu &lt;-<span class="st"> </span><span class="fl">5.14</span></a>
<a class="sourceLine" id="cb324-17" data-line-number="17">  lnWtMsd &lt;-<span class="st"> </span><span class="fl">0.17</span></a>
<a class="sourceLine" id="cb324-18" data-line-number="18">  Mrho    &lt;-<span class="st"> </span><span class="fl">0.42</span></a>
<a class="sourceLine" id="cb324-19" data-line-number="19">  Mmean   &lt;-<span class="st"> </span><span class="kw">c</span>(HtMmu, lnWtMmu)</a>
<a class="sourceLine" id="cb324-20" data-line-number="20">  Msigma  &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(HtMsd<span class="op">^</span><span class="dv">2</span>, Mrho <span class="op">*</span><span class="st"> </span>HtMsd <span class="op">*</span><span class="st"> </span>lnWtMsd,</a>
<a class="sourceLine" id="cb324-21" data-line-number="21">                      Mrho <span class="op">*</span><span class="st"> </span>HtMsd <span class="op">*</span><span class="st"> </span>lnWtMsd, lnWtMsd<span class="op">^</span><span class="dv">2</span>), <span class="dt">nrow =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb324-22" data-line-number="22">  <span class="co"># Women cluster 1:</span></a>
<a class="sourceLine" id="cb324-23" data-line-number="23">  HtFmu1   &lt;-<span class="st"> </span><span class="fl">63.11</span></a>
<a class="sourceLine" id="cb324-24" data-line-number="24">  HtFsd1   &lt;-<span class="st"> </span><span class="fl">2.76</span></a>
<a class="sourceLine" id="cb324-25" data-line-number="25">  lnWtFmu1 &lt;-<span class="st"> </span><span class="fl">5.06</span></a>
<a class="sourceLine" id="cb324-26" data-line-number="26">  lnWtFsd1 &lt;-<span class="st"> </span><span class="fl">0.24</span></a>
<a class="sourceLine" id="cb324-27" data-line-number="27">  Frho1    &lt;-<span class="st"> </span><span class="fl">0.41</span></a>
<a class="sourceLine" id="cb324-28" data-line-number="28">  prop1    &lt;-<span class="st"> </span><span class="fl">0.46</span></a>
<a class="sourceLine" id="cb324-29" data-line-number="29">  Fmean1   &lt;-<span class="st"> </span><span class="kw">c</span>(HtFmu1, lnWtFmu1)</a>
<a class="sourceLine" id="cb324-30" data-line-number="30">  Fsigma1  &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(HtFsd1<span class="op">^</span><span class="dv">2</span>, Frho1 <span class="op">*</span><span class="st"> </span>HtFsd1 <span class="op">*</span><span class="st"> </span>lnWtFsd1,</a>
<a class="sourceLine" id="cb324-31" data-line-number="31">                       Frho1 <span class="op">*</span><span class="st"> </span>HtFsd1 <span class="op">*</span><span class="st"> </span>lnWtFsd1, lnWtFsd1<span class="op">^</span><span class="dv">2</span>), <span class="dt">nrow =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb324-32" data-line-number="32">  <span class="co"># Women cluster 2:</span></a>
<a class="sourceLine" id="cb324-33" data-line-number="33">  HtFmu2   &lt;-<span class="st"> </span><span class="fl">64.36</span></a>
<a class="sourceLine" id="cb324-34" data-line-number="34">  HtFsd2   &lt;-<span class="st"> </span><span class="fl">2.49</span></a>
<a class="sourceLine" id="cb324-35" data-line-number="35">  lnWtFmu2 &lt;-<span class="st"> </span><span class="fl">4.86</span></a>
<a class="sourceLine" id="cb324-36" data-line-number="36">  lnWtFsd2 &lt;-<span class="st"> </span><span class="fl">0.14</span></a>
<a class="sourceLine" id="cb324-37" data-line-number="37">  Frho2    &lt;-<span class="st"> </span><span class="fl">0.44</span></a>
<a class="sourceLine" id="cb324-38" data-line-number="38">  prop2    &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>prop1</a>
<a class="sourceLine" id="cb324-39" data-line-number="39">  Fmean2   &lt;-<span class="st"> </span><span class="kw">c</span>(HtFmu2, lnWtFmu2)</a>
<a class="sourceLine" id="cb324-40" data-line-number="40">  Fsigma2  &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(HtFsd2<span class="op">^</span><span class="dv">2</span>, Frho2 <span class="op">*</span><span class="st"> </span>HtFsd2 <span class="op">*</span><span class="st"> </span>lnWtFsd2,</a>
<a class="sourceLine" id="cb324-41" data-line-number="41">                       Frho2 <span class="op">*</span><span class="st"> </span>HtFsd2 <span class="op">*</span><span class="st"> </span>lnWtFsd2, lnWtFsd2<span class="op">^</span><span class="dv">2</span>), <span class="dt">nrow =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb324-42" data-line-number="42">  </a>
<a class="sourceLine" id="cb324-43" data-line-number="43">  <span class="co"># Randomly generate data values from those MVN distributions.</span></a>
<a class="sourceLine" id="cb324-44" data-line-number="44">  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.null</span>(rndsd)) {<span class="kw">set.seed</span>(rndsd)}</a>
<a class="sourceLine" id="cb324-45" data-line-number="45">  data_matrix &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow =</span> n_subj, <span class="dt">ncol =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb324-46" data-line-number="46">  <span class="kw">colnames</span>(data_matrix) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;male&quot;</span>, <span class="st">&quot;height&quot;</span>, <span class="st">&quot;weight&quot;</span>)</a>
<a class="sourceLine" id="cb324-47" data-line-number="47">  maleval &lt;-<span class="st"> </span><span class="dv">1</span>; femaleval &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co"># arbitrary coding values</span></a>
<a class="sourceLine" id="cb324-48" data-line-number="48">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n_subj) {</a>
<a class="sourceLine" id="cb324-49" data-line-number="49">    <span class="co"># Flip coin to decide sex</span></a>
<a class="sourceLine" id="cb324-50" data-line-number="50">    sex =<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(maleval, femaleval), <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb324-51" data-line-number="51">                 <span class="dt">prob =</span> <span class="kw">c</span>(male_prob, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>male_prob))</a>
<a class="sourceLine" id="cb324-52" data-line-number="52">    <span class="cf">if</span> (sex <span class="op">==</span><span class="st"> </span>maleval) {datum &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">mvrnorm</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">mu =</span> Mmean, <span class="dt">Sigma =</span> Msigma)}</a>
<a class="sourceLine" id="cb324-53" data-line-number="53">    <span class="cf">if</span> (sex <span class="op">==</span><span class="st"> </span>femaleval) {</a>
<a class="sourceLine" id="cb324-54" data-line-number="54">      Fclust =<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(prop1, prop2))</a>
<a class="sourceLine" id="cb324-55" data-line-number="55">      <span class="cf">if</span> (Fclust <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {datum &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">mvrnorm</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">mu =</span> Fmean1, <span class="dt">Sigma =</span> Fsigma1)}</a>
<a class="sourceLine" id="cb324-56" data-line-number="56">      <span class="cf">if</span> (Fclust <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) {datum &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">mvrnorm</span>(<span class="dt">n =</span> <span class="dv">1</span>, <span class="dt">mu =</span> Fmean2, <span class="dt">Sigma =</span> Fsigma2)}</a>
<a class="sourceLine" id="cb324-57" data-line-number="57">    }</a>
<a class="sourceLine" id="cb324-58" data-line-number="58">    data_matrix[i, ] =<span class="st"> </span><span class="kw">c</span>(sex, <span class="kw">round</span>(<span class="kw">c</span>(datum[<span class="dv">1</span>], <span class="kw">exp</span>(datum[<span class="dv">2</span>])), <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb324-59" data-line-number="59">  }</a>
<a class="sourceLine" id="cb324-60" data-line-number="60">  </a>
<a class="sourceLine" id="cb324-61" data-line-number="61">  <span class="kw">return</span>(data_matrix)</a>
<a class="sourceLine" id="cb324-62" data-line-number="62">} <span class="co"># end function</span></a></code></pre></div>
<p>Now we have the <code>HtWtDataGenerator()</code> function, all we need to do is determine how many values are generated and how probable we want the values to be based on those from men. These are controlled by the <code>n_subj</code> and <code>male_prob</code> parameters.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb325-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb325-2" data-line-number="2">d &lt;-</a>
<a class="sourceLine" id="cb325-3" data-line-number="3"><span class="st">  </span><span class="kw">HtWtDataGenerator</span>(<span class="dt">n_subj =</span> <span class="dv">10000</span>, <span class="dt">male_prob =</span> <span class="fl">.5</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb325-4" data-line-number="4"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb325-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">person =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>())</a>
<a class="sourceLine" id="cb325-6" data-line-number="6"></a>
<a class="sourceLine" id="cb325-7" data-line-number="7">d <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb325-8" data-line-number="8"><span class="st">  </span><span class="kw">head</span>()</a></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##    male height weight person
##   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;int&gt;
## 1     1   76     222.      1
## 2     0   59.5   190       2
## 3     0   60.2   118.      3
## 4     1   64.1   138.      4
## 5     1   69.3   148.      5
## 6     1   69.1   166.      6</code></pre>
<p>For Figure 4.2, we’ll make extensive use of the <code>case_when()</code> syntax, which you can learn more about from <a href="https://rud.is/b/2017/03/10/making-a-case-for-case_when/">hrbrmstr’s <em>Making a Case for case_when</em></a>.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb327-1" data-line-number="1">d_bin &lt;-</a>
<a class="sourceLine" id="cb327-2" data-line-number="2"><span class="st">  </span>d <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb327-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">bin =</span> <span class="kw">case_when</span>(</a>
<a class="sourceLine" id="cb327-4" data-line-number="4">    height <span class="op">&lt;</span><span class="st"> </span><span class="dv">51</span> <span class="op">~</span><span class="st"> </span><span class="dv">51</span>,</a>
<a class="sourceLine" id="cb327-5" data-line-number="5">    <span class="kw">between</span>(height, <span class="dv">51</span>, <span class="dv">53</span>) <span class="op">~</span><span class="st"> </span><span class="dv">53</span>,</a>
<a class="sourceLine" id="cb327-6" data-line-number="6">    <span class="kw">between</span>(height, <span class="dv">53</span>, <span class="dv">55</span>) <span class="op">~</span><span class="st"> </span><span class="dv">55</span>,</a>
<a class="sourceLine" id="cb327-7" data-line-number="7">    <span class="kw">between</span>(height, <span class="dv">55</span>, <span class="dv">57</span>) <span class="op">~</span><span class="st"> </span><span class="dv">57</span>,</a>
<a class="sourceLine" id="cb327-8" data-line-number="8">    <span class="kw">between</span>(height, <span class="dv">57</span>, <span class="dv">59</span>) <span class="op">~</span><span class="st"> </span><span class="dv">59</span>,</a>
<a class="sourceLine" id="cb327-9" data-line-number="9">    <span class="kw">between</span>(height, <span class="dv">59</span>, <span class="dv">61</span>) <span class="op">~</span><span class="st"> </span><span class="dv">61</span>,</a>
<a class="sourceLine" id="cb327-10" data-line-number="10">    <span class="kw">between</span>(height, <span class="dv">61</span>, <span class="dv">63</span>) <span class="op">~</span><span class="st"> </span><span class="dv">63</span>,</a>
<a class="sourceLine" id="cb327-11" data-line-number="11">    <span class="kw">between</span>(height, <span class="dv">63</span>, <span class="dv">65</span>) <span class="op">~</span><span class="st"> </span><span class="dv">65</span>,</a>
<a class="sourceLine" id="cb327-12" data-line-number="12">    <span class="kw">between</span>(height, <span class="dv">65</span>, <span class="dv">67</span>) <span class="op">~</span><span class="st"> </span><span class="dv">67</span>,</a>
<a class="sourceLine" id="cb327-13" data-line-number="13">    <span class="kw">between</span>(height, <span class="dv">67</span>, <span class="dv">69</span>) <span class="op">~</span><span class="st"> </span><span class="dv">69</span>,</a>
<a class="sourceLine" id="cb327-14" data-line-number="14">    <span class="kw">between</span>(height, <span class="dv">69</span>, <span class="dv">71</span>) <span class="op">~</span><span class="st"> </span><span class="dv">71</span>,</a>
<a class="sourceLine" id="cb327-15" data-line-number="15">    <span class="kw">between</span>(height, <span class="dv">71</span>, <span class="dv">73</span>) <span class="op">~</span><span class="st"> </span><span class="dv">73</span>,</a>
<a class="sourceLine" id="cb327-16" data-line-number="16">    <span class="kw">between</span>(height, <span class="dv">73</span>, <span class="dv">75</span>) <span class="op">~</span><span class="st"> </span><span class="dv">75</span>,</a>
<a class="sourceLine" id="cb327-17" data-line-number="17">    <span class="kw">between</span>(height, <span class="dv">75</span>, <span class="dv">77</span>) <span class="op">~</span><span class="st"> </span><span class="dv">77</span>,</a>
<a class="sourceLine" id="cb327-18" data-line-number="18">    <span class="kw">between</span>(height, <span class="dv">77</span>, <span class="dv">79</span>) <span class="op">~</span><span class="st"> </span><span class="dv">79</span>,</a>
<a class="sourceLine" id="cb327-19" data-line-number="19">    <span class="kw">between</span>(height, <span class="dv">79</span>, <span class="dv">81</span>) <span class="op">~</span><span class="st"> </span><span class="dv">71</span>,</a>
<a class="sourceLine" id="cb327-20" data-line-number="20">    <span class="kw">between</span>(height, <span class="dv">81</span>, <span class="dv">83</span>) <span class="op">~</span><span class="st"> </span><span class="dv">83</span>,</a>
<a class="sourceLine" id="cb327-21" data-line-number="21">    height <span class="op">&gt;</span><span class="st"> </span><span class="dv">83</span> <span class="op">~</span><span class="st"> </span><span class="dv">85</span>)</a>
<a class="sourceLine" id="cb327-22" data-line-number="22">    ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb327-23" data-line-number="23"><span class="st">  </span><span class="kw">group_by</span>(bin) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb327-24" data-line-number="24"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb327-25" data-line-number="25"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">height =</span> bin <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb327-26" data-line-number="26"></a>
<a class="sourceLine" id="cb327-27" data-line-number="27">d <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb327-28" data-line-number="28"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> height, <span class="dt">y =</span> person)) <span class="op">+</span></a>
<a class="sourceLine" id="cb327-29" data-line-number="29"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span><span class="op">/</span><span class="dv">4</span>, <span class="dt">color =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb327-30" data-line-number="30"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">51</span>, <span class="dt">to =</span> <span class="dv">83</span>, <span class="dt">by =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb327-31" data-line-number="31">             <span class="dt">linetype =</span> <span class="dv">3</span>, <span class="dt">color =</span> <span class="st">&quot;grey33&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb327-32" data-line-number="32"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> d_bin, </a>
<a class="sourceLine" id="cb327-33" data-line-number="33">            <span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">5000</span>, <span class="dt">label =</span> n),</a>
<a class="sourceLine" id="cb327-34" data-line-number="34">            <span class="dt">size =</span> <span class="fl">3.25</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb327-35" data-line-number="35"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">5000</span>, <span class="dv">10000</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb327-36" data-line-number="36"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Total N = 10,000&quot;</span>,</a>
<a class="sourceLine" id="cb327-37" data-line-number="37">       <span class="dt">x =</span> <span class="st">&quot;Height (inches)&quot;</span>,</a>
<a class="sourceLine" id="cb327-38" data-line-number="38">       <span class="dt">y =</span> <span class="st">&quot;Person #&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb327-39" data-line-number="39"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-177-1.png" width="672" /></p>
<p>Because we’re simulating and we don’t know what seed number Kruschke used for his plot, ours will differ a little from his. But the overall pattern is the same.</p>
<p>It’s a little less work to make Figure 4.2.b.</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb328-1" data-line-number="1">d <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb328-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> height)) <span class="op">+</span></a>
<a class="sourceLine" id="cb328-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">stat</span>(density)),</a>
<a class="sourceLine" id="cb328-4" data-line-number="4">                 <span class="dt">binwidth =</span> <span class="dv">2</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>,</a>
<a class="sourceLine" id="cb328-5" data-line-number="5">                 <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb328-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.04</span>, <span class="fl">.08</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb328-7" data-line-number="7"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">51</span><span class="op">:</span><span class="dv">83</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb328-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Height (inches)&quot;</span>,</a>
<a class="sourceLine" id="cb328-9" data-line-number="9">       <span class="dt">y =</span> <span class="st">&quot;Probability density&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb328-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-178-1.png" width="672" /></p>
<p>Our data binning approach for Figure 4.2.c will be a little different than what we did, above. Here we’ll make our bins with the <code>round()</code> function.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb329-1" data-line-number="1">d_bin &lt;-</a>
<a class="sourceLine" id="cb329-2" data-line-number="2"><span class="st">  </span>d <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb329-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">bin =</span> <span class="kw">round</span>(height, <span class="dt">digits =</span> <span class="dv">0</span>)) <span class="op">%&gt;%</span><span class="st">   </span></a>
<a class="sourceLine" id="cb329-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(bin) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb329-5" data-line-number="5"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb329-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">height =</span> bin <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb329-7" data-line-number="7"></a>
<a class="sourceLine" id="cb329-8" data-line-number="8">d <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb329-9" data-line-number="9"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> height, <span class="dt">y =</span> person)) <span class="op">+</span></a>
<a class="sourceLine" id="cb329-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span><span class="op">/</span><span class="dv">4</span>, <span class="dt">color =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb329-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">51</span>, <span class="dt">to =</span> <span class="dv">83</span>, <span class="dt">by =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb329-12" data-line-number="12">             <span class="dt">linetype =</span> <span class="dv">3</span>, <span class="dt">color =</span> <span class="st">&quot;grey33&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb329-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> d_bin, </a>
<a class="sourceLine" id="cb329-14" data-line-number="14">            <span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">5000</span>, <span class="dt">label =</span> n, <span class="dt">angle =</span> <span class="dv">90</span>),</a>
<a class="sourceLine" id="cb329-15" data-line-number="15">            <span class="dt">size =</span> <span class="fl">3.25</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb329-16" data-line-number="16"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">5000</span>, <span class="dv">10000</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb329-17" data-line-number="17"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Total N = 10,000&quot;</span>,</a>
<a class="sourceLine" id="cb329-18" data-line-number="18">       <span class="dt">x =</span> <span class="st">&quot;Height (inches)&quot;</span>,</a>
<a class="sourceLine" id="cb329-19" data-line-number="19">       <span class="dt">y =</span> <span class="st">&quot;Person #&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb329-20" data-line-number="20"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-179-1.png" width="672" /></p>
<p>However, our method for Figure 4.2.d will be like what we did, before.</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb330-1" data-line-number="1">d <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb330-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> height)) <span class="op">+</span></a>
<a class="sourceLine" id="cb330-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">stat</span>(density)), <span class="dt">boundary =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb330-4" data-line-number="4">                 <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>,</a>
<a class="sourceLine" id="cb330-5" data-line-number="5">                 <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb330-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.04</span>, <span class="fl">.08</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb330-7" data-line-number="7"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">51</span><span class="op">:</span><span class="dv">83</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb330-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Height (inches)&quot;</span>,</a>
<a class="sourceLine" id="cb330-9" data-line-number="9">       <span class="dt">y =</span> <span class="st">&quot;Probability density&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb330-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-180-1.png" width="672" /></p>
<blockquote>
<p>The probability of a discrete outcome, such as the probability of falling into an interval on a continuous scale, is referred to as a probability <em>mass.</em> Loosely speaking, the term “mass” refers the amount of stuff in an object. When the stuff is probability and the object is an interval of a scale, then the mass is the proportion of the outcomes in the interval. (p. 80, <em>emphasis</em> in the original)</p>
</blockquote>
</div>
<div id="continuous-distributions-rendezvous-with-density." class="section level3">
<h3><span class="header-section-number">4.3.2</span> Continuous distributions: Rendezvous with density.</h3>
<blockquote>
<p>If you think carefully about a continuous outcome space, you realize that it becomes problematic to talk about the probability of a specific value on the continuum, as opposed to an interval on the continuum… Therefore, what we will do is make the intervals infinitesimally narrow, and instead of talking about the infinitesimal probability mass of each infinitesimal interval, we will talk about the ratio of the probability mass to the interval width. That ratio is called the probability <em>density</em>.</p>
<p>Loosely speaking, density is the amount of stuff per unit of space it takes up. Because we are measuring amount of stuff by its mass, then density is the mass divided by the amount space it occupies. (p. 80, <em>emphasis</em> in the original)</p>
</blockquote>
<p>To make Figure 4.3, we’ll need new data.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb331-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb331-2" data-line-number="2">d &lt;-</a>
<a class="sourceLine" id="cb331-3" data-line-number="3"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">height =</span> <span class="kw">rnorm</span>(<span class="fl">1e4</span>, <span class="dt">mean =</span> <span class="dv">84</span>, <span class="dt">sd =</span> <span class="fl">.1</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb331-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">door =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>())</a>
<a class="sourceLine" id="cb331-5" data-line-number="5"></a>
<a class="sourceLine" id="cb331-6" data-line-number="6">d <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb331-7" data-line-number="7"><span class="st">  </span><span class="kw">head</span>()</a></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   height  door
##    &lt;dbl&gt; &lt;int&gt;
## 1   84.0     1
## 2   83.9     2
## 3   84.1     3
## 4   84.1     4
## 5   84.2     5
## 6   84.1     6</code></pre>
<p>To make the bins for our version of Figure 4.3.a, we could use the <code>case_when()</code> approach from above. However, that would require some tedious code. Happily, we have an alternative in the <a href="https://github.com/hughjonesd/santoku"><strong>santoku</strong> package</a>. We can use the <code>santoku::chop()</code> function to discretize our <code>height</code> values. Here we’ll walk through the first part.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb333-1" data-line-number="1"><span class="co"># devtools::install_github(&quot;hughjonesd/santoku&quot;)</span></a>
<a class="sourceLine" id="cb333-2" data-line-number="2"><span class="kw">library</span>(santoku)</a>
<a class="sourceLine" id="cb333-3" data-line-number="3"></a>
<a class="sourceLine" id="cb333-4" data-line-number="4">d_bin &lt;-</a>
<a class="sourceLine" id="cb333-5" data-line-number="5"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb333-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">bin =</span> <span class="kw">chop</span>(height, </a>
<a class="sourceLine" id="cb333-7" data-line-number="7">                    <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">83.6</span>, <span class="dt">to =</span> <span class="fl">84.4</span>, <span class="dt">length.out =</span> <span class="dv">31</span>),</a>
<a class="sourceLine" id="cb333-8" data-line-number="8">                    <span class="dt">labels =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">83.6</span>, <span class="dt">to =</span> <span class="fl">84.4</span>, <span class="dt">length.out =</span> <span class="dv">31</span>)[<span class="op">-</span><span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb333-9" data-line-number="9"></a>
<a class="sourceLine" id="cb333-10" data-line-number="10"><span class="kw">head</span>(d_bin)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   height  door bin             
##    &lt;dbl&gt; &lt;int&gt; &lt;fct&gt;           
## 1   84.0     1 84.0266666666667
## 2   83.9     2 83.9466666666667
## 3   84.1     3 84.1066666666667
## 4   84.1     4 84.08           
## 5   84.2     5 84.1866666666667
## 6   84.1     6 84.08</code></pre>
<p>We’ve labeled our <code>bin</code> levels by their upper bounds. Note how they are saved as factors. To make use of those values in our plot, we’ll need to convert them to numerals. Here we make that conversion and complete the data wrangling.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb335-1" data-line-number="1">d_bin &lt;-</a>
<a class="sourceLine" id="cb335-2" data-line-number="2"><span class="st">  </span>d_bin <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb335-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">bin =</span> <span class="kw">as.character</span>(bin) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.double</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb335-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(bin) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb335-5" data-line-number="5"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb335-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">height =</span> bin <span class="op">-</span><span class="st"> </span>(<span class="fl">83.62667</span> <span class="op">-</span><span class="st"> </span><span class="fl">83.6</span>) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb335-7" data-line-number="7"></a>
<a class="sourceLine" id="cb335-8" data-line-number="8"><span class="kw">head</span>(d_bin)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##     bin     n height
##   &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;
## 1  83.7     5   83.6
## 2  83.7     5   83.7
## 3  83.7     7   83.7
## 4  83.7    24   83.7
## 5  83.8    37   83.7
## 6  83.8    86   83.8</code></pre>
<p>Now we plot.</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb337-1" data-line-number="1">d <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb337-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> height, <span class="dt">y =</span> door)) <span class="op">+</span></a>
<a class="sourceLine" id="cb337-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span><span class="op">/</span><span class="dv">4</span>, <span class="dt">color =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb337-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">83.6</span>, <span class="dt">to =</span> <span class="fl">84.4</span>, <span class="dt">length.out =</span> <span class="dv">31</span>),</a>
<a class="sourceLine" id="cb337-5" data-line-number="5">             <span class="dt">linetype =</span> <span class="dv">3</span>, <span class="dt">color =</span> <span class="st">&quot;grey33&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb337-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> d_bin,</a>
<a class="sourceLine" id="cb337-7" data-line-number="7">            <span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">5000</span>, <span class="dt">label =</span> n, <span class="dt">angle =</span> <span class="dv">90</span>),</a>
<a class="sourceLine" id="cb337-8" data-line-number="8">            <span class="dt">size =</span> <span class="fl">3.25</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb337-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">5000</span>, <span class="dv">10000</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb337-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Total N = 10,000&quot;</span>,</a>
<a class="sourceLine" id="cb337-11" data-line-number="11">       <span class="dt">x =</span> <span class="st">&quot;Height (inches)&quot;</span>,</a>
<a class="sourceLine" id="cb337-12" data-line-number="12">       <span class="dt">y =</span> <span class="st">&quot;Door #&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb337-13" data-line-number="13"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-184-1.png" width="672" /></p>
<p>Figure 4.3.b is a breeze.</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb338-1" data-line-number="1">d <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb338-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> height)) <span class="op">+</span></a>
<a class="sourceLine" id="cb338-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">stat</span>(density)), <span class="dt">boundary =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb338-4" data-line-number="4">                 <span class="dt">binwidth =</span> <span class="fl">.025</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>,</a>
<a class="sourceLine" id="cb338-5" data-line-number="5">                 <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb338-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb338-7" data-line-number="7"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">83.6</span>, <span class="fl">84.4</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb338-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Height (inches)&quot;</span>,</a>
<a class="sourceLine" id="cb338-9" data-line-number="9">       <span class="dt">y =</span> <span class="st">&quot;Probability density&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb338-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-185-1.png" width="672" /></p>
<div id="properties-of-probability-density-functions." class="section level4">
<h4><span class="header-section-number">4.3.2.1</span> Properties of probability density functions.</h4>
</div>
<div id="the-normal-probability-density-function." class="section level4">
<h4><span class="header-section-number">4.3.2.2</span> The normal probability density function.</h4>
<p>We’ll use <code>dnorm()</code> again to make our version of Figure 4.4.</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb339-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">x   =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">-.8</span>, <span class="dt">to =</span> <span class="fl">.8</span>, <span class="dt">by =</span> <span class="fl">.02</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb339-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p =</span> <span class="kw">dnorm</span>(x, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="fl">.2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb339-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb339-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb339-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> p),</a>
<a class="sourceLine" id="cb339-6" data-line-number="6">            <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>, <span class="dt">size =</span> <span class="fl">1.25</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb339-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_linerange</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> p),</a>
<a class="sourceLine" id="cb339-8" data-line-number="8">                 <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb339-9" data-line-number="9"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span>.<span class="dv">61</span>, <span class="fl">.61</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb339-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title    =</span> <span class="st">&quot;Normal probability density&quot;</span>,</a>
<a class="sourceLine" id="cb339-11" data-line-number="11">       <span class="dt">subtitle =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(mu, <span class="st">&quot; = 0 and &quot;</span>, sigma, <span class="st">&quot; = 0.2&quot;</span>)),</a>
<a class="sourceLine" id="cb339-12" data-line-number="12">       <span class="dt">y        =</span> <span class="st">&quot;p(x)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb339-13" data-line-number="13"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-186-1.png" width="432" /></p>
<p>The equation for the normal probability density follows the form</p>
<p><span class="math display">\[
p(x) = \frac{1}{\sigma \sqrt{2 \pi}} \exp \Bigg ( - \frac{1}{2} \bigg [ \frac{x - \mu}{\sigma}^2 \bigg ] \Bigg ),
\]</span></p>
<p>where <span class="math inline">\(\mu\)</span> governs the mean and <span class="math inline">\(\sigma\)</span> governs the standard deviation.</p>
</div>
</div>
<div id="mean-and-variance-of-a-distribution." class="section level3">
<h3><span class="header-section-number">4.3.3</span> Mean and variance of a distribution.</h3>
<p>The mean of a probability distribution is also called the <em>expected value</em>, which follow the form</p>
<p><span class="math display">\[E[x] = \sum_x p(x) x\]</span></p>
<p>when <span class="math inline">\(x\)</span> is discrete. For continuous <span class="math inline">\(x\)</span> values, the formula is</p>
<p><span class="math display">\[E[x] = \int \text d x \; p(x) x.\]</span></p>
<p>The variance is defined as the mean squared deviation from the mean,</p>
<p><span class="math display">\[\text{var}_x = \int \text d x \; p(x) (x - E[x])^2.\]</span></p>
<p>If you take the square root of the variance, you get the standard deviation.</p>
</div>
<div id="highest-density-interval-hdi." class="section level3">
<h3><span class="header-section-number">4.3.4</span> Highest density interval (HDI).</h3>
<blockquote>
<p>The HDI indicates which points of a distribution are most credible, and which cover most of the distribution. Thus, the HDI summarizes the distribution by specifying an interval that spans most of the distribution, say 95% of it, such that every point inside the interval has higher credibility than any point outside the interval. (p. 87)</p>
</blockquote>
<p>In chapter 10 (p. 294), Kruschke briefly mentions his <code>HDIofICDF()</code> function, the code for which you can find in his <code>DBDA2E-utilities.R</code> file. It’s a handy function which we’ll put to use from time to time. Here’s a mild reworking of his code.</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb340-1" data-line-number="1">hdi_of_icdf &lt;-<span class="st"> </span><span class="cf">function</span>(name, <span class="dt">width =</span> <span class="fl">.95</span>, <span class="dt">tol =</span> <span class="fl">1e-8</span>, ... ) {</a>
<a class="sourceLine" id="cb340-2" data-line-number="2">  <span class="co"># Arguments:</span></a>
<a class="sourceLine" id="cb340-3" data-line-number="3">  <span class="co">#   `name` is R&#39;s name for the inverse cumulative density function</span></a>
<a class="sourceLine" id="cb340-4" data-line-number="4">  <span class="co">#   of the distribution.</span></a>
<a class="sourceLine" id="cb340-5" data-line-number="5">  <span class="co">#   `width` is the desired mass of the HDI region.</span></a>
<a class="sourceLine" id="cb340-6" data-line-number="6">  <span class="co">#   `tol` is passed to R&#39;s optimize function.</span></a>
<a class="sourceLine" id="cb340-7" data-line-number="7">  <span class="co"># Return value:</span></a>
<a class="sourceLine" id="cb340-8" data-line-number="8">  <span class="co">#   Highest density iterval (HDI) limits in a vector.</span></a>
<a class="sourceLine" id="cb340-9" data-line-number="9">  <span class="co"># Example of use: For determining HDI of a beta(30, 12) distribution, type</span></a>
<a class="sourceLine" id="cb340-10" data-line-number="10">  <span class="co">#   `hdi_of_icdf(qbeta, shape1 = 30, shape2 = 12)`</span></a>
<a class="sourceLine" id="cb340-11" data-line-number="11">  <span class="co">#   Notice that the parameters of the `name` must be explicitly stated;</span></a>
<a class="sourceLine" id="cb340-12" data-line-number="12">  <span class="co">#   e.g., `hdi_of_icdf(qbeta, 30, 12)` does not work.</span></a>
<a class="sourceLine" id="cb340-13" data-line-number="13">  <span class="co"># Adapted and corrected from Greg Snow&#39;s TeachingDemos package.</span></a>
<a class="sourceLine" id="cb340-14" data-line-number="14">  incredible_mass &lt;-<span class="st">  </span><span class="fl">1.0</span> <span class="op">-</span><span class="st"> </span>width</a>
<a class="sourceLine" id="cb340-15" data-line-number="15">  interval_width  &lt;-<span class="st"> </span><span class="cf">function</span>(low_tail_prob, name, width, ...) {</a>
<a class="sourceLine" id="cb340-16" data-line-number="16">    <span class="kw">name</span>(width <span class="op">+</span><span class="st"> </span>low_tail_prob, ...) <span class="op">-</span><span class="st"> </span><span class="kw">name</span>(low_tail_prob, ...)</a>
<a class="sourceLine" id="cb340-17" data-line-number="17">  }</a>
<a class="sourceLine" id="cb340-18" data-line-number="18">  opt_info            &lt;-<span class="st"> </span><span class="kw">optimize</span>(interval_width, <span class="kw">c</span>(<span class="dv">0</span>, incredible_mass), </a>
<a class="sourceLine" id="cb340-19" data-line-number="19">                                  <span class="dt">name =</span> name, <span class="dt">width =</span> width, </a>
<a class="sourceLine" id="cb340-20" data-line-number="20">                                  <span class="dt">tol =</span> tol, ...)</a>
<a class="sourceLine" id="cb340-21" data-line-number="21">  hdi_lower_tail_prob &lt;-<span class="st"> </span>opt_info<span class="op">$</span>minimum</a>
<a class="sourceLine" id="cb340-22" data-line-number="22">  <span class="kw">return</span>(<span class="kw">c</span>(<span class="kw">name</span>(hdi_lower_tail_prob, ...),</a>
<a class="sourceLine" id="cb340-23" data-line-number="23">           <span class="kw">name</span>(width <span class="op">+</span><span class="st"> </span>hdi_lower_tail_prob, ...)))</a>
<a class="sourceLine" id="cb340-24" data-line-number="24">}</a></code></pre></div>
<p>Now we already know from the text, and perhaps from prior experience, what the 95% HDIs for the unit normal. But it’s nice to be able to confirm that with a function.</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb341-1" data-line-number="1">h &lt;-</a>
<a class="sourceLine" id="cb341-2" data-line-number="2"><span class="st">  </span><span class="kw">hdi_of_icdf</span>(<span class="dt">name =</span> qnorm,</a>
<a class="sourceLine" id="cb341-3" data-line-number="3">              <span class="dt">mean =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb341-4" data-line-number="4">              <span class="dt">sd   =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb341-5" data-line-number="5"></a>
<a class="sourceLine" id="cb341-6" data-line-number="6">h</a></code></pre></div>
<pre><code>## [1] -1.959964  1.959964</code></pre>
<p>Now we’ve saved those values in <code>h</code>, we can use then to make our version of Figure 4.5.a.</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb343-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">-3.5</span>, <span class="dt">to =</span> <span class="fl">3.5</span>, <span class="dt">by =</span> <span class="fl">.05</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb343-2" data-line-number="2"><span class="st">  </span></a>
<a class="sourceLine" id="cb343-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb343-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb343-5" data-line-number="5">                  <span class="dt">ymax =</span> <span class="kw">dnorm</span>(x, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb343-6" data-line-number="6">              <span class="dt">fill =</span> <span class="st">&quot;grey75&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb343-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> . <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(x <span class="op">&gt;=</span>h[<span class="dv">1</span>] <span class="op">&amp;</span><span class="st"> </span>x <span class="op">&lt;=</span><span class="st"> </span>h[<span class="dv">2</span>]),</a>
<a class="sourceLine" id="cb343-8" data-line-number="8">                <span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb343-9" data-line-number="9">                  <span class="dt">ymax =</span> <span class="kw">dnorm</span>(x, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb343-10" data-line-number="10">              <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb343-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">c</span>(h[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="fl">.02</span>, h[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span><span class="fl">.02</span>),</a>
<a class="sourceLine" id="cb343-12" data-line-number="12">                          <span class="dt">y =</span> <span class="kw">c</span>(.<span class="dv">059</span>, <span class="fl">.059</span>)),</a>
<a class="sourceLine" id="cb343-13" data-line-number="13">            <span class="kw">aes</span>(<span class="dt">y =</span> y),</a>
<a class="sourceLine" id="cb343-14" data-line-number="14">            <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(.<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>), </a>
<a class="sourceLine" id="cb343-15" data-line-number="15">                          <span class="dt">ends =</span> <span class="st">&quot;both&quot;</span>, </a>
<a class="sourceLine" id="cb343-16" data-line-number="16">                          <span class="dt">type =</span> <span class="st">&quot;closed&quot;</span>),</a>
<a class="sourceLine" id="cb343-17" data-line-number="17">            <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb343-18" data-line-number="18"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="fl">.09</span>, </a>
<a class="sourceLine" id="cb343-19" data-line-number="19">           <span class="dt">label =</span> <span class="st">&quot;95% HDI&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb343-20" data-line-number="20"><span class="st">  </span><span class="kw">xlim</span>(<span class="op">-</span><span class="fl">3.1</span>, <span class="fl">3.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb343-21" data-line-number="21"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;p(x)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb343-22" data-line-number="22"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-189-1.png" width="432" /></p>
<p>As far as I could tell, Figure 4.5.b is of a beta distribution, which Kruschke covers in greater detail starting in chapter 6. I got the <code>shape1</code> and <code>shape2</code> values from playing around. If you have a more principled approach, <a href="https://github.com/ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse/issues">do share</a>. But anyway, we can use our <code>hdi_of_icdf()</code> funciton to ge the correct values.</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb344-1" data-line-number="1">h &lt;-</a>
<a class="sourceLine" id="cb344-2" data-line-number="2"><span class="st">  </span><span class="kw">hdi_of_icdf</span>(<span class="dt">name   =</span> qbeta,</a>
<a class="sourceLine" id="cb344-3" data-line-number="3">              <span class="dt">shape1 =</span> <span class="dv">15</span>, </a>
<a class="sourceLine" id="cb344-4" data-line-number="4">              <span class="dt">shape2 =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb344-5" data-line-number="5"></a>
<a class="sourceLine" id="cb344-6" data-line-number="6">h</a></code></pre></div>
<pre><code>## [1] 0.6103498 0.9507510</code></pre>
<p>Let’s put those <code>h</code> values to work.</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb346-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">.01</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb346-2" data-line-number="2"><span class="st">  </span></a>
<a class="sourceLine" id="cb346-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb346-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb346-5" data-line-number="5">                  <span class="dt">ymax =</span> <span class="kw">dbeta</span>(x, <span class="dt">shape1 =</span> <span class="dv">15</span>, <span class="dt">shape2 =</span> <span class="dv">4</span>)),</a>
<a class="sourceLine" id="cb346-6" data-line-number="6">              <span class="dt">fill =</span> <span class="st">&quot;grey75&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb346-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> . <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(x <span class="op">&gt;=</span>h[<span class="dv">1</span>] <span class="op">&amp;</span><span class="st"> </span>x <span class="op">&lt;=</span><span class="st"> </span>h[<span class="dv">2</span>]),</a>
<a class="sourceLine" id="cb346-8" data-line-number="8">              <span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb346-9" data-line-number="9">                  <span class="dt">ymax =</span> <span class="kw">dbeta</span>(x, <span class="dt">shape1 =</span> <span class="dv">15</span>, <span class="dt">shape2 =</span> <span class="dv">4</span>)),</a>
<a class="sourceLine" id="cb346-10" data-line-number="10">              <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb346-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">c</span>(h[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="fl">.01</span>, h[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span><span class="fl">.002</span>),</a>
<a class="sourceLine" id="cb346-12" data-line-number="12">                          <span class="dt">y =</span> <span class="kw">c</span>(.<span class="dv">75</span>, <span class="fl">.75</span>)),</a>
<a class="sourceLine" id="cb346-13" data-line-number="13">            <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y),</a>
<a class="sourceLine" id="cb346-14" data-line-number="14">            <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(.<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>),</a>
<a class="sourceLine" id="cb346-15" data-line-number="15">                          <span class="dt">ends =</span> <span class="st">&quot;both&quot;</span>,</a>
<a class="sourceLine" id="cb346-16" data-line-number="16">                          <span class="dt">type =</span> <span class="st">&quot;closed&quot;</span>),</a>
<a class="sourceLine" id="cb346-17" data-line-number="17">            <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb346-18" data-line-number="18"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">.8</span>, <span class="dt">y =</span> <span class="fl">1.1</span>, </a>
<a class="sourceLine" id="cb346-19" data-line-number="19">           <span class="dt">label =</span> <span class="st">&quot;95% HDI&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb346-20" data-line-number="20"><span class="st">  </span><span class="kw">xlim</span>(.<span class="dv">4</span>, <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb346-21" data-line-number="21"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;p(x)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb346-22" data-line-number="22"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-191-1.png" width="432" /></p>
<p>Figure 4.5.c was also a lot of trial and error. It seemed the easiest way to reproduce the shape was to mash two Gaussians together. After playing around with <code>rnorm()</code>, I ended up with this.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb347-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb347-2" data-line-number="2">d &lt;-</a>
<a class="sourceLine" id="cb347-3" data-line-number="3"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="kw">rnorm</span>(<span class="fl">6e5</span>, <span class="dt">mean =</span> <span class="fl">1.50</span>, <span class="dt">sd =</span> <span class="fl">.5</span>),</a>
<a class="sourceLine" id="cb347-4" data-line-number="4">               <span class="kw">rnorm</span>(<span class="fl">4e5</span>, <span class="dt">mean =</span> <span class="fl">4.75</span>, <span class="dt">sd =</span> <span class="fl">.5</span>)))</a>
<a class="sourceLine" id="cb347-5" data-line-number="5"></a>
<a class="sourceLine" id="cb347-6" data-line-number="6"><span class="kw">glimpse</span>(d)</a></code></pre></div>
<pre><code>## Observations: 1,000,000
## Variables: 1
## $ x &lt;dbl&gt; 1.6083774, 1.2287537, 1.9455723, 1.7979903, 2.3178090, 1.84463…</code></pre>
<p>As you’ll see, it’s not exactly right. But it’s close enough to give you a sense of what’s going on. But anyway, since we’re working with simulated data rather than an analytic solution, we’ll want to use a powerful convenience function from the <strong>tidybayes</strong> package.</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb349-1" data-line-number="1"><span class="kw">library</span>(tidybayes)</a></code></pre></div>
<p>Kay’s <strong>tidybayes</strong> package</p>
<blockquote>
<p>provides a family of functions for generating point summaries and intervals from draws in a tidy format. These functions follow the naming scheme <code>[median|mean|mode]_[qi|hdi]</code>, for example, <code>median_qi</code>, <code>mean_qi</code>, <code>mode_hdi</code>, and so on. The first name (before the <code>_</code>) indicates the type of point summary, and the second name indicates the type of interval. <code>qi</code> yields a quantile interval (a.k.a. equi-tailed interval, central interval, or percentile interval) and <code>hdi</code> yields a highest (posterior) density interval. (from <a href="https://mjskay.github.io/tidybayes/articles/tidy-brms.html">here</a>)</p>
</blockquote>
<p>Here we’ll use <code>mode_hdi()</code> to compute the HDIs and put them in a tibble. We’ll be using a lot of <code>mode_hdi()</code> in this project.</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb350-1" data-line-number="1">h &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb350-2" data-line-number="2"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb350-3" data-line-number="3"><span class="st">  </span><span class="kw">mode_hdi</span>()</a>
<a class="sourceLine" id="cb350-4" data-line-number="4"></a>
<a class="sourceLine" id="cb350-5" data-line-number="5">h</a></code></pre></div>
<pre><code>## # A tibble: 2 x 6
##       x .lower .upper .width .point .interval
##   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1  1.50  0.458   2.55   0.95 mode   hdi      
## 2  1.50  3.82    5.68   0.95 mode   hdi</code></pre>
<p>Usually, <code>mode_hdi()</code> will return a tibble with just one row. But in this case, since we had a bimodal distribution, it returned two rows—one for each of the two distinct regions. Oh, and in case it wasn’t clear, that first column <code>x</code> is the measure of central tendency—the mode, in this case. Though I acknowledge, it’s a little odd to speak of central tendency in a bimodal distribution. Again, this won’t happen much.</p>
<p>In order to fill the bimodal density with the split HDIs, you need to use the <code>density()</code> function to transform the <code>d</code> data to a tibble with the values for the x-axis in an <code>x</code> vector and the corresponding density values in a <code>y</code> vector.</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb352-1" data-line-number="1">dens &lt;-</a>
<a class="sourceLine" id="cb352-2" data-line-number="2"><span class="st">  </span>d<span class="op">$</span>x <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb352-3" data-line-number="3"><span class="st">  </span><span class="kw">density</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb352-4" data-line-number="4"><span class="st">  </span><span class="kw">with</span>(<span class="kw">tibble</span>(x, y))</a>
<a class="sourceLine" id="cb352-5" data-line-number="5"></a>
<a class="sourceLine" id="cb352-6" data-line-number="6"><span class="kw">head</span>(dens)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##       x            y
##   &lt;dbl&gt;        &lt;dbl&gt;
## 1 -1.11 0.0000000503
## 2 -1.09 0.0000000822
## 3 -1.08 0.000000131 
## 4 -1.06 0.000000201 
## 5 -1.04 0.000000304 
## 6 -1.03 0.000000449</code></pre>
<p>We’re finally ready to plot. Forgive me. It’s a monster.</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb354-1" data-line-number="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> dens,</a>
<a class="sourceLine" id="cb354-2" data-line-number="2">         <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb354-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> y),</a>
<a class="sourceLine" id="cb354-4" data-line-number="4">              <span class="dt">size =</span> <span class="dv">0</span>, <span class="dt">fill =</span> <span class="st">&quot;grey75&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb354-5" data-line-number="5"><span class="st">  </span><span class="co"># note the use of `pull()`, which extracts the values, rather than return a tibble  </span></a>
<a class="sourceLine" id="cb354-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> dens <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(x <span class="op">&gt;</span><span class="st"> </span>h[<span class="dv">1</span>, <span class="dv">2</span>] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>() <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb354-7" data-line-number="7"><span class="st">                                       </span>x <span class="op">&lt;</span><span class="st"> </span>h[<span class="dv">1</span>, <span class="dv">3</span>] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>()),</a>
<a class="sourceLine" id="cb354-8" data-line-number="8">              <span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> y),</a>
<a class="sourceLine" id="cb354-9" data-line-number="9">              <span class="dt">size =</span> <span class="dv">0</span>, <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb354-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> dens <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(x <span class="op">&gt;</span><span class="st"> </span>h[<span class="dv">2</span>, <span class="dv">2</span>] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>() <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb354-11" data-line-number="11"><span class="st">                                       </span>x <span class="op">&lt;</span><span class="st"> </span>h[<span class="dv">2</span>, <span class="dv">3</span>] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>()),</a>
<a class="sourceLine" id="cb354-12" data-line-number="12">              <span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> y),</a>
<a class="sourceLine" id="cb354-13" data-line-number="13">              <span class="dt">size =</span> <span class="dv">0</span>, <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb354-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">c</span>(h[<span class="dv">1</span>, <span class="dv">2</span>] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(), h[<span class="dv">1</span>, <span class="dv">3</span>] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>()),</a>
<a class="sourceLine" id="cb354-15" data-line-number="15">                          <span class="dt">y =</span> <span class="kw">c</span>(.<span class="dv">06</span>, <span class="fl">.06</span>)),</a>
<a class="sourceLine" id="cb354-16" data-line-number="16">            <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y),</a>
<a class="sourceLine" id="cb354-17" data-line-number="17">            <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(.<span class="dv">2</span>,<span class="st">&quot;cm&quot;</span>),</a>
<a class="sourceLine" id="cb354-18" data-line-number="18">                          <span class="dt">ends =</span> <span class="st">&quot;both&quot;</span>,</a>
<a class="sourceLine" id="cb354-19" data-line-number="19">                          <span class="dt">type =</span> <span class="st">&quot;closed&quot;</span>),</a>
<a class="sourceLine" id="cb354-20" data-line-number="20">            <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb354-21" data-line-number="21"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">c</span>(h[<span class="dv">2</span>, <span class="dv">2</span>] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(), h[<span class="dv">2</span>, <span class="dv">3</span>] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>()),</a>
<a class="sourceLine" id="cb354-22" data-line-number="22">                          <span class="dt">y =</span> <span class="kw">c</span>(.<span class="dv">06</span>, <span class="fl">.06</span>)),</a>
<a class="sourceLine" id="cb354-23" data-line-number="23">            <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y),</a>
<a class="sourceLine" id="cb354-24" data-line-number="24">            <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(.<span class="dv">2</span>,<span class="st">&quot;cm&quot;</span>),</a>
<a class="sourceLine" id="cb354-25" data-line-number="25">                          <span class="dt">ends =</span> <span class="st">&quot;both&quot;</span>,</a>
<a class="sourceLine" id="cb354-26" data-line-number="26">                          <span class="dt">type =</span> <span class="st">&quot;closed&quot;</span>),</a>
<a class="sourceLine" id="cb354-27" data-line-number="27">            <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb354-28" data-line-number="28"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">1.5</span>, <span class="dt">y =</span> <span class="fl">.1</span>, </a>
<a class="sourceLine" id="cb354-29" data-line-number="29">           <span class="dt">label =</span> <span class="st">&quot;95% HDI&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb354-30" data-line-number="30"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">4.75</span>, <span class="dt">y =</span> <span class="fl">.1</span>, </a>
<a class="sourceLine" id="cb354-31" data-line-number="31">           <span class="dt">label =</span> <span class="st">&quot;95% HDI&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb354-32" data-line-number="32"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">6.3</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb354-33" data-line-number="33"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;p(x)&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.3</span>, <span class="fl">.4</span>, <span class="fl">.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb354-34" data-line-number="34"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-196-1.png" width="432" /></p>
</div>
</div>
<div id="two-way-distributions" class="section level2">
<h2><span class="header-section-number">4.4</span> Two-way distributions</h2>
<p>Here’s a way to compute the marginals from the inner cells of Table 4.1.</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb355-1" data-line-number="1">d1 &lt;-</a>
<a class="sourceLine" id="cb355-2" data-line-number="2"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">eye_color =</span> <span class="kw">c</span>(<span class="st">&quot;brown&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;hazel&quot;</span>, <span class="st">&quot;green&quot;</span>),</a>
<a class="sourceLine" id="cb355-3" data-line-number="3">       <span class="dt">black     =</span> <span class="kw">c</span>(.<span class="dv">11</span>, <span class="fl">.03</span>, <span class="fl">.03</span>, <span class="fl">.01</span>),</a>
<a class="sourceLine" id="cb355-4" data-line-number="4">       <span class="dt">brunette  =</span> <span class="kw">c</span>(.<span class="dv">2</span>, <span class="fl">.14</span>, <span class="fl">.09</span>, <span class="fl">.05</span>),</a>
<a class="sourceLine" id="cb355-5" data-line-number="5">       <span class="dt">red       =</span> <span class="kw">c</span>(.<span class="dv">04</span>, <span class="fl">.03</span>, <span class="fl">.02</span>, <span class="fl">.02</span>),</a>
<a class="sourceLine" id="cb355-6" data-line-number="6">       <span class="dt">blond     =</span> <span class="kw">c</span>(.<span class="dv">01</span>, <span class="fl">.16</span>, <span class="fl">.02</span>, <span class="fl">.03</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb355-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">marginal_eye_color =</span> black <span class="op">+</span><span class="st"> </span>brunette <span class="op">+</span><span class="st"> </span>red <span class="op">+</span><span class="st"> </span>blond)</a>
<a class="sourceLine" id="cb355-8" data-line-number="8"></a>
<a class="sourceLine" id="cb355-9" data-line-number="9">d2 &lt;-</a>
<a class="sourceLine" id="cb355-10" data-line-number="10"><span class="st">  </span>d1 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb355-11" data-line-number="11"><span class="st">  </span><span class="kw">summarise_if</span>(is.double, sum) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb355-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">eye_color =</span> <span class="st">&quot;marginal_hair_color&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb355-13" data-line-number="13"><span class="st">  </span><span class="kw">select</span>(eye_color, <span class="kw">everything</span>())</a>
<a class="sourceLine" id="cb355-14" data-line-number="14"></a>
<a class="sourceLine" id="cb355-15" data-line-number="15"><span class="kw">bind_rows</span>(d1, d2)</a></code></pre></div>
<pre><code>## # A tibble: 5 x 6
##   eye_color           black brunette   red blond marginal_eye_color
##   &lt;chr&gt;               &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;              &lt;dbl&gt;
## 1 brown                0.11     0.2   0.04  0.01              0.36 
## 2 blue                 0.03     0.14  0.03  0.16              0.36 
## 3 hazel                0.03     0.09  0.02  0.02              0.160
## 4 green                0.01     0.05  0.02  0.03              0.11 
## 5 marginal_hair_color  0.18     0.48  0.11  0.22              0.99</code></pre>
</div>
<div id="reference-3" class="section level2 unnumbered">
<h2>Reference</h2>
<p><a href="https://sites.google.com/site/doingbayesiandataanalysis/">Kruschke, J. K. (2015). <em>Doing Bayesian data analysis, Second Edition: A tutorial with R, JAGS, and Stan.</em> Burlington, MA: Academic Press/Elsevier.</a></p>
</div>
<div id="session-info-3" class="section level2 unnumbered">
<h2>Session info</h2>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb357-1" data-line-number="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>## R version 3.6.0 (2019-04-26)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS High Sierra 10.13.6
## 
## Matrix products: default
## BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] tidybayes_1.1.0    santoku_0.2.0.9000 forcats_0.4.0     
##  [4] stringr_1.4.0      dplyr_0.8.3        purrr_0.3.2       
##  [7] readr_1.3.1        tidyr_1.0.0        tibble_2.1.3      
## [10] ggplot2_3.2.1      tidyverse_1.2.1   
## 
## loaded via a namespace (and not attached):
##   [1] pacman_0.5.1              utf8_1.1.4               
##   [3] ggstance_0.3.2            tidyselect_0.2.5         
##   [5] htmlwidgets_1.5           grid_3.6.0               
##   [7] munsell_0.5.0             codetools_0.2-16         
##   [9] DT_0.9                    miniUI_0.1.1.1           
##  [11] withr_2.1.2               Brobdingnag_1.2-6        
##  [13] colorspace_1.4-1          knitr_1.23               
##  [15] rstudioapi_0.10           stats4_3.6.0             
##  [17] bayesplot_1.7.0           labeling_0.3             
##  [19] rstan_2.19.2              bridgesampling_0.7-2     
##  [21] coda_0.19-3               vctrs_0.2.0              
##  [23] generics_0.0.2            xfun_0.10                
##  [25] R6_2.4.0                  markdown_1.1             
##  [27] HDInterval_0.2.0          assertthat_0.2.1         
##  [29] promises_1.1.0            scales_1.0.0             
##  [31] gtable_0.3.0              processx_3.4.1           
##  [33] rlang_0.4.0               zeallot_0.1.0            
##  [35] lazyeval_0.2.2            broom_0.5.2              
##  [37] inline_0.3.15             yaml_2.2.0               
##  [39] reshape2_1.4.3            abind_1.4-5              
##  [41] modelr_0.1.4              threejs_0.3.1            
##  [43] crosstalk_1.0.0           backports_1.1.5          
##  [45] httpuv_1.5.2              rsconnect_0.8.15         
##  [47] tools_3.6.0               bookdown_0.12            
##  [49] ellipsis_0.3.0            ggridges_0.5.1           
##  [51] Rcpp_1.0.2                plyr_1.8.4               
##  [53] base64enc_0.1-3           ps_1.3.0                 
##  [55] prettyunits_1.0.2         openssl_1.4.1            
##  [57] zoo_1.8-6                 haven_2.1.0              
##  [59] magrittr_1.5              colourpicker_1.0         
##  [61] packrat_0.5.0             matrixStats_0.55.0       
##  [63] hms_0.4.2                 shinyjs_1.0              
##  [65] mime_0.7                  evaluate_0.14            
##  [67] arrayhelpers_1.0-20160527 xtable_1.8-4             
##  [69] shinystan_2.5.0           readxl_1.3.1             
##  [71] gridExtra_2.3             rstantools_2.0.0         
##  [73] compiler_3.6.0            crayon_1.3.4             
##  [75] StanHeaders_2.19.0        htmltools_0.4.0          
##  [77] later_1.0.0               lubridate_1.7.4          
##  [79] MASS_7.3-51.4             Matrix_1.2-17            
##  [81] cli_1.1.0                 parallel_3.6.0           
##  [83] igraph_1.2.4.1            pkgconfig_2.0.3          
##  [85] xml2_1.2.0                svUnit_0.7-12            
##  [87] dygraphs_1.1.1.6          rvest_0.3.4              
##  [89] callr_3.3.2               digest_0.6.21            
##  [91] rmarkdown_1.13            cellranger_1.1.0         
##  [93] curl_4.2                  shiny_1.3.2              
##  [95] gtools_3.8.1              lifecycle_0.1.0          
##  [97] nlme_3.1-139              jsonlite_1.6             
##  [99] askpass_1.1               fansi_0.4.0              
## [101] pillar_1.4.2              lattice_0.20-38          
## [103] loo_2.1.0                 httr_1.4.0               
## [105] pkgbuild_1.0.5            glue_1.3.1               
## [107] xts_0.11-2                shinythemes_1.1.2        
## [109] stringi_1.4.3</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-r-programming-language.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bayes-rule.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
